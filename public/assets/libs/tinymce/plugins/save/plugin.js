!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=e=>"function"==typeof e;var n=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),o=tinymce.util.Tools.resolve("tinymce.util.Tools");let a=e=>t=>t.options.get(e),i=e=>{let t=e.options.register;t("save_enablewhendirty",{processor:"boolean",default:!0}),t("save_onsavecallback",{processor:"function"}),t("save_oncancelcallback",{processor:"function"})},l=a("save_enablewhendirty"),r=a("save_onsavecallback"),c=a("save_oncancelcallback"),s=(e,t)=>{e.notificationManager.open({text:t,type:"error"})},d=e=>{let o=n.DOM.getParent(e.id,"form");if(l(e)&&!e.isDirty())return;e.save();let a=r(e);if(t(a)){a.call(e,e),e.nodeChanged();return}o?(e.setDirty(!1),(!o.onsubmit||o.onsubmit())&&("function"==typeof o.submit?o.submit():s(e,"Error: Form submit field collision.")),e.nodeChanged()):s(e,"Error: No form element found.")},m=e=>{let n=o.trim(e.startContent),a=c(e);if(t(a)){a.call(e,e);return}e.resetContent(n)},u=e=>{e.addCommand("mceSave",()=>{d(e)}),e.addCommand("mceCancel",()=>{m(e)})},v=e=>t=>{let n=()=>{t.setEnabled(!l(e)||e.isDirty())};return n(),e.on("NodeChange dirty",n),()=>e.off("NodeChange dirty",n)},f=e=>{e.ui.registry.addButton("save",{icon:"save",tooltip:"Save",enabled:!1,onAction:()=>e.execCommand("mceSave"),onSetup:v(e)}),e.ui.registry.addButton("cancel",{icon:"cancel",tooltip:"Cancel",enabled:!1,onAction:()=>e.execCommand("mceCancel"),onSetup:v(e)}),e.addShortcut("Meta+S","","mceSave")};e.add("save",e=>{i(e),f(e),u(e)})}();