!function(){"use strict";let e=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}};var t=tinymce.util.Tools.resolve("tinymce.PluginManager");let n=(e,t,n)=>{var r;return!!n(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},r=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&n(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},l=e=>t=>r(t)===e,u=e=>t=>typeof t===e,o=l("string"),a=l("array"),s=u("boolean"),i=e=>null==e,d=e=>!i(e),c=u("number"),m=()=>{},h=e=>()=>e,g=h(!0),f=`[~\u2116|!-*+-\\/:;?@\\[-\`{}\u00A1\u00AB\u00B7\u00BB\u00BF;\u00B7\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1361-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u3008\u3009\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30\u2E31\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]`,p=h(f);class F{constructor(e,t){this.tag=e,this.value=t}static some(e){return new F(!0,e)}static none(){return F.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?F.some(e(this.value)):F.none()}bind(e){return this.tag?e(this.value):F.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:F.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return d(e)?F.some(e):F.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}F.singletonNone=new F(!1);var A=tinymce.util.Tools.resolve("tinymce.Env"),E=tinymce.util.Tools.resolve("tinymce.util.Tools");let y=Array.prototype.slice,x=Array.prototype.push,C=(e,t)=>{let n=e.length,r=Array(n);for(let l=0;l<n;l++){let n=e[l];r[l]=t(n,l)}return r},b=(e,t)=>{for(let n=0,r=e.length;n<r;n++){let r=e[n];t(r,n)}},D=(e,t)=>{for(let n=e.length-1;n>=0;n--){let r=e[n];t(r,n)}},v=(e,t)=>{if(0===e.length)return[];{let n=t(e[0]),r=[],l=[];for(let u=0,o=e.length;u<o;u++){let o=e[u],a=t(o);a!==n&&(r.push(l),l=[]),n=a,l.push(o)}return 0!==l.length&&r.push(l),r}},w=(e,t,n)=>(b(e,(e,r)=>{n=t(n,e,r)}),n),B=e=>{let t=[];for(let n=0,r=e.length;n<r;++n){if(!a(e[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+e);x.apply(t,e[n])}return t},N=(e,t)=>B(C(e,t)),T=(e,t)=>{let n=y.call(e,0);return n.sort(t),n},O=Object.hasOwnProperty,k=(e,t)=>O.call(e,t);"undefined"!=typeof window?window:Function("return this;")();let S=e=>e.dom.nodeType,M=(e,t,n)=>{if(o(n)||s(n)||c(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),Error("Attribute value was not simple")},I=(e,t,n)=>{M(e.dom,t,n)},R=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},P={fromHtml:(e,t)=>{let n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return R(r.childNodes[0])},fromTag:(e,t)=>{let n=t||document,r=n.createElement(e);return R(r)},fromText:(e,t)=>{let n=t||document,r=n.createTextNode(e);return R(r)},fromDom:R,fromPoint:(e,t,n)=>F.from(e.dom.elementFromPoint(t,n)).map(R)},W=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,$=(e,t)=>{let n=void 0===t?document:t.dom;return W(n)?[]:C(n.querySelectorAll(e),P.fromDom)},V=e=>F.from(e.dom.parentNode).map(P.fromDom),j=e=>C(e.dom.childNodes,P.fromDom),H=(e,t)=>({element:e,offset:t}),z=(e,t)=>{let n=j(e);return n.length>0&&t<n.length?H(n[t],0):H(e,t)},L=(e,t)=>{let n=V(e);n.each(n=>{n.dom.insertBefore(t.dom,e.dom)})},U=(e,t)=>{e.dom.appendChild(t.dom)},_=(e,t)=>{L(e,t),U(t,e)},q=((e,t)=>{let n=t=>e(t)?F.from(t.dom.nodeValue):F.none();return{get:r=>{if(!e(r))throw Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:(n,r)=>{if(!e(n))throw Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}})(e=>3===S(e),"text"),G=e=>q.get(e),K=(e,t,n)=>(e.compareDocumentPosition(t)&n)!=0,J=(e,t)=>K(e,t,Node.DOCUMENT_POSITION_PRECEDING),Q=(e,t)=>$(t,e);var X=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker");let Y=(e,t)=>e.isBlock(t)||k(e.schema.getVoidElements(),t.nodeName),Z=(e,t)=>"false"===e.getContentEditable(t),ee=(e,t)=>"true"===e.getContentEditable(t)&&t.parentNode&&"false"===e.getContentEditableParent(t.parentNode),et=(e,t)=>!e.isBlock(t)&&k(e.schema.getWhitespaceElements(),t.nodeName),en=(e,t)=>Y(e,t)||Z(e,t)||et(e,t)||ee(e,t),er=e=>3===e.nodeType,el=()=>({sOffset:0,fOffset:0,elements:[]}),eu=(e,t)=>z(P.fromDom(e),t),eo=(e,t,n,r,l,u=!0)=>{let o=u?t(!1):n;for(;o;){let n=Z(e,o);if(n||et(e,o)){let e=n?r.cef(o):r.boundary(o);if(e)break;o=t(!0);continue}if(Y(e,o)){if(r.boundary(o))break}else er(o)&&r.text(o);if(o===l)break;o=t(!1)}},ea=(e,t,n,r,l)=>{var u;if(en(e,n))return;let o=null!==(u=e.getParent(r,e.isBlock))&&void 0!==u?u:e.getRoot(),a=new X(n,o),s=l?a.next.bind(a):a.prev.bind(a);eo(e,s,n,{boundary:g,cef:g,text:e=>{l?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(P.fromDom(e))}})},es=(e,t,n,r,l,u=!0)=>{let o=new X(n,t),a=[],s=el();ea(e,s,n,t,!1);let i=()=>(s.elements.length>0&&(a.push(s),s=el()),!1);return eo(e,o.next.bind(o),n,{boundary:i,cef:e=>(i(),l&&a.push(...l.cef(e)),!1),text:e=>{s.elements.push(P.fromDom(e)),l&&l.text(e,s)}},r,u),r&&ea(e,s,r,t,!0),i(),a},ei=(e,t)=>{let n=eu(t.startContainer,t.startOffset),r=n.element.dom,l=eu(t.endContainer,t.endOffset),u=l.element.dom;return es(e,t.commonAncestorContainer,r,u,{text:(e,t)=>{e===u?t.fOffset+=e.length-l.offset:e===r&&(t.sOffset+=n.offset)},cef:t=>{let n=N(Q(P.fromDom(t),"*[contenteditable=true]"),t=>{let n=t.dom;return es(e,n,n)});return T(n,(e,t)=>J(e.elements[0].dom,t.elements[0].dom)?1:-1)}},!1)},ed=(e,t)=>t.collapsed?[]:ei(e,t),ec=(e,t)=>{let n=e.createRng();return n.selectNode(t),ed(e,n)},em=(e,t)=>N(t,t=>ec(e,t)),eh=(e,t,n=0,r=e.length)=>{let l;let u=t.regex;u.lastIndex=n;let o=[];for(;l=u.exec(e);){let e=l[t.matchIndex],n=l.index+l[0].indexOf(e),a=n+e.length;if(a>r)break;o.push({start:n,finish:a}),u.lastIndex=a}return o},eg=(e,t)=>{let n=w(e,(e,n)=>{let r=G(n),l=e.last,u=l+r.length,o=N(t,(e,t)=>e.start<u&&e.finish>l?[{element:n,start:Math.max(l,e.start)-l,finish:Math.min(u,e.finish)-l,matchId:t}]:[]);return{results:e.results.concat(o),last:u}},{results:[],last:0}).results;return v(n,e=>e.matchId)},ef=(e,t)=>N(t,t=>{let n=t.elements,r=C(n,G).join(""),l=eh(r,e,t.sOffset,r.length-t.fOffset);return eg(n,l)}),ep=(e,t)=>{D(e,(e,n)=>{D(e,e=>{let r=P.fromDom(t.cloneNode(!1));I(r,"data-mce-index",n);let l=e.element.dom;if(l.length===e.finish&&0===e.start)_(e.element,r);else{l.length!==e.finish&&l.splitText(e.finish);let t=l.splitText(e.start);_(P.fromDom(t),r)}})})},eF=(e,t,n,r)=>{let l=ec(e,n),u=ef(t,l);return ep(u,r),u.length},eA=(e,t,n,r)=>{let l=n.getBookmark(),u=e.select("td[data-mce-selected],th[data-mce-selected]"),o=u.length>0?em(e,u):ed(e,n.getRng()),a=ef(t,o);return ep(a,r),n.moveToBookmark(l),a.length},eE=e=>e.getAttribute("data-mce-index"),ey=(e,t,n,r)=>{let l=e.dom.create("span",{"data-mce-bogus":1});l.className="mce-match-marker";let u=e.getBody();return(ek(e,t,!1),r)?eA(e.dom,n,e.selection,l):eF(e.dom,n,u,l)},ex=e=>{var t;let n=e.parentNode;e.firstChild&&n.insertBefore(e.firstChild,e),null===(t=e.parentNode)||void 0===t||t.removeChild(e)},eC=(e,t)=>{let n=[],r=E.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(let e=0;e<r.length;e++){let l=eE(r[e]);null!==l&&l.length&&l===t.toString()&&n.push(r[e])}return n},eb=(e,t,n)=>{let r=t.get(),l=r.index,u=e.dom;n?l+1===r.count?l=0:l++:l-1==-1?l=r.count-1:l--,u.removeClass(eC(e,r.index),"mce-match-marker-selected");let o=eC(e,l);return o.length?(u.addClass(eC(e,l),"mce-match-marker-selected"),e.selection.scrollIntoView(o[0]),l):-1},eD=(e,t)=>{let n=t.parentNode;e.remove(t),n&&e.isEmpty(n)&&e.remove(n)},ev=(e,t)=>{let n=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]"),r="("+n+")";return t?`(?:^|\\s|${p()})`+r+`(?=$|\\s|${p()})`:r},ew=(e,t,n,r,l,u)=>{let o=e.selection,a=ev(n,l),s=o.isForward(),i={regex:new RegExp(a,r?"g":"gi"),matchIndex:1},d=ey(e,t,i,u);if(A.browser.isSafari()&&o.setRng(o.getRng(),s),d){let o=eb(e,t,!0);t.set({index:o,count:d,text:n,matchCase:r,wholeWord:l,inSelection:u})}return d},eB=(e,t)=>{let n=eb(e,t,!0);t.set({...t.get(),index:n})},eN=(e,t)=>{let n=eb(e,t,!1);t.set({...t.get(),index:n})},eT=e=>{let t=eE(e);return null!==t&&t.length>0},eO=(e,t,n,r,l)=>{let u=t.get(),o=u.index,a,s=o;r=!1!==r;let i=e.getBody(),d=E.grep(E.toArray(i.getElementsByTagName("span")),eT);for(let t=0;t<d.length;t++){let i=eE(d[t]),c=a=parseInt(i,10);if(l||c===u.index){for(n.length?(d[t].innerText=n,ex(d[t])):eD(e.dom,d[t]);d[++t];)if((c=parseInt(eE(d[t]),10))===a)eD(e.dom,d[t]);else{t--;break}r&&s--}else a>o&&d[t].setAttribute("data-mce-index",String(a-1))}return t.set({...u,count:l?0:u.count-1,index:s}),r?eB(e,t):eN(e,t),!l&&t.get().count>0},ek=(e,t,n)=>{let r,l;let u=t.get(),o=E.toArray(e.getBody().getElementsByTagName("span"));for(let e=0;e<o.length;e++){let t=eE(o[e]);null!==t&&t.length&&(t===u.index.toString()&&(r||(r=o[e].firstChild),l=o[e].firstChild),ex(o[e]))}if(t.set({...u,index:-1,count:0,text:""}),r&&l){let t=e.dom.createRng();return t.setStart(r,0),t.setEnd(l,l.data.length),!1!==n&&e.selection.setRng(t),t}},eS=(e,t)=>t.get().count>1,eM=(e,t)=>t.get().count>1,eI=(e,t)=>({done:n=>ek(e,t,n),find:(n,r,l,u=!1)=>ew(e,t,n,r,l,u),next:()=>eB(e,t),prev:()=>eN(e,t),replace:(n,r,l)=>eO(e,t,n,r,l)}),eR=t=>{let n=e(F.none()),r=()=>n.get().each(t);return{clear:()=>{r(),n.set(F.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:e=>{r(),n.set(F.some(e))}}},eP=()=>{let e=eR(m);return{...e,on:t=>e.get().each(t)}},eW=(e,t)=>{let n=eP();e.undoManager.add();let r=E.trim(e.selection.getContent({format:"text"})),l=n=>{n.setEnabled("next",eS(e,t)),n.setEnabled("prev",eM(e,t))},u=e=>{let n=e.getData(),r=t.get();t.set({...r,matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection})},o=(e,t)=>{b(["replace","replaceall","prev","next"],n=>e.setEnabled(n,!t))},a=(e,t)=>{t.redial(g(e,t.getData()))},s=(e,t)=>{A.browser.isSafari()&&A.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},i=n=>{ek(e,t,!1),o(n,!0),l(n)},d=n=>{let r=n.getData(),u=t.get();if(!r.findtext.length){i(n);return}if(u.text===r.findtext&&u.matchCase===r.matchcase&&u.wholeWord===r.wholewords)eB(e,t);else{let l=ew(e,t,r.findtext,r.matchcase,r.wholewords,r.inselection);l<=0&&a(!0,n),o(n,0===l)}l(n)},c=t.get(),m={findtext:r,replacetext:"",wholewords:c.wholeWord,matchcase:c.matchCase,inselection:c.inSelection},h=e=>{let t=[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",enabled:!1,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",enabled:!1,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}];return e&&t.push({type:"alertbanner",level:"error",text:"Could not find the specified string.",icon:"warning"}),t},g=(n,r)=>({title:"Find and Replace",size:"normal",body:{type:"panel",items:h(n)},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",enabled:!1},{type:"custom",name:"replaceall",text:"Replace all",enabled:!1}],initialData:r,onChange:(e,r)=>{n&&a(!1,e),"findtext"===r.name&&t.get().count>0&&i(e)},onAction:(n,r)=>{let o=n.getData();switch(r.name){case"find":d(n);break;case"replace":eO(e,t,o.replacetext)?l(n):i(n);break;case"replaceall":eO(e,t,o.replacetext,!0,!0),i(n);break;case"prev":eN(e,t),l(n);break;case"next":eB(e,t),l(n);break;case"matchcase":case"wholewords":case"inselection":a(!1,n),u(n),i(n)}s(n,r.name)},onSubmit:e=>{d(e),s(e,"find")},onClose:()=>{e.focus(),ek(e,t),e.undoManager.add()}});n.set(e.windowManager.open(g(!1,m),{inline:"toolbar"}))},e$=(e,t)=>{e.addCommand("SearchReplace",()=>{eW(e,t)})},eV=(e,t)=>()=>{eW(e,t)},ej=(e,t)=>{e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:eV(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:eV(e,t),icon:"search"}),e.shortcuts.add("Meta+F","",eV(e,t))};t.add("searchreplace",t=>{let n=e({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return e$(t,n),ej(t,n),eI(t,n)})}();