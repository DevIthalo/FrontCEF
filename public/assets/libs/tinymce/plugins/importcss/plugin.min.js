!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=e=>t=>(e=>{var t,r;let s=typeof e;return null===e?"null":"object"===s&&Array.isArray(e)?"array":"object"===s&&((t=String).prototype.isPrototypeOf(e)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name)?"string":s})(t)===e,r=t("string"),s=t("object"),o=t("array"),l=e=>"function"==typeof e;var i=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),n=tinymce.util.Tools.resolve("tinymce.EditorManager"),c=tinymce.util.Tools.resolve("tinymce.Env"),a=tinymce.util.Tools.resolve("tinymce.util.Tools");let p=e=>t=>t.options.get(e),u=p("importcss_merge_classes"),m=p("importcss_exclusive"),f=p("importcss_selector_converter"),y=p("importcss_selector_filter"),d=p("importcss_groups"),h=p("importcss_append"),_=p("importcss_file_filter"),g=p("skin"),v=p("skin_url"),b=Array.prototype.push,x=/^\.(?:ephox|tiny-pageembed|mce)(?:[.-]+\w+)+$/,T=e=>r(e)?t=>-1!==t.indexOf(e):e instanceof RegExp?t=>e.test(t):e,S=(e,t)=>{let r={},s=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(t);if(!s)return;let o=s[1],l=s[2].substr(1).split(".").join(" "),i=a.makeMap("a,img");return s[1]?(r={title:t},e.schema.getTextBlockElements()[o]?r.block=o:e.schema.getBlockElements()[o]||i[o.toLowerCase()]?r.selector=o:r.inline=o):s[2]&&(r={inline:"span",title:t.substr(1),classes:l}),u(e)?r.classes=l:r.attributes={class:l},r},k=(e,t)=>null===t||m(e),A=e=>{e.on("init",()=>{var t;let s=(()=>{let e=[],t=[],r={};return{addItemToGroup:(e,s)=>{r[e]?r[e].push(s):(t.push(e),r[e]=[s])},addItem:t=>{e.push(t)},toFormats:()=>(e=>{let t=[];for(let r=0,s=e.length;r<s;++r){if(!o(e[r]))throw Error("Arr.flatten item "+r+" was not an array, input: "+e);b.apply(t,e[r])}return t})(((e,t)=>{let r=e.length,s=Array(r);for(let o=0;o<r;o++){let r=e[o];s[o]=t(r,o)}return s})(t,e=>{let t=r[e];return 0===t.length?[]:[{title:e,items:t}]})).concat(e)}})(),l={},p=T(y(e)),u=(t=d(e),a.map(t,e=>a.extend({},e,{original:e,selectors:{},filter:T(e.filter)}))),m=(t,r)=>{if(!(k(e,r)?t in l:t in r.selectors)){k(e,r)?l[t]=!0:r.selectors[t]=!0;let s=((e,t,r,s)=>{let o=f(e);return(s&&s.selector_converter?s.selector_converter:o||(()=>S(e,r))).call(t,r,s)})(e,e.plugins.importcss,t,r);if(s){let t=s.name||i.DOM.uniqueId();return e.formatter.register(t,s),{title:s.title,format:t}}}return null};a.each(((e,t,s)=>{let o=[],l={},i=(t,l)=>{let p,u=t.href;if((u=(e=>{let t=c.cacheSuffix;return r(e)&&(e=e.replace("?"+t,"").replace("&"+t,"")),e})(u))&&(!s||s(u,l))&&!((e,t)=>{let r=g(e);if(r){let s=v(e),o=s?e.documentBaseURI.toAbsolute(s):n.baseURL+"/skins/ui/"+r,l=n.baseURL+"/skins/content/";return t===o+"/content"+(e.inline?".inline":"")+".min.css"||-1!==t.indexOf(l)}return!1})(e,u)){a.each(t.imports,e=>{i(e,!0)});try{p=t.cssRules||t.rules}catch(e){}a.each(p,e=>{e.styleSheet?i(e.styleSheet,!0):e.selectorText&&a.each(e.selectorText.split(","),e=>{o.push(a.trim(e))})})}};a.each(e.contentCSS,e=>{l[e]=!0}),s||(s=(e,t)=>t||l[e]);try{a.each(t.styleSheets,e=>{i(e)})}catch(e){}return o})(e,e.getDoc(),T(_(e))),e=>{if(!x.test(e)&&(!p||p(e))){let t=a.grep(u,t=>!t.filter||t.filter(e));if(t.length>0)a.each(t,t=>{let r=m(e,t);r&&s.addItemToGroup(t.title,r)});else{let t=m(e,null);t&&s.addItem(t)}}});let A=s.toFormats();e.dispatch("addStyleModifications",{items:A,replace:!h(e)})})};e.add("importcss",e=>((e=>{let t=e.options.register,o=e=>r(e)||l(e)||s(e);t("importcss_merge_classes",{processor:"boolean",default:!0}),t("importcss_exclusive",{processor:"boolean",default:!0}),t("importcss_selector_converter",{processor:"function"}),t("importcss_selector_filter",{processor:o}),t("importcss_file_filter",{processor:o}),t("importcss_groups",{processor:"object[]"}),t("importcss_append",{processor:"boolean",default:!1})})(e),A(e),{convertSelectorToFormat:t=>S(e,t)}))}();