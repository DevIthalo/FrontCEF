!function(){"use strict";var e,t=tinymce.util.Tools.resolve("tinymce.PluginManager");let r=e=>t=>(e=>{var t,r;let n=typeof e;return null===e?"null":"object"===n&&Array.isArray(e)?"array":"object"===n&&((t=String).prototype.isPrototypeOf(e)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name)?"string":n})(t)===e,n=e=>t=>typeof t===e,l=r("string"),o=r("object"),i=r("array"),s=n("boolean"),a=e=>null!=e,d=n("function"),m=n("number"),u=()=>{},c=(e,t)=>e===t,p=e=>t=>!e(t),g=()=>!1;class h{constructor(e,t){this.tag=e,this.value=t}static some(e){return new h(!0,e)}static none(){return h.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?h.some(e(this.value)):h.none()}bind(e){return this.tag?e(this.value):h.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:h.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return a(e)?h.some(e):h.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}h.singletonNone=new h(!1);let f=Array.prototype.slice,y=Array.prototype.indexOf,v=Array.prototype.push,b=(e,t)=>y.call(e,t)>-1,C=(e,t)=>{for(let r=0,n=e.length;r<n;r++)if(t(e[r],r))return!0;return!1},S=(e,t)=>{let r=e.length,n=Array(r);for(let l=0;l<r;l++){let r=e[l];n[l]=t(r,l)}return n},N=(e,t)=>{for(let r=0,n=e.length;r<n;r++)t(e[r],r)},L=(e,t)=>{let r=[];for(let n=0,l=e.length;n<l;n++){let l=e[n];t(l,n)&&r.push(l)}return r},O=(e,t,r)=>(N(e,(e,n)=>{r=t(r,e,n)}),r),k=(e,t,r)=>{for(let n=0,l=e.length;n<l;n++){let l=e[n];if(t(l,n))return h.some(l);if(r(l,n))break}return h.none()},T=(e,t)=>k(e,t,g),A=(e,t)=>(e=>{let t=[];for(let r=0,n=e.length;r<n;++r){if(!i(e[r]))throw Error("Arr.flatten item "+r+" was not an array, input: "+e);v.apply(t,e[r])}return t})(S(e,t)),E=e=>{let t=f.call(e,0);return t.reverse(),t},x=(e,t)=>t>=0&&t<e.length?h.some(e[t]):h.none(),D=e=>x(e,0),B=e=>x(e,e.length-1),w=(e,t)=>{let r=[],n=d(t)?e=>C(r,r=>t(r,e)):e=>b(r,e);for(let t=0,l=e.length;t<l;t++){let l=e[t];n(l)||r.push(l)}return r},I=(e,t,r=c)=>e.exists(e=>r(e,t)),P=(e,t,r)=>e.isSome()&&t.isSome()?h.some(r(e.getOrDie(),t.getOrDie())):h.none(),M=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},R=(e,t)=>{let r=(t||document).createElement(e);return M(r)},U=(e,t)=>e.dom===t.dom;"undefined"!=typeof window?window:Function("return this;")();let $=e=>e.dom.nodeName.toLowerCase(),_=e=>1===e.dom.nodeType,F=e=>t=>_(t)&&$(t)===e,H=e=>h.from(e.dom.parentNode).map(M),V=e=>S(e.dom.childNodes,M),j=(e,t)=>h.from(e.dom.childNodes[t]).map(M),K=e=>j(e,0),z=e=>j(e,e.dom.childNodes.length-1),Q=(e,t,r)=>{let n=e.dom,l=d(r)?r:g;for(;n.parentNode;){n=n.parentNode;let e=M(n);if(t(e))return h.some(e);if(l(e))break}return h.none()},q=(e,t,r)=>t(e)?h.some(e):d(r)&&r(e)?h.none():Q(e,t,r),W=(e,t)=>{H(e).each(r=>{r.dom.insertBefore(t.dom,e.dom)})},Z=(e,t)=>{e.dom.appendChild(t.dom)},G=(e,t)=>{N(t,t=>{Z(e,t)})},J=e=>{e.dom.textContent="",N(V(e),e=>{X(e)})},X=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)};var Y=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),ee=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),et=tinymce.util.Tools.resolve("tinymce.util.VK");let er=e=>S(e,M),en=Object.keys,el=(e,t)=>{let r=en(e);for(let n=0,l=r.length;n<l;n++){let l=r[n];t(e[l],l)}},eo=(e,t)=>{let r=e.dom;el(t,(e,t)=>{((e,t,r)=>{if(!(l(r)||s(r)||m(r)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(t,r+"")})(r,t,e)})},ei=e=>O(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),es=e=>M(e.dom.cloneNode(!0)),ea=(e,t)=>{let r=((e,t)=>{let r=R(t),n=ei(e);return eo(r,n),r})(e,t);h.from(e.dom.nextSibling).map(M).fold(()=>{H(e).each(e=>{Z(e,r)})},e=>{W(e,r)});let n=V(e);return G(r,n),X(e),r};var ed=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),em=tinymce.util.Tools.resolve("tinymce.util.Tools");let eu=e=>t=>a(t)&&t.nodeName.toLowerCase()===e,ec=e=>t=>a(t)&&e.test(t.nodeName),ep=e=>a(e)&&3===e.nodeType,eg=e=>a(e)&&1===e.nodeType,eh=ec(/^(OL|UL|DL)$/),ef=ec(/^(OL|UL)$/),ey=eu("ol"),ev=ec(/^(LI|DT|DD)$/),eb=ec(/^(DT|DD)$/),eC=ec(/^(TH|TD)$/),eS=eu("br"),eN=(e,t)=>a(t)&&t.nodeName in e.schema.getTextBlockElements(),eL=(e,t)=>a(e)&&e.nodeName in t,eO=(e,t)=>a(t)&&t.nodeName in e.schema.getVoidElements(),ek=(e,t,r)=>{let n=e.isEmpty(t);return!(r&&e.select("span[data-mce-type=bookmark]",t).length>0)&&n},eT=(e,t)=>e.isChildOf(t,e.getRoot()),eA=e=>t=>t.options.get(e),eE=eA("lists_indent_on_tab"),ex=eA("forced_root_block"),eD=eA("forced_root_block_attrs"),eB=(e,t)=>{let r=e.dom,n=e.schema.getBlockElements(),l=r.createFragment(),o=ex(e),i=eD(e),s,a,d=!1;for(a=r.create(o,i),eL(t.firstChild,n)||l.appendChild(a);s=t.firstChild;){let e=s.nodeName;d||"SPAN"===e&&"bookmark"===s.getAttribute("data-mce-type")||(d=!0),eL(s,n)?(l.appendChild(s),a=null):(a||(a=r.create(o,i),l.appendChild(a)),a.appendChild(s))}return!d&&a&&a.appendChild(r.create("br",{"data-mce-bogus":"1"})),l},ew=ed.DOM,eI=F("dd"),eP=F("dt"),eM=(e,t)=>{eI(t)?ea(t,"dt"):eP(t)&&h.from(t.dom.parentElement).map(M).each(r=>((e,t,r)=>{let n=ew.select('span[data-mce-type="bookmark"]',t),l=eB(e,r),o=ew.createRng();o.setStartAfter(r),o.setEndAfter(t);let i=o.extractContents();for(let t=i.firstChild;t;t=t.firstChild)if("LI"===t.nodeName&&e.dom.isEmpty(t)){ew.remove(t);break}e.dom.isEmpty(i)||ew.insertAfter(i,t),ew.insertAfter(l,t);let s=r.parentElement;s&&ek(e.dom,s)&&(e=>{let t=e.parentNode;t&&em.each(n,e=>{t.insertBefore(e,r.parentNode)}),ew.remove(e)})(s),ew.remove(r),ek(e.dom,t)&&ew.remove(t)})(e,r.dom,t.dom))},eR=e=>{eP(e)&&ea(e,"dd")},eU=(e,t)=>{if(ep(e))return{container:e,offset:t};let r=Y.getNode(e,t);return ep(r)?{container:r,offset:t>=e.childNodes.length?r.data.length:0}:r.previousSibling&&ep(r.previousSibling)?{container:r.previousSibling,offset:r.previousSibling.data.length}:r.nextSibling&&ep(r.nextSibling)?{container:r.nextSibling,offset:0}:{container:e,offset:t}},e$=e=>{let t=e.cloneRange(),r=eU(e.startContainer,e.startOffset);t.setStart(r.container,r.offset);let n=eU(e.endContainer,e.endOffset);return t.setEnd(n.container,n.offset),t},e_=["OL","UL","DL"],eF=e_.join(","),eH=(e,t)=>{let r=t||e.selection.getStart(!0);return e.dom.getParent(r,eF,eK(e,r))},eV=e=>{let t=e.selection.getSelectedBlocks();return L(((e,t)=>{let r=em.map(t,t=>e.dom.getParent(t,"li,dd,dt",eK(e,t))||t);return w(r)})(e,t),ev)},ej=(e,t)=>{let r=e.dom.getParents(t,"TD,TH");return r.length>0?r[0]:e.getBody()},eK=(e,t)=>{let r=e.dom.getParents(t,e.dom.isBlock),n=T(r,t=>{var r;return r=e.schema,!eh(t)&&!ev(t)&&C(e_,e=>r.isValidChild(t.nodeName,e))});return n.getOr(e.getBody())},ez=(e,t)=>{let r=e.dom.getParents(t,"ol,ul",eK(e,t));return B(r)},eQ=(e,t)=>{let r=S(t,t=>ez(e,t).getOr(t));return w(r)},eq=e=>/\btox\-/.test(e.className),eW=(e,t)=>k(e,eh,eC).exists(e=>e.nodeName===t&&!eq(e)),eZ=(e,t)=>null!==t&&!e.dom.isEditable(t),eG=(e,t)=>{let r=e.dom.getParent(t,"ol,ul,dl");return eZ(e,r)},eJ=(e,t)=>{let r=e.selection.getNode();return t({parents:e.dom.getParents(r),element:r}),e.on("NodeChange",t),()=>e.off("NodeChange",t)},eX=(e,t,r)=>e.dispatch("ListMutation",{action:t,element:r}),eY=(e=/^\s+|\s+$/g,t=>t.replace(e,"")),e0=(e,t,r)=>{((e,t,r)=>{if(!l(r))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",e),Error("CSS value must be a string: "+r);void 0!==e.style&&d(e.style.getPropertyValue)&&e.style.setProperty(t,r)})(e.dom,t,r)},e1=(e,t)=>{Z(e.item,t.list)},e2=(e,t)=>{let r={list:R(t,e),item:R("li",e)};return Z(r.list,r.item),r},e6=e=>((e,t)=>{let r=e.dom;if(1!==r.nodeType)return!1;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw Error("Browser lacks native selectors")})(e,"OL,UL"),e3=e=>K(e).exists(e6),e4=e=>e.depth>0,e5=e=>e.isSelected,e9=e=>{let t=V(e),r=z(e).exists(e6)?t.slice(0,-1):t;return S(r,es)},e7=e=>(N(e,(t,r)=>{((e,t)=>{let r=e[t].depth,n=e=>e.depth===r&&!e.dirty,l=e=>e.depth<r;return k(E(e.slice(0,t)),n,l).orThunk(()=>k(e.slice(t+1),n,l))})(e,r).fold(()=>{t.dirty&&(t.listAttributes=((e,t)=>{var r;let n={};return r=(e,t)=>{n[t]=e},el(e,(e,n)=>{(t(e,n)?r:u)(e,n)}),n})(t.listAttributes,(e,t)=>"start"!==t))},e=>(t.listType=e.listType,void(t.listAttributes={...e.listAttributes})))}),e),e8=(e,t,r,n)=>K(n).filter(e6).fold(()=>{var l;t.each(e=>{U(e.start,n)&&r.set(!0)});let o=(l=r.get(),H(n).filter(_).map(t=>({depth:e,dirty:!1,isSelected:l,content:e9(n),itemAttributes:ei(n),listAttributes:ei(t),listType:$(t)})));t.each(e=>{U(e.end,n)&&r.set(!1)});let i=z(n).filter(e6).map(n=>te(e,t,r,n)).getOr([]);return o.toArray().concat(i)},n=>te(e,t,r,n)),te=(e,t,r,n)=>A(V(n),n=>(e6(n)?te:e8)(e+1,t,r,n)),tt=(e,t)=>{let r=e7(t);return((e,t)=>{let r=O(t,(t,r)=>r.depth>t.length?((e,t,r)=>{let n=((e,t,r)=>{let n=[];for(let l=0;l<r;l++)n.push(e2(e,t.listType));return n})(e,r,r.depth-t.length);return(e=>{for(let t=1;t<e.length;t++)e1(e[t-1],e[t])})(n),((e,t)=>{for(let t=0;t<e.length-1;t++)e0(e[t].item,"list-style-type","none");B(e).each(e=>{eo(e.list,t.listAttributes),eo(e.item,t.itemAttributes),G(e.item,t.content)})})(n,r),P(B(t),D(n),e1),t.concat(n)})(e,t,r):((e,t,r)=>{let n=t.slice(0,r.depth);return B(n).each(t=>{let n=((e,t,r)=>{let n=R("li",e);return eo(n,t),G(n,r),n})(e,r.itemAttributes,r.content);Z(t.list,n),t.item=n,$(t.list)!==r.listType&&(t.list=ea(t.list,r.listType)),eo(t.list,r.listAttributes)}),n})(e,t,r),[]);return D(r).map(e=>e.list)})(e.contentDocument,r).toArray()},tr=(e,t,r)=>{let n=((e,t)=>{let r;let n=(r=!1,{get:()=>r,set:e=>{r=e}});return S(e,e=>({sourceList:e,entries:te(0,t,n,e)}))})(t,(e=>{let t=S(eV(e),M);return P(T(t,p(e3)),T(E(t),p(e3)),(e,t)=>({start:e,end:t}))})(e));N(n,t=>{var n;N(L(t.entries,e5),e=>((e,t)=>{switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0})(r,e));let l=A(((e,t)=>{if(0===e.length)return[];{let r=t(e[0]),n=[],l=[];for(let o=0,i=e.length;o<i;o++){let i=e[o],s=t(i);s!==r&&(n.push(l),l=[]),r=s,l.push(i)}return 0!==l.length&&n.push(l),n}})(t.entries,e4),t=>D(t).exists(e4)?tt(e,t):((e,t)=>{let r=e7(t);return S(r,t=>{let r=((e,t)=>{let r=document.createDocumentFragment();return N(e,e=>{r.appendChild(e.dom)}),M(r)})(t.content);return M(eB(e,r.dom))})})(e,t));N(l,t=>{eX(e,"Indent"===r?"IndentList":"OutdentList",t.dom)}),n=t.sourceList,N(l,e=>{W(n,e)}),X(t.sourceList)})},tn=(e,t)=>{let r=er((e=>{let t=(e=>{let t=ez(e,e.selection.getStart()),r=L(e.selection.getSelectedBlocks(),ef);return t.toArray().concat(r)})(e);return eQ(e,t)})(e)),n=er(L(eV(e),eb)),l=!1;if(r.length||n.length){let o=e.selection.getBookmark();tr(e,r,t),N(n,"Indent"===t?eR:t=>eM(e,t)),e.selection.moveToBookmark(o),e.selection.setRng(e$(e.selection.getRng())),e.nodeChanged(),l=!0}return l},tl=(e,t)=>!(e=>{let t=eH(e);return eZ(e,t)})(e)&&tn(e,t),to=e=>tl(e,"Indent"),ti=e=>tl(e,"Outdent"),ts=e=>tl(e,"Flatten"),ta=e=>"\uFEFF"===e;var td=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");let tm=ed.DOM,tu=e=>{let t={},r=r=>{let n=e[r?"startContainer":"endContainer"],l=e[r?"startOffset":"endOffset"];if(eg(n)){let e=tm.create("span",{"data-mce-type":"bookmark"});n.hasChildNodes()?(l=Math.min(l,n.childNodes.length-1),r?n.insertBefore(e,n.childNodes[l]):tm.insertAfter(e,n.childNodes[l])):n.appendChild(e),n=e,l=0}t[r?"startContainer":"endContainer"]=n,t[r?"startOffset":"endOffset"]=l};return r(!0),e.collapsed||r(),t},tc=e=>{let t=t=>{let r=e[t?"startContainer":"endContainer"],n=e[t?"startOffset":"endOffset"];if(r){if(eg(r)&&r.parentNode){let e=r;n=(e=>{var t;let r=null===(t=e.parentNode)||void 0===t?void 0:t.firstChild,n=0;for(;r;){if(r===e)return n;eg(r)&&"bookmark"===r.getAttribute("data-mce-type")||n++,r=r.nextSibling}return -1})(r),r=r.parentNode,tm.remove(e),!r.hasChildNodes()&&tm.isBlock(r)&&r.appendChild(tm.create("br"))}e[t?"startContainer":"endContainer"]=r,e[t?"startOffset":"endOffset"]=n}};t(!0),t();let r=tm.createRng();return r.setStart(e.startContainer,e.startOffset),e.endContainer&&r.setEnd(e.endContainer,e.endOffset),e$(r)},tp=e=>{switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},tg=(e,t)=>{em.each(t,(t,r)=>{e.setAttribute(r,t)})},th=(e,t,r)=>{((e,t,r)=>{let n=r["list-style-type"]?r["list-style-type"]:null;e.setStyle(t,"list-style-type",n)})(e,t,r),tg(t,r["list-attributes"]),em.each(e.select("li",t),e=>{tg(e,r["list-item-attributes"])})},tf=(e,t)=>a(t)&&!eL(t,e.schema.getBlockElements()),ty=(e,t,r,n)=>{let l=t[r?"startContainer":"endContainer"],o=t[r?"startOffset":"endOffset"];eg(l)&&(l=l.childNodes[Math.min(o,l.childNodes.length-1)]||l),!r&&eS(l.nextSibling)&&(l=l.nextSibling);let i=(t,r)=>{var l;let o;let i=new ee(t,n),s=r?"next":"prev";for(;o=i[s]();)if(!eO(e,o)&&!ta(o.textContent)&&0!==(null===(l=o.textContent)||void 0===l?void 0:l.length))return h.some(o);return h.none()};if(r&&ep(l)){if(ta(l.textContent))l=i(l,!1).getOr(l);else for(null!==l.parentNode&&tf(e,l.parentNode)&&(l=l.parentNode);null!==l.previousSibling&&(tf(e,l.previousSibling)||ep(l.previousSibling));)l=l.previousSibling}if(!r&&ep(l)){if(ta(l.textContent))l=i(l,!0).getOr(l);else for(null!==l.parentNode&&tf(e,l.parentNode)&&(l=l.parentNode);null!==l.nextSibling&&(tf(e,l.nextSibling)||ep(l.nextSibling));)l=l.nextSibling}for(;l.parentNode!==n;){let t=l.parentNode;if(eN(e,l)||/^(TD|TH)$/.test(t.nodeName))break;l=t}return l},tv=(e,t,r)=>{let n=e.selection.getRng(),l="LI",o=eK(e,e.selection.getStart(!0)),i=e.dom;if("false"===i.getContentEditable(e.selection.getNode()))return;"DL"===(t=t.toUpperCase())&&(l="DT");let s=tu(n),a=L(((e,t,r)=>{let n;let l=[],o=e.dom,i=ty(e,t,!0,r),s=ty(e,t,!1,r),a=[];for(let e=i;e&&(a.push(e),e!==s);e=e.nextSibling);return em.each(a,t=>{var i;if(eN(e,t))return l.push(t),void(n=null);if(o.isBlock(t)||eS(t))return eS(t)&&o.remove(t),void(n=null);let s=t.nextSibling;td.isBookmarkNode(t)&&(eh(s)||eN(e,s)||!s&&t.parentNode===r)?n=null:(n||(n=o.create("p"),null===(i=t.parentNode)||void 0===i||i.insertBefore(n,t),l.push(n)),n.appendChild(t))}),l})(e,n,o),e.dom.isEditable);em.each(a,n=>{var o;let s;let a=n.previousSibling,d=n.parentNode;ev(d)||(a&&eh(a)&&a.nodeName===t&&((e,t,r)=>{let n=e.getStyle(t,"list-style-type"),l=r?r["list-style-type"]:"";return n===(l=null===l?"":l)})(i,a,r)?(s=a,n=i.rename(n,l),a.appendChild(n)):(s=i.create(t),d.insertBefore(s,n),s.appendChild(n),n=i.rename(n,l)),o=n,em.each(["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],e=>i.setStyle(o,e,"")),th(i,s,r),tC(e.dom,s))}),e.selection.setRng(tc(s))},tb=(e,t,r)=>eh(t)&&t.nodeName===(null==r?void 0:r.nodeName)&&e.getStyle(t,"list-style-type",!0)===e.getStyle(r,"list-style-type",!0)&&t.className===r.className,tC=(e,t)=>{let r,n=t.nextSibling;if(tb(e,t,n)){let l=n;for(;r=l.firstChild;)t.appendChild(r);e.remove(l)}if(n=t.previousSibling,tb(e,t,n)){let l=n;for(;r=l.lastChild;)t.insertBefore(r,t.firstChild);e.remove(l)}},tS=e=>"list-style-type"in e,tN=(e,t,r)=>{let n=eH(e);if(eG(e,n)||!e.hasEditableRoot())return;let l=(e=>{let t=eH(e),r=e.selection.getSelectedBlocks();return a(t)&&1===r.length&&r[0]===t?L(t.querySelectorAll(eF),eh):L(r,e=>eh(e)&&t!==e)})(e),i=o(r)?r:{};l.length>0?((e,t,r,n,l)=>{let o=eh(t);if(o&&t.nodeName===n&&!tS(l))ts(e);else{tv(e,n,l);let i=tu(e.selection.getRng()),s=o?[t,...r]:r;em.each(s,t=>{((e,t,r,n)=>{if(t.nodeName!==r){let l=e.dom.rename(t,r);th(e.dom,l,n),eX(e,tp(r),l)}else th(e.dom,t,n),eX(e,tp(r),t)})(e,t,n,l)}),e.selection.setRng(tc(i))}})(e,n,l,t,i):((e,t,r,n)=>{if(t!==e.getBody()){if(t){if(t.nodeName!==r||tS(n)||eq(t)){let l=tu(e.selection.getRng());th(e.dom,t,n);let o=e.dom.rename(t,r);tC(e.dom,o),e.selection.setRng(tc(l)),tv(e,r,n),eX(e,tp(r),o)}else ts(e)}else tv(e,r,n),eX(e,tp(r),t)}})(e,n,t,i)},tL=ed.DOM,tO=(e,t)=>{let r=em.grep(e.select("ol,ul",t));em.each(r,t=>{((e,t)=>{let r=t.parentElement;if(r&&"LI"===r.nodeName&&r.firstChild===t){let n=r.previousSibling;n&&"LI"===n.nodeName?(n.appendChild(t),ek(e,r)&&tL.remove(r)):tL.setStyle(r,"listStyleType","none")}if(eh(r)){let e=r.previousSibling;e&&"LI"===e.nodeName&&e.appendChild(t)}})(e,t)})},tk=(e,t,r,n)=>{var l,o;let i=t.startContainer,s=t.startOffset;if(ep(i)&&(r?s<i.data.length:s>0))return i;let a=e.schema.getNonEmptyElements();eg(i)&&(i=Y.getNode(i,s));let d=new ee(i,n);r&&(l=e.dom,eS(o=i)&&l.isBlock(o.nextSibling)&&!eS(o.previousSibling))&&d.next();let m=r?d.next.bind(d):d.prev2.bind(d);for(;i=m();)if("LI"===i.nodeName&&!i.hasChildNodes()||a[i.nodeName]||ep(i)&&i.data.length>0)return i;return null},tT=(e,t)=>{let r=t.childNodes;return 1===r.length&&!eh(r[0])&&e.isBlock(r[0])},tA=(e,t,r)=>{let n;let l=t.parentNode;if(!eT(e,t)||!eT(e,r))return;eh(r.lastChild)&&(n=r.lastChild),l===r.lastChild&&eS(l.previousSibling)&&e.remove(l.previousSibling);let o=r.lastChild;o&&eS(o)&&t.hasChildNodes()&&e.remove(o),ek(e,r,!0)&&J(M(r)),((e,t,r)=>{let n;let l=tT(e,r)?r.firstChild:r;if(tT(e,t)&&e.remove(t.firstChild,!0),!ek(e,t,!0))for(;n=t.firstChild;)l.appendChild(n)})(e,t,r),n&&r.appendChild(n);let i=((e,t)=>{let r=e.dom,n=t.dom;return r!==n&&r.contains(n)})(M(r),M(t))?e.getParents(t,eh,r):[];e.remove(t),N(i,t=>{ek(e,t)&&t!==e.getRoot()&&e.remove(t)})},tE=(e,t)=>{let r=e.dom,n=e.selection,l=n.getStart(),o=ej(e,l),i=r.getParent(n.getStart(),"LI",o);if(i){let l=i.parentElement;if(l===e.getBody()&&ek(r,l))return!0;let s=e$(n.getRng()),a=r.getParent(tk(e,s,t,o),"LI",o);if(a&&a!==i)return e.undoManager.transact(()=>{var r;t?((e,t,r,n)=>{let l=e.dom;if(l.isEmpty(n))J(M(n)),tA(e.dom,r,n),e.selection.setCursorLocation(n,0);else{let o=tu(t);tA(l,r,n),e.selection.setRng(tc(o))}})(e,s,a,i):(null===(r=i.parentNode)||void 0===r?void 0:r.firstChild)===i?ti(e):((e,t,r,n)=>{let l=tu(t);tA(e.dom,r,n);let o=tc(l);e.selection.setRng(o)})(e,s,i,a)}),!0;if(!a&&!t&&0===s.startOffset&&0===s.endOffset)return e.undoManager.transact(()=>{ts(e)}),!0}return!1},tx=e=>{let t=e.selection.getStart(),r=ej(e,t);return e.dom.getParent(t,"LI,DT,DD",r)||eV(e).length>0},tD=(e,t)=>{let r=e.selection;return!eG(e,r.getNode())&&(r.isCollapsed()?tE(e,t)||((e,t)=>{let r=e.dom,n=e.selection.getStart(),l=ej(e,n),o=r.getParent(n,r.isBlock,l);if(o&&r.isEmpty(o)){let n=e$(e.selection.getRng()),i=r.getParent(tk(e,n,t,l),"LI",l);if(i){let s=e=>b(["td","th","caption"],$(e)),a=e=>e.dom===l;return!!((e,t,r=c)=>P(e,t,r).getOr(e.isNone()&&t.isNone()))(q(M(i),s,a),q(M(n.startContainer),s,a),U)&&(e.undoManager.transact(()=>{((e,t,r)=>{let n=e.getParent(t.parentNode,e.isBlock,r);e.remove(t),n&&e.isEmpty(n)&&e.remove(n)})(r,o,l),tC(r,i.parentNode),e.selection.select(i,!0),e.selection.collapse(t)}),!0)}}return!1})(e,t):!!tx(e)&&(e.undoManager.transact(()=>{e.execCommand("Delete"),tO(e.dom,e.getBody())}),!0))},tB=e=>{let t=E(eY(e).split("")),r=S(t,(e,t)=>{let r=e.toUpperCase().charCodeAt(0)-65+1;return Math.pow(26,t)*r});return O(r,(e,t)=>e+t,0)},tw=e=>{if(--e<0)return"";{let t=e%26,r=Math.floor(e/26);return tw(r)+String.fromCharCode(65+t)}},tI=e=>{let t=parseInt(e.start,10);return I(e.listStyleType,"upper-alpha")?tw(t):I(e.listStyleType,"lower-alpha")?tw(t).toLowerCase():e.start},tP=(e,t)=>()=>{let r=eH(e);return a(r)&&r.nodeName===t},tM=e=>{e.addCommand("mceListProps",()=>{(e=>{let t=eH(e);ey(t)&&!eG(e,t)&&e.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:tI({start:e.dom.getAttrib(t,"start","1"),listStyleType:h.from(e.dom.getStyle(t,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:t=>{(e=>{switch(/^[0-9]+$/.test(e)?2:/^[A-Z]+$/.test(e)?0:/^[a-z]+$/.test(e)?1:e.length>0?4:3){case 2:return h.some({listStyleType:h.none(),start:e});case 0:return h.some({listStyleType:h.some("upper-alpha"),start:tB(e).toString()});case 1:return h.some({listStyleType:h.some("lower-alpha"),start:tB(e).toString()});case 3:return h.some({listStyleType:h.none(),start:""});case 4:return h.none()}})(t.getData().start).each(t=>{e.execCommand("mceListUpdate",!1,{attrs:{start:"1"===t.start?"":t.start},styles:{"list-style-type":t.listStyleType.getOr("")}})}),t.close()}})})(e)})};var tR=tinymce.util.Tools.resolve("tinymce.html.Node");let tU=e=>3===e.type,t$=e=>0===e.length,t_=e=>{let t=(t,r)=>{let n=tR.create("li");N(t,e=>n.append(e)),r?e.insert(n,r,!0):e.append(n)},r=O(e.children(),(e,r)=>tU(r)?[...e,r]:t$(e)||tU(r)?e:(t(e,r),[]),[]);t$(r)||t(r)},tF=(e,t)=>r=>(r.setEnabled(e.selection.isEditable()),eJ(e,n=>{r.setActive(eW(n.parents,t)),r.setEnabled(!eG(e,n.element)&&e.selection.isEditable())})),tH=(e,t)=>r=>eJ(e,n=>r.setEnabled(eW(n.parents,t)&&!eG(e,n.element)));t.add("lists",e=>((e=>{(0,e.options.register)("lists_indent_on_tab",{processor:"boolean",default:!0})})(e),(e=>{e.on("PreInit",()=>{let{parser:t}=e;t.addNodeFilter("ul,ol",e=>N(e,t_))})})(e),e.hasPlugin("rtc",!0)?tM(e):(eE(e)&&(e=>{e.on("keydown",t=>{t.keyCode!==et.TAB||et.metaKeyPressed(t)||e.undoManager.transact(()=>{(t.shiftKey?ti(e):to(e))&&t.preventDefault()})})})(e),e.on("ExecCommand",t=>{let r=t.command.toLowerCase();("delete"===r||"forwarddelete"===r)&&tx(e)&&tO(e.dom,e.getBody())}),e.on("keydown",t=>{t.keyCode===et.BACKSPACE?tD(e,!1)&&t.preventDefault():t.keyCode===et.DELETE&&tD(e,!0)&&t.preventDefault()}),e.on("BeforeExecCommand",t=>{let r=t.command.toLowerCase();"indent"===r?to(e):"outdent"===r&&ti(e)}),e.addCommand("InsertUnorderedList",(t,r)=>{tN(e,"UL",r)}),e.addCommand("InsertOrderedList",(t,r)=>{tN(e,"OL",r)}),e.addCommand("InsertDefinitionList",(t,r)=>{tN(e,"DL",r)}),e.addCommand("RemoveList",()=>{ts(e)}),tM(e),e.addCommand("mceListUpdate",(t,r)=>{o(r)&&((e,t)=>{let r=eH(e);null===r||eG(e,r)||e.undoManager.transact(()=>{o(t.styles)&&e.dom.setStyles(r,t.styles),o(t.attrs)&&el(t.attrs,(t,n)=>e.dom.setAttrib(r,n,t))})})(e,r)}),e.addQueryStateHandler("InsertUnorderedList",tP(e,"UL")),e.addQueryStateHandler("InsertOrderedList",tP(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",tP(e,"DL"))),(e=>{let t=t=>()=>e.execCommand(t);e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:tF(e,"OL")}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:tF(e,"UL")}))})(e),(e=>{let t={text:"List properties...",icon:"ordered-list",onAction:()=>e.execCommand("mceListProps"),onSetup:tH(e,"OL")};e.ui.registry.addMenuItem("listprops",t),e.ui.registry.addContextMenu("lists",{update:t=>{let r=eH(e,t);return ey(r)?["listprops"]:[]}})})(e),{backspaceDelete:t=>{tD(e,t)}}))}();