!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.Env");let t=e=>a=>a.options.get(e),r=e=>{let a=e.options.register;a("pagebreak_separator",{processor:"string",default:"<!-- pagebreak -->"}),a("pagebreak_split_block",{processor:"boolean",default:!1})},n=t("pagebreak_separator"),o=t("pagebreak_split_block"),l="mce-pagebreak",s=e=>{let t=`<img src="${a.transparentSrc}" class="${l}" data-mce-resize="false" data-mce-placeholder />`;return e?`<p>${t}</p>`:t},i=e=>{let a=n(e),t=()=>o(e),r=RegExp(a.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,e=>"\\"+e),"gi");e.on("BeforeSetContent",e=>{e.content=e.content.replace(r,s(t()))}),e.on("PreInit",()=>{e.serializer.addNodeFilter("img",r=>{let n=r.length,o,s;for(;n--;)if((s=(o=r[n]).attr("class"))&&-1!==s.indexOf(l)){let r=o.parent;if(r&&e.schema.getBlockElements()[r.name]&&t()){r.type=3,r.value=a,r.raw=!0,o.remove();continue}o.type=3,o.value=a,o.raw=!0}})})},g=e=>{e.addCommand("mcePageBreak",()=>{e.insertContent(s(o(e)))})},p=e=>{e.on("ResolveName",a=>{"IMG"===a.target.nodeName&&e.dom.hasClass(a.target,l)&&(a.name="pagebreak")})},c=e=>a=>{let t=()=>{a.setEnabled(e.selection.isEditable())};return e.on("NodeChange",t),t(),()=>{e.off("NodeChange",t)}},d=e=>{let a=()=>e.execCommand("mcePageBreak");e.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:a,onSetup:c(e)}),e.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:a,onSetup:c(e)})};e.add("pagebreak",e=>{r(e),g(e),d(e),i(e),p(e)})}();