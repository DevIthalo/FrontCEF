!function(){"use strict";var e,t=tinymce.util.Tools.resolve("tinymce.ModelManager");let r=e=>t=>(e=>{var t,r;let l=typeof e;return null===e?"null":"object"===l&&Array.isArray(e)?"array":"object"===l&&((t=String).prototype.isPrototypeOf(e)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name)?"string":l})(t)===e,l=e=>t=>typeof t===e,o=e=>t=>e===t,n=r("string"),s=r("object"),a=r("array"),i=o(null),m=l("boolean"),c=o(void 0),d=e=>null!=e,u=l("function"),f=l("number"),g=()=>{},h=e=>()=>e,p=e=>e,b=(e,t)=>e===t;function w(e,...t){return(...r)=>{let l=t.concat(r);return e.apply(null,l)}}let v=e=>t=>!e(t),y=e=>e(),x=h(!1),C=h(!0);class S{constructor(e,t){this.tag=e,this.value=t}static some(e){return new S(!0,e)}static none(){return S.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?S.some(e(this.value)):S.none()}bind(e){return this.tag?e(this.value):S.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:S.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return d(e)?S.some(e):S.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}S.singletonNone=new S(!1);let T=Array.prototype.slice,R=Array.prototype.indexOf,D=Array.prototype.push,O=(e,t)=>R.call(e,t)>-1,k=(e,t)=>{for(let r=0,l=e.length;r<l;r++)if(t(e[r],r))return!0;return!1},E=(e,t)=>{let r=[];for(let l=0;l<e;l++)r.push(t(l));return r},N=(e,t)=>{let r=e.length,l=Array(r);for(let o=0;o<r;o++){let r=e[o];l[o]=t(r,o)}return l},B=(e,t)=>{for(let r=0,l=e.length;r<l;r++)t(e[r],r)},_=(e,t)=>{let r=[],l=[];for(let o=0,n=e.length;o<n;o++){let n=e[o];(t(n,o)?r:l).push(n)}return{pass:r,fail:l}},z=(e,t)=>{let r=[];for(let l=0,o=e.length;l<o;l++){let o=e[l];t(o,l)&&r.push(o)}return r},A=(e,t,r)=>(((e,t)=>{for(let r=e.length-1;r>=0;r--)t(e[r],r)})(e,(e,l)=>{r=t(r,e,l)}),r),L=(e,t,r)=>(B(e,(e,l)=>{r=t(r,e,l)}),r),W=(e,t)=>((e,t,r)=>{for(let l=0,o=e.length;l<o;l++){let o=e[l];if(t(o,l))return S.some(o);if(r(o,l))break}return S.none()})(e,t,x),M=(e,t)=>{for(let r=0,l=e.length;r<l;r++)if(t(e[r],r))return S.some(r);return S.none()},j=e=>{let t=[];for(let r=0,l=e.length;r<l;++r){if(!a(e[r]))throw Error("Arr.flatten item "+r+" was not an array, input: "+e);D.apply(t,e[r])}return t},P=(e,t)=>j(N(e,t)),I=(e,t)=>{for(let r=0,l=e.length;r<l;++r)if(!0!==t(e[r],r))return!1;return!0},F=(e,t)=>{let r={};for(let l=0,o=e.length;l<o;l++){let o=e[l];r[String(o)]=t(o,l)}return r},H=(e,t)=>t>=0&&t<e.length?S.some(e[t]):S.none(),$=e=>H(e,0),V=e=>H(e,e.length-1),q=(e,t)=>{for(let r=0;r<e.length;r++){let l=t(e[r],r);if(l.isSome())return l}return S.none()},U=Object.keys,G=Object.hasOwnProperty,K=(e,t)=>{let r=U(e);for(let l=0,o=r.length;l<o;l++){let o=r[l];t(e[o],o)}},Y=(e,t)=>J(e,(e,r)=>({k:r,v:t(e,r)})),J=(e,t)=>{let r={};return K(e,(e,l)=>{let o=t(e,l);r[o.k]=o.v}),r},Q=(e,t)=>{let r=[];return K(e,(e,l)=>{r.push(t(e,l))}),r},X=e=>Q(e,p),Z=(e,t)=>G.call(e,t),ee="undefined"!=typeof window?window:Function("return this;")(),et=(e,t)=>((e,t)=>{let r=null!=t?t:ee;for(let t=0;t<e.length&&null!=r;++t)r=r[e[t]];return r})(e.split("."),t),er=Object.getPrototypeOf,el=e=>{let t=et("ownerDocument.defaultView",e);return s(e)&&(((e,t)=>{let r=et(e,t);if(null==r)throw Error(e+" not available on this browser");return r})("HTMLElement",t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(er(e).constructor.name))},eo=e=>e.dom.nodeName.toLowerCase(),en=e=>e.dom.nodeType,es=e=>t=>en(t)===e,ea=e=>8===en(e)||"#comment"===eo(e),ei=e=>em(e)&&el(e.dom),em=es(1),ec=es(3),ed=es(9),eu=es(11),ef=e=>t=>em(t)&&eo(t)===e,eg=(e,t,r)=>{if(!(n(r)||m(r)||f(r)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(t,r+"")},eh=(e,t,r)=>{eg(e.dom,t,r)},ep=(e,t)=>{let r=e.dom;K(t,(e,t)=>{eg(r,t,e)})},eb=(e,t)=>{let r=e.dom.getAttribute(t);return null===r?void 0:r},ew=(e,t)=>S.from(eb(e,t)),ev=(e,t)=>{e.dom.removeAttribute(t)},ey=e=>L(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),ex=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},eC={fromHtml:(e,t)=>{let r=(t||document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return ex(r.childNodes[0])},fromTag:(e,t)=>{let r=(t||document).createElement(e);return ex(r)},fromText:(e,t)=>{let r=(t||document).createTextNode(e);return ex(r)},fromDom:ex,fromPoint:(e,t,r)=>S.from(e.dom.elementFromPoint(t,r)).map(ex)},eS=(e,t)=>{let r=e.dom;if(1!==r.nodeType)return!1;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},eT=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,eR=(e,t)=>{let r=void 0===t?document:t.dom;return eT(r)?S.none():S.from(r.querySelector(e)).map(eC.fromDom)},eD=(e,t)=>e.dom===t.dom,eO=(e,t)=>{let r=e.dom,l=t.dom;return r!==l&&r.contains(l)},ek=e=>eC.fromDom(e.dom.ownerDocument),eE=e=>ed(e)?e:ek(e),eN=e=>S.from(e.dom.parentNode).map(eC.fromDom),eB=e=>S.from(e.dom.parentElement).map(eC.fromDom),e_=(e,t)=>{let r=u(t)?t:x,l=e.dom,o=[];for(;null!==l.parentNode&&void 0!==l.parentNode;){let e=l.parentNode,t=eC.fromDom(e);if(o.push(t),!0===r(t))break;l=e}return o},ez=e=>S.from(e.dom.previousSibling).map(eC.fromDom),eA=e=>S.from(e.dom.nextSibling).map(eC.fromDom),eL=e=>N(e.dom.childNodes,eC.fromDom),eW=(e,t)=>S.from(e.dom.childNodes[t]).map(eC.fromDom),eM=(e,t)=>{eN(e).each(r=>{r.dom.insertBefore(t.dom,e.dom)})},ej=(e,t)=>{eA(e).fold(()=>{eN(e).each(e=>{eI(e,t)})},e=>{eM(e,t)})},eP=(e,t)=>{let r=eW(e,0);r.fold(()=>{eI(e,t)},r=>{e.dom.insertBefore(t.dom,r.dom)})},eI=(e,t)=>{e.dom.appendChild(t.dom)},eF=(e,t)=>{eM(e,t),eI(t,e)},eH=(e,t)=>{B(t,(r,l)=>{let o=0===l?e:t[l-1];ej(o,r)})},e$=(e,t)=>{B(t,t=>{eI(e,t)})},eV=e=>{e.dom.textContent="",B(eL(e),e=>{eq(e)})},eq=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},eU=e=>{let t=eL(e);t.length>0&&eH(e,t),eq(e)},eG=(e,t)=>eC.fromDom(e.dom.cloneNode(t)),eK=e=>eG(e,!1),eY=e=>eG(e,!0),eJ=(e,t)=>{let r=eC.fromTag(t),l=ey(e);return ep(r,l),r},eQ=["tfoot","thead","tbody","colgroup"],eX=(e,t,r)=>({element:e,rowspan:t,colspan:r}),eZ=(e,t,r)=>({element:e,cells:t,section:r}),e0=(e,t,r)=>({element:e,isNew:t,isLocked:r}),e1=(e,t,r,l)=>({element:e,cells:t,section:r,isNew:l}),e9=u(Element.prototype.attachShadow)&&u(Node.prototype.getRootNode),e3=h(e9),e5=e9?e=>eC.fromDom(e.dom.getRootNode()):eE,e2=e=>eC.fromDom(e.dom.host),e7=e=>{let t=ec(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let r=t.ownerDocument;return(e=>{let t=e5(e);return eu(t)&&d(t.dom.host)?S.some(t):S.none()})(eC.fromDom(t)).fold(()=>r.body.contains(t),e=>e7(e2(e)))},e4=e=>{let t=e.dom.body;if(null==t)throw Error("Body is not available yet");return eC.fromDom(t)},e6=(e,t)=>{let r=[];return B(eL(e),e=>{t(e)&&(r=r.concat([e])),r=r.concat(e6(e,t))}),r},e8=(e,t,r)=>z(e_(e,r),e=>eS(e,t)),te=(e,t)=>z(eL(e),e=>eS(e,t)),tt=(e,t)=>((e,t)=>{let r=void 0===t?document:t.dom;return eT(r)?[]:N(r.querySelectorAll(e),eC.fromDom)})(t,e);var tr=(e,t,r,l,o)=>e(r,l)?S.some(r):u(o)&&o(r)?S.none():t(r,l,o);let tl=(e,t,r)=>{let l=e.dom,o=u(r)?r:x;for(;l.parentNode;){l=l.parentNode;let e=eC.fromDom(l);if(t(e))return S.some(e);if(o(e))break}return S.none()},to=(e,t,r)=>tr((e,t)=>t(e),tl,e,t,r),tn=(e,t,r)=>tl(e,e=>eS(e,t),r),ts=(e,t)=>W(e.dom.childNodes,e=>eS(eC.fromDom(e),t)).map(eC.fromDom),ta=(e,t)=>eR(t,e),ti=(e,t,r)=>tr((e,t)=>eS(e,t),tn,e,t,r),tm=(e,t,r=b)=>e.exists(e=>r(e,t)),tc=e=>{let t=[],r=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(r);return t},td=(e,t)=>e?S.some(t):S.none(),tu=(e,t,r)=>""===t||e.length>=t.length&&e.substr(r,r+t.length)===t,tf=(e,t,r=0,l)=>{let o=e.indexOf(t,r);return -1!==o&&(!!c(l)||o+t.length<=l)},tg=(e,t)=>tu(e,t,0),th=(e,t)=>tu(e,t,e.length-t.length),tp=(e=/^\s+|\s+$/g,t=>t.replace(e,"")),tb=e=>e.length>0,tw=e=>void 0!==e.style&&u(e.style.getPropertyValue),tv=(e,t,r)=>{if(!n(r))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",e),Error("CSS value must be a string: "+r);tw(e)&&e.style.setProperty(t,r)},ty=(e,t,r)=>{let l=e.dom;tv(l,t,r)},tx=(e,t)=>{let r=e.dom;K(t,(e,t)=>{tv(r,t,e)})},tC=(e,t)=>{let r=e.dom,l=window.getComputedStyle(r).getPropertyValue(t);return""!==l||e7(e)?l:tS(r,t)},tS=(e,t)=>tw(e)?e.style.getPropertyValue(t):"",tT=(e,t)=>{let r=e.dom,l=tS(r,t);return S.from(l).filter(e=>e.length>0)},tR=(e,t)=>{var r;tw(r=e.dom)&&r.style.removeProperty(t),tm(ew(e,"style").map(tp),"")&&ev(e,"style")},tD=(e,t,r=0)=>ew(e,t).map(e=>parseInt(e,10)).getOr(r),tO=(e,t)=>tD(e,t,1),tk=e=>ef("col")(e)?tD(e,"span",1)>1:tO(e,"colspan")>1,tE=e=>tO(e,"rowspan")>1,tN=(e,t)=>parseInt(tC(e,t),10),tB=h(10),t_=h(10),tz=(e,t)=>tA(e,t,C),tA=(e,t,r)=>P(eL(e),e=>eS(e,t)?r(e)?[e]:[]:tA(e,t,r)),tL=(e,t)=>((e,t,r=x)=>r(t)?S.none():O(e,eo(t))?S.some(t):tn(t,e.join(","),e=>eS(e,"table")||r(e)))(["td","th"],e,t),tW=e=>tz(e,"th,td"),tM=e=>eS(e,"colgroup")?te(e,"col"):P(tI(e),e=>te(e,"col")),tj=(e,t)=>ti(e,"table",t),tP=e=>tz(e,"tr"),tI=e=>tj(e).fold(h([]),e=>te(e,"colgroup")),tF=(e,t)=>N(e,e=>{if("colgroup"===eo(e)){let t=N(tM(e),e=>{let t=tD(e,"span",1);return eX(e,1,t)});return eZ(e,t,"colgroup")}{let r=N(tW(e),e=>{let t=tD(e,"rowspan",1),r=tD(e,"colspan",1);return eX(e,t,r)});return eZ(e,r,t(e))}}),tH=e=>eN(e).map(e=>{let t=eo(e);return O(eQ,t)?t:"tbody"}).getOr("tbody"),t$=e=>{let t=tP(e),r=[...tI(e),...t];return tF(r,tH)},tV=e=>{let t,r=!1;return(...l)=>(r||(r=!0,t=e.apply(null,l)),t)},tq=()=>tU(0,0),tU=(e,t)=>({major:e,minor:t}),tG={nu:tU,detect:(e,t)=>{let r=String(t).toLowerCase();return 0===e.length?tq():((e,t)=>{let r=((e,t)=>{for(let r=0;r<e.length;r++){let l=e[r];if(l.test(t))return l}})(e,t);if(!r)return{major:0,minor:0};let l=e=>Number(t.replace(r,"$"+e));return tU(l(1),l(2))})(e,r)},unknown:tq},tK=(e,t)=>{let r=String(t).toLowerCase();return W(e,e=>e.search(r))},tY=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,tJ=e=>t=>tf(t,e),tQ=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>tf(e,"edge/")&&tf(e,"chrome")&&tf(e,"safari")&&tf(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,tY],search:e=>tf(e,"chrome")&&!tf(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>tf(e,"msie")||tf(e,"trident")},{name:"Opera",versionRegexes:[tY,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:tJ("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:tJ("firefox")},{name:"Safari",versionRegexes:[tY,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(tf(e,"safari")||tf(e,"mobile/"))&&tf(e,"applewebkit")}],tX=[{name:"Windows",search:tJ("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>tf(e,"iphone")||tf(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:tJ("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:tJ("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:tJ("linux"),versionRegexes:[]},{name:"Solaris",search:tJ("sunos"),versionRegexes:[]},{name:"FreeBSD",search:tJ("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:tJ("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],tZ={browsers:h(tQ),oses:h(tX)},t0="Edge",t1="Chromium",t9="Opera",t3="Firefox",t5="Safari",t2=e=>{let t=e.current,r=e.version,l=e=>()=>t===e;return{current:t,version:r,isEdge:l(t0),isChromium:l(t1),isIE:l("IE"),isOpera:l(t9),isFirefox:l(t3),isSafari:l(t5)}},t7=()=>t2({current:void 0,version:tG.unknown()}),t4=(h(t0),h(t1),h("IE"),h(t9),h(t3),h(t5),"Windows"),t6="Android",t8="Linux",re="macOS",rt="Solaris",rr="FreeBSD",rl="ChromeOS",ro=e=>{let t=e.current,r=e.version,l=e=>()=>t===e;return{current:t,version:r,isWindows:l(t4),isiOS:l("iOS"),isAndroid:l(t6),isMacOS:l(re),isLinux:l(t8),isSolaris:l(rt),isFreeBSD:l(rr),isChromeOS:l(rl)}},rn=()=>ro({current:void 0,version:tG.unknown()}),rs=(h(t4),h("iOS"),h(t6),h(t8),h(re),h(rt),h(rr),h(rl),e=>window.matchMedia(e).matches),ra=tV(()=>((e,t,r)=>{let l=tZ.browsers(),o=tZ.oses(),n=t.bind(e=>q(e.brands,e=>{let t=e.brand.toLowerCase();return W(l,e=>{var r;return t===(null===(r=e.brand)||void 0===r?void 0:r.toLowerCase())}).map(t=>({current:t.name,version:tG.nu(parseInt(e.version,10),0)}))})).orThunk(()=>tK(l,e).map(t=>{let r=tG.detect(t.versionRegexes,e);return{current:t.name,version:r}})).fold(t7,t2),s=tK(o,e).map(t=>{let r=tG.detect(t.versionRegexes,e);return{current:t.name,version:r}}).fold(rn,ro),a=((e,t,r,l)=>{let o=e.isiOS()&&!0===/ipad/i.test(r),n=e.isiOS()&&!o,s=e.isiOS()||e.isAndroid(),a=s||l("(pointer:coarse)"),i=o||!n&&s&&l("(min-device-width:768px)"),m=n||s&&!i,c=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),d=!m&&!i&&!c;return{isiPad:h(o),isiPhone:h(n),isTablet:h(i),isPhone:h(m),isTouch:h(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:h(c),isDesktop:h(d)}})(s,n,e,r);return{browser:n,os:s,deviceType:a}})(navigator.userAgent,S.from(navigator.userAgentData),rs)),ri=()=>ra(),rm=(e,t)=>{let r=r=>{let l=t(r);if(l<=0||null===l){let t=tC(r,e);return parseFloat(t)||0}return l},l=(e,t)=>L(t,(t,r)=>{let l=tC(e,r),o=void 0===l?0:parseInt(l,10);return isNaN(o)?t:t+o},0);return{set:(t,r)=>{if(!f(r)&&!r.match(/^[0-9]+$/))throw Error(e+".set accepts only positive integer values. Value was "+r);let l=t.dom;tw(l)&&(l.style[e]=r+"px")},get:r,getOuter:r,aggregate:l,max:(e,t,r)=>{let o=l(e,r);return t>o?t-o:0}}},rc=(e,t,r)=>(e=>{let t=parseFloat(e);return isNaN(t)?S.none():S.some(t)})(tC(e,t)).getOr(r),rd=rm("width",e=>e.dom.offsetWidth),ru=e=>rd.get(e),rf=e=>rd.getOuter(e),rg=e=>((e,t)=>{var r,l;let o=e.dom,n=o.getBoundingClientRect().width||o.offsetWidth;return"border-box"===t?n:(l="right",n-rc(e,`padding-${r="left"}`,0)-rc(e,`padding-${l}`,0)-rc(e,`border-${r}-width`,0)-rc(e,`border-${l}-width`,0))})(e,"content-box"),rh=(e,t,r)=>{let l=e.cells,o=l.slice(0,t),n=l.slice(t),s=o.concat(r).concat(n);return rw(e,s)},rp=(e,t,r)=>rh(e,t,[r]),rb=(e,t,r)=>{e.cells[t]=r},rw=(e,t)=>e1(e.element,t,e.section,e.isNew),rv=(e,t)=>e.cells[t],ry=(e,t)=>rv(e,t).element,rx=e=>e.cells.length,rC=e=>{let t=_(e,e=>"colgroup"===e.section);return{rows:t.fail,cols:t.pass}},rS=(e,t,r)=>{let l=N(e.cells,r);return e1(t(e.element),l,e.section,!0)},rT="data-snooker-locked-cols",rR=e=>ew(e,rT).bind(e=>S.from(e.match(/\d+/g))).map(e=>F(e,C)),rD=e=>{let t=L(rC(e).rows,(e,t)=>(B(t.cells,(t,r)=>{t.isLocked&&(e[r]=!0)}),e),{}),r=Q(t,(e,t)=>parseInt(t,10));return((e,t)=>{let r=T.call(e,0);return r.sort(void 0),r})(r)},rO=(e,t)=>e+","+t,rk=(e,t)=>{let r=P(e.all,e=>e.cells);return z(r,t)},rE=e=>{let t={},r=[],l=$(e).map(e=>e.element).bind(tj).bind(rR).getOr({}),o=0,n=0,s=0,{pass:a,fail:i}=_(e,e=>"colgroup"===e.section);B(i,e=>{let a=[];B(e.cells,e=>{var r,o,i;let m=0;for(;void 0!==t[rO(s,m)];)m++;let c=Z(l,r=m.toString())&&void 0!==l[r]&&null!==l[r],d=(o=e.element,i=e.rowspan,{element:o,rowspan:i,colspan:e.colspan,row:s,column:m,isLocked:c});for(let r=0;r<e.colspan;r++)for(let l=0;l<e.rowspan;l++){let e=m+r,o=rO(s+l,e);t[o]=d,n=Math.max(n,e+1)}a.push(d)}),o++,r.push(eZ(e.element,a,e.section)),s++});let{columns:m,colgroups:c}=V(a).map(e=>{let t=(e=>{let t={},r=0;return B(e.cells,e=>{let l=e.colspan;E(l,o=>{let n=r+o;t[n]={element:e.element,colspan:l,column:n}}),r+=l}),t})(e),r={element:e.element,columns:X(t)};return{colgroups:[r],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})),d={rows:o,columns:n};return{grid:d,access:t,all:r,columns:m,colgroups:c}},rN=e=>{let t=t$(e);return rE(t)},rB=(e,t,r)=>S.from(e.access[rO(t,r)]),r_=(e,t,r)=>{let l=rk(e,e=>r(t,e.element));return l.length>0?S.some(l[0]):S.none()},rz=e=>P(e.all,e=>e.cells),rA=e=>X(e.columns),rL=e=>U(e.columns).length>0,rW=(e,t)=>S.from(e.columns[t]),rM=(e,t=C)=>{let r=e.grid,l=E(r.columns,p),o=E(r.rows,p);return N(l,r=>rj(()=>P(o,t=>rB(e,t,r).filter(e=>e.column===r).toArray()),e=>1===e.colspan&&t(e.element),()=>rB(e,0,r)))},rj=(e,t,r)=>{let l=e();return W(l,t).orThunk(()=>S.from(l[0]).orThunk(r)).map(e=>e.element)},rP=e=>{let t=e.grid,r=E(t.rows,p),l=E(t.columns,p);return N(r,t=>rj(()=>P(l,r=>rB(e,t,r).filter(e=>e.row===t).fold(h([]),e=>[e])),e=>1===e.rowspan,()=>rB(e,t,0)))},rI=(e,t)=>r=>"rtl"===rF(r)?t:e,rF=e=>"rtl"===tC(e,"direction")?"rtl":"ltr",rH=rm("height",e=>{let t=e.dom;return e7(e)?t.getBoundingClientRect().height:t.offsetHeight}),r$=e=>rH.get(e),rV=e=>rH.getOuter(e),rq=(e,t)=>({left:e,top:t,translate:(r,l)=>rq(e+r,t+l)}),rU=(e,t)=>void 0!==e?e:void 0!==t?t:0,rG=e=>{let t=e.dom.ownerDocument,r=t.body,l=t.defaultView,o=t.documentElement;if(r===e.dom)return rq(r.offsetLeft,r.offsetTop);let n=rU(null==l?void 0:l.pageYOffset,o.scrollTop),s=rU(null==l?void 0:l.pageXOffset,o.scrollLeft),a=rU(o.clientTop,r.clientTop),i=rU(o.clientLeft,r.clientLeft);return rK(e).translate(s-i,n-a)},rK=e=>{let t=e.dom,r=t.ownerDocument.body;return r===t?rq(r.offsetLeft,r.offsetTop):e7(e)?(e=>{let t=e.getBoundingClientRect();return rq(t.left,t.top)})(t):rq(0,0)},rY=(e,t)=>({row:e,y:t}),rJ=(e,t)=>({col:e,x:t}),rQ=e=>rG(e).left+rf(e),rX=e=>rG(e).left,rZ=(e,t)=>rJ(e,rX(t)),r0=(e,t)=>rJ(e,rQ(t)),r1=e=>rG(e).top,r9=(e,t)=>rY(e,r1(t)),r3=(e,t)=>rY(e,r1(t)+rV(t)),r5=(e,t,r)=>{if(0===r.length)return[];let l=N(r.slice(1),(t,r)=>t.map(t=>e(r,t))),o=r[r.length-1].map(e=>t(r.length-1,e));return l.concat([o])},r2={delta:p,positions:e=>r5(r9,r3,e),edge:r1},r7=rI({delta:p,edge:rX,positions:e=>r5(rZ,r0,e)},{delta:e=>-e,edge:rQ,positions:e=>r5(r0,rZ,e)}),r4={delta:(e,t)=>r7(t).delta(e,t),positions:(e,t)=>r7(t).positions(e,t),edge:e=>r7(e).edge(e)},r6={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},r8=(()=>{let e="[0-9]+",t="[eE][+-]?"+e,r=e=>`(?:${e})?`,l=["Infinity",e+"\\."+r(e)+r(t),"\\."+e+r(t),e+r(t)].join("|");return RegExp(`^([+-]?(?:${l}))(.*)$`)})(),le=/(\d+(\.\d+)?)%/,lt=/(\d+(\.\d+)?)px|em/,lr=ef("col"),ll=(e,t,r)=>{let l=eB(e).getOrThunk(()=>e4(ek(e)));return t(e)/r(l)*100},lo=(e,t)=>{ty(e,"width",t+"px")},ln=(e,t)=>{ty(e,"width",t+"%")},ls=(e,t)=>{ty(e,"height",t+"px")},la=e=>{let t=rc(e,"height",e.dom.offsetHeight)+"px";return t?((e,t,r,l)=>{let o=parseFloat(e);return th(e,"%")&&"table"!==eo(t)?((e,t,r,l)=>{let o=tj(e).map(e=>{let l=r(e);return Math.floor(t/100*l)}).getOr(t);return l(e,o),o})(t,o,r,l):o})(t,e,r$,ls):r$(e)},li=(e,t)=>tT(e,t).orThunk(()=>ew(e,t).map(e=>e+"px")),lm=e=>li(e,"width"),lc=e=>ll(e,ru,rg),ld=e=>lr(e)?ru(e):rc(e,"width",e.dom.offsetWidth),lu=e=>la(e)/tO(e,"rowspan"),lf=(e,t,r)=>{ty(e,"width",t+r)},lg=e=>ll(e,ru,rg)+"%",lh=h(le),lp=ef("col"),lb=e=>lm(e).getOrThunk(()=>ld(e)+"px"),lw=e=>li(e,"height").getOrThunk(()=>lu(e)+"px"),lv=(e,t,r,l,o,n)=>e.filter(l).fold(()=>n(((e,t)=>{if(t<0||t>=e.length-1)return S.none();let r=e[t].fold(()=>{let r=(e=>{let t=T.call(e,0);return t.reverse(),t})(e.slice(0,t));return q(r,(e,t)=>e.map(e=>({value:e,delta:t+1})))},e=>S.some({value:e,delta:0})),l=e[t+1].fold(()=>{let r=e.slice(t+1);return q(r,(e,t)=>e.map(e=>({value:e,delta:t+1})))},e=>S.some({value:e,delta:1}));return r.bind(e=>l.map(t=>{let r=t.delta+e.delta;return Math.abs(t.value-e.value)/r}))})(r,t)),e=>o(e)),ly=(e,t,r,l)=>{let o=rM(e),n=rL(e)?N(rA(e),e=>S.from(e.element)):o,s=[S.some(r4.edge(t))].concat(N(r4.positions(o,t),e=>e.map(e=>e.x))),a=v(tk);return N(n,(e,t)=>lv(e,t,s,a,e=>{var n;if((e=>{let t=ri().browser,r=t.isChromium()||t.isFirefox();return!lp(e)||r})(e))return r(e);{let e=null!=(n=o[t])?p(n):S.none();return lv(e,t,s,a,e=>l(S.some(ru(e))),l)}},l))},lx=e=>e.map(e=>e+"px").getOr(""),lC=(e,t,r)=>ly(e,t,ld,e=>e.getOrThunk(r.minCellWidth)),lS=(e,t,r,l,o)=>{let n=rP(e),s=[S.some(r.edge(t))].concat(N(r.positions(n,t),e=>e.map(e=>e.y)));return N(n,(e,t)=>lv(e,t,s,v(tE),l,o))},lT=(e,t)=>()=>e7(e)?t(e):parseFloat(tT(e,"width").getOr("0")),lR=e=>{let t=lT(e,e=>parseFloat(lg(e))),r=lT(e,ru);return{width:t,pixelWidth:r,getWidths:(t,r)=>ly(t,e,lc,e=>e.fold(()=>r.minCellWidth(),e=>e/r.pixelWidth()*100)),getCellDelta:e=>e/r()*100,singleColumnWidth:(e,t)=>[100-e],minCellWidth:()=>tB()/r()*100,setElementWidth:ln,adjustTableWidth:r=>{let l=t();ln(e,l+r/100*l)},isRelative:!0,label:"percent"}},lD=e=>{let t=lT(e,ru);return{width:t,pixelWidth:t,getWidths:(t,r)=>lC(t,e,r),getCellDelta:p,singleColumnWidth:(e,t)=>[Math.max(tB(),e+t)-e],minCellWidth:tB,setElementWidth:lo,adjustTableWidth:r=>{let l=t()+r;lo(e,l)},isRelative:!1,label:"pixel"}},lO=e=>lm(e).fold(()=>(e=>{let t=lT(e,ru),r=h(0);return{width:t,pixelWidth:t,getWidths:(t,r)=>lC(t,e,r),getCellDelta:r,singleColumnWidth:h([0]),minCellWidth:r,setElementWidth:g,adjustTableWidth:g,isRelative:!0,label:"none"}})(e),t=>null!==lh().exec(t)?lR(e):lD(e)),lk=(e,t,r)=>{let l=e[r].element,o=eC.fromTag("td");eI(o,eC.fromTag("br")),(t?eI:eP)(l,o)},lE=((e,t)=>{let r=t=>e(t)?S.from(t.dom.nodeValue):S.none();return{get:t=>{if(!e(t))throw Error("Can only get text value of a text node");return r(t).getOr("")},getOption:r,set:(t,r)=>{if(!e(t))throw Error("Can only set raw text value of a text node");t.dom.nodeValue=r}}})(ec),lN=e=>lE.get(e),lB=e=>lE.getOption(e),l_=(e,t)=>lE.set(e,t),lz=e=>"img"===eo(e)?1:lB(e).fold(()=>eL(e).length,e=>e.length),lA=["img","br"],lL=e=>lB(e).filter(e=>0!==e.trim().length||e.indexOf("\xa0")>-1).isSome()||O(lA,eo(e))||ei(e)&&"false"===eb(e,"contenteditable"),lW=e=>((e,t)=>{let r=e=>{for(let l=0;l<e.childNodes.length;l++){let o=eC.fromDom(e.childNodes[l]);if(t(o))return S.some(o);let n=r(e.childNodes[l]);if(n.isSome())return n}return S.none()};return r(e.dom)})(e,lL),lM=e=>lj(e,lL),lj=(e,t)=>{let r=e=>{let l=eL(e);for(let e=l.length-1;e>=0;e--){let o=l[e];if(t(o))return S.some(o);let n=r(o);if(n.isSome())return n}return S.none()};return r(e)},lP={scope:["row","col"]},lI=e=>()=>{let t=eC.fromTag("td",e.dom);return eI(t,eC.fromTag("br",e.dom)),t},lF=e=>()=>eC.fromTag("col",e.dom),lH=e=>()=>eC.fromTag("colgroup",e.dom),l$=e=>()=>eC.fromTag("tr",e.dom),lV=(e,t,r)=>{let l=((e,t)=>{let r=eJ(e,t),l=eL(eY(e));return e$(r,l),r})(e,t);return K(r,(e,t)=>{null===e?ev(l,t):eh(l,t,e)}),l},lq=e=>e,lU=(e,t,r)=>{let l=(e,t)=>{((e,t)=>{let r=e.dom,l=t.dom;tw(r)&&tw(l)&&(l.style.cssText=r.style.cssText)})(e.element,t),tR(t,"height"),1!==e.colspan&&tR(t,"width")};return{col:r=>{let o=eC.fromTag(eo(r.element),t.dom);return l(r,o),e(r.element,o),o},colgroup:lH(t),row:l$(t),cell:o=>{var n,s;let a=eC.fromTag(eo(o.element),t.dom),i=r.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),m=i.length>0?lW(n=o.element).map(e=>{let t=i.join(","),r=e8(e,t,e=>eD(e,n));return A(r,(e,t)=>{let r=eK(t);return eI(e,r),r},a)}).getOr(a):a;return eI(m,eC.fromTag("br")),l(o,a),s=o.element,K(lP,(e,t)=>ew(s,t).filter(t=>O(e,t)).each(e=>eh(a,t,e))),e(o.element,a),a},replace:lV,colGap:lF(t),gap:lI(t)}},lG=e=>({col:lF(e),colgroup:lH(e),row:l$(e),cell:lI(e),replace:lq,colGap:lF(e),gap:lI(e)}),lK=e=>t=>t.options.get(e),lY="100%",lJ=e=>{var t;let r=e.dom,l=null!==(t=r.getParent(e.selection.getStart(),r.isBlock))&&void 0!==t?t:e.getBody();return rg(eC.fromDom(l))+"px"},lQ=e=>S.from(e.options.get("table_clone_elements")),lX=lK("table_header_type"),lZ=lK("table_column_resizing"),l0=e=>"preservetable"===lZ(e),l1=e=>"resizetable"===lZ(e),l9=lK("table_sizing_mode"),l3=e=>"relative"===l9(e),l5=e=>"fixed"===l9(e),l2=e=>"responsive"===l9(e),l7=lK("table_resize_bars"),l4=lK("table_style_by_css"),l6=lK("table_merge_content_on_paste"),l8=e=>{let t=e.options,r=t.get("table_default_attributes");return t.isSet("table_default_attributes")?r:l2(e)||l4(e)?r:l5(e)?{...r,width:lJ(e)}:{...r,width:lY}},oe=lK("table_use_colgroups"),ot=e=>ti(e,"[contenteditable]"),or=(e,t=!1)=>e7(e)?e.dom.isContentEditable:ot(e).fold(h(t),e=>"true"===ol(e)),ol=e=>e.dom.contentEditable,oo=e=>eC.fromDom(e.getBody()),on=e=>t=>eD(t,oo(e)),os=e=>{ev(e,"data-mce-style");let t=e=>ev(e,"data-mce-style");B(tW(e),t),B(tM(e),t),B(tP(e),t)},oa=e=>eC.fromDom(e.selection.getStart()),oi=e=>e.getBoundingClientRect().width,om=e=>e.getBoundingClientRect().height,oc=e=>to(e,ef("table")).exists(or),od=(e,t)=>{let r=t.column,l=t.column+t.colspan-1,o=t.row,n=t.row+t.rowspan-1;return r<=e.finishCol&&l>=e.startCol&&o<=e.finishRow&&n>=e.startRow},ou=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,of=(e,t,r)=>{let l=r_(e,t,eD),o=r_(e,r,eD);return l.bind(e=>o.map(t=>({startRow:Math.min(e.row,t.row),startCol:Math.min(e.column,t.column),finishRow:Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,t.column+t.colspan-1)})))},og=(e,t,r)=>of(e,t,r).map(t=>{let r=rk(e,w(od,t));return N(r,e=>e.element)}),oh=(e,t)=>r_(e,t,(e,t)=>eO(t,e)).map(e=>e.element),op=(e,t,r)=>{let l=ow(e);return og(l,t,r)},ob=(e,t,r,l,o)=>{let n=ow(e),s=eD(e,r)?S.some(t):oh(n,t),a=eD(e,o)?S.some(l):oh(n,l);return s.bind(e=>a.bind(t=>og(n,e,t)))},ow=rN;var ov=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],oy=()=>({up:h({selector:tn,closest:ti,predicate:tl,all:e_}),down:h({selector:tt,predicate:e6}),styles:h({get:tC,getRaw:tT,set:ty,remove:tR}),attrs:h({get:eb,set:eh,remove:ev,copyTo:(e,t)=>{let r=ey(e);ep(t,r)}}),insert:h({before:eM,after:ej,afterAll:eH,append:eI,appendAll:e$,prepend:eP,wrap:eF}),remove:h({unwrap:eU,remove:eq}),create:h({nu:eC.fromTag,clone:e=>eC.fromDom(e.dom.cloneNode(!1)),text:eC.fromText}),query:h({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:ez,nextSibling:eA}),property:h({children:eL,name:eo,parent:eN,document:e=>eE(e).dom,isText:ec,isComment:ea,isElement:em,isSpecial:e=>{let t=eo(e);return O(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>em(e)?ew(e,"lang"):S.none(),getText:lN,setText:l_,isBoundary:e=>!!em(e)&&("body"===eo(e)||O(ov,eo(e))),isEmptyTag:e=>!!em(e)&&O(["br","img","hr","input"],eo(e)),isNonEditable:e=>em(e)&&"false"===eb(e,"contenteditable")}),eq:eD,is:eS});let ox=(e,t,r,l)=>{let o=t(e,r);return A(l,(r,l)=>{let o=t(e,l);return oC(e,r,o)},o)},oC=(e,t,r)=>t.bind(t=>r.filter(w(e.eq,t))),oS=oy(),oT=(e,t)=>t.length>0?ox(oS,(t,r)=>e(r),t[0],t.slice(1)):S.none(),oR=e=>tn(e,"table"),oD=(e,t,r)=>{let l=e=>t=>void 0!==r&&r(t)||eD(t,e);return eD(e,t)?S.some({boxes:S.some([e]),start:e,finish:t}):oR(e).bind(o=>oR(t).bind(n=>{if(eD(o,n))return S.some({boxes:op(o,e,t),start:e,finish:t});if(eO(o,n)){let r=e8(t,"td,th",l(o)),s=r.length>0?r[r.length-1]:t;return S.some({boxes:ob(o,e,o,t,n),start:e,finish:s})}if(eO(n,o)){let r=e8(e,"td,th",l(n)),s=r.length>0?r[r.length-1]:e;return S.some({boxes:ob(n,e,o,t,n),start:e,finish:s})}return((e,t,r,l=x)=>{let o=[t].concat(e.up().all(t)),n=[r].concat(e.up().all(r)),s=e=>M(e,l).fold(()=>e,t=>e.slice(0,t+1)),a=s(o),i=s(n),m=W(a,t=>k(i,w(e.eq,t)));return{firstpath:a,secondpath:i,shared:m}})(oS,e,t,void 0).shared.bind(s=>ti(s,"table",r).bind(r=>{let s=e8(t,"td,th",l(r)),a=s.length>0?s[s.length-1]:t,i=e8(e,"td,th",l(r)),m=i.length>0?i[i.length-1]:e;return S.some({boxes:ob(r,e,o,t,n),start:m,finish:a})}))}))},oO=(e,t)=>{let r=tt(e,t);return r.length>0?S.some(r):S.none()},ok=(e,t,r)=>ta(e,t).bind(t=>ta(e,r).bind(e=>oT(oR,[t,e]).map(r=>({first:t,last:e,table:r})))),oE=(e,t,r,l,o)=>W(e,e=>eS(e,o)).bind(e=>tj(e).bind(l=>{var o;return r_(o=ow(l),e,eD).bind(e=>{let l=t>0?e.row+e.rowspan-1:e.row,n=r>0?e.column+e.colspan-1:e.column;return rB(o,l+t,n+r).map(e=>e.element)})}).bind(e=>tn(e,"table").bind(t=>ta(t,l).bind(t=>oD(t,e).bind(e=>e.boxes.map(t=>({boxes:t,start:e.start,finish:e.finish}))))))),oN=(e,t)=>oO(e,t),oB=(e,t,r)=>ok(e,t,r).bind(t=>{let r=t=>eD(e,t),l="thead,tfoot,tbody,table",o=tn(t.first,l,r),n=tn(t.last,l,r);return o.bind(e=>n.bind(r=>{var l,o,n,s;return eD(e,r)?(l=t.table,o=t.first,n=t.last,of(s=ow(l),o,n).bind(e=>((e,t)=>{let r=!0,l=w(ou,t);for(let o=t.startRow;o<=t.finishRow;o++)for(let n=t.startCol;n<=t.finishCol;n++)r=r&&rB(e,o,n).exists(l);return r?S.some(t):S.none()})(s,e))):S.none()}))}),o_=e=>{let t=(e,t)=>ew(e,t).exists(e=>parseInt(e,10)>1);return e.length>0&&I(e,e=>t(e,"rowspan")||t(e,"colspan"))?S.some(e):S.none()},oz=(e,t,r)=>t.length<=1?S.none():oB(e,r.firstSelectedSelector,r.lastSelectedSelector).map(e=>({bounds:e,cells:t})),oA="data-mce-selected",oL="data-mce-first-selected",oW="data-mce-last-selected",oM="["+oA+"]",oj={selected:oA,selectedSelector:"td["+oA+"],th["+oA+"]",firstSelected:oL,firstSelectedSelector:"td["+oL+"],th["+oL+"]",lastSelected:oW,lastSelectedSelector:"td["+oW+"],th["+oW+"]"},oP=(e,t,r)=>({element:r,mergable:oz(t,e,oj),unmergable:o_(e),selection:p(e)}),oI=e=>(t,r)=>{let l=eo(t),o="col"===l||"colgroup"===l?tj(t).bind(e=>oN(e,oj.firstSelectedSelector)).fold(h(t),e=>e[0]):t;return ti(o,e,r)},oF=oI("th,td,caption"),oH=oI("th,td"),o$=e=>N(e.model.table.getSelectedCells(),eC.fromDom),oV=(e,t)=>{e.on("BeforeGetContent",t=>{if(!0===t.selection){let r=z(o$(e),e=>eS(e,oj.selectedSelector));r.length>=1&&(t.preventDefault(),tj(r[0]).map(e=>{let t=((e,t)=>{let r=e=>eS(e.element,t),l=eY(e),o=t$(l),n=lO(e),s=rE(o),a=((e,t)=>{let r=e.grid.columns,l=e.grid.rows,o=r,n=0,s=0,a=[],i=[];return K(e.access,e=>{if(a.push(e),t(e)){i.push(e);let t=e.row,r=t+e.rowspan-1,a=e.column,m=a+e.colspan-1;t<l?l=t:r>n&&(n=r),a<o?o=a:m>s&&(s=m)}}),{minRow:l,minCol:o,maxRow:n,maxCol:s,allCells:a,selectedCells:i}})(s,r),i="th:not("+t+"),td:not("+t+")",m=tA(l,"th,td",e=>eS(e,i));B(m,eq),((e,t,r,l)=>{let o=z(e,e=>"colgroup"!==e.section),n=t.grid.columns,s=t.grid.rows;for(let e=0;e<s;e++){let s=!1;for(let a=0;a<n;a++)e<r.minRow||e>r.maxRow||a<r.minCol||a>r.maxCol||(rB(t,e,a).filter(l).isNone()?lk(o,s,e):s=!0)}})(o,s,a,r);let c=((e,t,r,l)=>{if(0===l.minCol&&t.grid.columns===l.maxCol+1)return 0;let o=lC(t,e,r),n=L(o,(e,t)=>e+t,0),s=L(o.slice(l.minCol,l.maxCol+1),(e,t)=>e+t,0),a=s/n*r.pixelWidth()-r.pixelWidth();return r.getCellDelta(a)})(e,rN(e),n,a);return((e,t,r,l)=>{K(r.columns,e=>{(e.column<t.minCol||e.column>t.maxCol)&&eq(e.element)});let o=z(tz(e,"tr"),e=>0===e.dom.childElementCount);B(o,eq),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||B(tz(e,"th,td"),e=>{ev(e,"rowspan"),ev(e,"colspan")}),ev(e,rT),ev(e,"data-snooker-col-series"),lO(e).adjustTableWidth(l)})(l,a,s,c),l})(e,oM);return os(t),[t]}).each(r=>{t.content="text"===t.format?N(r,e=>e.dom.innerText).join(""):N(r,t=>e.selection.serializer.serialize(t.dom,{})).join("")}))}}),e.on("BeforeSetContent",r=>{if(!0===r.selection&&!0===r.paste){let l=o$(e);$(l).each(l=>{tj(l).each(o=>{let n=z(((e,t)=>{let r=document.createElement("div");return r.innerHTML=e,eL(eC.fromDom(r))})(r.content),e=>"meta"!==eo(e)),s=ef("table");if(l6(e)&&1===n.length&&s(n[0])){r.preventDefault();let s=eC.fromDom(e.getDoc()),a=lG(s),i={element:l,clipboard:n[0],generators:a};t.pasteCells(o,i).each(()=>{e.focus()})}})})}})},oq=(e,t)=>({element:e,offset:t}),oU=(e,t,r)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?r(t).bind(t=>oU(e,t,r).orThunk(()=>S.some(t))):S.none(),oG=(e,t)=>e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length,oK=(e,t)=>{let r=oU(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(r))return oq(r,oG(e,r));let l=e.property().children(r);return l.length>0?oK(e,l[l.length-1]):oq(r,oG(e,r))},oY=oy(),oJ=(e,t)=>{if(!tk(e)){let r=lm(e).bind(e=>{var t;return t=["fixed","relative","empty"],S.from(r8.exec(e)).bind(e=>{let r=Number(e[1]),l=e[2];return k(t,e=>k(r6[e],e=>l===e))?S.some({value:r,unit:l}):S.none()})});r.each(r=>{let l=r.value/2;lf(e,l,r.unit),lf(t,l,r.unit)})}},oQ=e=>N(e,h(0)),oX=(e,t,r,l,o)=>o(e.slice(0,t)).concat(l).concat(o(e.slice(r))),oZ=e=>(t,r,l,o)=>{if(e(l)){let e=Math.max(o,t[r]-Math.abs(l)),n=Math.abs(e-t[r]);return l>=0?n:-n}return l},o0=oZ(e=>e<0),o1=oZ(C),o9=()=>{let e=(e,t,r,l)=>{let o=(100+r)/100,n=Math.max(l,(e[t]+r)/o);return N(e,(e,r)=>(r===t?n:e/o)-e)},t=(t,r,l,o,n,s)=>s?e(t,r,o,n):((e,t,r,l,o)=>{let n=o0(e,t,l,o);return oX(e,t,r+1,[n,0],oQ)})(t,r,l,o,n);return{resizeTable:(e,t)=>e(t),clampTableDelta:o0,calcLeftEdgeDeltas:t,calcMiddleDeltas:(e,r,l,o,n,s,a)=>t(e,l,o,n,s,a),calcRightEdgeDeltas:(t,r,l,o,n,s)=>{if(s)return e(t,l,o,n);{let e=o0(t,l,o,n);return oQ(t.slice(0,l)).concat([e])}},calcRedestributedWidths:(e,t,r,l)=>{if(l){let l=(t+r)/t,o=N(e,e=>e/l);return{delta:100*l-100,newSizes:o}}return{delta:r,newSizes:e}}}},o3=()=>{let e=(e,t,r,l,o)=>{let n=o1(e,l>=0?r:t,l,o);return oX(e,t,r+1,[n,-n],oQ)};return{resizeTable:(e,t,r)=>{r&&e(t)},clampTableDelta:(e,t,r,l,o)=>{if(o){if(r>=0)return r;{let t=L(e,(e,t)=>e+t-l,0);return Math.max(-t,r)}}return o0(e,t,r,l)},calcLeftEdgeDeltas:e,calcMiddleDeltas:(t,r,l,o,n,s)=>e(t,l,o,n,s),calcRightEdgeDeltas:(e,t,r,l,o,n)=>{if(n)return oQ(e);{let t=l/e.length;return N(e,h(t))}},calcRedestributedWidths:(e,t,r,l)=>({delta:0,newSizes:e})}},o5=e=>rN(e).grid,o2=ef("th"),o7=e=>I(e,e=>o2(e.element)),o4=(e,t)=>e&&t?"sectionCells":e?"section":"cells",o6=e=>{let t="thead"===e.section,r=tm(o8(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||r?{type:"header",subType:o4(t,r)}:{type:"body"}},o8=e=>{let t=z(e,e=>o2(e.element));return 0===t.length?S.some("td"):t.length===e.length?S.some("th"):S.none()},ne=(e,t,r)=>e0(r(e.element,t),!0,e.isLocked),nt=(e,t)=>e.section!==t?e1(e.element,e.cells,t,e.isNew):e,nr=()=>({transformRow:nt,transformCell:(e,t,r)=>{let l=r(e.element,t),o="td"!==eo(l)?((e,t)=>{let r=eJ(e,"td");ej(e,r);let l=eL(e);return e$(r,l),eq(e),r})(l):l;return e0(o,e.isNew,e.isLocked)}}),nl=()=>({transformRow:nt,transformCell:ne}),no=()=>({transformRow:(e,t)=>nt(e,"thead"===t?"tbody":t),transformCell:ne}),nn=()=>({transformRow:p,transformCell:ne}),ns=(e,t,r,l)=>{r===l?ev(e,t):eh(e,t,r)},na=(e,t,r)=>{V(te(e,t)).fold(()=>eP(e,r),e=>ej(e,r))},ni=(e,t)=>{let r=[],l=[],o=e=>N(e,e=>{e.isNew&&r.push(e.element);let t=e.element;return eV(t),B(e.cells,e=>{e.isNew&&l.push(e.element),ns(e.element,"colspan",e.colspan,1),ns(e.element,"rowspan",e.rowspan,1),eI(t,e.element)}),t}),n=e=>P(e,e=>N(e.cells,e=>(ns(e.element,"span",e.colspan,1),e.element))),s=(t,r)=>{let l=((e,t)=>{let r=ts(e,t).getOrThunk(()=>{let r=eC.fromTag(t,ek(e).dom);return"thead"===t?na(e,"caption,colgroup",r):"colgroup"===t?na(e,"caption",r):eI(e,r),r});return eV(r),r})(e,r),s=("colgroup"===r?n:o)(t);e$(l,s)},a=(t,r)=>{t.length>0?s(t,r):(t=>{ts(e,t).each(eq)})(r)},i=[],m=[],c=[],d=[];return B(t,e=>{switch(e.section){case"thead":i.push(e);break;case"tbody":m.push(e);break;case"tfoot":c.push(e);break;case"colgroup":d.push(e)}}),a(d,"colgroup"),a(i,"thead"),a(m,"tbody"),a(c,"tfoot"),{newRows:r,newCells:l}},nm=(e,t)=>{if(0===e.length)return 0;let r=e[0];return M(e,e=>!t(r.element,e.element)).getOr(e.length)},nc=(e,t)=>{let r=N(e,e=>N(e.cells,x));return N(e,(l,o)=>{var n;let s=P(l.cells,(l,n)=>{var s;if(!1===r[o][n]){let a=((e,t,r,l)=>{let o=e[t],n="colgroup"===o.section,s=nm(o.cells.slice(r),l),a=n?1:nm(N(e.slice(t),e=>rv(e,r)),l);return{colspan:s,rowspan:a}})(e,o,n,t);return((e,t,l,o)=>{for(let n=e;n<e+l;n++)for(let e=t;e<t+o;e++)r[n][e]=!0})(o,n,a.rowspan,a.colspan),[(s=l.element,{element:s,rowspan:a.rowspan,colspan:a.colspan,isNew:l.isNew})]}return[]});return n=l.element,{element:n,cells:s,section:l.section,isNew:l.isNew}})},nd=(e,t,r)=>{let l=[];B(e.colgroups,o=>{let n=[];for(let l=0;l<e.grid.columns;l++){let o=rW(e,l).map(e=>e0(e.element,r,!1)).getOrThunk(()=>e0(t.colGap(),!0,!1));n.push(o)}l.push(e1(o.element,n,"colgroup",r))});for(let o=0;o<e.grid.rows;o++){let n=[];for(let l=0;l<e.grid.columns;l++){let s=rB(e,o,l).map(e=>e0(e.element,r,e.isLocked)).getOrThunk(()=>e0(t.gap(),!0,!1));n.push(s)}let s=e.all[o],a=e1(s.element,n,s.section,r);l.push(a)}return l},nu=e=>nc(e,eD),nf=(e,t)=>q(e.all,e=>W(e.cells,e=>eD(t,e.element))),ng=(e,t,r)=>{let l=N(t.selection,t=>tL(t).bind(t=>nf(e,t)).filter(r)),o=tc(l);return td(o.length>0,o)},nh=(e,t,r,l,o)=>(n,s,a,i)=>{let m=rN(n),c=S.from(null==i?void 0:i.section).getOrThunk(nn);return t(m,s).map(t=>{let r=nd(m,a,!1),l=e(r,t,eD,o(a),c),n=rD(l.grid);return{info:t,grid:nu(l.grid),cursor:l.cursor,lockedColumns:n}}).bind(e=>{let t=ni(n,e.grid),o=S.from(null==i?void 0:i.sizing).getOrThunk(()=>lO(n)),s=S.from(null==i?void 0:i.resize).getOrThunk(o3);return r(n,e.grid,e.info,{sizing:o,resize:s,section:c}),l(n),ev(n,rT),e.lockedColumns.length>0&&eh(n,rT,e.lockedColumns.join(",")),S.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})},np=(e,t)=>ng(e,t,C).map(e=>({cells:e,generators:t.generators,clipboard:t.clipboard})),nb=(e,t)=>ng(e,t,C),nw=(e,t)=>ng(e,t,e=>!e.isLocked),nv=(e,t)=>I(t,t=>nf(e,t).exists(e=>!e.isLocked)),ny=(e,t,r,l)=>{let o=rC(e).rows,n=!0;for(let e=0;e<o.length;e++)for(let s=0;s<rx(o[0]);s++){let a=o[e],i=rv(a,s),m=r(i.element,t);m&&!n?rb(a,s,e0(l(),!0,i.isLocked)):m&&(n=!1)}return e},nx=e=>{let t=t=>t(e),r=h(e),l={tag:!0,inner:e,fold:(t,r)=>r(e),isValue:C,isError:x,map:t=>nS.value(t(e)),mapError:()=>l,bind:t,exists:t,forall:t,getOr:r,or:()=>l,getOrThunk:r,orThunk:()=>l,getOrDie:r,each:t=>{t(e)},toOptional:()=>S.some(e)};return l},nC=e=>{var t;let r={tag:!1,inner:e,fold:(t,r)=>t(e),isValue:x,isError:C,map:()=>r,mapError:t=>nS.error(t(e)),bind:()=>r,exists:x,forall:C,getOr:p,or:p,getOrThunk:y,orThunk:y,getOrDie:(t=String(e),()=>{throw Error(t)}),each:g,toOptional:S.none};return r},nS={value:nx,error:nC,fromOption:(e,t)=>e.fold(()=>nC(t),nx)},nT=(e,t)=>({rowDelta:0,colDelta:rx(e[0])-rx(t[0])}),nR=(e,t)=>({rowDelta:e.length-t.length,colDelta:0}),nD=(e,t,r,l)=>{let o="colgroup"===t.section?r.col:r.cell;return E(e,e=>e0(o(),!0,l(e)))},nO=(e,t,r,l)=>{let o=e[e.length-1];return e.concat(E(t,()=>{let e="colgroup"===o.section?r.colgroup:r.row,t=rS(o,e,p),n=nD(t.cells.length,t,r,e=>Z(l,e.toString()));return rw(t,n)}))},nk=(e,t,r,l)=>N(e,e=>{let o=nD(t,e,r,x);return rh(e,l,o)}),nE=(e,t,r)=>{let l=t.colDelta<0?nk:p,o=t.rowDelta<0?nO:p,n=rD(e),s=rx(e[0]),a=k(n,e=>e===s-1),i=l(e,Math.abs(t.colDelta),r,a?s-1:s),m=rD(i);return o(i,Math.abs(t.rowDelta),r,F(m,C))},nN=(e,t,r,l)=>{let o=w(l,rv(e[t],r).element),n=e[t];return e.length>1&&rx(n)>1&&(r>0&&o(ry(n,r-1))||r<n.cells.length-1&&o(ry(n,r+1))||t>0&&o(ry(e[t-1],r))||t<e.length-1&&o(ry(e[t+1],r)))},nB=(e,t,r)=>z(r,r=>r>=e.column&&r<=rx(t[0])+e.column),n_=(e,t,r,l,o)=>{var n;n=l.cell,e>0&&e<t[0].cells.length&&B(t,t=>{let r=t.cells[e-1],l=0,s=n();for(;t.cells.length>e+l&&o(r.element,t.cells[e+l].element);)rb(t,e+l,e0(s,!0,t.cells[e+l].isLocked)),l++});let s=nR(r,t),a=nE(r,s,l),i=nR(t,a),m=nE(t,i,l);return N(m,(t,r)=>rh(t,e,a[r].cells))},nz=(e,t,r,l,o)=>{((e,t,r,l)=>{let o=rC(e).rows;if(t>0&&t<o.length){let e=L(o[t-1].cells,(e,t)=>k(e,e=>r(e.element,t.element))?e:e.concat([t]),[]);B(e,e=>{let n=S.none();for(let s=t;s<o.length;s++)for(let t=0;t<rx(o[0]);t++){let a=o[s],i=rv(a,t);r(i.element,e.element)&&(n.isNone()&&(n=S.some(l())),n.each(e=>{rb(a,t,e0(e,!0,i.isLocked))}))}})}})(t,e,o,l.cell);let n=rD(t),s=nT(t,r),a={...s,colDelta:s.colDelta-n.length},i=nE(t,a,l),{cols:m,rows:c}=rC(i),d=rD(i),u=nT(r,t),f={...u,colDelta:u.colDelta+d.length},g=N(r,e=>L(d,(t,r)=>{let o=nD(1,e,l,C)[0];return rp(t,r,o)},e)),h=nE(g,f,l);return[...m,...c.slice(0,e),...h,...c.slice(e,c.length)]},nA=(e,t,r,l,o)=>{let{rows:n,cols:s}=rC(e),a=n.slice(0,t),i=n.slice(t);return[...s,...a,rS(n[r],e=>o(e,l),(e,r)=>t>0&&t<n.length&&l(ry(n[t-1],r),ry(n[t],r))?rv(n[t],r):e0(o(e.element,l),!0,e.isLocked)),...i]},nL=(e,t,r,l,o)=>N(e,e=>{let n=t>0&&t<rx(e)&&l(ry(e,t-1),ry(e,t)),s=((e,t,r,l,o,n,s)=>{if("colgroup"!==r&&l)return rv(e,t);{let t=rv(e,o);return e0(s(t.element,n),!0,!1)}})(e,t,e.section,n,r,l,o);return rp(e,t,s)}),nW=(e,t,r,l)=>{var o;return void 0!==ry(e[t],r)&&t>0&&l(ry(e[t-1],r),ry(e[t],r))||(o=e[t],r>0&&l(ry(o,r-1),ry(o,r)))},nM=(e,t,r,l)=>{let o=e=>("row"===e?tE(t):tk(t))?`${e}group`:e;return e?o2(t)?o(r):null:l&&o2(t)?o("row"===r?"col":"row"):null},nj=(e,t,r)=>e0(r(e.element,t),!0,e.isLocked),nP=(e,t,r,l,o,n,s)=>N(e,(e,a)=>((e,i)=>{let m=e.cells,c=N(m,(e,i)=>{if(k(t,t=>r(e.element,t.element))){let t=s(e,a,i)?o(e,r,l):e;return n(t,a,i).each(e=>{var r;r=t.element,K({scope:S.from(e)},(e,t)=>{e.fold(()=>{ev(r,t)},e=>{eg(r.dom,t,e)})})}),t}return e});return e1(e.element,c,e.section,e.isNew)})(e)),nI=(e,t,r)=>P(e,(l,o)=>nW(e,o,t,r)?[]:[rv(l,t)]),nF=(e,t,r,l,o)=>{let n=rC(e).rows,s=P(t,e=>nI(n,e,l)),a=N(n,e=>o7(e.cells)),i=I(a,p)&&o7(s)?C:(e,t,r)=>!("th"===eo(e.element)&&a[t]);return nP(e,s,l,o,nj,(e,t)=>S.some(nM(r,e.element,"row",a[t])),i)},nH=(e,t,r,l)=>{let o=rC(e).rows,n=N(t,e=>rv(o[e.row],e.column));return nP(e,n,r,l,nj,S.none,C)},n$=e=>{if(!a(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],r={};return B(e,(l,o)=>{let n=U(l);if(1!==n.length)throw Error("one and only one name per case");let s=n[0],i=l[s];if(void 0!==r[s])throw Error("duplicate key detected:"+s);if("cata"===s)throw Error("cannot have a case named cata (sorry)");if(!a(i))throw Error("case arguments must be an array");t.push(s),r[s]=(...r)=>{let l=r.length;if(l!==i.length)throw Error("Wrong number of arguments to case "+s+". Expected "+i.length+" ("+i+"), got "+l);return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,r)},match:e=>{let l=U(e);if(t.length!==l.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+l.join(","));if(!I(t,e=>O(l,e)))throw Error("Not all branches were specified when using match. Specified: "+l.join(", ")+"\nRequired: "+t.join(", "));return e[s].apply(null,r)},log:e=>{console.log(e,{constructors:t,constructor:s,params:r})}}}}),r},nV={...n$([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},nq=(e,t,r)=>{let l=0;for(let o=e;o<t;o++)l+=void 0!==r[o]?r[o]:0;return l},nU=(e,t)=>{let r=rz(e);return N(r,e=>{let r=nq(e.row,e.row+e.rowspan,t);return{element:e.element,height:r,rowspan:e.rowspan}})},nG=(e,t,r)=>{let l=rL(e)?((e,t)=>{let r=rA(e);return N(r,(e,r)=>({element:e.element,width:t[r],colspan:e.colspan}))})(e,t):((e,t)=>{let r=rz(e);return N(r,e=>{let r=nq(e.column,e.column+e.colspan,t);return{element:e.element,width:r,colspan:e.colspan}})})(e,t);B(l,e=>{r.setElementWidth(e.element,e.width)})},nK=(e,t,r,l,o)=>{let n=rN(e),s=o.getCellDelta(t),a=o.getWidths(n,o),i=r===n.grid.columns-1,m=l.clampTableDelta(a,r,s,o.minCellWidth(),i),c=((e,t,r,l,o)=>{let n=e.slice(0),s=0===e.length?nV.none():1===e.length?nV.only(0):0===t?nV.left(0,1):t===e.length-1?nV.right(t-1,t):t>0&&t<e.length-1?nV.middle(t-1,t,t+1):nV.none(),a=h(N(n,h(0)));return s.fold(a,e=>l.singleColumnWidth(n[e],r),(e,t)=>o.calcLeftEdgeDeltas(n,e,t,r,l.minCellWidth(),l.isRelative),(e,t,s)=>o.calcMiddleDeltas(n,e,t,s,r,l.minCellWidth(),l.isRelative),(e,t)=>o.calcRightEdgeDeltas(n,e,t,r,l.minCellWidth(),l.isRelative))})(a,r,m,o,l),d=N(c,(e,t)=>e+a[t]);nG(n,d,o),l.resizeTable(o.adjustTableWidth,m,i)},nY=e=>L(e,(e,t)=>k(e,e=>e.column===t.column)?e:e.concat([t]),[]).sort((e,t)=>e.column-t.column),nJ=ef("col"),nQ=ef("colgroup"),nX=e=>"tr"===eo(e)||nQ(e),nZ=e=>({element:e,colspan:tD(e,"colspan",1),rowspan:tD(e,"rowspan",1)}),n0=e=>ew(e,"scope").map(e=>e.substr(0,3)),n1=(e,t=nZ)=>{let r=r=>{var o,n;if(nX(r))return nQ((o={element:r}).element)?e.colgroup(o):e.row(o);{let o=nJ((n=t(r)).element)?e.col(n):e.cell(n);return l=S.some({item:r,replacement:o}),o}},l=S.none();return{getOrInit:(e,t)=>l.fold(()=>r(e),l=>t(e,l.item)?l.replacement:r(e))}},n9=e=>t=>{let r=[],l=l=>{let o="td"===e?{scope:null}:{},n=t.replace(l,e,o);return r.push({item:l,sub:n}),n};return{replaceOrInit:(e,t)=>nX(e)||nJ(e)?e:W(r,r=>t(r.item,e)).fold(()=>l(e),r=>t(e,r.item)?r.sub:l(e))}},n3=e=>({unmerge:t=>{let r=n0(t);return r.each(e=>eh(t,"scope",e)),()=>{let l=e.cell({element:t,colspan:1,rowspan:1});return tR(l,"width"),tR(t,"width"),r.each(e=>eh(l,"scope",e)),l}},merge:e=>(tR(e[0],"width"),(()=>{let t=tc(N(e,n0));if(0===t.length)return S.none();{let e=t[0],r=["row","col"];return k(t,t=>t!==e&&O(r,t))?S.none():S.from(e)}})().fold(()=>ev(e[0],"scope"),t=>eh(e[0],"scope",t+"group")),h(e[0]))}),n5=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],n2=oy(),n7=e=>((e,t)=>{let r=e.property().name(t);return O(n5,r)})(n2,e),n4=e=>((e,t)=>{let r=e.property().name(t);return O(["ol","ul"],r)})(n2,e),n6=e=>{let t=ef("br"),r=e=>lM(e).bind(r=>{let l=eA(r).map(e=>!!n7(e)||!!O(["br","img","hr","input"],n2.property().name(e))&&"img"!==eo(e)).getOr(!1);return eN(r).map(o=>!0===l||"li"===eo(o)||tl(o,n4).isSome()||t(r)||n7(o)&&!eD(e,o)?[]:[eC.fromTag("br")])}).getOr([]),l=(()=>{let l=P(e,e=>{let l=eL(e);return I(l,e=>t(e)||ec(e)&&0===lN(e).trim().length)?[]:l.concat(r(e))});return 0===l.length?[eC.fromTag("br")]:l})();eV(e[0]),e$(e[0],l)},n8=e=>or(e,!0),se=e=>{0===tW(e).length&&eq(e)},st=(e,t)=>({grid:e,cursor:t}),sr=(e,t,r)=>{let l=((e,t,r)=>{var l,o;let n=rC(e).rows;return S.from(null===(o=null===(l=n[t])||void 0===l?void 0:l.cells[r])||void 0===o?void 0:o.element).filter(n8).orThunk(()=>q(n,e=>q(e.cells,e=>{let t=e.element;return td(n8(t),t)})))})(e,t,r);return st(e,l)},sl=e=>L(e,(e,t)=>k(e,e=>e.row===t.row)?e:e.concat([t]),[]).sort((e,t)=>e.row-t.row),so=(e,t)=>(r,l,o,n,s)=>{let a=sl(l),i=N(a,e=>e.row),m=((e,t,r,l,o,n,s)=>{let{cols:a,rows:i}=rC(e),m=i[t[0]],c=P(t,e=>((e,t,r)=>{let l=e[t];return P(l.cells,(l,o)=>nW(e,t,o,r)?[]:[l])})(i,e,o)),d=N(m.cells,(e,t)=>o7(nI(i,t,o))),u=[...i];B(t,e=>{u[e]=s.transformRow(i[e],r)});let f=[...a,...u],g=I(d,p)&&o7(m.cells)?C:(e,t,r)=>!("th"===eo(e.element)&&d[r]);return nP(f,c,o,n,s.transformCell,(e,t,r)=>S.some(nM(l,e.element,"col",d[r])),g)})(r,i,e,t,o,n.replaceOrInit,s);return sr(m,l[0].row,l[0].column)},sn=so("thead",!0),ss=so("tbody",!1),sa=so("tfoot",!1),si=(e,t,r)=>{var l;let o=(l=r.section,tF(e,()=>l)),n=rE(o);return nd(n,t,!0)},sm=(e,t,r,l)=>((e,t,r,l)=>{let o=rE(t),n=l.getWidths(o,l);nG(o,n,l)})(0,t,0,l.sizing),sc=(e,t,r,l)=>((e,t,r,l,o)=>{let n=rE(t),s=l.getWidths(n,l),a=l.pixelWidth(),{newSizes:i,delta:m}=o.calcRedestributedWidths(s,a,r.pixelDelta,l.isRelative);nG(n,i,l),l.adjustTableWidth(m)})(0,t,r,l.sizing,l.resize),sd=(e,t)=>k(t,e=>0===e.column&&e.isLocked),su=(e,t)=>k(t,t=>t.column+t.colspan>=e.grid.columns&&t.isLocked),sf=(e,t)=>{let r=rM(e),l=nY(t);return L(l,(e,t)=>e+r[t.column].map(rf).getOr(0),0)},sg=e=>(t,r)=>nb(t,r).filter(r=>!(e?sd:su)(t,r)).map(e=>({details:e,pixelDelta:sf(t,e)})),sh=e=>(t,r)=>np(t,r).filter(r=>!(e?sd:su)(t,r.cells)),sp=n9("th"),sb=n9("td"),sw=nh((e,t,r,l)=>{let o=t[0].row,n=sl(t),s=A(n,(e,t)=>({grid:nA(e.grid,o,t.row+e.delta,r,l.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid;return sr(s,o,t[0].column)},nb,g,g,n1),sv=nh((e,t,r,l)=>{let o=sl(t),n=o[o.length-1],s=n.row+n.rowspan,a=A(o,(e,t)=>nA(e,s,t.row,r,l.getOrInit),e);return sr(a,s,t[0].column)},nb,g,g,n1),sy=nh((e,t,r,l)=>{let o=t.details,n=nY(o),s=n[0].column,a=A(n,(e,t)=>({grid:nL(e.grid,s,t.column+e.delta,r,l.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid;return sr(a,o[0].row,s)},sg(!0),sc,g,n1),sx=nh((e,t,r,l)=>{let o=t.details,n=o[o.length-1],s=n.column+n.colspan,a=nY(o),i=A(a,(e,t)=>nL(e,s,t.column,r,l.getOrInit),e);return sr(i,o[0].row,s)},sg(!1),sc,g,n1),sC=nh((e,t,r,l)=>{var o;let n=nY(t.details),s=(o=N(n,e=>e.column),P(e,e=>{let t=e.cells,r=A(o,(e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e,t);return r.length>0?[e1(e.element,r,e.section,e.isNew)]:[]})),a=s.length>0?s[0].cells.length-1:0;return sr(s,n[0].row,Math.min(n[0].column,a))},(e,t)=>nw(e,t).map(t=>({details:t,pixelDelta:-sf(e,t)})),sc,se,n1),sS=nh((e,t,r,l)=>{let o=sl(t),n=((e,t,r)=>{let{rows:l,cols:o}=rC(e);return[...o,...l.slice(0,t),...l.slice(r+1)]})(e,o[0].row,o[o.length-1].row),s=n.length>0?n.length-1:0;return sr(n,Math.min(t[0].row,s),t[0].column)},nb,g,se,n1),sT=nh((e,t,r,l)=>{let o=nY(t),n=N(o,e=>e.column),s=nF(e,n,!0,r,l.replaceOrInit);return sr(s,t[0].row,t[0].column)},nw,g,g,sp),sR=nh((e,t,r,l)=>{let o=nY(t),n=N(o,e=>e.column),s=nF(e,n,!1,r,l.replaceOrInit);return sr(s,t[0].row,t[0].column)},nw,g,g,sb),sD=nh(sn,nw,g,g,sp),sO=nh(ss,nw,g,g,sb),sk=nh(sa,nw,g,g,sb),sE=nh((e,t,r,l)=>{let o=nH(e,t,r,l.replaceOrInit);return sr(o,t[0].row,t[0].column)},nw,g,g,sp),sN=nh((e,t,r,l)=>{let o=nH(e,t,r,l.replaceOrInit);return sr(o,t[0].row,t[0].column)},nw,g,g,sb),sB=nh((e,t,r,l)=>{let o=t.cells;n6(o);let n=((e,t,r,l)=>{let o=rC(e).rows;if(0===o.length)return e;for(let e=t.startRow;e<=t.finishRow;e++)for(let r=t.startCol;r<=t.finishCol;r++){let t=o[e],n=rv(t,r).isLocked;rb(t,r,e0(l(),!1,n))}return e})(e,t.bounds,0,l.merge(o));return st(n,S.from(o[0]))},(e,t)=>(0,t.mergable).filter(t=>nv(e,t.cells)),sm,g,n3),s_=nh((e,t,r,l)=>{let o=A(t,(e,t)=>ny(e,t,r,l.unmerge(t)),e);return st(o,S.from(t[0]))},(e,t)=>(0,t.unmergable).filter(t=>nv(e,t)),sm,g,n3),sz=nh((e,t,r,l)=>{let o=((e,t)=>{let r=rN(e);return nd(r,t,!0)})(t.clipboard,t.generators);return((e,t,r,l,o)=>{let n=rD(t),s=((e,t,r)=>{let l=rx(t[0]),o=rC(t).cols.length+e.row,n=E(l-e.column,t=>t+e.column);return{row:o,column:W(n,e=>I(r,t=>t!==e)).getOr(l-1)}})(e,t,n),a=rC(r).rows,i=nB(s,a,n),m=((e,t,r)=>{if(e.row>=t.length||e.column>rx(t[0]))return nS.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);let l=t.slice(e.row),o=l[0].cells.slice(e.column),n=rx(r[0]),s=r.length;return nS.value({rowDelta:l.length-s,colDelta:o.length-n})})(s,t,a);return m.map(e=>{let r={...e,colDelta:e.colDelta-i.length},n=nE(t,r,l),m=rD(n),c=nB(s,a,m);return((e,t,r,l,o,n)=>{let s=e.row,a=e.column,i=s+r.length,m=a+rx(r[0])+n.length,c=F(n,C);for(let e=s;e<i;e++){let n=0;for(let i=a;i<m;i++){if(c[i]){n++;continue}nN(t,e,i,o)&&ny(t,ry(t[e],i),o,l.cell);let m=i-a-n,d=rv(r[e-s],m),u=d.element,f=l.replace(u);rb(t[e],i,e0(f,!0,d.isLocked))}}return t})(s,n,a,l,o,c)})})({row:t.row,column:t.column},e,o,t.generators,r).fold(()=>st(e,S.some(t.element)),e=>sr(e,t.row,t.column))},(e,t)=>tL(t.element).bind(r=>nf(e,r).map(e=>({...e,generators:t.generators,clipboard:t.clipboard}))),sm,g,n1),sA=nh((e,t,r,l)=>{let o=rC(e).rows,n=t.cells[0].column,s=o[t.cells[0].row],a=si(t.clipboard,t.generators,s),i=n_(n,e,a,t.generators,r);return sr(i,t.cells[0].row,t.cells[0].column)},sh(!0),g,g,n1),sL=nh((e,t,r,l)=>{let o=rC(e).rows,n=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,s=o[t.cells[0].row],a=si(t.clipboard,t.generators,s),i=n_(n,e,a,t.generators,r);return sr(i,t.cells[0].row,t.cells[0].column)},sh(!1),g,g,n1),sW=nh((e,t,r,l)=>{let o=rC(e).rows,n=t.cells[0].row,s=o[n],a=si(t.clipboard,t.generators,s),i=nz(n,e,a,t.generators,r);return sr(i,t.cells[0].row,t.cells[0].column)},np,g,g,n1),sM=nh((e,t,r,l)=>{let o=rC(e).rows,n=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,s=o[t.cells[0].row],a=si(t.clipboard,t.generators,s),i=nz(n,e,a,t.generators,r);return sr(i,t.cells[0].row,t.cells[0].column)},np,g,g,n1),sj=(e,t)=>{let r=rN(e);return nb(r,t).bind(e=>{let t=e[e.length-1],l=e[0].column,o=t.column+t.colspan,n=j(N(r.all,e=>z(e.cells,e=>e.column>=l&&e.column<o)));return o8(n)}).getOr("")},sP=(e,t)=>{let r=rN(e);return nb(r,t).bind(o8).getOr("")},sI=(e,t)=>{let r=rN(e);return nb(r,t).bind(e=>{let t=e[e.length-1],l=e[0].row,o=t.row+t.rowspan;return(e=>{let t=N(e,e=>o6(e).type),r=O(t,"header"),l=O(t,"footer");if(r||l){let e=O(t,"body");return!r||e||l?r||e||!l?S.none():S.some("footer"):S.some("header")}return S.some("body")})(r.all.slice(l,o))}).getOr("")},sF=(e,t)=>e.dispatch("NewRow",{node:t}),sH=(e,t)=>e.dispatch("NewCell",{node:t}),s$=(e,t,r)=>{e.dispatch("TableModified",{...r,table:t})},sV={structure:!1,style:!0},sq={structure:!0,style:!1},sU={structure:!0,style:!0},sG=(e,t)=>l3(e)?lR(t):l5(e)?lD(t):lO(t),sK=(e,t,r)=>{let l=e=>"table"===eo(oo(e)),o=lQ(e),n=l1(e)?g:oJ,s=t=>{switch(lX(e)){case"section":return nr();case"sectionCells":return nl();case"cells":return no();default:return((e,t)=>{switch(q(rN(e).all,e=>{let t=o6(e);return"header"===t.type?S.from(t.subType):S.none()}).getOr(t)){case"section":return nr();case"sectionCells":return nl();case"cells":return no()}})(t,"section")}},a=(l,n,a,i)=>(m,c,d=!1)=>{os(m);let u=eC.fromDom(e.getDoc()),f=lU(a,u,o),g={sizing:sG(e,m),resize:l1(e)?o9():o3(),section:s(m)};return n(m)?l(m,c,f,g).bind(l=>{t.refresh(m.dom),B(l.newRows,t=>{sF(e,t.dom)}),B(l.newCells,t=>{sH(e,t.dom)});let o=l.cursor.fold(()=>{let t=tW(m);return $(t).filter(e7).map(t=>{r.clearSelectedCells(m.dom);let l=e.dom.createRng();return l.selectNode(t.dom),e.selection.setRng(l),eh(t,"data-mce-selected","1"),l})},t=>{let l=oK(oY,t),o=e.dom.createRng();return o.setStart(l.element.dom,l.offset),o.setEnd(l.element.dom,l.offset),e.selection.setRng(o),r.clearSelectedCells(m.dom),S.some(o)});return e7(m)&&(os(m),d||s$(e,m.dom,i)),o.map(e=>({rng:e,effect:i}))}):S.none()},i=a(sS,t=>!l(e)||o5(t).rows>1,g,sq),m=a(sC,t=>!l(e)||o5(t).columns>1,g,sq);return{deleteRow:i,deleteColumn:m,insertRowsBefore:a(sw,C,g,sq),insertRowsAfter:a(sv,C,g,sq),insertColumnsBefore:a(sy,C,n,sq),insertColumnsAfter:a(sx,C,n,sq),mergeCells:a(sB,C,g,sq),unmergeCells:a(s_,C,g,sq),pasteColsBefore:a(sA,C,g,sq),pasteColsAfter:a(sL,C,g,sq),pasteRowsBefore:a(sW,C,g,sq),pasteRowsAfter:a(sM,C,g,sq),pasteCells:a(sz,C,g,sU),makeCellsHeader:a(sE,C,g,sq),unmakeCellsHeader:a(sN,C,g,sq),makeColumnsHeader:a(sT,C,g,sq),unmakeColumnsHeader:a(sR,C,g,sq),makeRowsHeader:a(sD,C,g,sq),makeRowsBody:a(sO,C,g,sq),makeRowsFooter:a(sk,C,g,sq),getTableRowType:sI,getTableCellType:sP,getTableColType:sj}},sY=(e,t,r)=>{let l=tD(e,t,1);1===r||l<=1?ev(e,t):eh(e,t,Math.min(r,l))},sJ=(e,t)=>r=>{let l=r.column+r.colspan-1,o=r.column;return l>=e&&o<t},sQ=n$([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),sX=(e,t,r)=>{let l=r.substring(0,r.length-e.length),o=parseFloat(l);return l===o.toString()?t(o):sQ.invalid(r)},sZ={...sQ,from:e=>th(e,"%")?sX("%",sQ.percent,e):th(e,"px")?sX("px",sQ.pixels,e):sQ.invalid(e)},s0=(e,t,r)=>{let l=sZ.from(r),o=I(e,e=>"0px"===e)?((e,t)=>{let r=e.fold(()=>h(""),e=>h(e/t+"px"),()=>h(100/t+"%"));return E(t,r)})(l,e.length):l.fold(()=>e,r=>((e,t,r)=>{let l=r/t;return N(e,e=>sZ.from(e).fold(()=>e,e=>e*l+"px",e=>e/100*r+"px"))})(e,t,r),r=>N(e,e=>sZ.from(e).fold(()=>e,e=>e/t*100+"%",e=>e+"%")));return s3(o)},s1=(e,t)=>0===e.length?t:A(e,(e,t)=>sZ.from(t).fold(h(0),p,p)+e,0),s9=(e,t)=>sZ.from(e).fold(h(e),e=>e+t+"px",e=>e+t+"%"),s3=e=>{if(0===e.length)return e;let t=A(e,(e,t)=>{let r=sZ.from(t).fold(()=>({value:t,remainder:0}),e=>((e,t)=>{let r=Math.floor(e);return{value:r+"px",remainder:e-r}})(e),e=>({value:e+"%",remainder:0}));return{output:[r.value].concat(e.output),remainder:e.remainder+r.remainder}},{output:[],remainder:0}),r=t.output;return r.slice(0,r.length-1).concat([s9(r[r.length-1],Math.round(t.remainder))])},s5=sZ.from,s2=e=>s5(e).fold(h("px"),h("px"),h("%")),s7=(e,t,r)=>{let l=rN(e),o=l.all,n=rz(l),s=rA(l);t.each(t=>{let r=s2(t),o=ru(e),a=ly(l,e,lb,lx),i=s0(a,o,t);rL(l)?B(s,(e,t)=>{let l=s1([i[t]],tB());ty(e.element,"width",l+r)}):B(n,e=>{let t=i.slice(e.column,e.colspan+e.column),l=s1(t,tB());ty(e.element,"width",l+r)}),ty(e,"width",t)}),r.each(t=>{var r;let s=s2(t),a=r$(e),i=lS(l,e,r2,lw,lx);r=s0(i,a,t),B(n,e=>{let t=r.slice(e.row,e.rowspan+e.row),l=s1(t,t_());ty(e.element,"height",l+s)}),B(o,(e,t)=>{ty(e.element,"height",r[t])}),ty(e,"height",t)})},s4=e=>lm(e).exists(e=>le.test(e)),s6=e=>lm(e).exists(e=>lt.test(e)),s8=e=>lm(e).isNone(),ae=e=>{ev(e,"width")},at=e=>{let t=lg(e);s7(e,S.some(t),S.none()),ae(e)},ar=e=>{let t=ru(e)+"px";s7(e,S.some(t),S.none()),ae(e)},al=e=>{tR(e,"width");let t=tM(e),r=t.length>0?t:tW(e);B(r,e=>{tR(e,"width"),ae(e)}),ae(e)},ao={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},an=(e,t,r,l)=>E(e,e=>((e,t,r,l)=>{let o=eC.fromTag("tr");for(let n=0;n<e;n++){let e=eC.fromTag(l<t||n<r?"th":"td");n<r&&eh(e,"scope","row"),l<t&&eh(e,"scope","col"),eI(e,eC.fromTag("br")),eI(o,e)}return o})(t,r,l,e)),as=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},aa=(e,t,r,l,o)=>{let s=(e=>{let t=e.options,r=t.get("table_default_styles");return t.isSet("table_default_styles")?r:l2(e)||!l4(e)?r:l5(e)?{...r,width:lJ(e)}:{...r,width:lY}})(e),a={styles:s,attributes:l8(e),colGroups:oe(e)};return e.undoManager.ignore(()=>{let n=((e,t,r,l,o,n=ao)=>{let s=eC.fromTag("table"),a="cells"!==o;tx(s,n.styles),ep(s,n.attributes),n.colGroups&&eI(s,(e=>{let t=eC.fromTag("colgroup");return E(e,()=>eI(t,eC.fromTag("col"))),t})(t));let i=Math.min(e,r);if(a&&r>0){let e=eC.fromTag("thead");eI(s,e);let n=an(r,t,"sectionCells"===o?i:0,l);e$(e,n)}let m=eC.fromTag("tbody");eI(s,m);let c=an(a?e-i:e,t,a?0:r,l);return e$(m,c),s})(r,t,o,l,lX(e),a);eh(n,"data-mce-id","__mce");let s=(e=>{let t=eC.fromTag("div"),r=eC.fromDom(e.dom.cloneNode(!0));return eI(t,r),t.dom.innerHTML})(n);e.insertContent(s),e.addVisual()}),ta(oo(e),'table[data-mce-id="__mce"]').map(t=>{var r;return l5(e)?ar(t):l2(e)?al(t):(l3(e)||n(r=s.width)&&-1!==r.indexOf("%"))&&at(t),os(t),ev(t,"data-mce-id"),B(tt(t,"tr"),t=>{sF(e,t.dom),B(tt(t,"th,td"),t=>{sH(e,t.dom)})}),((e,t)=>{ta(t,"td,th").each(w(as,e))})(e,t),t.dom}).getOrNull()};var ai=tinymce.util.Tools.resolve("tinymce.FakeClipboard");let am="x-tinymce/dom-table-",ac=am+"rows",ad=am+"columns",au=e=>{let t=ai.FakeClipboardItem(e);ai.write([t])},af=e=>{var t;let r=null!==(t=ai.read())&&void 0!==t?t:[];return q(r,t=>S.from(t.getType(e)))},ag=e=>{af(e).isSome()&&ai.clear()},ah=e=>{e.fold(ab,e=>au({[ac]:e}))},ap=()=>af(ac),ab=()=>ag(ac),aw=e=>{e.fold(ay,e=>au({[ad]:e}))},av=()=>af(ad),ay=()=>ag(ad),ax=e=>oF(oa(e),on(e)).filter(oc),aC=(e,t)=>{let r=on(e),l=e=>tj(e,r),o=t=>oH(oa(e),on(e)).filter(oc).bind(e=>l(e).map(r=>t(r,e))),a=t=>{e.focus()},i=(t,r=!1)=>o((l,o)=>{let n=oP(o$(e),l,o);t(l,n,r).each(a)}),m=()=>o((t,r)=>((e,t,r)=>{let l=rN(e);return nb(l,t).bind(e=>{let t=nd(l,r,!1),o=rC(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),n=P(o,e=>{let t=z(e.cells,e=>!e.isLocked);return t.length>0?[{...e,cells:t}]:[]}),s=nu(n);return td(s.length>0,s)}).map(e=>N(e,e=>{let t=eK(e.element);return B(e.cells,e=>{let r=eY(e.element);ns(r,"colspan",e.colspan,1),ns(r,"rowspan",e.rowspan,1),eI(t,r)}),t}))})(t,oP(o$(e),t,r),lU(g,eC.fromDom(e.getDoc()),S.none()))),c=()=>o((t,r)=>((e,t)=>{let r=rN(e);return nw(r,t).map(e=>{let t=e[e.length-1],l=e[0].column,o=t.column+t.colspan,n=((e,t,r)=>{if(rL(e)){let l=z(rA(e),sJ(t,r)),o=N(l,e=>{let l=eY(e.element);return sY(l,"span",r-t),l}),n=eC.fromTag("colgroup");return e$(n,o),[n]}return[]})(r,l,o),s=N(r.all,e=>{let t=z(e.cells,sJ(l,o)),r=N(t,e=>{let t=eY(e.element);return sY(t,"colspan",o-l),t}),n=eC.fromTag("tr");return e$(n,r),n});return[...n,...s]})})(t,oP(o$(e),t,r))),d=(t,r)=>r().each(r=>{let l=N(r,e=>eY(e));o((r,o)=>{let n=lG(eC.fromDom(e.getDoc())),s={selection:p(o$(e)),clipboard:l,generators:n};t(r,s).each(a)})}),u=e=>(t,r)=>{var l;return(Z(r,l="type")?S.from(r[l]):S.none()).each(t=>{i(e(t),r.no_events)})};K({mceTableSplitCells:()=>i(t.unmergeCells),mceTableMergeCells:()=>i(t.mergeCells),mceTableInsertRowBefore:()=>i(t.insertRowsBefore),mceTableInsertRowAfter:()=>i(t.insertRowsAfter),mceTableInsertColBefore:()=>i(t.insertColumnsBefore),mceTableInsertColAfter:()=>i(t.insertColumnsAfter),mceTableDeleteCol:()=>i(t.deleteColumn),mceTableDeleteRow:()=>i(t.deleteRow),mceTableCutCol:()=>c().each(e=>{aw(e),i(t.deleteColumn)}),mceTableCutRow:()=>m().each(e=>{ah(e),i(t.deleteRow)}),mceTableCopyCol:()=>c().each(e=>aw(e)),mceTableCopyRow:()=>m().each(e=>ah(e)),mceTablePasteColBefore:()=>d(t.pasteColsBefore,av),mceTablePasteColAfter:()=>d(t.pasteColsAfter,av),mceTablePasteRowBefore:()=>d(t.pasteRowsBefore,ap),mceTablePasteRowAfter:()=>d(t.pasteRowsAfter,ap),mceTableDelete:()=>ax(e).each(t=>{tj(t,r).filter(v(r)).each(t=>{let r=eC.fromText("");if(ej(t,r),eq(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{let t=e.dom.createRng();t.setStart(r.dom,0),t.setEnd(r.dom,0),e.selection.setRng(t),e.nodeChanged()}})}),mceTableCellToggleClass:(t,r)=>{o(t=>{let l=o$(e),o=I(l,t=>e.formatter.match("tablecellclass",{value:r},t.dom)),n=o?e.formatter.remove:e.formatter.apply;B(l,e=>n("tablecellclass",{value:r},e.dom)),s$(e,t.dom,sV)})},mceTableToggleClass:(t,r)=>{o(t=>{e.formatter.toggle("tableclass",{value:r},t.dom),s$(e,t.dom,sV)})},mceTableToggleCaption:()=>{ax(e).each(t=>{tj(t,r).each(r=>{ts(r,"caption").fold(()=>{let t=eC.fromTag("caption");eI(t,eC.fromText("Caption")),((e,t,r)=>{eW(e,0).fold(()=>{eI(e,t)},e=>{eM(e,t)})})(r,t),e.selection.setCursorLocation(t.dom,0)},l=>{ef("caption")(t)&&eR("td",r).each(t=>e.selection.setCursorLocation(t.dom,0)),eq(l)}),s$(e,r.dom,sq)})})},mceTableSizingMode:(t,l)=>ax(e).each(t=>{l2(e)||l5(e)||l3(e)||tj(t,r).each(t=>{"relative"!==l||s4(t)?"fixed"!==l||s6(t)?"responsive"!==l||s8(t)||al(t):ar(t):at(t),os(t),s$(e,t.dom,sq)})}),mceTableCellType:u(e=>"th"===e?t.makeCellsHeader:t.unmakeCellsHeader),mceTableColType:u(e=>"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader),mceTableRowType:u(e=>{switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}})},(t,r)=>e.addCommand(r,t)),e.addCommand("mceInsertTable",(t,r)=>{((e,t,r,l={})=>{let o=e=>f(e)&&e>0;if(o(t)&&o(r)){let o=l.headerRows||0,n=l.headerColumns||0;return aa(e,r,t,n,o)}console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table.")})(e,r.rows,r.columns,r.options)}),e.addCommand("mceTableApplyCellStyle",(t,r)=>{let o=e=>"tablecell"+e.toLowerCase().replace("-","");if(!s(r))return;let a=z(o$(e),oc);if(0===a.length)return;let i=((e,t)=>{var r;let l={};return r=(e,t)=>{l[t]=e},K(e,(e,l)=>{(t(e,l)?r:g)(e,l)}),l})(r,(t,r)=>e.formatter.has(o(r))&&n(t));(e=>{for(let t in e)if(G.call(e,t))return!1;return!0})(i)||(K(i,(t,r)=>{let l=o(r);B(a,r=>{""===t?e.formatter.remove(l,{value:null},r.dom,!0):e.formatter.apply(l,{value:t},r.dom)})}),l(a[0]).each(t=>s$(e,t.dom,sV)))})},aS=n$([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),aT={before:aS.before,on:aS.on,after:aS.after,cata:(e,t,r,l)=>e.fold(t,r,l),getStart:e=>e.fold(p,p,p)},aR=(e,t)=>({selection:e,kill:t}),aD=(e,t)=>{let r=e.document.createRange();return r.selectNode(t.dom),r},aO=(e,t)=>{let r=e.document.createRange();return ak(r,t),r},ak=(e,t)=>e.selectNodeContents(t.dom),aE=(e,t,r)=>{let l=e.document.createRange();return t.fold(e=>{l.setStartBefore(e.dom)},(e,t)=>{l.setStart(e.dom,t)},e=>{l.setStartAfter(e.dom)}),((e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,r)=>{e.setEnd(t.dom,r)},t=>{e.setEndAfter(t.dom)})})(l,r),l},aN=(e,t,r,l,o)=>{let n=e.document.createRange();return n.setStart(t.dom,r),n.setEnd(l.dom,o),n},aB=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),a_=n$([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),az=(e,t,r)=>t(eC.fromDom(r.startContainer),r.startOffset,eC.fromDom(r.endContainer),r.endOffset),aA=(e,t)=>{let r=t.match({domRange:e=>({ltr:h(e),rtl:S.none}),relative:(t,r)=>({ltr:tV(()=>aE(e,t,r)),rtl:tV(()=>S.some(aE(e,r,t)))}),exact:(t,r,l,o)=>({ltr:tV(()=>aN(e,t,r,l,o)),rtl:tV(()=>S.some(aN(e,l,o,t,r)))})});return((e,t)=>{let r=t.ltr();return r.collapsed?t.rtl().filter(e=>!1===e.collapsed).map(e=>a_.rtl(eC.fromDom(e.endContainer),e.endOffset,eC.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>az(0,a_.ltr,r)):az(0,a_.ltr,r)})(0,r)},aL=(e,t)=>aA(e,t).match({ltr:(t,r,l,o)=>{let n=e.document.createRange();return n.setStart(t.dom,r),n.setEnd(l.dom,o),n},rtl:(t,r,l,o)=>{let n=e.document.createRange();return n.setStart(l.dom,o),n.setEnd(t.dom,r),n}});a_.ltr,a_.rtl;let aW=(e,t,r,l)=>({start:e,soffset:t,finish:r,foffset:l}),aM=(e,t,r,l)=>({start:aT.on(e,t),finish:aT.on(r,l)}),aj=(e,t)=>{let r=aL(e,t);return aW(eC.fromDom(r.startContainer),r.startOffset,eC.fromDom(r.endContainer),r.endOffset)},aP=(e,t,r,l,o)=>eD(r,l)?S.none():oD(r,l,t).bind(t=>{let l=t.boxes.getOr([]);return l.length>1?(o(e,l,t.start,t.finish),S.some(aR(S.some(aM(r,0,r,lz(r))),!0))):S.none()}),aI=(e,t)=>({item:e,mode:t}),aF=(e,t,r,l=aH)=>e.property().parent(t).map(e=>aI(e,l)),aH=(e,t,r,l=a$)=>r.sibling(e,t).map(e=>aI(e,l)),a$=(e,t,r,l=a$)=>{let o=e.property().children(t);return r.first(o).map(e=>aI(e,l))},aV=[{current:aF,next:aH,fallback:S.none()},{current:aH,next:a$,fallback:S.some(aF)},{current:a$,next:a$,fallback:S.some(aH)}],aq=(e,t,r,l,o=aV)=>W(o,e=>e.current===r).bind(r=>r.current(e,t,l,r.next).orThunk(()=>r.fallback.bind(r=>aq(e,t,r,l)))),aU=(e,t,r,l,o,n)=>aq(e,t,l,o).bind(t=>n(t.item)?S.none():r(t.item)?S.some(t.item):aU(e,t.item,r,t.mode,o,n)),aG=e=>t=>0===e.property().children(t).length,aK=(e,t,r,l)=>aU(e,t,r,aH,{sibling:(e,t)=>e.query().prevSibling(t),first:e=>e.length>0?S.some(e[e.length-1]):S.none()},l),aY=(e,t,r,l)=>aU(e,t,r,aH,{sibling:(e,t)=>e.query().nextSibling(t),first:e=>e.length>0?S.some(e[0]):S.none()},l),aJ=oy(),aQ=(e,t)=>aK(aJ,e,aG(aJ),t),aX=(e,t)=>aY(aJ,e,aG(aJ),t),aZ=n$([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),a0=e=>ti(e,"tr"),a1={...aZ,verify:(e,t,r,l,o,n,s)=>ti(l,"td,th",s).bind(r=>ti(t,"td,th",s).map(t=>eD(r,t)?eD(l,r)&&lz(r)===o?n(t):aZ.none("in same cell"):oT(a0,[r,t]).fold(()=>((e,t,r)=>{let l=e.getRect(t),o=e.getRect(r);return o.right>l.left&&o.left<l.right})(e,t,r)?aZ.success():n(t),e=>n(t)))).getOr(aZ.none("default")),cata:(e,t,r,l,o)=>e.fold(t,r,l,o)},a9=ef("br"),a3=(e,t,r)=>t(e,r).bind(e=>ec(e)&&0===lN(e).trim().length?a3(e,t,r):S.some(e)),a5=(e,t,r,l)=>eW(t,r).filter(a9).orThunk(()=>eW(t,r-1).filter(a9)).bind(t=>l.traverse(t).fold(()=>a3(t,l.gather,e).map(l.relative),e=>eN(e).bind(t=>{let r=eL(t);return M(r,w(eD,e)).map(l=>({parent:t,children:r,element:e,index:l}))}).map(e=>aT.on(e.parent,e.index)))),a2=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),a7=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),a4=(e,t,r)=>({left:e.left+t,top:e.top+r,right:e.right+t,bottom:e.bottom+r}),a6=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),a8=(e,t)=>S.some(e.getRect(t)),ie=(e,t,r)=>em(t)?a8(e,t).map(a6):ec(t)?(r>=0&&r<lz(t)?e.getRangedRect(t,r,t,r+1):r>0?e.getRangedRect(t,r-1,t,r):S.none()).map(a6):S.none(),it=(e,t)=>em(t)?a8(e,t).map(a6):ec(t)?e.getRangedRect(t,0,t,lz(t)).map(a6):S.none(),ir=n$([{none:[]},{retry:["caret"]}]),il=(e,t,r)=>to(t,n7).fold(x,t=>it(e,t).exists(e=>r.left<e.left||1>Math.abs(e.right-r.left)||r.left>e.right)),io=(e,t,r,l,o)=>{var n,s,a;return 0===o?S.some(l):(n=l.left,s=t.point(l),e.elementFromPoint(n,s).filter(e=>"table"===eo(e)).isSome())?(a=o-1,io(e,t,r,t.move(l,5),a)):e.situsFromPoint(l.left,t.point(l)).bind(n=>n.start.fold(S.none,n=>it(e,n).bind(s=>t.adjuster(e,n,s,r,l).fold(S.none,l=>io(e,t,r,l,o-1))).orThunk(()=>S.some(l)),S.none))},is=(e,t,r)=>{let l=e.move(r,5),o=io(t,e,r,l,100).getOr(l);return(e.point(o)>t.getInnerHeight()?S.some(e.point(o)-t.getInnerHeight()):0>e.point(o)?S.some(-e.point(o)):S.none()).fold(()=>t.situsFromPoint(o.left,e.point(o)),r=>(t.scrollBy(0,r),t.situsFromPoint(o.left,e.point(o)-r)))},ia={tryUp:w(is,{point:e=>e.top,adjuster:(e,t,r,l,o)=>{let n=a7(o,5);return 1>Math.abs(r.top-l.top)||r.bottom<o.top?ir.retry(n):r.bottom===o.top?ir.retry(a7(o,1)):il(e,t,o)?ir.retry(a4(n,5,0)):ir.none()},move:a7,gather:aQ}),tryDown:w(is,{point:e=>e.bottom,adjuster:(e,t,r,l,o)=>{let n=a2(o,5);return 1>Math.abs(r.bottom-l.bottom)||r.top>o.bottom?ir.retry(n):r.top===o.bottom?ir.retry(a2(o,1)):il(e,t,o)?ir.retry(a4(n,5,0)):ir.none()},move:a2,gather:aX}),getJumpSize:h(5)},ii=(e,t,r)=>e.getSelection().bind(l=>((e,t,r,l)=>{let o=a9(t)?l.traverse(t).orThunk(()=>a3(t,l.gather,e)).map(l.relative):a5(e,t,r,l);return o.map(e=>({start:e,finish:e}))})(t,l.finish,l.foffset,r).fold(()=>S.some(oq(l.finish,l.foffset)),o=>{var n;let s=e.fromSitus(o);return n=a1.verify(e,l.finish,l.foffset,s.finish,s.foffset,r.failure,t),a1.cata(n,e=>S.none(),()=>S.none(),e=>S.some(oq(e,0)),e=>S.some(oq(e,lz(e))))})),im=(e,t,r,l,o,n)=>0===n?S.none():iu(e,t,r,l,o).bind(s=>{let a=e.fromSitus(s),i=a1.verify(e,r,l,a.finish,a.foffset,o.failure,t);return a1.cata(i,()=>S.none(),()=>S.some(s),s=>eD(r,s)&&0===l?ic(e,r,l,a7,o):im(e,t,s,0,o,n-1),s=>eD(r,s)&&l===lz(s)?ic(e,r,l,a2,o):im(e,t,s,lz(s),o,n-1))}),ic=(e,t,r,l,o)=>ie(e,t,r).bind(t=>id(e,o,l(t,ia.getJumpSize()))),id=(e,t,r)=>{let l=ri().browser;return l.isChromium()||l.isSafari()||l.isFirefox()?t.retry(e,r):S.none()},iu=(e,t,r,l,o)=>ie(e,r,l).bind(t=>id(e,o,t)),ig=(e,t,r,l,o)=>ti(l,"td,th",t).bind(l=>ti(l,"table",t).bind(n=>tl(o,e=>eN(e).exists(e=>eD(e,n)),void 0).isSome()?ii(e,t,r).bind(l=>im(e,t,l.element,l.offset,r,20).map(e.fromSitus)).bind(e=>ti(e.finish,"td,th",t).map(t=>({start:l,finish:t,range:e}))):S.none())),ih=(e,t,r,l,o,n)=>n(l,t).orThunk(()=>ig(e,t,r,l,o).map(e=>{let t=e.range;return aR(S.some(aM(t.start,t.soffset,t.finish,t.foffset)),!0)})),ip=(e,t)=>ti(e,"tr",t).bind(e=>ti(e,"table",t).bind(r=>{let l=tt(r,"tr");return eD(e,l[0])?aK(aJ,r,e=>lM(e).isSome(),t).map(e=>{let t=lz(e);return aR(S.some(aM(e,t,e,t)),!0)}):S.none()})),ib=(e,t)=>ti(e,"tr",t).bind(e=>ti(e,"table",t).bind(r=>{let l=tt(r,"tr");return eD(e,l[l.length-1])?aY(aJ,r,e=>lW(e).isSome(),t).map(e=>aR(S.some(aM(e,0,e,0)),!0)):S.none()})),iw=(e,t,r,l,o,n,s)=>ig(e,r,l,o,n).bind(e=>aP(t,r,e.start,e.finish,s)),iv=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},iy=()=>{let e=(e=>{let t=iv(S.none()),r=()=>t.get().each(e);return{clear:()=>{r(),t.set(S.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{r(),t.set(S.some(e))}}})(g);return{...e,on:t=>e.get().each(t)}},ix=(e,t)=>ti(e,"td,th",t),iC=e=>eB(e).exists(or),iS={traverse:eA,gather:aX,relative:aT.before,retry:ia.tryDown,failure:a1.failedDown},iT={traverse:ez,gather:aQ,relative:aT.before,retry:ia.tryUp,failure:a1.failedUp},iR=e=>t=>t===e,iD=iR(38),iO=iR(40),ik=e=>e>=37&&e<=40,iE={isBackward:iR(37),isForward:iR(39)},iN={isBackward:iR(39),isForward:iR(37)},iB=n$([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),i_={domRange:iB.domRange,relative:iB.relative,exact:iB.exact,exactFromRange:e=>iB.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{let t=e.match({domRange:e=>eC.fromDom(e.startContainer),relative:(e,t)=>aT.getStart(e),exact:(e,t,r,l)=>e});return eC.fromDom(eE(t).dom.defaultView)},range:aW},iz=document.caretPositionFromPoint?(e,t,r)=>{var l,o;return S.from(null===(o=(l=e.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(l,t,r)).bind(t=>{if(null===t.offsetNode)return S.none();let r=e.dom.createRange();return r.setStart(t.offsetNode,t.offset),r.collapse(),S.some(r)})}:document.caretRangeFromPoint?(e,t,r)=>{var l,o;return S.from(null===(o=(l=e.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(l,t,r))}:S.none,iA=(e,t)=>{let r=eo(e);return"input"===r?aT.after(e):O(["br","img"],r)?0===t?aT.before(e):aT.after(e):aT.on(e,t)},iL=e=>S.from(e.getSelection()),iW=(e,t)=>{iL(e).each(e=>{e.removeAllRanges(),e.addRange(t)})},iM=(e,t,r,l,o)=>{let n=aN(e,t,r,l,o);iW(e,n)},ij=(e,t)=>aA(e,t).match({ltr:(t,r,l,o)=>{iM(e,t,r,l,o)},rtl:(t,r,l,o)=>{iL(e).each(n=>{if(n.setBaseAndExtent)n.setBaseAndExtent(t.dom,r,l.dom,o);else if(n.extend)try{n.collapse(t.dom,r),n.extend(l.dom,o)}catch(n){iM(e,l,o,t,r)}else iM(e,l,o,t,r)})}}),iP=(e,t,r,l,o)=>{let n=((e,t,r,l)=>{let o=iA(e,t),n=iA(r,l);return i_.relative(o,n)})(t,r,l,o);ij(e,n)},iI=(e,t,r)=>{let l=((e,t)=>{let r=e.fold(aT.before,iA,aT.after),l=t.fold(aT.before,iA,aT.after);return i_.relative(r,l)})(t,r);ij(e,l)},iF=e=>{if(e.rangeCount>0){let t=e.getRangeAt(0),r=e.getRangeAt(e.rangeCount-1);return S.some(aW(eC.fromDom(t.startContainer),t.startOffset,eC.fromDom(r.endContainer),r.endOffset))}return S.none()},iH=e=>{if(null===e.anchorNode||null===e.focusNode)return iF(e);{let t=eC.fromDom(e.anchorNode),r=eC.fromDom(e.focusNode);return((e,t,r,l)=>{let o=((e,t,r,l)=>{let o=ek(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(r.dom,l),o})(e,t,r,l),n=eD(e,r)&&t===l;return o.collapsed&&!n})(t,e.anchorOffset,r,e.focusOffset)?S.some(aW(t,e.anchorOffset,r,e.focusOffset)):iF(e)}},i$=(e,t,r=!0)=>{let l=(r?aO:aD)(e,t);iW(e,l)},iV=e=>iL(e).filter(e=>e.rangeCount>0).bind(iH).map(e=>i_.exact(e.start,e.soffset,e.finish,e.foffset)),iq=e=>({elementFromPoint:(t,r)=>eC.fromPoint(eC.fromDom(e.document),t,r),getRect:e=>e.dom.getBoundingClientRect(),getRangedRect:(t,r,l,o)=>{let n=i_.exact(t,r,l,o);return(e=>{let t=e.getClientRects(),r=t.length>0?t[0]:e.getBoundingClientRect();return r.width>0||r.height>0?S.some(r).map(aB):S.none()})(aL(e,n))},getSelection:()=>iV(e).map(t=>aj(e,t)),fromSitus:t=>{let r=i_.relative(t.start,t.finish);return aj(e,r)},situsFromPoint:(t,r)=>((e,t,r)=>{let l=eC.fromDom(e.document);return iz(l,t,r).map(e=>aW(eC.fromDom(e.startContainer),e.startOffset,eC.fromDom(e.endContainer),e.endOffset))})(e,t,r).map(e=>aM(e.start,e.soffset,e.finish,e.foffset)),clearSelection:()=>{(e=>{iL(e).each(e=>e.removeAllRanges())})(e)},collapseSelection:(t=!1)=>{iV(e).each(r=>r.fold(e=>e.collapse(t),(r,l)=>{let o=t?r:l;iI(e,o,o)},(r,l,o,n)=>{let s=t?r:o,a=t?l:n;iP(e,s,a,s,a)}))},setSelection:t=>{iP(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:(t,r)=>{iI(e,t,r)},selectNode:t=>{i$(e,t,!1)},selectContents:t=>{i$(e,t)},getInnerHeight:()=>e.innerHeight,getScrollY:()=>(e=>{let t=void 0!==e?e.dom:document,r=t.body.scrollLeft||t.documentElement.scrollLeft,l=t.body.scrollTop||t.documentElement.scrollTop;return rq(r,l)})(eC.fromDom(e.document)).top,scrollBy:(t,r)=>{((e,t,r)=>{let l=(void 0!==r?r.dom:document).defaultView;l&&l.scrollBy(e,t)})(t,r,eC.fromDom(e.document))}}),iU=(e,t)=>({rows:e,cols:t}),iG=e=>to(e,ei).exists(or),iK=(e,t)=>iG(e)||iG(t),iY=e=>void 0!==e.dom.classList,iJ=(e,t)=>((e,t,r)=>{let l=((e,t)=>{let r=eb(e,t);return void 0===r||""===r?[]:r.split(" ")})(e,t).concat([r]);return eh(e,t,l.join(" ")),!0})(e,"class",t),iQ=(e,t)=>{iY(e)?e.dom.classList.add(t):iJ(e,t)},iX=(e,t)=>iY(e)&&e.dom.classList.contains(t),iZ=()=>({tag:"none"}),i0=e=>({tag:"multiple",elements:e}),i1=e=>({tag:"single",element:e}),i9=e=>{let t=eC.fromDom((e=>{if(e3()&&d(e.target)){let t=eC.fromDom(e.target);if(em(t)&&d(t.dom.shadowRoot)&&e.composed&&e.composedPath){let t=e.composedPath();if(t)return $(t)}}return S.from(e.target)})(e).getOr(e.target)),r=()=>e.stopPropagation(),l=()=>e.preventDefault();return{target:t,x:e.clientX,y:e.clientY,stop:r,prevent:l,kill:(...e)=>l(r.apply(null,e)),raw:e}},i3=(e,t,r,l)=>{e.dom.removeEventListener(t,r,l)},i5=(e,t,r)=>((e,t,r,l,o)=>{let n=e=>{r(e)&&l(i9(e))};return e.dom.addEventListener(t,n,o),{unbind:w(i3,e,t,n,o)}})(e,t,C,r,!1),i2=e=>!iX(eC.fromDom(e.target),"ephox-snooker-resizer-bar"),i7=(e,t)=>{var r;let l=(r=oj.selectedSelector,{get:()=>oN(eC.fromDom(e.getBody()),r).fold(()=>oH(oa(e),on(e)).fold(iZ,i1),i0)}),o=((e,t,r)=>{let l=t=>{ev(t,e.selected),ev(t,e.firstSelected),ev(t,e.lastSelected)},o=t=>{eh(t,e.selected,"1")},n=e=>{s(e),r()},s=t=>{let r=tt(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`);B(r,l)};return{clearBeforeUpdate:s,clear:n,selectRange:(r,l,s,a)=>{n(r),B(l,o),eh(s,e.firstSelected,"1"),eh(a,e.lastSelected,"1"),t(l,s,a)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}})(oj,(t,r,l)=>{tj(r).each(o=>{let n=lQ(e),s=lU(g,eC.fromDom(e.getDoc()),n),a=((e,t,r)=>{let l=rN(e);return nb(l,t).map(e=>{let t=nd(l,r,!1),{rows:o}=rC(t),n=((e,t)=>{let r=e.slice(0,t[t.length-1].row+1),l=nu(r);return P(l,e=>{let r=e.cells.slice(0,t[t.length-1].column+1);return N(r,e=>e.element)})})(o,e),s=((e,t)=>{let r=e.slice(t[0].row+t[0].rowspan-1,e.length),l=nu(r);return P(l,e=>{let r=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return N(r,e=>e.element)})})(o,e);return{upOrLeftCells:n,downOrRightCells:s}})})(o,{selection:o$(e)},s);((e,t,r,l,o)=>{e.dispatch("TableSelectionChange",{cells:t,start:r,finish:l,otherCells:o})})(e,t,r,l,a)})},()=>(e=>{e.dispatch("TableSelectionClear")})(e));return e.on("init",r=>{let l=e.getWin(),n=oo(e),s=on(e),a=((e,t,r,l)=>{let o=((e,t,r,l)=>{let o=iy(),n=o.clear,s=n=>{o.on(o=>{l.clearBeforeUpdate(t),ix(n.target,r).each(s=>{oD(o,s,r).each(r=>{let o=r.boxes.getOr([]);if(1===o.length){let r=o[0],s="false"===ol(r),a=tm(ot(n.target),r,eD);s&&a&&(l.selectRange(t,o,r,r),e.selectContents(r))}else o.length>1&&(l.selectRange(t,o,r.start,r.finish),e.selectContents(s))})})})};return{clearstate:n,mousedown:e=>{l.clear(t),ix(e.target,r).filter(iC).each(o.set)},mouseover:e=>{s(e)},mouseup:e=>{s(e),n()}}})(iq(e),t,r,l);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}})(l,n,s,o),i=((e,t,r,l)=>{let o=iq(e),n=()=>(l.clear(t),S.none());return{keydown:(e,s,a,i,m,c)=>{let d=e.raw,u=d.which,f=!0===d.shiftKey,g=oO(t,l.selectedSelector).fold(()=>(ik(u)&&!f&&l.clearBeforeUpdate(t),ik(u)&&f&&!iK(s,i)?S.none:iO(u)&&f?w(iw,o,t,r,iS,i,s,l.selectRange):iD(u)&&f?w(iw,o,t,r,iT,i,s,l.selectRange):iO(u)?w(ih,o,r,iS,i,s,ib):iD(u)?w(ih,o,r,iT,i,s,ip):S.none),e=>{let r=r=>()=>{let n=q(r,r=>oE(e,r.rows,r.cols,l.firstSelectedSelector,l.lastSelectedSelector).map(e=>(l.clearBeforeUpdate(t),l.selectRange(t,e.boxes,e.start,e.finish),e.boxes)));return n.fold(()=>ok(t,l.firstSelectedSelector,l.lastSelectedSelector).map(e=>{let r=iO(u)||c.isForward(u)?aT.after:aT.before;return o.setRelativeSelection(aT.on(e.first,0),r(e.table)),l.clear(t),aR(S.none(),!0)}),e=>S.some(aR(S.none(),!0)))};return ik(u)&&f&&!iK(s,i)?S.none:iO(u)&&f?r([iU(1,0)]):iD(u)&&f?r([iU(-1,0)]):c.isBackward(u)&&f?r([iU(0,-1),iU(-1,0)]):c.isForward(u)&&f?r([iU(0,1),iU(1,0)]):ik(u)&&!f?n:S.none});return g()},keyup:(e,o,n,s,a)=>oO(t,l.selectedSelector).fold(()=>{var i;let m=e.raw,c=m.which;return!0===m.shiftKey&&ik(c)&&iK(o,s)?(i=l.selectRange,eD(o,s)&&n===a?S.none():ti(o,"td,th",r).bind(e=>ti(s,"td,th",r).bind(l=>aP(t,r,e,l,i)))):S.none()},S.none)}})(l,n,s,o),m=((e,t,r,l)=>{let o=iq(e);return(e,n)=>{l.clearBeforeUpdate(t),oD(e,n,r).each(e=>{let r=e.boxes.getOr([]);l.selectRange(t,r,e.start,e.finish),o.selectContents(n),o.collapseSelection()})}})(l,n,s,o);e.on("TableSelectorChange",e=>m(e.start,e.finish));let c=(t,r)=>{!0===t.raw.shiftKey&&(r.kill&&t.kill(),r.selection.each(t=>{let r=i_.relative(t.start,t.finish),o=aL(l,r);e.selection.setRng(o)}))},d=e=>0===e.button,u=(()=>{let e=iv(eC.fromDom(n)),t=iv(0);return{touchEnd:r=>{let l=eC.fromDom(r.target);if(ef("td")(l)||ef("th")(l)){let o=e.get(),n=t.get();eD(o,l)&&r.timeStamp-n<300&&(r.preventDefault(),m(l,l))}e.set(l),t.set(r.timeStamp)}}})();e.on("dragstart",e=>{a.clearstate()}),e.on("mousedown",e=>{d(e)&&i2(e)&&a.mousedown(i9(e))}),e.on("mouseover",e=>{(void 0===e.buttons||0!=(1&e.buttons))&&i2(e)&&a.mouseover(i9(e))}),e.on("mouseup",e=>{d(e)&&i2(e)&&a.mouseup(i9(e))}),e.on("touchend",u.touchEnd),e.on("keyup",t=>{let r=i9(t);if(r.raw.shiftKey&&ik(r.raw.which)){let t=e.selection.getRng(),l=eC.fromDom(t.startContainer),o=eC.fromDom(t.endContainer);i.keyup(r,l,t.startOffset,o,t.endOffset).each(e=>{c(r,e)})}}),e.on("keydown",r=>{let l=i9(r);t.hide();let o=e.selection.getRng(),n=eC.fromDom(o.startContainer),s=eC.fromDom(o.endContainer),a=rI(iE,iN)(eC.fromDom(e.selection.getStart()));i.keydown(l,n,o.startOffset,s,o.endOffset,a).each(e=>{c(l,e)}),t.show()}),e.on("NodeChange",()=>{let t=e.selection,r=eC.fromDom(t.getStart()),l=eC.fromDom(t.getEnd());oT(tj,[r,l]).fold(()=>o.clear(n),g)})}),e.on("PreInit",()=>{e.serializer.addTempAttr(oj.firstSelected),e.serializer.addTempAttr(oj.lastSelected)}),{getSelectedCells:()=>((e,t,r,l)=>{switch(e.tag){case"none":return t();case"single":return[e.element.dom];case"multiple":return N(e.elements,e=>e.dom)}})(l.get(),h([])),clearSelectedCells:e=>o.clear(eC.fromDom(e))}},i4=e=>{let t=[];return{bind:e=>{if(void 0===e)throw Error("Event bind error: undefined handler");t.push(e)},unbind:e=>{t=z(t,t=>t!==e)},trigger:(...r)=>{let l={};B(e,(e,t)=>{l[e]=r[t]}),B(t,e=>{e(l)})}}},i6=e=>({registry:Y(e,e=>({bind:e.bind,unbind:e.unbind})),trigger:Y(e,e=>e.trigger)}),i8=e=>e.slice(0).sort(),me=(e,t)=>{let r=z(t,t=>!O(e,t));r.length>0&&(e=>{throw Error("Unsupported keys for object: "+i8(e).join(", "))})(r)},mt=e=>((e,t,r)=>{if(0===t.length)throw Error("You must specify at least one required field.");return((e,t)=>{if(!a(t))throw Error("The "+e+" fields must be an array. Was: "+t+".");B(t,t=>{if(!n(t))throw Error("The value "+t+" in the "+e+" fields was not a string.")})})("required",t),(e=>{let t=i8(e);W(t,(e,r)=>r<t.length-1&&e===t[r+1]).each(e=>{throw Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})})(t),l=>{let o=U(l);I(t,e=>O(o,e))||((e,t)=>{throw Error("All required keys ("+i8(e).join(", ")+") were not specified. Specified keys were: "+i8(t).join(", ")+".")})(t,o),e(t,o);let n=z(t,e=>!r.validate(l[e],e));return n.length>0&&((e,t)=>{throw Error("All values need to be of type: "+t+". Keys ("+i8(e).join(", ")+") were not.")})(n,r.label),l}})(me,e,{validate:u,label:"function"}),mr=mt(["compare","extract","mutate","sink"]),ml=mt(["element","start","stop","destroy"]),mo=mt(["forceDrop","drop","move","delayDrop"]),mn=()=>{let e=(()=>{let e=i6({move:i4(["info"])});return{onEvent:g,reset:g,events:e.registry}})(),t=(()=>{let e=S.none(),t=i6({move:i4(["info"])});return{onEvent:(r,l)=>{l.extract(r).each(r=>{let o=((t,r)=>{let l=e.map(e=>t.compare(e,r));return e=S.some(r),l})(l,r);o.each(e=>{t.trigger.move(e)})})},reset:()=>{e=S.none()},events:t.registry}})(),r=e;return{on:()=>{r.reset(),r=t},off:()=>{r.reset(),r=e},isOn:()=>r===t,onEvent:(e,t)=>{r.onEvent(e,t)},events:t.events}},ms=e=>{let t=e.replace(/\./g,"-");return{resolve:e=>t+"-"+e}},ma=ms("ephox-dragster").resolve;var mi=mr({compare:(e,t)=>rq(t.left-e.left,t.top-e.top),extract:e=>S.some(rq(e.x,e.y)),sink:(e,t)=>{let r=(e=>{let t={layerClass:ma("blocker"),...e},r=eC.fromTag("div");return eh(r,"role","presentation"),tx(r,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),iQ(r,ma("blocker")),iQ(r,t.layerClass),{element:h(r),destroy:()=>{eq(r)}}})(t),l=i5(r.element(),"mousedown",e.forceDrop),o=i5(r.element(),"mouseup",e.drop),n=i5(r.element(),"mousemove",e.move),s=i5(r.element(),"mouseout",e.delayDrop);return ml({element:r.element,start:e=>{eI(e,r.element())},stop:()=>{eq(r.element())},destroy:()=>{r.destroy(),o.unbind(),n.unbind(),s.unbind(),l.unbind()}})},mutate:(e,t)=>{e.mutate(t.left,t.top)}});let mm=ms("ephox-snooker").resolve,mc=mm("resizer-bar"),md=mm("resizer-rows"),mu=mm("resizer-cols"),mf=e=>{let t=tt(e.parent(),"."+mc);B(t,eq)},mg=(e,t,r)=>{let l=e.origin();B(t,t=>{t.each(t=>{let o=r(l,t);iQ(o,mc),eI(e.parent(),o)})})},mh=(e,t,r,l,o)=>{var n,s,a,i;let m=rG(r),c=t.isResizable,d=l.length>0?r2.positions(l,r):[],u=d.length>0?P(e.all,(e,t)=>c(e.element)?[t]:[]):[];n=z(d,(e,t)=>k(u,e=>t===e)),s=rf(r),mg(t,n,(e,t)=>{let r=((e,t,r,l,o)=>{let n=eC.fromTag("div");return tx(n,{position:"absolute",left:t+"px",top:r-3.5+"px",height:"7px",width:l+"px"}),ep(n,{"data-row":e,role:"presentation"}),n})(t.row,m.left-e.left,t.y-e.top,s);return iQ(r,md),r});let f=o.length>0?r4.positions(o,r):[],g=f.length>0?((e,t)=>{let r=[];return E(e.grid.columns,l=>{rW(e,l).map(e=>e.element).forall(t)&&r.push(l)}),z(r,r=>{let l=rk(e,e=>e.column===r);return I(l,e=>t(e.element))})})(e,c):[];a=z(f,(e,t)=>k(g,e=>t===e)),i=rV(r),mg(t,a,(e,t)=>{let r=((e,t,r,l,o)=>{let n=eC.fromTag("div");return tx(n,{position:"absolute",left:t-3.5+"px",top:r+"px",height:o+"px",width:"7px"}),ep(n,{"data-column":e,role:"presentation"}),n})(t.col,t.x-e.left,m.top-e.top,0,i);return iQ(r,mu),r})},mp=(e,t)=>{if(mf(e),e.isResizable(t)){let r=rN(t),l=rP(r),o=rM(r);mh(r,e,t,l,o)}},mb=(e,t)=>{let r=tt(e.parent(),"."+mc);B(r,t)},mw=e=>{mb(e,e=>{ty(e,"display","none")})},mv=e=>{mb(e,e=>{ty(e,"display","block")})},my=mm("resizer-bar-dragging"),mx=e=>{let t=(()=>{let e=i6({drag:i4(["xDelta","yDelta","target"])}),t=S.none(),r=(()=>{let e=i6({drag:i4(["xDelta","yDelta"])});return{mutate:(t,r)=>{e.trigger.drag(t,r)},events:e.registry}})();return r.events.drag.bind(r=>{t.each(t=>{e.trigger.drag(r.xDelta,r.yDelta,t)})}),{assign:e=>{t=S.some(e)},get:()=>t,mutate:r.mutate,events:e.registry}})(),r=((e,t={})=>{var r;return((e,t,r)=>{let l=!1,o=i6({start:i4([]),stop:i4([])}),n=mn(),s=()=>{c.stop(),n.isOn()&&(n.off(),o.trigger.stop())},a=((e,t)=>{let r=null,l=()=>{i(r)||(clearTimeout(r),r=null)};return{cancel:l,throttle:(...t)=>{l(),r=setTimeout(()=>{r=null,e.apply(null,t)},200)}}})(s);n.events.move.bind(r=>{t.mutate(e,r.info)});let m=e=>(...t)=>{l&&e.apply(null,t)},c=t.sink(mo({forceDrop:s,drop:m(s),move:m(e=>{a.cancel(),n.onEvent(e,t)}),delayDrop:m(a.throttle)}),r);return{element:c.element,go:e=>{c.start(e),n.on(),o.trigger.start()},on:()=>{l=!0},off:()=>{l=!1},isActive:()=>l,destroy:()=>{c.destroy()},events:o.registry}})(e,null!==(r=t.mode)&&void 0!==r?r:mi,t)})(t,{}),l=S.none(),o=(e,t)=>S.from(eb(e,t));t.events.drag.bind(e=>{o(e.target,"data-row").each(t=>{let r=tN(e.target,"top");ty(e.target,"top",r+e.yDelta+"px")}),o(e.target,"data-column").each(t=>{let r=tN(e.target,"left");ty(e.target,"left",r+e.xDelta+"px")})});let n=(e,t)=>tN(e,t)-tD(e,"data-initial-"+t,0);r.events.stop.bind(()=>{t.get().each(t=>{l.each(r=>{o(t,"data-row").each(e=>{let l=n(t,"top");ev(t,"data-initial-top"),d.trigger.adjustHeight(r,l,parseInt(e,10))}),o(t,"data-column").each(e=>{let l=n(t,"left");ev(t,"data-initial-left"),d.trigger.adjustWidth(r,l,parseInt(e,10))}),mp(e,r)})})});let s=(l,o)=>{d.trigger.startAdjust(),t.assign(l),eh(l,"data-initial-"+o,tN(l,o)),iQ(l,my),ty(l,"opacity","0.2"),r.go(e.parent())},a=i5(e.parent(),"mousedown",e=>{iX(e.target,md)&&s(e.target,"top"),iX(e.target,mu)&&s(e.target,"left")}),m=t=>eD(t,e.view()),c=i5(e.view(),"mouseover",t=>{ti(t.target,"table",m).filter(or).fold(()=>{e7(t.target)&&mf(e)},t=>{r.isActive()&&(l=S.some(t),mp(e,t))})}),d=i6({adjustHeight:i4(["table","delta","row"]),adjustWidth:i4(["table","delta","column"]),startAdjust:i4([])});return{destroy:()=>{a.unbind(),c.unbind(),r.destroy(),mf(e)},refresh:t=>{mp(e,t)},on:r.on,off:r.off,hideBars:w(mw,e),showBars:w(mv,e),events:d.registry}},mC=(e,t,r)=>{let l=mx(e),o=i6({beforeResize:i4(["table","type"]),afterResize:i4(["table","type"]),startDrag:i4([])});return l.events.adjustHeight.bind(e=>{let t=e.table;o.trigger.beforeResize(t,"row"),((e,t,r,l)=>{let o=rN(e),n=lS(o,e,l,lu,e=>e.getOrThunk(t_)),s=N(n,(e,l)=>r===l?Math.max(t+e,t_()):e),a=nU(o,s),i=N(o.all,(e,t)=>({element:e.element,height:s[t]}));B(i,e=>{ls(e.element,e.height)}),B(a,e=>{ls(e.element,e.height)});let m=A(s,(e,t)=>e+t,0);ls(e,m)})(t,r2.delta(e.delta,t),e.row,r2),o.trigger.afterResize(t,"row")}),l.events.startAdjust.bind(e=>{o.trigger.startDrag()}),l.events.adjustWidth.bind(e=>{let l=e.table;o.trigger.beforeResize(l,"col");let n=r4.delta(e.delta,l),s=r(l);nK(l,n,e.column,t,s),o.trigger.afterResize(l,"col")}),{on:l.on,off:l.off,refreshBars:l.refresh,hideBars:l.hideBars,showBars:l.showBars,destroy:l.destroy,events:o.registry}},mS=e=>d(e)&&"TABLE"===e.nodeName,mT="bar-",mR=e=>"false"!==eb(e,"data-mce-resize"),mD=e=>{let t,r;let l=iy(),o=iy(),n=iy(),s=t=>sG(e,t),a=()=>l0(e)?o3():o9();return e.on("init",()=>{var t;let r=e.inline?(t=eC.fromDom(e.getBody()),{parent:h((()=>{let e=eC.fromTag("div");return tx(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),eI(e4(eC.fromDom(document)),e),e})()),view:h(t),origin:h(rq(0,0)),isResizable:mR}):((e,t)=>{let r=ed(e)?eC.fromDom(eE(e).dom.documentElement):e;return{parent:h(r),view:h(e),origin:h(rq(0,0)),isResizable:t}})(eC.fromDom(e.getDoc()),mR);if(n.set(r),(e=>{let t=e.options.get("object_resizing");return O(t.split(","),"table")})(e)&&l7(e)){let t=a(),n=mC(r,t,s);n.on(),n.events.startDrag.bind(t=>{l.set(e.selection.getRng())}),n.events.beforeResize.bind(t=>{let r=t.table.dom;((e,t,r,l,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:r,height:l,origin:o})})(e,r,oi(r),om(r),mT+t.type)}),n.events.afterResize.bind(t=>{let r=t.table,o=r.dom;os(r),l.on(t=>{e.selection.setRng(t),e.focus()}),((e,t,r,l,o)=>{e.dispatch("ObjectResized",{target:t,width:r,height:l,origin:o})})(e,o,oi(o),om(o),mT+t.type),e.undoManager.add()}),o.set(n)}}),e.on("ObjectResizeStart",l=>{let o=l.target;if(mS(o)){let n=eC.fromDom(o);B(e.dom.select(".mce-clonedresizable"),t=>{e.dom.addClass(t,"mce-"+lZ(e)+"-columns")}),!s6(n)&&l5(e)?ar(n):!s4(n)&&l3(e)&&at(n),s8(n)&&tg(l.origin,mT)&&at(n),t=l.width,r=l2(e)?"":((e,t)=>{let r=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return S.from(r).filter(tb)})(e,o).getOr("")}}),e.on("ObjectResized",l=>{let o=l.target;if(mS(o)){let n=eC.fromDom(o),i=l.origin;tg(i,"corner-")&&((l,o,n)=>{var i,m;let c=th(o,"e");if(""===r&&at(l),n!==t&&""!==r){ty(l,"width",r);let o=a(),i=s(l),m=l0(e)||c?o5(l).columns-1:0;nK(l,n-t,m,o,i)}else if(i=r,/^(\d+(\.\d+)?)%$/.test(i)){let e=parseFloat(r.replace("%",""));ty(l,"width",n*e/t+"%")}m=r,/^(\d+(\.\d+)?)px$/.test(m)&&(e=>{let t=rN(e);rL(t)||B(tW(e),e=>{let t=tC(e,"width");ty(e,"width",t),ev(e,"width")})})(l)})(n,i,l.width),os(n),s$(e,n.dom,sV)}}),e.on("SwitchMode",()=>{o.on(t=>{e.mode.isReadOnly()?t.hideBars():t.showBars()})}),e.on("dragstart dragend",e=>{o.on(t=>{"dragstart"===e.type?(t.hideBars(),t.off()):(t.on(),t.showBars())})}),e.on("remove",()=>{o.on(e=>{e.destroy()}),n.on(t=>{e.inline&&eq(t.parent())})}),{refresh:e=>{o.on(t=>t.refreshBars(eC.fromDom(e)))},hide:()=>{o.on(e=>e.hideBars())},show:()=>{o.on(e=>e.showBars())}}},mO=e=>{(e=>{let t=e.options.register;t("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{let t=O(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{let t=O(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0}),t("table_merge_content_on_paste",{processor:"boolean",default:!0})})(e);let t=mD(e),r=i7(e,t),l=sK(e,t,r);return aC(e,l),((e,t)=>{let r=on(e),l=t=>oH(oa(e)).bind(l=>tj(l,r).map(r=>{let o=oP(o$(e),r,l);return t(r,o)})).getOr("");K({mceTableRowType:()=>l(t.getTableRowType),mceTableCellType:()=>l(t.getTableCellType),mceTableColType:()=>l(t.getTableColType)},(t,r)=>e.addQueryValueHandler(r,t))})(e,l),oV(e,l),{getSelectedCells:r.getSelectedCells,clearSelectedCells:r.clearSelectedCells}};t.add("dom",e=>({table:mO(e)}))}();