!function(){"use strict";let t,r,n,o;var a,l,i,s,d,c,u,m,f,g,p=function(t){if(null===t)return"null";if(void 0===t)return"undefined";var r=typeof t;return"object"===r&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":r},h=function(t){return{eq:t}},b=h(function(t,r){return t===r}),v=function(t){return h(function(r,n){if(r.length!==n.length)return!1;for(var o=r.length,a=0;a<o;a++)if(!t.eq(r[a],n[a]))return!1;return!0})},y=function(t){return h(function(r,n){var o,a,l=Object.keys(r),i=Object.keys(n);if(!(o=v(b),a=function(t){return Array.prototype.slice.call(t).sort(void 0)},h(function(t,r){return o.eq(a(t),a(r))})).eq(l,i))return!1;for(var s=l.length,d=0;d<s;d++){var c=l[d];if(!t.eq(r[c],n[c]))return!1}return!0})},C=h(function(t,r){if(t===r)return!0;var n=p(t);return n===p(r)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(n)?t===r:"array"===n?v(C).eq(t,r):"object"===n&&y(C).eq(t,r))});let x=Object.getPrototypeOf,w=(t,r,n)=>{var o;return!!n(t,r.prototype)||(null===(o=t.constructor)||void 0===o?void 0:o.name)===r.name},E=t=>r=>(t=>{let r=typeof t;return null===t?"null":"object"===r&&Array.isArray(t)?"array":"object"===r&&w(t,String,(t,r)=>r.isPrototypeOf(t))?"string":r})(r)===t,k=t=>r=>typeof r===t,S=t=>r=>t===r,_=(t,r)=>R(t)&&w(t,r,(t,r)=>x(t)===r),N=E("string"),R=E("object"),A=t=>_(t,Object),O=E("array"),T=S(null),B=k("boolean"),D=S(void 0),P=t=>null==t,L=t=>!P(t),M=k("function"),F=k("number"),I=(t,r)=>{if(O(t)){for(let n=0,o=t.length;n<o;++n)if(!r(t[n]))return!1;return!0}return!1},U=()=>{},z=(t,r)=>(...n)=>t(r.apply(null,n)),j=(t,r)=>n=>t(r(n)),H=t=>()=>t,$=t=>t,V=(t,r)=>t===r;function q(t,...r){return(...n)=>{let o=r.concat(n);return t.apply(null,o)}}let W=t=>r=>!t(r),K=t=>()=>{throw Error(t)},G=t=>t(),Y=t=>{t()},X=H(!1),Q=H(!0);class J{constructor(t,r){this.tag=t,this.value=r}static some(t){return new J(!0,t)}static none(){return J.singletonNone}fold(t,r){return this.tag?r(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?J.some(t(this.value)):J.none()}bind(t){return this.tag?t(this.value):J.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:J.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw Error(null!=t?t:"Called getOrDie on None")}static from(t){return L(t)?J.some(t):J.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}J.singletonNone=new J(!1);let Z=Array.prototype.slice,ee=Array.prototype.indexOf,et=Array.prototype.push,er=(t,r)=>ee.call(t,r),en=(t,r)=>er(t,r)>-1,eo=(t,r)=>{for(let n=0,o=t.length;n<o;n++)if(r(t[n],n))return!0;return!1},ea=(t,r)=>{let n=t.length,o=Array(n);for(let a=0;a<n;a++){let n=t[a];o[a]=r(n,a)}return o},el=(t,r)=>{for(let n=0,o=t.length;n<o;n++)r(t[n],n)},ei=(t,r)=>{for(let n=t.length-1;n>=0;n--)r(t[n],n)},es=(t,r)=>{let n=[],o=[];for(let a=0,l=t.length;a<l;a++){let l=t[a];(r(l,a)?n:o).push(l)}return{pass:n,fail:o}},ed=(t,r)=>{let n=[];for(let o=0,a=t.length;o<a;o++){let a=t[o];r(a,o)&&n.push(a)}return n},ec=(t,r,n)=>(ei(t,(t,o)=>{n=r(n,t,o)}),n),eu=(t,r,n)=>(el(t,(t,o)=>{n=r(n,t,o)}),n),em=(t,r,n)=>{for(let o=0,a=t.length;o<a;o++){let a=t[o];if(r(a,o))return J.some(a);if(n(a,o))break}return J.none()},ef=(t,r)=>em(t,r,X),eg=(t,r)=>{for(let n=0,o=t.length;n<o;n++)if(r(t[n],n))return J.some(n);return J.none()},ep=t=>{let r=[];for(let n=0,o=t.length;n<o;++n){if(!O(t[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+t);et.apply(r,t[n])}return r},eh=(t,r)=>ep(ea(t,r)),eb=(t,r)=>{for(let n=0,o=t.length;n<o;++n)if(!0!==r(t[n],n))return!1;return!0},ev=t=>{let r=Z.call(t,0);return r.reverse(),r},ey=(t,r)=>ed(t,t=>!en(r,t)),eC=(t,r)=>{let n={};for(let o=0,a=t.length;o<a;o++){let a=t[o];n[String(a)]=r(a,o)}return n},ex=(t,r)=>{let n=Z.call(t,0);return n.sort(r),n},ew=(t,r)=>r>=0&&r<t.length?J.some(t[r]):J.none(),eE=t=>ew(t,0),ek=t=>ew(t,t.length-1),eS=M(Array.from)?Array.from:t=>Z.call(t),e_=(t,r)=>{for(let n=0;n<t.length;n++){let o=r(t[n],n);if(o.isSome())return o}return J.none()},eN=Object.keys,eR=Object.hasOwnProperty,eA=(t,r)=>{let n=eN(t);for(let o=0,a=n.length;o<a;o++){let a=n[o];r(t[a],a)}},eO=(t,r)=>eT(t,(t,n)=>({k:n,v:r(t,n)})),eT=(t,r)=>{let n={};return eA(t,(t,o)=>{let a=r(t,o);n[a.k]=a.v}),n},eB=t=>(r,n)=>{t[n]=r},eD=(t,r,n,o)=>{eA(t,(t,a)=>{(r(t,a)?n:o)(t,a)})},eP=(t,r)=>{let n={};return eD(t,r,eB(n),U),n},eL=(t,r)=>{let n=[];return eA(t,(t,o)=>{n.push(r(t,o))}),n},eM=t=>eL(t,$),eF=(t,r)=>eI(t,r)?J.from(t[r]):J.none(),eI=(t,r)=>eR.call(t,r),eU=(t,r)=>eI(t,r)&&void 0!==t[r]&&null!==t[r],ez=t=>{let r={};return el(t,t=>{r[t]={}}),eN(r)},ej=t=>void 0!==t.length,eH=Array.isArray,e$=(t,r,n)=>{if(!t)return!1;if(n=n||t,ej(t)){for(let o=0,a=t.length;o<a;o++)if(!1===r.call(n,t[o],o,t))return!1}else for(let o in t)if(eI(t,o)&&!1===r.call(n,t[o],o,t))return!1;return!0},eV=(t,r)=>{let n=[];return e$(t,(o,a)=>{n.push(r(o,a,t))}),n},eq=(t,r)=>{let n=[];return e$(t,(o,a)=>{r&&!r(o,a,t)||n.push(o)}),n},eW=(t,r,n,o)=>{let a=D(n)?t[0]:n;for(let n=0;n<t.length;n++)a=r.call(o,a,t[n],n);return a},eK=(t,r,n)=>{for(let o=0,a=t.length;o<a;o++)if(r.call(n,t[o],o,t))return o;return -1},eG=t=>t[t.length-1],eY=t=>{let r,n=!1;return(...o)=>(n||(n=!0,r=t.apply(null,o)),r)},eX=()=>eQ(0,0),eQ=(t,r)=>({major:t,minor:r}),eJ={nu:eQ,detect:(t,r)=>{let n=String(r).toLowerCase();return 0===t.length?eX():((t,r)=>{let n=((t,r)=>{for(let n=0;n<t.length;n++){let o=t[n];if(o.test(r))return o}})(t,r);if(!n)return{major:0,minor:0};let o=t=>Number(r.replace(n,"$"+t));return eQ(o(1),o(2))})(t,n)},unknown:eX},eZ=(t,r)=>{let n=String(r).toLowerCase();return ef(t,t=>t.search(n))},e0=(t,r,n)=>""===r||t.length>=r.length&&t.substr(n,n+r.length)===r,e1=(t,r)=>{var n;return e3(t,r)?(n=r.length,t.substring(n)):t},e2=(t,r,n=0,o)=>{let a=t.indexOf(r,n);return -1!==a&&(!!D(o)||a+r.length<=o)},e3=(t,r)=>e0(t,r,0),e8=(t,r)=>e0(t,r,t.length-r.length),e5=t=>r=>r.replace(t,""),e6=e5(/^\s+|\s+$/g),e9=e5(/^\s+/g),e4=e5(/\s+$/g),e7=t=>t.length>0,te=t=>!e7(t),tt=(t,r=10)=>{let n=parseInt(t,r);return isNaN(n)?J.none():J.some(n)},tr=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,tn=t=>r=>e2(r,t),to=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:t=>e2(t,"edge/")&&e2(t,"chrome")&&e2(t,"safari")&&e2(t,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,tr],search:t=>e2(t,"chrome")&&!e2(t,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:t=>e2(t,"msie")||e2(t,"trident")},{name:"Opera",versionRegexes:[tr,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:tn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:tn("firefox")},{name:"Safari",versionRegexes:[tr,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:t=>(e2(t,"safari")||e2(t,"mobile/"))&&e2(t,"applewebkit")}],ta=[{name:"Windows",search:tn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:t=>e2(t,"iphone")||e2(t,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:tn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:tn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:tn("linux"),versionRegexes:[]},{name:"Solaris",search:tn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:tn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:tn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],tl={browsers:H(to),oses:H(ta)},ti="Edge",ts="Chromium",td="Opera",tc="Firefox",tu="Safari",tm=t=>{let r=t.current,n=t.version,o=t=>()=>r===t;return{current:r,version:n,isEdge:o(ti),isChromium:o(ts),isIE:o("IE"),isOpera:o(td),isFirefox:o(tc),isSafari:o(tu)}},tf=()=>tm({current:void 0,version:eJ.unknown()}),tg=(H(ti),H(ts),H("IE"),H(td),H(tc),H(tu),"Windows"),tp="Android",th="Linux",tb="macOS",tv="Solaris",ty="FreeBSD",tC="ChromeOS",tx=t=>{let r=t.current,n=t.version,o=t=>()=>r===t;return{current:r,version:n,isWindows:o(tg),isiOS:o("iOS"),isAndroid:o(tp),isMacOS:o(tb),isLinux:o(th),isSolaris:o(tv),isFreeBSD:o(ty),isChromeOS:o(tC)}},tw=()=>tx({current:void 0,version:eJ.unknown()}),tE=(H(tg),H("iOS"),H(tp),H(th),H(tb),H(tv),H(ty),H(tC),t=>window.matchMedia(t).matches),tk=eY(()=>((t,r,n)=>{let o=tl.browsers(),a=tl.oses(),l=r.bind(t=>e_(t.brands,t=>{let r=t.brand.toLowerCase();return ef(o,t=>{var n;return r===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())}).map(r=>({current:r.name,version:eJ.nu(parseInt(t.version,10),0)}))})).orThunk(()=>eZ(o,t).map(r=>{let n=eJ.detect(r.versionRegexes,t);return{current:r.name,version:n}})).fold(tf,tm),i=eZ(a,t).map(r=>{let n=eJ.detect(r.versionRegexes,t);return{current:r.name,version:n}}).fold(tw,tx),s=((t,r,n,o)=>{let a=t.isiOS()&&!0===/ipad/i.test(n),l=t.isiOS()&&!a,i=t.isiOS()||t.isAndroid(),s=i||o("(pointer:coarse)"),d=a||!l&&i&&o("(min-device-width:768px)"),c=l||i&&!d,u=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(n),m=!c&&!d&&!u;return{isiPad:H(a),isiPhone:H(l),isTablet:H(d),isPhone:H(c),isTouch:H(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:H(u),isDesktop:H(m)}})(i,l,t,n);return{browser:l,os:i,deviceType:s}})(navigator.userAgent,J.from(navigator.userAgentData),tE)),tS=()=>tk(),t_=navigator.userAgent,tN=tS(),tR=tN.browser,tA=tN.os,tO=tN.deviceType,tT=-1!==t_.indexOf("Windows Phone"),tB={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:tR.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!tR.isIE(),windowsPhone:tT,browser:{current:tR.current,version:tR.version,isChromium:tR.isChromium,isEdge:tR.isEdge,isFirefox:tR.isFirefox,isIE:tR.isIE,isOpera:tR.isOpera,isSafari:tR.isSafari},os:{current:tA.current,version:tA.version,isAndroid:tA.isAndroid,isChromeOS:tA.isChromeOS,isFreeBSD:tA.isFreeBSD,isiOS:tA.isiOS,isLinux:tA.isLinux,isMacOS:tA.isMacOS,isSolaris:tA.isSolaris,isWindows:tA.isWindows},deviceType:{isDesktop:tO.isDesktop,isiPad:tO.isiPad,isiPhone:tO.isiPhone,isPhone:tO.isPhone,isTablet:tO.isTablet,isTouch:tO.isTouch,isWebView:tO.isWebView}},tD=/^\s*|\s*$/g,tP=t=>P(t)?"":(""+t).replace(tD,""),tL=function(t,r,n,o){o=o||this,t&&(n&&(t=t[n]),e$(t,(t,a)=>!1!==r.call(o,t,a,n)&&(tL(t,r,n,o),!0)))},tM={trim:tP,isArray:eH,is:(t,r)=>r?!("array"!==r||!eH(t))||typeof t===r:void 0!==t,toArray:t=>{if(eH(t))return t;{let r=[];for(let n=0,o=t.length;n<o;n++)r[n]=t[n];return r}},makeMap:(t,r,n={})=>{let o=N(t)?t.split(r||","):t||[],a=o.length;for(;a--;)n[o[a]]={};return n},each:e$,map:eV,grep:eq,inArray:(t,r)=>{if(t){for(let n=0,o=t.length;n<o;n++)if(t[n]===r)return n}return -1},hasOwn:eI,extend:(t,...r)=>{for(let n=0;n<r.length;n++){let o=r[n];for(let r in o)if(eI(o,r)){let n=o[r];void 0!==n&&(t[r]=n)}}return t},walk:tL,resolve:(t,r=window)=>{let n=t.split(".");for(let t=0,o=n.length;t<o&&(r=r[n[t]]);t++);return r},explode:(t,r)=>O(t)?t:""===t?[]:eV(t.split(r||","),tP),_addCacheSuffix:t=>{let r=tB.cacheSuffix;return r&&(t+=(-1===t.indexOf("?")?"?":"&")+r),t}},tF=(t,r,n=V)=>t.exists(t=>n(t,r)),tI=(t,r,n)=>t.isSome()&&r.isSome()?J.some(n(t.getOrDie(),r.getOrDie())):J.none(),tU=(t,r)=>t?J.some(r):J.none(),tz="undefined"!=typeof window?window:Function("return this;")(),tj=(t,r)=>((t,r)=>{let n=null!=r?r:tz;for(let r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n})(t.split("."),r),tH=Object.getPrototypeOf,t$=t=>{let r=tj("ownerDocument.defaultView",t);return R(t)&&(((t,r)=>{let n=tj(t,r);if(null==n)throw Error(t+" not available on this browser");return n})("HTMLElement",r).prototype.isPrototypeOf(t)||/^HTML\w*Element$/.test(tH(t).constructor.name))},tV=t=>t.dom.nodeName.toLowerCase(),tq=t=>t.dom.nodeType,tW=t=>r=>tq(r)===t,tK=t=>tG(t)&&t$(t.dom),tG=tW(1),tY=tW(3),tX=tW(9),tQ=tW(11),tJ=t=>r=>tG(r)&&tV(r)===t,tZ=(t,r,n)=>{if(!(N(n)||B(n)||F(n)))throw console.error("Invalid call to Attribute.set. Key ",r,":: Value ",n,":: Element ",t),Error("Attribute value was not simple");t.setAttribute(r,n+"")},t0=(t,r,n)=>{tZ(t.dom,r,n)},t1=(t,r)=>{let n=t.dom;eA(r,(t,r)=>{tZ(n,r,t)})},t2=(t,r)=>{let n=t.dom.getAttribute(r);return null===n?void 0:n},t3=(t,r)=>J.from(t2(t,r)),t8=(t,r)=>{let n=t.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(r)},t5=(t,r)=>{t.dom.removeAttribute(r)},t6=t=>eu(t.dom.attributes,(t,r)=>(t[r.name]=r.value,t),{}),t9=(t,r)=>{let n=t2(t,r);return void 0===n||""===n?[]:n.split(" ")},t4=t=>void 0!==t.dom.classList,t7=t=>t9(t,"class"),re=(t,r)=>((t,r,n)=>{let o=t9(t,r).concat([n]);return t0(t,r,o.join(" ")),!0})(t,"class",r),rt=(t,r)=>((t,r,n)=>{let o=ed(t9(t,r),t=>t!==n);return o.length>0?t0(t,r,o.join(" ")):t5(t,r),!1})(t,"class",r),rr=(t,r)=>{t4(t)?t.dom.classList.add(r):re(t,r)},rn=t=>{0===(t4(t)?t.dom.classList:t7(t)).length&&t5(t,"class")},ro=(t,r)=>{t4(t)?t.dom.classList.remove(r):rt(t,r),rn(t)},ra=(t,r)=>t4(t)&&t.dom.classList.contains(r),rl=t=>{if(null==t)throw Error("Node cannot be null or undefined");return{dom:t}},ri=(t,r)=>{let n=(r||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||n.childNodes.length>1){let r="HTML does not have a single root node";throw console.error(r,t),Error(r)}return rl(n.childNodes[0])},rs=(t,r)=>{let n=(r||document).createElement(t);return rl(n)},rd=(t,r)=>{let n=(r||document).createTextNode(t);return rl(n)},rc=(t,r,n)=>J.from(t.dom.elementFromPoint(r,n)).map(rl),ru=(t,r)=>{let n=[],o=t=>(n.push(t),r(t)),a=r(t);do a=a.bind(o);while(a.isSome());return n},rm=(t,r)=>{let n=t.dom;if(1!==n.nodeType)return!1;if(void 0!==n.matches)return n.matches(r);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(r);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(r);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(r);throw Error("Browser lacks native selectors")},rf=t=>1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount,rg=(t,r)=>t.dom===r.dom,rp=(t,r)=>{let n=t.dom,o=r.dom;return n!==o&&n.contains(o)},rh=t=>rl(t.dom.ownerDocument),rb=t=>tX(t)?t:rh(t),rv=t=>rl(rb(t).dom.defaultView),ry=t=>J.from(t.dom.parentNode).map(rl),rC=t=>J.from(t.dom.parentElement).map(rl),rx=(t,r)=>{let n=M(r)?r:X,o=t.dom,a=[];for(;null!==o.parentNode&&void 0!==o.parentNode;){let t=o.parentNode,r=rl(t);if(a.push(r),!0===n(r))break;o=t}return a},rw=t=>J.from(t.dom.previousSibling).map(rl),rE=t=>J.from(t.dom.nextSibling).map(rl),rk=t=>ev(ru(t,rw)),rS=t=>ru(t,rE),r_=t=>ea(t.dom.childNodes,rl),rN=(t,r)=>J.from(t.dom.childNodes[r]).map(rl),rR=t=>rN(t,0),rA=t=>rN(t,t.dom.childNodes.length-1),rO=t=>t.dom.childNodes.length,rT=t=>tQ(t)&&L(t.dom.host),rB=M(Element.prototype.attachShadow)&&M(Node.prototype.getRootNode),rD=H(rB),rP=rB?t=>rl(t.dom.getRootNode()):rb,rL=t=>rT(t)?t:(t=>{let r=t.dom.head;if(null==r)throw Error("Head is not available yet");return rl(r)})(rb(t)),rM=t=>rl(t.dom.host),rF=t=>{if(rD()&&L(t.target)){let r=rl(t.target);if(tG(r)&&rI(r)&&t.composed&&t.composedPath){let r=t.composedPath();if(r)return eE(r)}}return J.from(t.target)},rI=t=>L(t.dom.shadowRoot),rU=t=>{let r=tY(t)?t.dom.parentNode:t.dom;if(null==r||null===r.ownerDocument)return!1;let n=r.ownerDocument;return(t=>{let r=rP(t);return rT(r)?J.some(r):J.none()})(rl(r)).fold(()=>n.body.contains(r),j(rU,rM))};var rz=(t,r,n,o,a)=>t(n,o)?J.some(n):M(a)&&a(n)?J.none():r(n,o,a);let rj=(t,r,n)=>{let o=t.dom,a=M(n)?n:X;for(;o.parentNode;){o=o.parentNode;let t=rl(o);if(r(t))return J.some(t);if(a(t))break}return J.none()},rH=(t,r,n)=>rz((t,r)=>r(t),rj,t,r,n),r$=(t,r,n)=>rj(t,t=>rm(t,r),n),rV=(t,r)=>((t,r)=>{let n=void 0===r?document:r.dom;return rf(n)?J.none():J.from(n.querySelector(t)).map(rl)})(r,t),rq=(t,r,n)=>rz((t,r)=>rm(t,r),r$,t,r,n),rW=(t,r=!1)=>rU(t)?t.dom.isContentEditable:rq(t,"[contenteditable]").fold(H(r),t=>"true"===rK(t)),rK=t=>t.dom.contentEditable,rG=t=>void 0!==t.style&&M(t.style.getPropertyValue),rY=(t,r,n)=>{if(!N(n))throw console.error("Invalid call to CSS.set. Property ",r,":: Value ",n,":: Element ",t),Error("CSS value must be a string: "+n);rG(t)&&t.style.setProperty(r,n)},rX=(t,r,n)=>{let o=t.dom;rY(o,r,n)},rQ=(t,r)=>{let n=t.dom;eA(r,(t,r)=>{rY(n,r,t)})},rJ=(t,r)=>{let n=t.dom,o=window.getComputedStyle(n).getPropertyValue(r);return""!==o||rU(t)?o:rZ(n,r)},rZ=(t,r)=>rG(t)?t.style.getPropertyValue(r):"",r0=(t,r)=>{let n=t.dom,o=rZ(n,r);return J.from(o).filter(t=>t.length>0)},r1=t=>{let r={},n=t.dom;if(rG(n))for(let t=0;t<n.style.length;t++){let o=n.style.item(t);r[o]=n.style[o]}return r},r2=(t,r)=>{var n;rG(n=t.dom)&&n.style.removeProperty(r),tF(t3(t,"style").map(e6),"")&&t5(t,"style")},r3=(t,r)=>{ry(t).each(n=>{n.dom.insertBefore(r.dom,t.dom)})},r8=(t,r)=>{rE(t).fold(()=>{ry(t).each(t=>{r6(t,r)})},t=>{r3(t,r)})},r5=(t,r)=>{rR(t).fold(()=>{r6(t,r)},n=>{t.dom.insertBefore(r.dom,n.dom)})},r6=(t,r)=>{t.dom.appendChild(r.dom)},r9=(t,r)=>{r3(t,r),r6(r,t)},r4=(t,r)=>{el(r,r=>{r6(t,r)})},r7=t=>{t.dom.textContent="",el(r_(t),t=>{ne(t)})},ne=t=>{let r=t.dom;null!==r.parentNode&&r.parentNode.removeChild(r)},nt=t=>{let r=r_(t);r.length>0&&el(r,(n,o)=>{let a=0===o?t:r[o-1];r8(a,n)}),ne(t)},nr=t=>ea(t,rl),nn=t=>t.dom.innerHTML,no=(t,r)=>{let n=rh(t).dom,o=rl(n.createDocumentFragment()),a=((t,r)=>{let n=(r||document).createElement("div");return n.innerHTML=t,r_(rl(n))})(r,n);r4(o,a),r7(t),r6(t,o)},na=(t,r,n,o)=>((t,r,n,o,a)=>{let l=t=>{n(t)&&o((t=>{let r=rl(rF(t).getOr(t.target)),n=()=>t.stopPropagation(),o=()=>t.preventDefault(),a=z(o,n);return{target:r,x:t.clientX,y:t.clientY,stop:n,prevent:o,kill:a,raw:t}})(t))};return t.dom.addEventListener(r,l,!1),{unbind:q(nl,t,r,l,!1)}})(t,r,n,o),nl=(t,r,n,o)=>{t.dom.removeEventListener(r,n,o)},ni=(t,r)=>({left:t,top:r,translate:(n,o)=>ni(t+n,r+o)}),ns=(t,r)=>void 0!==t?t:void 0!==r?r:0,nd=t=>{let r=t.dom,n=r.ownerDocument.body;return n===r?ni(n.offsetLeft,n.offsetTop):rU(t)?(t=>{let r=t.getBoundingClientRect();return ni(r.left,r.top)})(r):ni(0,0)},nc=t=>{let r=void 0!==t?t.dom:document,n=r.body.scrollLeft||r.documentElement.scrollLeft,o=r.body.scrollTop||r.documentElement.scrollTop;return ni(n,o)},nu=(t,r)=>{tS().browser.isSafari()&&M(t.dom.scrollIntoViewIfNeeded)?t.dom.scrollIntoViewIfNeeded(!1):t.dom.scrollIntoView(r)},nm=(t,r,n,o)=>({x:t,y:r,width:n,height:o,right:t+n,bottom:r+o}),nf=t=>{let r=void 0===t?window:t,n=r.document,o=nc(rl(n));return(t=>{let r=void 0===t?window:t;return tS().browser.isFirefox()?J.none():J.from(r.visualViewport)})(r).fold(()=>{let t=r.document.documentElement,n=t.clientWidth,a=t.clientHeight;return nm(o.left,o.top,n,a)},t=>nm(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height))},ng=(t,r)=>{let n=[];return el(r_(t),t=>{r(t)&&(n=n.concat([t])),n=n.concat(ng(t,r))}),n},np=(t,r)=>((t,r)=>{let n=void 0===r?document:r.dom;return rf(n)?[]:ea(n.querySelectorAll(t),rl)})(r,t),nh=(t,r,n)=>r$(t,r,n).isSome();class nb{constructor(t,r){this.node=t,this.rootNode=r,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,r,n,o){if(t){if(!o&&t[r])return t[r];if(t!==this.rootNode){let r=t[n];if(r)return r;for(let o=t.parentNode;o&&o!==this.rootNode;o=o.parentNode)if(r=o[n])return r}}}findPreviousNode(t,r){if(t){let n=t.previousSibling;if(this.rootNode&&n===this.rootNode)return;if(n){if(!r){for(let t=n.lastChild;t;t=t.lastChild)if(!t.lastChild)return t}return n}let o=t.parentNode;if(o&&o!==this.rootNode)return o}}}let nv=t=>r=>!!r&&r.nodeType===t,ny=t=>!!t&&!Object.getPrototypeOf(t),nC=nv(1),nx=t=>{let r=t.toLowerCase();return t=>L(t)&&t.nodeName.toLowerCase()===r},nw=t=>{let r=t.map(t=>t.toLowerCase());return t=>{if(t&&t.nodeName){let n=t.nodeName.toLowerCase();return en(r,n)}return!1}},nE=(t,r)=>{let n=r.toLowerCase().split(" ");return r=>{if(nC(r)){let o=r.ownerDocument.defaultView;if(o)for(let a=0;a<n.length;a++){let l=o.getComputedStyle(r,null);if((l?l.getPropertyValue(t):null)===n[a])return!0}}return!1}},nk=t=>r=>nC(r)&&r.hasAttribute(t),nS=t=>nC(t)&&t.hasAttribute("data-mce-bogus"),n_=t=>nC(t)&&"TABLE"===t.tagName,nN=t=>r=>!!nC(r)&&(r.contentEditable===t||r.getAttribute("data-mce-contenteditable")===t),nR=nw(["textarea","input"]),nA=nv(3),nO=nv(4),nT=nv(7),nB=nv(8),nD=nv(9),nP=nv(11),nL=nx("br"),nM=nx("img"),nF=nN("true"),nI=nN("false"),nU=nw(["td","th"]),nz=nw(["td","th","caption"]),nj=nw(["video","audio","object","embed"]),nH=nx("li"),n$=nx("details"),nV=nx("summary"),nq=t=>"\uFEFF"===t,nW=((t,r)=>{let n=r=>t(r)?J.from(r.dom.nodeValue):J.none();return{get:r=>{if(!t(r))throw Error("Can only get text value of a text node");return n(r).getOr("")},getOption:n,set:(r,n)=>{if(!t(r))throw Error("Can only set raw text value of a text node");r.dom.nodeValue=n}}})(tY),nK=t=>nW.get(t),nG=t=>nW.getOption(t),nY=["pre"].concat(["h1","h2","h3","h4","h5","h6"]),nX=t=>{let r;return n=>eI(r=r||eC(t,Q),tV(n))},nQ=nX(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),nJ=t=>tG(t)&&!nQ(t),nZ=t=>tG(t)&&"br"===tV(t),n0=nX(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),n1=nX(["ul","ol","dl"]),n2=nX(["li","dd","dt"]),n3=nX(["thead","tbody","tfoot"]),n8=nX(["td","th"]),n5=nX(["pre","script","textarea","style"]),n6=nX(nY),n9=t=>n6(t)||nJ(t),n4=()=>{let t=rs("br");return t0(t,"data-mce-bogus","1"),t},n7=t=>{r7(t),r6(t,n4())},oe=t=>{rA(t).each(r=>{rw(r).each(n=>{nQ(t)&&nZ(r)&&nQ(n)&&ne(r)})})},ot=t=>t.replace(/\uFEFF/g,""),or=t=>(nA(t)&&(t=t.parentNode),nC(t)&&t.hasAttribute("data-mce-caret")),on=t=>nA(t)&&nq(t.data),oo=t=>or(t)||on(t),oa=t=>t.firstChild!==t.lastChild||!nL(t.firstChild),ol=t=>{let r=t.container();return!!nA(r)&&("\uFEFF"===r.data.charAt(t.offset())||t.isAtStart()&&on(r.previousSibling))},oi=t=>{let r=t.container();return!!nA(r)&&("\uFEFF"===r.data.charAt(t.offset()-1)||t.isAtEnd()&&on(r.nextSibling))},os=t=>nA(t)&&"\uFEFF"===t.data[0],od=t=>nA(t)&&"\uFEFF"===t.data[t.data.length-1],oc=t=>t&&t.hasAttribute("data-mce-caret")?((t=>{var r;let n=t.getElementsByTagName("br"),o=n[n.length-1];nS(o)&&(null===(r=o.parentNode)||void 0===r||r.removeChild(o))})(t),t.removeAttribute("data-mce-caret"),t.removeAttribute("data-mce-bogus"),t.removeAttribute("style"),t.removeAttribute("data-mce-style"),t.removeAttribute("_moz_abspos"),t):null,ou=t=>or(t.startContainer),om=nw(["script","style","textarea"]),of=nw(["img","input","textarea","hr","iframe","video","audio","object","embed"]),og=nw(["table"]),op=t=>!oo(t)&&(nA(t)?!om(t.parentNode):of(t)||nL(t)||og(t)||oh(t)),oh=t=>(!nC(t)||"true"!==t.getAttribute("unselectable"))&&nI(t),ob=(t,r)=>op(t)&&((t,r)=>{for(let n=t.parentNode;n&&n!==r;n=n.parentNode){if(oh(n))return!1;if(nF(n))break}return!0})(t,r),ov=/^[ \t\r\n]*$/,oy=t=>ov.test(t),oC=t=>{for(let r of t)if(!nq(r))return!1;return!0},ox=t=>"\n"===t||"\r"===t,ow=(t,r=4,n=!0,o=!0)=>{let a=r<=0?"":Array(r+1).join(" "),l=t.replace(/\t/g,a),i=eu(l,(t,r)=>{var a;return -1!==" \f	\v".indexOf(r)||"\xa0"===r?t.pcIsSpace||""===t.str&&n||t.str.length===l.length-1&&o||(a=t.str.length+1)<l.length&&a>=0&&ox(l[a])?{pcIsSpace:!1,str:t.str+"\xa0"}:{pcIsSpace:!0,str:t.str+" "}:{pcIsSpace:ox(r),str:t.str+r}},{pcIsSpace:!1,str:""});return i.str},oE=(t,r)=>op(t)&&(!(nA(t)&&oy(t.data))||!!((t,r)=>{let n=rl(r),o=rl(t);return nh(o,"pre,code",q(rg,n))})(t,r))||nC(t)&&"A"===t.nodeName&&!t.hasAttribute("href")&&(t.hasAttribute("name")||t.hasAttribute("id"))||ok(t),ok=nk("data-mce-bookmark"),oS=nk("data-mce-bogus"),o_=t=>nC(t)&&"all"===t.getAttribute("data-mce-bogus"),oN=(t,r=!0)=>((t,r)=>{let n=0;if(oE(t,t))return!1;{let o=t.firstChild;if(!o)return!0;let a=new nb(o,t);do{if(r){if(o_(o)){o=a.next(!0);continue}if(oS(o)){o=a.next();continue}}if(nL(o))n++,o=a.next();else{if(oE(o,t))return!1;o=a.next()}}while(o);return n<=1}})(t.dom,r),oR="data-mce-block",oA=t=>ed(eN(t),t=>!/[A-Z]/.test(t)).join(","),oO=(t,r)=>L(r.querySelector(t))?(r.setAttribute(oR,"true"),"inline-boundary"===r.getAttribute("data-mce-selected")&&r.removeAttribute("data-mce-selected"),!0):(r.removeAttribute(oR),!1),oT=(t,r)=>{let n=oA(t.getTransparentElements()),o=oA(t.getBlockElements());return ed(r.querySelectorAll(n),t=>oO(o,t))},oB=(t,r)=>{var n;let o=r?"lastChild":"firstChild";for(let r=t[o];r;r=r[o])if(oN(rl(r)))return void(null===(n=r.parentNode)||void 0===n||n.removeChild(r))},oD=(t,r,n)=>{let o=t.getBlockElements(),a=rl(r),l=t=>tV(t) in o,i=t=>rg(t,a);el(nr(n),r=>{rj(r,l,i).each(n=>{let o=ed(r_(r),r=>l(r)&&!t.isValidChild(tV(n),tV(r)));if(o.length>0){let r=rC(n);el(o,t=>{rj(t,l,i).each(r=>{((t,r)=>{let n=document.createRange(),o=t.parentNode;if(o){n.setStartBefore(t),n.setEndBefore(r);let a=n.extractContents();oB(a,!0),n.setStartAfter(r),n.setEndAfter(t);let l=n.extractContents();oB(l,!1),oN(rl(a))||o.insertBefore(a,t),oN(rl(r))||o.insertBefore(r,t),oN(rl(l))||o.insertBefore(l,t),o.removeChild(t)}})(r.dom,t.dom)})}),r.each(r=>oT(t,r.dom))}})})},oP=(t,r)=>{let n=oT(t,r);oD(t,r,n),el([...n,...oU(t,r)?[r]:[]],r=>el(np(rl(r),r.nodeName.toLowerCase()),r=>{oz(t,r.dom)&&nt(r)}))},oL=(t,r)=>{if(oI(t,r)){let n=oA(t.getBlockElements());oO(n,r)}},oM=t=>t.hasAttribute(oR),oF=(t,r)=>eI(t.getTransparentElements(),r),oI=(t,r)=>nC(r)&&oF(t,r.nodeName),oU=(t,r)=>oI(t,r)&&oM(r),oz=(t,r)=>oI(t,r)&&!oM(r),oj=(t,r)=>1===r.type&&oF(t,r.name)&&N(r.attr(oR)),oH=tS().browser,o$=t=>ef(t,tG),oV=(t,r)=>t.children&&en(t.children,r),oq=(t,r={})=>{let n=0,o={},a=rl(t),l=rb(a),i=t=>new Promise((i,s)=>{let d;let c=tM._addCacheSuffix(t),u=eF(o,c).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0}));o[c]=u,u.count++;let m=(t,r)=>{el(t,Y),u.status=r,u.passed=[],u.failed=[],d&&(d.onload=null,d.onerror=null,d=null)},f=()=>m(u.passed,2),g=()=>m(u.failed,3);if(i&&u.passed.push(i),s&&u.failed.push(s),1===u.status)return;if(2===u.status)return void f();if(3===u.status)return void g();u.status=1;let p=rs("link",l.dom);t1(p,{rel:"stylesheet",type:"text/css",id:u.id}),r.contentCssCors&&t0(p,"crossOrigin","anonymous"),r.referrerPolicy&&t0(p,"referrerpolicy",r.referrerPolicy),(d=p.dom).onload=f,d.onerror=g,r6(rL(a),p),t0(p,"href",c)}),s=t=>{let r=tM._addCacheSuffix(t);eF(o,r).each(t=>{0==--t.count&&(delete o[r],(t=>{let r=rL(a);rV(r,"#"+t).each(ne)})(t.id))})};return{load:i,loadAll:t=>Promise.allSettled(ea(t,t=>i(t).then(H(t)))).then(t=>{let r=es(t,t=>"fulfilled"===t.status);return r.fail.length>0?Promise.reject(ea(r.fail,t=>t.reason)):ea(r.pass,t=>t.value)}),unload:s,unloadAll:t=>{el(t,t=>{s(t)})},_setReferrerPolicy:t=>{r.referrerPolicy=t},_setContentCssCors:t=>{r.contentCssCors=t}}},oW=(()=>{let t=new WeakMap;return{forElement:(r,n)=>{let o=rP(r).dom;return J.from(t.get(o)).getOrThunk(()=>{let r=oq(o,n);return t.set(o,r),r})}}})(),oK=(t,r)=>L(t)&&(oE(t,r)||nJ(rl(t))),oG=t=>"span"===t.nodeName.toLowerCase()&&"bookmark"===t.getAttribute("data-mce-type"),oY=(t,r,n)=>{var o;let a=n||r;if(nC(r)&&oG(r))return r;let l=r.childNodes;for(let r=l.length-1;r>=0;r--)oY(t,l[r],a);if(nC(r)){let t=r.childNodes;1===t.length&&oG(t[0])&&(null===(o=r.parentNode)||void 0===o||o.insertBefore(t[0],r))}return nP(r)||nD(r)||oE(r,a)||nC(r)&&r.childNodes.length>0||nA(r)&&r.data.length>0&&((t,r)=>{let n=new nb(t,r).prev(!1),o=new nb(t,r).next(!1),a=D(n)||oK(n,r),l=D(o)||oK(o,r);return a&&l})(r,a)||t.remove(r),r},oX=tM.makeMap,oQ=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,oJ=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,oZ=/[<>&\"\']/g,o0=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,o1={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},o2={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},o3={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},o8=(t,r)=>{let n={};if(t){let o=t.split(",");r=r||10;for(let t=0;t<o.length;t+=2){let a=String.fromCharCode(parseInt(o[t],r));if(!o2[a]){let r="&"+o[t+1]+";";n[a]=r,n[r]=a}}return n}},o5=o8("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),o6=(t,r)=>t.replace(r?oQ:oJ,t=>o2[t]||t),o9=(t,r)=>t.replace(r?oQ:oJ,t=>t.length>1?"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";":o2[t]||"&#"+t.charCodeAt(0)+";"),o4=(t,r,n)=>{let o=n||o5;return t.replace(r?oQ:oJ,t=>o2[t]||o[t]||t)},o7={encodeRaw:o6,encodeAllRaw:t=>(""+t).replace(oZ,t=>o2[t]||t),encodeNumeric:o9,encodeNamed:o4,getEncodeFunc:(t,r)=>{let n=o8(r)||o5,o=oX(t.replace(/\+/g,","));return o.named&&o.numeric?(t,r)=>t.replace(r?oQ:oJ,t=>void 0!==o2[t]?o2[t]:void 0!==n[t]?n[t]:t.length>1?"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";":"&#"+t.charCodeAt(0)+";"):o.named?r?(t,r)=>o4(t,r,n):o4:o.numeric?o9:o6},decode:t=>t.replace(o0,(t,r)=>r?(r="x"===r.charAt(0).toLowerCase()?parseInt(r.substr(1),16):parseInt(r,10))>65535?String.fromCharCode(55296+((r-=65536)>>10),56320+(1023&r)):o1[r]||String.fromCharCode(r):o3[t]||o5[t]||(t=>{let r=rs("div").dom;return r.innerHTML=t,r.textContent||r.innerText||t})(t))},ae={},at={},ar={},an=tM.makeMap,ao=tM.each,aa=tM.extend,al=tM.explode,ai=tM.inArray,as=(t,r)=>(t=tM.trim(t))?t.split(r||" "):[],ad=(t,r={})=>{let n=an(t," ",an(t.toUpperCase()," "));return aa(n,r)},ac=t=>ad("td th li dt dd figcaption caption details summary",t.getTextBlockElements()),au=(t,r)=>{if(t){let n={};return N(t)&&(t={"*":t}),ao(t,(t,o)=>{n[o]=n[o.toUpperCase()]="map"===r?an(t,/[, ]/):al(t,/[, ]/)}),n}},am=(t={})=>{var r;let n={},o={},a=[],l={},i={},s=(r,n,o)=>{let a=t[r];if(a)return an(a,/[, ]/,an(a.toUpperCase(),/[, ]/));{let t=at[r];return t||(t=ad(n,o),at[r]=t),t}},d=null!==(r=t.schema)&&void 0!==r?r:"html5",c=(t=>{let r,n,o,a;let l={},i=(t,n="",o="")=>{let a=as(o),i=as(t),s=i.length;for(;s--;){let t=as([r,n].join(" "));l[i[s]]={attributes:eC(t,()=>({})),attributesOrder:t,children:eC(a,H(ar))}}},s=(t,r)=>{let n=as(t),o=as(r),a=n.length;for(;a--;){let t=l[n[a]];for(let r=0,n=o.length;r<n;r++)t.attributes[o[r]]={},t.attributesOrder.push(o[r])}};if(ae[t])return ae[t];if(r="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==t&&(r+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav a ins del canvas map",o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==t){r+=" xml:lang";let t="acronym applet basefont big font strike tt";o=[o,t].join(" "),ao(as(t),t=>{i(t,"",o)});let l="center dir isindex noframes";a=[n=[n,l].join(" "),o].join(" "),ao(as(l),t=>{i(t,"",a)})}return a=a||[n,o].join(" "),i("html","manifest","head body"),i("head","","base command link meta noscript script style title"),i("title hr noscript br"),i("base","href target"),i("link","href rel media hreflang type sizes hreflang"),i("meta","name http-equiv content charset"),i("style","media type scoped"),i("script","src async defer type charset"),i("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",a),i("dd div","",a),i("address dt caption","","html4"===t?o:a),i("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",o),i("blockquote","cite",a),i("ol","reversed start type","li"),i("ul","","li"),i("li","value",a),i("dl","","dt dd"),i("a","href target rel media hreflang type","html4"===t?o:a),i("q","cite",o),i("ins del","cite datetime",a),i("img","src sizes srcset alt usemap ismap width height"),i("iframe","src name width height",a),i("embed","src type width height"),i("object","data type typemustmatch name usemap form width height",[a,"param"].join(" ")),i("param","name value"),i("map","name",[a,"area"].join(" ")),i("area","alt coords shape href target rel media hreflang type"),i("table","border","caption colgroup thead tfoot tbody tr"+("html4"===t?" col":"")),i("colgroup","span","col"),i("col","span"),i("tbody thead tfoot","","tr"),i("tr","","td th"),i("td","colspan rowspan headers",a),i("th","colspan rowspan headers scope abbr",a),i("form","accept-charset action autocomplete enctype method name novalidate target",a),i("fieldset","disabled form name",[a,"legend"].join(" ")),i("label","form for",o),i("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),i("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===t?a:o),i("select","disabled form multiple name required size","option optgroup"),i("optgroup","disabled label","option"),i("option","disabled label selected value"),i("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),i("menu","type label",[a,"li"].join(" ")),i("noscript","",a),"html4"!==t&&(i("wbr"),i("ruby","",[o,"rt rp"].join(" ")),i("figcaption","",a),i("mark rt rp summary bdi","",o),i("canvas","width height",a),i("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[a,"track source"].join(" ")),i("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[a,"track source"].join(" ")),i("picture","","img source"),i("source","src srcset type media sizes"),i("track","kind src srclang label default"),i("datalist","",[o,"option"].join(" ")),i("article section nav aside main header footer","",a),i("hgroup","","h1 h2 h3 h4 h5 h6"),i("figure","",[a,"figcaption"].join(" ")),i("time","datetime",o),i("dialog","open",a),i("command","type label icon disabled checked radiogroup command"),i("output","for form name",o),i("progress","value max",o),i("meter","value min max low high optimum",o),i("details","open",[a,"summary"].join(" ")),i("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==t&&(s("script","language xml:space"),s("style","xml:space"),s("object","declare classid code codebase codetype archive standby align border hspace vspace"),s("embed","align name hspace vspace"),s("param","valuetype type"),s("a","charset name rev shape coords"),s("br","clear"),s("applet","codebase archive code object alt name width height align hspace vspace"),s("img","name longdesc align border hspace vspace"),s("iframe","longdesc frameborder marginwidth marginheight scrolling align"),s("font basefont","size color face"),s("input","usemap align"),s("select"),s("textarea"),s("h1 h2 h3 h4 h5 h6 div p legend caption","align"),s("ul","type compact"),s("li","type"),s("ol dl menu dir","compact"),s("pre","width xml:space"),s("hr","align noshade size width"),s("isindex","prompt"),s("table","summary width frame rules cellspacing cellpadding align bgcolor"),s("col","width align char charoff valign"),s("colgroup","width align char charoff valign"),s("thead","align char charoff valign"),s("tr","align char charoff valign bgcolor"),s("th","axis align char charoff valign nowrap bgcolor width height"),s("form","accept"),s("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),s("tfoot","align char charoff valign"),s("tbody","align char charoff valign"),s("area","nohref"),s("body","background bgcolor text link vlink alink")),"html4"!==t&&(s("input button select textarea","autofocus"),s("input textarea","placeholder"),s("a","download"),s("link script img","crossorigin"),s("img","loading"),s("iframe","sandbox seamless allow allowfullscreen loading")),"html4"!==t&&el([l.video,l.audio],t=>{delete t.children.audio,delete t.children.video}),ao(as("a form meter progress dfn"),t=>{l[t]&&delete l[t].children[t]}),delete l.caption.children.table,delete l.script,ae[t]=l,l})(d);!1===t.verify_html&&(t.valid_elements="*[*]");let u=au(t.valid_styles),m=au(t.invalid_styles,"map"),f=au(t.valid_classes,"map"),g=s("whitespace_elements","pre script noscript style textarea video audio iframe object code"),p=s("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),h=s("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),b=s("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),v="td th iframe video audio object script code",y=s("non_empty_elements",v+" pre",h),C=s("move_caret_before_on_enter_elements",v+" table",h),x=s("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),w=s("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",x),E=s("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),k=s("transparent_elements","a ins del canvas map");ao("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),t=>{i[t]=RegExp("</"+t+"[^>]*>","gi")});let S=t=>RegExp("^"+t.replace(/([?+*])/g,".$1")+"$"),_=t=>{let r=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,o=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,l=/[*?+]/;if(t){let i,s;let d=as(t,",");n["@"]&&(i=n["@"].attributes,s=n["@"].attributesOrder);for(let t=0,c=d.length;t<c;t++){let c=r.exec(d[t]);if(c){let t=c[1],r=c[2],d=c[3],u=c[5],m={},f=[],g={attributes:m,attributesOrder:f};if("#"===t&&(g.paddEmpty=!0),"-"===t&&(g.removeEmpty=!0),"!"===c[4]&&(g.removeEmptyAttrs=!0),i&&(eA(i,(t,r)=>{m[r]=t}),s&&f.push(...s)),u){let t=as(u,"|");for(let r=0,n=t.length;r<n;r++)if(c=o.exec(t[r])){let t={},r=c[1],n=c[2].replace(/[\\:]:/g,":"),o=c[3],a=c[4];if("!"===r&&(g.attributesRequired=g.attributesRequired||[],g.attributesRequired.push(n),t.required=!0),"-"===r){delete m[n],f.splice(ai(f,n),1);continue}(o&&("="===o&&(g.attributesDefault=g.attributesDefault||[],g.attributesDefault.push({name:n,value:a}),t.defaultValue=a),"~"===o&&(g.attributesForced=g.attributesForced||[],g.attributesForced.push({name:n,value:a}),t.forcedValue=a),"<"===o&&(t.validValues=an(a,"?"))),l.test(n))?(g.attributePatterns=g.attributePatterns||[],t.pattern=S(n),g.attributePatterns.push(t)):(m[n]||f.push(n),m[n]=t)}}(i||"@"!==r||(i=m,s=f),d&&(g.outputName=r,n[d]=g),l.test(r))?(g.pattern=S(r),a.push(g)):n[r]=g}}}},N=t=>{a=[],el(eN(n),t=>{delete n[t]}),_(t),ao(c,(t,r)=>{o[r]=t.children})},R=t=>{let r=/^(~)?(.+)$/;t&&(delete at.text_block_elements,delete at.block_elements,ao(as(t,","),t=>{let a=r.exec(t);if(a){let t="~"===a[1],r=t?"span":"div",i=a[2];if(o[i]=o[r],l[i]=r,y[i.toUpperCase()]={},y[i]={},t||(w[i.toUpperCase()]={},w[i]={}),!n[i]){let t=n[r];t=aa({},t),delete t.removeEmptyAttrs,delete t.removeEmpty,n[i]=t}ao(o,(t,n)=>{t[r]&&(o[n]=t=aa({},o[n]),t[i]=t[r])})}}))},A=t=>{let r=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;delete ae[d],t&&ao(as(t,","),t=>{let n=r.exec(t);if(n){let t;let r=n[1];t=r?o[n[2]]:o[n[2]]={"#comment":{}},t=o[n[2]],ao(as(n[3],"|"),n=>{"-"===r?delete t[n]:t[n]={}})}})},O=t=>{let r=n[t];if(r)return r;let o=a.length;for(;o--;){let r=a[o];if(r.pattern.test(t))return r}};t.valid_elements?N(t.valid_elements):(ao(c,(t,r)=>{n[r]={attributes:t.attributes,attributesOrder:t.attributesOrder},o[r]=t.children}),ao(as("strong/b em/i"),t=>{let r=as(t,"/");n[r[1]].outputName=r[0]}),ao(E,(r,o)=>{n[o]&&(t.padd_empty_block_inline_children&&(n[o].paddInEmptyBlock=!0),n[o].removeEmpty=!0)}),ao(as("ol ul blockquote a table tbody"),t=>{n[t]&&(n[t].removeEmpty=!0)}),ao(as("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),t=>{n[t]&&(n[t].paddEmpty=!0)}),ao(as("span"),t=>{n[t].removeEmptyAttrs=!0})),R(t.custom_elements),A(t.valid_children),_(t.extended_valid_elements),A("+ol[ul|ol],+ul[ul|ol]"),ao({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(t,r)=>{n[r]&&(n[r].parentsRequired=as(t))}),t.invalid_elements&&ao(al(t.invalid_elements),t=>{n[t]&&delete n[t]}),O("span")||_("span[!data-mce-type|*]");let T=H(u),B=H(m),D=H(f),P=H(b),L=H(w),M=H(x),F=H(E),I=H(Object.seal(h)),U=H(p),z=H(y),j=H(C),$=H(g),V=H(k),q=H(Object.seal(i)),W=H(l);return{type:d,children:o,elements:n,getValidStyles:T,getValidClasses:D,getBlockElements:L,getInvalidStyles:B,getVoidElements:I,getTextBlockElements:M,getTextInlineElements:F,getBoolAttrs:P,getElementRule:O,getSelfClosingElements:U,getNonEmptyElements:z,getMoveCaretBeforeOnEnterElements:j,getWhitespaceElements:$,getTransparentElements:V,getSpecialElements:q,isValidChild:(t,r)=>{let n=o[t.toLowerCase()];return!(!n||!n[r.toLowerCase()])},isValid:(t,r)=>{let n=O(t);if(n){if(!r)return!0;{if(n.attributes[r])return!0;let t=n.attributePatterns;if(t){let n=t.length;for(;n--;)if(t[n].pattern.test(r))return!0}}}return!1},getCustomElements:W,addValidElements:_,setValidElements:N,addCustomElements:R,addValidChildren:A}},af=(t={},r)=>{let n,o;let a=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,l=/\s*([^:]+):\s*([^;]+);?/g,i=/\s+$/,s={};r&&(n=r.getValidStyles(),o=r.getInvalidStyles());let d="\\\" \\' \\; \\: ; : \uFEFF".split(" ");for(let t=0;t<d.length;t++)s[d[t]]="\uFEFF"+t,s["\uFEFF"+t]=d[t];let c={parse:r=>{var n,o,d;let u={},m=!1,f=t.url_converter,g=t.url_converter_scope||c,p=(t,r,n)=>{let o=u[t+"-top"+r];if(!o)return;let a=u[t+"-right"+r];if(!a)return;let l=u[t+"-bottom"+r];if(!l)return;let i=u[t+"-left"+r];if(!i)return;let s=[o,a,l,i],d=s.length-1;for(;d--&&s[d]===s[d+1];);d>-1&&n||(u[t+r]=-1===d?s[0]:s.join(" "),delete u[t+"-top"+r],delete u[t+"-right"+r],delete u[t+"-bottom"+r],delete u[t+"-left"+r])},h=t=>{let r=u[t];if(!r)return;let n=r.split(" "),o=n.length;for(;o--;)if(n[o]!==n[0])return!1;return u[t]=n[0],!0},b=t=>(m=!0,s[t]),v=(t,r)=>(m&&(t=t.replace(/\uFEFF[0-9]/g,t=>s[t])),r||(t=t.replace(/\\([\'\";:])/g,"$1")),t),y=t=>String.fromCharCode(parseInt(t.slice(1),16)),C=t=>t.replace(/\\[0-9a-f]+/gi,y),x=(r,n,o,a,l,i)=>{if(l=l||i)return"'"+(l=v(l)).replace(/\'/g,"\\'")+"'";if(n=v(n||o||a||""),!t.allow_script_urls){let r=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(r)||!t.allow_svg_data_urls&&/^data:image\/svg/i.test(r))return""}return f&&(n=f.call(g,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(r){let s;for(r=(r=r.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,b).replace(/\"[^\"]+\"|\'[^\']+\'/g,t=>t.replace(/[;:]/g,b));s=l.exec(r);){l.lastIndex=s.index+s[0].length;let r=s[1].replace(i,"").toLowerCase(),n=s[2].replace(i,"");if(r&&n){if(r=C(r),n=C(n),-1!==r.indexOf("\uFEFF")||-1!==r.indexOf('"')||!t.allow_script_urls&&("behavior"===r||/expression\s*\(|\/\*|\*\//.test(n)))continue;"font-weight"===r&&"700"===n?n="bold":"color"!==r&&"background-color"!==r||(n=n.toLowerCase()),n=n.replace(a,x),u[r]=m?v(n,!0):n}}p("border","",!0),p("border","-width"),p("border","-color"),p("border","-style"),p("padding",""),p("margin",""),o="border-style",d="border-color",h(n="border-width")&&h(o)&&h(d)&&(u.border=u[n]+" "+u[o]+" "+u[d],delete u[n],delete u[o],delete u[d]),"medium none"===u.border&&delete u.border,"none"===u["border-image"]&&delete u["border-image"]}return u},serialize:(t,r)=>{let a="",l=(r,n)=>{let o=n[r];if(o)for(let r=0,n=o.length;r<n;r++){let n=o[r],l=t[n];l&&(a+=(a.length>0?" ":"")+n+": "+l+";")}};return r&&n?(l("*",n),l(r,n)):eA(t,(t,n)=>{t&&((t,r)=>{if(!o||!r)return!0;let n=o["*"];return!(n&&n[t]||(n=o[r])&&n[t])})(n,r)&&(a+=(a.length>0?" ":"")+n+": "+t+";")}),a}};return c},ag={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},ap=(t,r)=>{let n=null!=r?r:{};for(let r in t)eI(ag,r)||(n[r]=t[r]);return L(t.composedPath)&&(n.composedPath=()=>t.composedPath()),n},ah=(t,r,n,o)=>{var a;let l=ap(r,o);return l.type=t,P(l.target)&&(l.target=null!==(a=l.srcElement)&&void 0!==a?a:n),(P(r.preventDefault)||r instanceof Event||M(r.initEvent))&&(l.preventDefault=()=>{l.defaultPrevented=!0,l.isDefaultPrevented=Q,M(r.preventDefault)&&r.preventDefault()},l.stopPropagation=()=>{l.cancelBubble=!0,l.isPropagationStopped=Q,M(r.stopPropagation)&&r.stopPropagation()},l.stopImmediatePropagation=()=>{l.isImmediatePropagationStopped=Q,l.stopPropagation()},l.isDefaultPrevented===Q||l.isDefaultPrevented===X||(l.isDefaultPrevented=!0===l.defaultPrevented?Q:X,l.isPropagationStopped=!0===l.cancelBubble?Q:X,l.isImmediatePropagationStopped=X)),l},ab=/^(?:mouse|contextmenu)|click/,av=(t,r,n,o)=>{t.addEventListener(r,n,o||!1)},ay=(t,r,n,o)=>{t.removeEventListener(r,n,o||!1)},aC=(t,r)=>{let n=ah(t.type,t,document,r);if(L(t)&&ab.test(t.type)&&D(t.pageX)&&!D(t.clientX)){let r=n.target.ownerDocument||document,o=r.documentElement,a=r.body;n.pageX=t.clientX+(o&&o.scrollLeft||a&&a.scrollLeft||0)-(o&&o.clientLeft||a&&a.clientLeft||0),n.pageY=t.clientY+(o&&o.scrollTop||a&&a.scrollTop||0)-(o&&o.clientTop||a&&a.clientTop||0)}return n},ax=(t,r,n)=>{let o=t.document,a={type:"ready"};if(n.domLoaded)return void r(a);let l=()=>{ay(t,"DOMContentLoaded",l),ay(t,"load",l),n.domLoaded||(n.domLoaded=!0,r(a)),t=null};"complete"===o.readyState||"interactive"===o.readyState&&o.body?l():av(t,"DOMContentLoaded",l),n.domLoaded||av(t,"load",l)};class aw{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,r,n,o){let a,l;let i=this,s=window,d=t=>{i.executeHandlers(aC(t||s.event),l)};if(!t||nA(t)||nB(t))return n;t[i.expando]?l=t[i.expando]:(l=i.count++,t[i.expando]=l,i.events[l]={}),o=o||t;let c=r.split(" "),u=c.length;for(;u--;){let r=c[u],m=d,f=!1,g=!1;"DOMContentLoaded"===r&&(r="ready"),i.domLoaded&&"ready"===r&&"complete"===t.readyState?n.call(o,aC({type:r})):(i.hasFocusIn||"focusin"!==r&&"focusout"!==r||(f=!0,g="focusin"===r?"focus":"blur",m=t=>{let r=aC(t||s.event);r.type="focus"===r.type?"focusin":"focusout",i.executeHandlers(r,l)}),(a=i.events[l][r])?"ready"===r&&i.domLoaded?n(aC({type:r})):a.push({func:n,scope:o}):(i.events[l][r]=a=[{func:n,scope:o}],a.fakeName=g,a.capture=f,a.nativeHandler=m,"ready"===r?ax(t,m,i):av(t,g||r,m,f)))}return t=a=null,n}unbind(t,r,n){if(!t||nA(t)||nB(t))return this;let o=t[this.expando];if(o){let a=this.events[o];if(r){let o=r.split(" "),l=o.length;for(;l--;){let r=o[l],i=a[r];if(i){if(n){let t=i.length;for(;t--;)if(i[t].func===n){let n=i.nativeHandler,o=i.fakeName,l=i.capture,s=i.slice(0,t).concat(i.slice(t+1));s.nativeHandler=n,s.fakeName=o,s.capture=l,a[r]=s}}n&&0!==i.length||(delete a[r],ay(t,i.fakeName||r,i.nativeHandler,i.capture))}}}else eA(a,(r,n)=>{ay(t,r.fakeName||n,r.nativeHandler,r.capture)}),a={};for(let t in a)if(eI(a,t))return this;delete this.events[o];try{delete t[this.expando]}catch(r){t[this.expando]=null}}return this}fire(t,r,n){return this.dispatch(t,r,n)}dispatch(t,r,n){if(!t||nA(t)||nB(t))return this;let o=aC({type:r,target:t},n);do{let r=t[this.expando];r&&this.executeHandlers(o,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!o.isPropagationStopped());return this}clean(t){if(!t||nA(t)||nB(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);let r=t.getElementsByTagName("*"),n=r.length;for(;n--;)(t=r[n])[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,r){let n=this.events[r],o=n&&n[t.type];if(o)for(let r=0,n=o.length;r<n;r++){let n=o[r];if(n&&!1===n.func.call(n.scope,t)&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}aw.Event=new aw;let aE=tM.each,ak=tM.grep,aS="data-mce-style",a_=tM.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),aN=(t,r,n)=>{P(n)||""===n?t5(t,r):t0(t,r,n)},aR=t=>t.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),aA=(t,r)=>{let n=0;if(t)for(let o=t.nodeType,a=t.previousSibling;a;a=a.previousSibling){let t=a.nodeType;r&&nA(a)&&(t===o||!a.data.length)||(n++,o=t)}return n},aO=(t,r)=>{let n=t2(r,"style"),o=t.serialize(t.parse(n),tV(r));aN(r,aS,o)},aT=(t,r,n)=>{let o=aR(r);P(n)||""===n?r2(t,o):rX(t,o,F(n)?eI(a_,o)?n+"":n+"px":n)},aB=(t,r={})=>{let n={},o=window,a={},l=0,i=oW.forElement(rl(t),{contentCssCors:r.contentCssCors,referrerPolicy:r.referrerPolicy}),s=[],d=r.schema?r.schema:am({}),c=af({url_converter:r.url_converter,url_converter_scope:r.url_converter_scope},r.schema),u=r.ownEvents?new aw:aw.Event,m=d.getBlockElements(),f=r=>r&&t&&N(r)?t.getElementById(r):r,g=t=>{let r=f(t);return L(r)?rl(r):null},p=(t,r,n="")=>{let o;let a=g(t);if(L(a)&&tG(a)){let t=K[r];o=t&&t.get?t.get(a.dom,r):t2(a,r)}return L(o)?o:n},h=t=>{let r=f(t);return P(r)?[]:r.attributes},b=(t,n,o)=>{S(t,t=>{if(nC(t)){let a=rl(t),l=""===o?null:o,i=t2(a,n),s=K[n];s&&s.set?s.set(a.dom,l,n):aN(a,n,l),i!==l&&r.onSetAttrib&&r.onSetAttrib({attrElm:a.dom,attrName:n,attrValue:l})}})},v=()=>r.root_element||t.body,y=(r,n)=>((t,r,n)=>{let o=0,a=0,l=t.ownerDocument;if(n=n||t,r){var i;if(n===t&&r.getBoundingClientRect&&"static"===rJ(rl(t),"position")){let n=r.getBoundingClientRect();return{x:o=n.left+(l.documentElement.scrollLeft||t.scrollLeft)-l.documentElement.clientLeft,y:a=n.top+(l.documentElement.scrollTop||t.scrollTop)-l.documentElement.clientTop}}let s=r;for(;s&&s!==n&&s.nodeType&&!oV(s,n);){let t=s;o+=t.offsetLeft||0,a+=t.offsetTop||0,s=t.offsetParent}for(s=r.parentNode;s&&s!==n&&s.nodeType&&!oV(s,n);)o-=s.scrollLeft||0,a-=s.scrollTop||0,s=s.parentNode;a+=(i=rl(r),oH.isFirefox()&&"table"===tV(i)?o$(r_(i)).filter(t=>"caption"===tV(t)).bind(t=>o$(rS(t)).map(r=>{let n=r.dom.offsetTop,o=t.dom.offsetTop,a=t.dom.offsetHeight;return n<=o?-a:0})).getOr(0):0)}return{x:o,y:a}})(t.body,f(r),n),C=(t,r,n)=>{let o=f(t);if(!P(o)&&nC(o))return n?rJ(rl(o),aR(r)):("float"===(r=r.replace(/-(\D)/g,(t,r)=>r.toUpperCase()))&&(r="cssFloat"),o.style?o.style[r]:void 0)},x=t=>{let r=f(t);if(!r)return{w:0,h:0};let n=C(r,"width"),o=C(r,"height");return n&&-1!==n.indexOf("px")||(n="0"),o&&-1!==o.indexOf("px")||(o="0"),{w:parseInt(n,10)||r.offsetWidth||r.clientWidth,h:parseInt(o,10)||r.offsetHeight||r.clientHeight}},w=(t,r)=>{if(!t)return!1;let n=O(t)?t:[t];return eo(n,t=>rm(rl(t),r))},E=(t,r,n,o)=>{let a=[],l=f(t);o=void 0===o;let i=n||("BODY"!==v().nodeName?v().parentNode:null);if(N(r)){if("*"===r)r=nC;else{let t=r;r=r=>w(r,t)}}for(;l&&!(l===i||P(l.nodeType)||nD(l)||nP(l));){if(!r||r(l)){if(!o)return[l];a.push(l)}l=l.parentNode}return o?a:null},k=(t,r,n)=>{let o=r;if(t){N(r)&&(o=t=>w(t,r));for(let r=t[n];r;r=r[n])if(M(o)&&o(r))return r}return null},S=function(t,r,n){let o=null!=n?n:this;if(O(t)){let n=[];return aE(t,(t,a)=>{let l=f(t);l&&n.push(r.call(o,l,a))}),n}{let n=f(t);return!!n&&r.call(o,n)}},_=(t,r)=>{S(t,t=>{eA(r,(r,n)=>{b(t,n,r)})})},R=(t,r)=>{S(t,t=>{let n=rl(t);no(n,r)})},A=(r,n,o,a,l)=>S(r,r=>{let i=N(n)?t.createElement(n):n;return L(o)&&_(i,o),a&&(!N(a)&&a.nodeType?i.appendChild(a):N(a)&&R(i,a)),l?i:r.appendChild(i)}),T=(r,n,o)=>A(t.createElement(r),r,n,o,!0),B=o7.encodeAllRaw,D=(t,r)=>S(t,t=>{let n=rl(t);return r&&el(r_(n),t=>{tY(t)&&0===t.dom.length?ne(t):r3(n,t)}),ne(n),n.dom}),F=(t,r,n)=>{S(t,t=>{if(nC(t)){let o=rl(t),a=r.split(" ");el(a,t=>{L(n)?(n?rr:ro)(o,t):(t4(o)?o.dom.classList.toggle(t):en(t7(o),t)?rt(o,t):re(o,t),rn(o))})}})},I=(t,r,n)=>S(r,o=>{var a;let l=O(r)?t.cloneNode(!0):t;return n&&aE(ak(o.childNodes),t=>{l.appendChild(t)}),null===(a=o.parentNode)||void 0===a||a.replaceChild(l,o),o}),z=t=>{if(nC(t)){let r="a"===t.nodeName.toLowerCase()&&!p(t,"href")&&p(t,"id");if(p(t,"name")||p(t,"data-mce-bookmark")||r)return!0}return!1},j=()=>t.createRange(),$=(n,a,l,i)=>{if(O(n)){let t=n.length,r=[];for(;t--;)r[t]=$(n[t],a,l,i);return r}return r.collect&&(n===t||n===o)&&s.push([n,a,l,i]),u.bind(n,a,l,i||W)},V=(r,n,a)=>{if(O(r)){let t=r.length,o=[];for(;t--;)o[t]=V(r[t],n,a);return o}if(s.length>0&&(r===t||r===o)){let t=s.length;for(;t--;){let[o,l,i]=s[t];r!==o||n&&n!==l||a&&a!==i||u.unbind(o,l,i)}}return u.unbind(r,n,a)},q=t=>{if(t&&nC(t)){let r=t.getAttribute("data-mce-contenteditable");return r&&"inherit"!==r?r:"inherit"!==t.contentEditable?t.contentEditable:null}return null},W={doc:t,settings:r,win:o,files:a,stdMode:!0,boxModel:!0,styleSheetLoader:i,boundEvents:s,styles:c,schema:d,events:u,isBlock:t=>N(t)?eI(m,t):nC(t)&&(eI(m,t.nodeName)||oU(d,t)),root:null,clone:(t,r)=>t.cloneNode(r),getRoot:v,getViewPort:t=>{let r=nf(t);return{x:r.x,y:r.y,w:r.width,h:r.height}},getRect:t=>{let r=f(t),n=y(r),o=x(r);return{x:n.x,y:n.y,w:o.w,h:o.h}},getSize:x,getParent:(t,r,n)=>{let o=E(t,r,n,!1);return o&&o.length>0?o[0]:null},getParents:E,get:f,getNext:(t,r)=>k(t,r,"nextSibling"),getPrev:(t,r)=>k(t,r,"previousSibling"),select:(n,o)=>{var a,l;let i=null!==(l=null!==(a=f(o))&&void 0!==a?a:r.root_element)&&void 0!==l?l:t;return M(i.querySelectorAll)?eS(i.querySelectorAll(n)):[]},is:w,add:A,create:T,createHTML:(t,r,n="")=>{let o="<"+t;for(let t in r)eU(r,t)&&(o+=" "+t+'="'+B(r[t])+'"');return te(n)&&eI(d.getVoidElements(),t)?o+" />":o+">"+n+"</"+t+">"},createFragment:r=>{let n;let o=t.createElement("div"),a=t.createDocumentFragment();for(a.appendChild(o),r&&(o.innerHTML=r);n=o.firstChild;)a.appendChild(n);return a.removeChild(o),a},remove:D,setStyle:(t,n,o)=>{S(t,t=>{let a=rl(t);aT(a,n,o),r.update_styles&&aO(c,a)})},getStyle:C,setStyles:(t,n)=>{S(t,t=>{let o=rl(t);eA(n,(t,r)=>{aT(o,r,t)}),r.update_styles&&aO(c,o)})},removeAllAttribs:t=>S(t,t=>{let r=t.attributes;for(let n=r.length-1;n>=0;n--)t.removeAttributeNode(r.item(n))}),setAttrib:b,setAttribs:_,getAttrib:p,getPos:y,parseStyle:t=>c.parse(t),serializeStyle:(t,r)=>c.serialize(t,r),addStyle:r=>{if(W!==aB.DOM&&t===document){if(n[r])return;n[r]=!0}let o=t.getElementById("mceDefaultStyles");if(!o){(o=t.createElement("style")).id="mceDefaultStyles",o.type="text/css";let r=t.head;r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o)}o.styleSheet?o.styleSheet.cssText+=r:o.appendChild(t.createTextNode(r))},loadCSS:t=>{t||(t=""),el(t.split(","),t=>{a[t]=!0,i.load(t).catch(U)})},addClass:(t,r)=>{F(t,r,!0)},removeClass:(t,r)=>{F(t,r,!1)},hasClass:(t,r)=>{let n=g(t),o=r.split(" ");return L(n)&&eb(o,t=>ra(n,t))},toggleClass:F,show:t=>{S(t,t=>r2(rl(t),"display"))},hide:t=>{S(t,t=>rX(rl(t),"display","none"))},isHidden:t=>{let r=g(t);return L(r)&&tF(r0(r,"display"),"none")},uniqueId:t=>(t||"mce_")+l++,setHTML:R,getOuterHTML:t=>{let r=g(t);return L(r)?nC(r.dom)?r.dom.outerHTML:(t=>{let r=rs("div"),n=rl(t.dom.cloneNode(!0));return r6(r,n),nn(r)})(r):""},setOuterHTML:(t,r)=>{S(t,t=>{nC(t)&&(t.outerHTML=r)})},decode:o7.decode,encode:B,insertAfter:(t,r)=>{let n=f(r);return S(t,t=>{let r=null==n?void 0:n.parentNode,o=null==n?void 0:n.nextSibling;return r&&(o?r.insertBefore(t,o):r.appendChild(t)),t})},replace:I,rename:(t,r)=>{if(t.nodeName!==r.toUpperCase()){let n=T(r);return aE(h(t),r=>{b(n,r.nodeName,p(t,r.nodeName))}),I(n,t,!0),n}return t},findCommonAncestor:(t,r)=>{let n=t;for(;n;){let t=r;for(;t&&n!==t;)t=t.parentNode;if(n===t)break;n=n.parentNode}return!n&&t.ownerDocument?t.ownerDocument.documentElement:n},run:S,getAttribs:h,isEmpty:(t,r,n)=>{let o=0;if(z(t))return!1;let a=t.firstChild;if(a){let l=new nb(a,t),i=d?d.getWhitespaceElements():{},s=r||(d?d.getNonEmptyElements():null),c=a;do{if(nC(c)){let t=c.getAttribute("data-mce-bogus");if(t){c=l.next("all"===t);continue}let r=c.nodeName.toLowerCase();if(s&&s[r]){if("br"===r){o++,c=l.next();continue}return!1}if(z(c))return!1}if(nB(c)||nA(c)&&!oy(c.data)&&(!(null==n?void 0:n.includeZwsp)||!oC(c.data))||nA(c)&&c.parentNode&&i[c.parentNode.nodeName]&&oy(c.data))return!1;c=l.next()}while(c)}return o<=1},createRng:j,nodeIndex:aA,split:(t,r,n)=>{let o,a,l=j();if(t&&r&&t.parentNode&&r.parentNode){let i=t.parentNode;return l.setStart(i,aA(t)),l.setEnd(r.parentNode,aA(r)),o=l.extractContents(),(l=j()).setStart(r.parentNode,aA(r)+1),l.setEnd(i,aA(t)+1),a=l.extractContents(),i.insertBefore(oY(W,o),t),n?i.insertBefore(n,t):i.insertBefore(r,t),i.insertBefore(oY(W,a),t),D(t),n||r}},bind:$,unbind:V,fire:(t,r,n)=>u.dispatch(t,r,n),dispatch:(t,r,n)=>u.dispatch(t,r,n),getContentEditable:q,getContentEditableParent:t=>{let r=v(),n=null;for(let o=t;o&&o!==r&&null===(n=q(o));o=o.parentNode);return n},isEditable:t=>{if(L(t)){let r=nC(t)?t:t.parentElement;return L(r)&&rW(rl(r))}return!1},destroy:()=>{if(s.length>0){let t=s.length;for(;t--;){let[r,n,o]=s[t];u.unbind(r,n,o)}}eA(a,(t,r)=>{i.unload(r),delete a[r]})},isChildOf:(t,r)=>t===r||r.contains(t),dumpRng:t=>"startContainer: "+t.startContainer.nodeName+", startOffset: "+t.startOffset+", endContainer: "+t.endContainer.nodeName+", endOffset: "+t.endOffset},K=((t,r,n)=>{let o=r.keep_values,a={set:(t,o,a)=>{let l=rl(t);M(r.url_converter)&&L(o)&&(o=r.url_converter.call(r.url_converter_scope||n(),String(o),a,t)),aN(l,"data-mce-"+a,o),aN(l,a,o)},get:(t,r)=>{let n=rl(t);return t2(n,"data-mce-"+r)||t2(n,r)}},l={style:{set:(r,n)=>{let a=rl(r);o&&aN(a,aS,n),t5(a,"style"),N(n)&&rQ(a,t.parse(n))},get:r=>{let n=rl(r),o=t2(n,aS)||t2(n,"style");return t.serialize(t.parse(o),tV(n))}}};return o&&(l.href=l.src=a),l})(c,r,H(W));return W};aB.DOM=aB(document),aB.nodeIndex=aA;let aD=aB.DOM;class aP{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((r,n)=>{let o;let a=()=>{aD.remove(l),o&&(o.onerror=o.onload=o=null)},l=aD.uniqueId();(o=document.createElement("script")).id=l,o.type="text/javascript",o.src=tM._addCacheSuffix(t),this.settings.referrerPolicy&&aD.setAttrib(o,"referrerpolicy",this.settings.referrerPolicy),o.onload=()=>{a(),r()},o.onerror=()=>{a(),n("Failed to load script: "+t)},(document.getElementsByTagName("head")[0]||document.body).appendChild(o)})}isDone(t){return 2===this.states[t]}markDone(t){this.states[t]=2}add(t){let r=this;return r.queue.push(t),void 0===r.states[t]&&(r.states[t]=0),new Promise((n,o)=>{r.scriptLoadedCallbacks[t]||(r.scriptLoadedCallbacks[t]=[]),r.scriptLoadedCallbacks[t].push({resolve:n,reject:o})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){let t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){let r=this,n=(t,n)=>{eF(r.scriptLoadedCallbacks,n).each(r=>{el(r,r=>r[t](n))}),delete r.scriptLoadedCallbacks[n]},o=t=>{let r=ed(t,t=>"rejected"===t.status);return r.length>0?Promise.reject(eh(r,({reason:t})=>O(t)?t:[t])):Promise.resolve()},a=t=>Promise.allSettled(ea(t,t=>2===r.states[t]?(n("resolve",t),Promise.resolve()):3===r.states[t]?(n("reject",t),Promise.reject(t)):(r.states[t]=1,r.loadScript(t).then(()=>{r.states[t]=2,n("resolve",t);let l=r.queue;return l.length>0?(r.queue=[],a(l).then(o)):Promise.resolve()},()=>(r.states[t]=3,n("reject",t),Promise.reject(t)))))),l=t=>(r.loading=!0,a(t).then(t=>{r.loading=!1;let n=r.queueLoadedCallbacks.shift();return J.from(n).each(Y),o(t)})),i=ez(t);return r.loading?new Promise((t,n)=>{r.queueLoadedCallbacks.push(()=>{l(i).then(t,n)})}):l(i)}}aP.ScriptLoader=new aP;let aL=t=>{let r=t;return{get:()=>r,set:t=>{r=t}}},aM={},aF=aL("en"),aI=()=>eF(aM,aF.get()),aU={getData:()=>eO(aM,t=>({...t})),setCode:t=>{t&&aF.set(t)},getCode:()=>aF.get(),add:(t,r)=>{let n=aM[t];n||(aM[t]=n={}),eA(r,(t,r)=>{n[r.toLowerCase()]=t})},translate:t=>{let r=aI().getOr({}),n=t=>M(t)?Object.prototype.toString.call(t):o(t)?"":""+t,o=t=>""===t||null==t,a=t=>{let o=n(t);return eF(r,o.toLowerCase()).map(n).getOr(o)},l=t=>t.replace(/{context:\w+}$/,"");if(o(t))return"";if(R(t)&&eI(t,"raw"))return n(t.raw);if(O(t)&&t.length>1){let r=t.slice(1);return l(a(t[0]).replace(/\{([0-9]+)\}/g,(t,o)=>eI(r,o)?n(r[o]):t))}return l(a(t))},isRtl:()=>aI().bind(t=>eF(t,"_dir")).exists(t=>"rtl"===t),hasCode:t=>eI(aM,t)},az=()=>{let t=[],r={},n={},o=[],a=(t,r)=>{let n=ed(o,n=>n.name===t&&n.state===r);el(n,t=>t.resolve())},l=t=>eI(r,t),i=(t,n)=>{let o=aU.getCode();!o||n&&-1===(","+(n||"")+",").indexOf(","+o+",")||aP.ScriptLoader.add(r[t]+"/langs/"+o+".js")},s=(t,r="added")=>"added"===r&&eI(n,t)||"loaded"===r&&l(t)?Promise.resolve():new Promise(n=>{o.push({name:t,state:r,resolve:n})});return{items:t,urls:r,lookup:n,get:t=>{if(n[t])return n[t].instance},requireLangPack:(t,r)=>{!1!==az.languageLoad&&(l(t)?i(t,r):s(t,"loaded").then(()=>i(t,r)))},add:(r,o)=>(t.push(o),n[r]={instance:o},a(r,"added"),o),remove:t=>{delete r[t],delete n[t]},createUrl:(t,r)=>N(r)?N(t)?{prefix:"",resource:r,suffix:""}:{prefix:t.prefix,resource:r,suffix:t.suffix}:r,load:(t,o)=>{if(r[t])return Promise.resolve();let l=N(o)?o:o.prefix+o.resource+o.suffix;0!==l.indexOf("/")&&-1===l.indexOf("://")&&(l=az.baseURL+"/"+l),r[t]=l.substring(0,l.lastIndexOf("/"));let i=()=>(a(t,"loaded"),Promise.resolve());return n[t]?i():aP.ScriptLoader.add(l).then(i)},waitFor:s}};az.languageLoad=!0,az.baseURL="",az.PluginManager=az(),az.ThemeManager=az(),az.ModelManager=az();let aj=t=>{let r=aL(J.none()),n=()=>r.get().each(t=>clearInterval(t));return{clear:()=>{n(),r.set(J.none())},isSet:()=>r.get().isSome(),get:()=>r.get(),set:o=>{n(),r.set(J.some(setInterval(o,t)))}}},aH=()=>{let t=(t=>{let r=aL(J.none()),n=()=>r.get().each(t);return{clear:()=>{n(),r.set(J.none())},isSet:()=>r.get().isSome(),get:()=>r.get(),set:t=>{n(),r.set(J.some(t))}}})(U);return{...t,on:r=>t.get().each(r)}},a$=(t,r)=>{let n=null;return{cancel:()=>{T(n)||(clearTimeout(n),n=null)},throttle:(...o)=>{T(n)&&(n=setTimeout(()=>{n=null,t.apply(null,o)},r))}}},aV=(t,r)=>{let n=null,o=()=>{T(n)||(clearTimeout(n),n=null)};return{cancel:o,throttle:(...a)=>{o(),n=setTimeout(()=>{n=null,t.apply(null,a)},r)}}},aq=H("mce-annotation"),aW=H("data-mce-annotation"),aK=H("data-mce-annotation-uid"),aG=H("data-mce-annotation-active"),aY=H("data-mce-annotation-classes"),aX=H("data-mce-annotation-attrs"),aQ=t=>r=>rg(r,t),aJ=(t,r)=>{let n=t.selection.getRng(),o=rl(n.startContainer),a=rl(t.getBody()),l=r.fold(()=>"."+aq(),t=>`[${aW()}="${t}"]`),i=rN(o,n.startOffset).getOr(o);return rq(i,l,aQ(a)).bind(r=>t3(r,`${aK()}`).bind(n=>t3(r,`${aW()}`).map(r=>{let o=a0(t,n);return{uid:n,name:r,elements:o}})))},aZ=(t,r)=>t8(t,"data-mce-bogus")||nh(t,'[data-mce-bogus="all"]',aQ(r)),a0=(t,r)=>{let n=rl(t.getBody()),o=np(n,`[${aK()}="${r}"]`);return ed(o,t=>!aZ(t,n))},a1=(t,r)=>{let n=rl(t.getBody()),o=np(n,`[${aW()}="${r}"]`),a={};return el(o,t=>{if(!aZ(t,n)){let r=t2(t,aK()),n=eF(a,r).getOr([]);a[r]=n.concat([t])}}),a},a2=0,a3=t=>{let r=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++a2+String(r)},a8=(t,r)=>rl(t.dom.cloneNode(r)),a5=t=>a8(t,!1),a6=t=>a8(t,!0),a9=(t,r)=>{let n=((t,r)=>{let n=rs(r),o=t6(t);return t1(n,o),n})(t,r);r8(t,n);let o=r_(t);return r4(n,o),ne(t),n},a4=(t,r,n=X)=>{let o=new nb(t,r),a=t=>{let r;do r=o[t]();while(r&&!nA(r)&&!n(r));return J.from(r).filter(nA)};return{current:()=>J.from(o.current()).filter(nA),next:()=>a("next"),prev:()=>a("prev"),prev2:()=>a("prev2")}},a7=(t,r)=>{let n=r||(r=>t.isBlock(r)||nL(r)||nI(r)),o=(t,r,n,a)=>{if(nA(t)){let n=a(t,r,t.data);if(-1!==n)return J.some({container:t,offset:n})}return n().bind(t=>o(t.container,t.offset,n,a))};return{backwards:(r,a,l,i)=>{let s=a4(r,null!=i?i:t.getRoot(),n);return o(r,a,()=>s.prev().map(t=>({container:t,offset:t.length})),l).getOrNull()},forwards:(r,a,l,i)=>{let s=a4(r,null!=i?i:t.getRoot(),n);return o(r,a,()=>s.next().map(t=>({container:t,offset:0})),l).getOrNull()}}},le=Math.round,lt=t=>t?{left:le(t.left),top:le(t.top),bottom:le(t.bottom),right:le(t.right),width:le(t.width),height:le(t.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},lr=(t,r)=>(t=lt(t),r||(t.left=t.left+t.width),t.right=t.left,t.width=0,t),ln=(t,r,n)=>t>=0&&t<=Math.min(r.height,n.height)/2,lo=(t,r)=>{let n=Math.min(r.height/2,t.height/2);return t.bottom-n<r.top||!(t.top>r.bottom)&&ln(r.top-t.bottom,t,r)},la=(t,r)=>t.top>r.bottom||!(t.bottom<r.top)&&ln(r.bottom-t.top,t,r),ll=(t,r,n)=>{let o=Math.max(Math.min(r,t.left+t.width),t.left),a=Math.max(Math.min(n,t.top+t.height),t.top);return Math.sqrt((r-o)*(r-o)+(n-a)*(n-a))},li=t=>{let r=t.startContainer,n=t.startOffset;return r===t.endContainer&&r.hasChildNodes()&&t.endOffset===n+1?r.childNodes[n]:null},ls=(t,r)=>{if(nC(t)&&t.hasChildNodes()){let n=t.childNodes,o=Math.min(Math.max(r,0),n.length-1);return n[o]}return t},ld=RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),lc=t=>N(t)&&t.charCodeAt(0)>=768&&ld.test(t),lu=nE("display","block table"),lm=nE("float","left right"),lf=((...t)=>r=>{for(let n=0;n<t.length;n++)if(!t[n](r))return!1;return!0})(nC,op,W(lm)),lg=W(nE("white-space","pre pre-line pre-wrap")),lp=aB.nodeIndex,lh=(t,r)=>r<0&&nC(t)&&t.hasChildNodes()?void 0:ls(t,r),lb=t=>t?t.createRange():aB.DOM.createRng(),lv=t=>N(t)&&/[\r\n\t ]/.test(t),ly=t=>!!t.setStart&&!!t.setEnd,lC=t=>{let r=t.startContainer,n=t.startOffset;if(lv(t.toString())&&lg(r.parentNode)&&nA(r)){let t=r.data;if(lv(t[n-1])||lv(t[n+1]))return!0}return!1},lx=t=>0===t.left&&0===t.right&&0===t.top&&0===t.bottom,lw=t=>{var r;let n;let o=t.getClientRects();return n=o.length>0?lt(o[0]):lt(t.getBoundingClientRect()),!ly(t)&&nL(t)&&lx(n)?(t=>{let r=t.ownerDocument,n=lb(r),o=r.createTextNode("\xa0"),a=t.parentNode;a.insertBefore(o,t),n.setStart(o,0),n.setEnd(o,1);let l=lt(n.getBoundingClientRect());return a.removeChild(o),l})(t):lx(n)&&ly(t)&&null!==(r=(t=>{let r=t.startContainer,n=t.endContainer,o=t.startOffset,a=t.endOffset;if(r===n&&nA(n)&&0===o&&1===a){let r=t.cloneRange();return r.setEndAfter(n),lw(r)}return null})(t))&&void 0!==r?r:n},lE=(t,r)=>{let n=lr(t,r);return n.width=1,n.right=n.left+1,n},lk=(t,r,n)=>{let o=()=>(n||(n=(t=>{let r=[],n=t=>{var n;0!==t.height&&(r.length>0&&(n=r[r.length-1],t.left===n.left&&t.top===n.top&&t.bottom===n.bottom&&t.right===n.right)||r.push(t))},o=(t,r)=>{let o=lb(t.ownerDocument);if(r<t.data.length){if(lc(t.data[r]))return;if(lc(t.data[r-1])&&(o.setStart(t,r),o.setEnd(t,r+1),!lC(o)))return void n(lE(lw(o),!1))}r>0&&(o.setStart(t,r-1),o.setEnd(t,r),lC(o)||n(lE(lw(o),!1))),r<t.data.length&&(o.setStart(t,r),o.setEnd(t,r+1),lC(o)||n(lE(lw(o),!0)))},a=t.container(),l=t.offset();if(nA(a))return o(a,l),r;if(nC(a)){if(t.isAtEnd()){let t=lh(a,l);nA(t)&&o(t,t.data.length),lf(t)&&!nL(t)&&n(lE(lw(t),!1))}else{let i=lh(a,l);if(nA(i)&&o(i,0),lf(i)&&t.isAtEnd())return n(lE(lw(i),!1)),r;let s=lh(t.container(),t.offset()-1);lf(s)&&!nL(s)&&(lu(s)||lu(i)||!lf(i))&&n(lE(lw(s),!1)),lf(i)&&n(lE(lw(i),!0))}}return r})(lk(t,r))),n);return{container:H(t),offset:H(r),toRange:()=>{let n=lb(t.ownerDocument);return n.setStart(t,r),n.setEnd(t,r),n},getClientRects:o,isVisible:()=>o().length>0,isAtStart:()=>(nA(t),0===r),isAtEnd:()=>nA(t)?r>=t.data.length:r>=t.childNodes.length,isEqual:n=>n&&t===n.container()&&r===n.offset(),getNode:n=>lh(t,n?r-1:r)}};lk.fromRangeStart=t=>lk(t.startContainer,t.startOffset),lk.fromRangeEnd=t=>lk(t.endContainer,t.endOffset),lk.after=t=>lk(t.parentNode,lp(t)+1),lk.before=t=>lk(t.parentNode,lp(t)),lk.isAbove=(t,r)=>tI(eE(r.getClientRects()),ek(t.getClientRects()),lo).getOr(!1),lk.isBelow=(t,r)=>tI(ek(r.getClientRects()),eE(t.getClientRects()),la).getOr(!1),lk.isAtStart=t=>!!t&&t.isAtStart(),lk.isAtEnd=t=>!!t&&t.isAtEnd(),lk.isTextPosition=t=>!!t&&nA(t.container()),lk.isElementPosition=t=>!lk.isTextPosition(t);let lS=(t,r)=>{nA(r)&&0===r.data.length&&t.remove(r)},l_=(t,r,n)=>{nP(n)?((t,r,n)=>{let o=J.from(n.firstChild),a=J.from(n.lastChild);r.insertNode(n),o.each(r=>lS(t,r.previousSibling)),a.each(r=>lS(t,r.nextSibling))})(t,r,n):(r.insertNode(n),lS(t,n.previousSibling),lS(t,n.nextSibling))},lN=aB.nodeIndex,lR=t=>{let r=t.parentNode;return nS(r)?lR(r):r},lA=t=>t?eW(t.childNodes,(t,r)=>(nS(r)&&"BR"!==r.nodeName?t=t.concat(lA(r)):t.push(r),t),[]):[],lO=t=>r=>t===r,lT=t=>(nA(t)?"text()":t.nodeName.toLowerCase())+"["+(t=>{let r,n;n=eK(r=lA(lR(t)),lO(t),t),r=r.slice(0,n+1);let o=eW(r,(t,n,o)=>(nA(n)&&nA(r[o-1])&&t++,t),0);return(n=eK(r=eq(r,nw([t.nodeName])),lO(t),t))-o})(t)+"]",lB=(t,r)=>{let n,o=[],a=r.container(),l=r.offset();if(nA(a))n=((t,r)=>{let n=t;for(;(n=n.previousSibling)&&nA(n);)r+=n.data.length;return r})(a,l);else{let t=a.childNodes;l>=t.length?(n="after",l=t.length-1):n="before",a=t[l]}o.push(lT(a));let i=((t,r,n)=>{let o=[];for(let n=r.parentNode;n&&n!==t;n=n.parentNode)o.push(n);return o})(t,a);return i=eq(i,W(nS)),(o=o.concat(eV(i,t=>lT(t)))).reverse().join("/")+","+n},lD=(t,r)=>{if(!r)return null;let n=r.split(","),o=n[0].split("/"),a=n.length>1?n[1]:"before",l=eW(o,(t,r)=>{var n,o;let a;let l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(r);return l?("text()"===l[1]&&(l[1]="#text"),n=l[1],o=parseInt(l[2],10),a=eq(a=lA(t),(t,r)=>!nA(t)||!nA(a[r-1])),(a=eq(a,nw([n])))[o]):null},t);if(!l)return null;if(!nA(l)&&l.parentNode){let t;return t="after"===a?lN(l)+1:lN(l),lk(l.parentNode,t)}return((t,r)=>{let n=t,o=0;for(;nA(n);){let a=n.data.length;if(r>=o&&r<=o+a){t=n,r-=o;break}if(!nA(n.nextSibling)){t=n,r=a;break}o+=a,n=n.nextSibling}return nA(t)&&r>t.data.length&&(r=t.data.length),lk(t,r)})(l,parseInt(a,10))},lP=(t,r,n,o,a)=>{let l=a?o.startContainer:o.endContainer,i=a?o.startOffset:o.endOffset,s=[],d=t.getRoot();if(nA(l))s.push(n?((t,r,n)=>{let o=t(r.data.slice(0,n)).length;for(let n=r.previousSibling;n&&nA(n);n=n.previousSibling)o+=t(n.data).length;return o})(r,l,i):i);else{let r=0,o=l.childNodes;i>=o.length&&o.length&&(r=1,i=Math.max(0,o.length-1)),s.push(t.nodeIndex(o[i],n)+r)}for(let r=l;r&&r!==d;r=r.parentNode)s.push(t.nodeIndex(r,n));return s},lL=(t,r,n)=>{let o=0;return tM.each(t.select(r),t=>"all"===t.getAttribute("data-mce-bogus")?void 0:t!==n&&void o++),o},lM=(t,r)=>{let n=r?t.startContainer:t.endContainer,o=r?t.startOffset:t.endOffset;if(nC(n)&&"TR"===n.nodeName){let a=n.childNodes;(n=a[Math.min(r?o:o-1,a.length-1)])&&(o=r?0:n.childNodes.length,r?t.setStart(n,o):t.setEnd(n,o))}},lF=t=>(lM(t,!0),lM(t,!1),t),lI=(t,r)=>{if(nC(t)&&nI(t=ls(t,r)))return t;if(oo(t)){nA(t)&&or(t)&&(t=t.parentNode);let r=t.previousSibling;if(nI(r)||nI(r=t.nextSibling))return r}},lU=(t,r,n)=>{let o=n.getNode(),a=n.getRng();if("IMG"===o.nodeName||nI(o)){let t=o.nodeName;return{name:t,index:lL(n.dom,t,o)}}let l=lI(a.startContainer,a.startOffset)||lI(a.endContainer,a.endOffset);if(l){let t=l.tagName;return{name:t,index:lL(n.dom,t,l)}}return((t,r,n,o)=>{let a=r.dom,l=lP(a,t,n,o,!0),i=r.isForward(),s=ou(o)?{isFakeCaret:!0}:{};return r.isCollapsed()?{start:l,forward:i,...s}:{start:l,end:lP(a,t,n,o,!1),forward:i,...s}})(t,n,r,a)},lz=(t,r,n)=>{let o={"data-mce-type":"bookmark",id:r,style:"overflow:hidden;line-height:0px"};return n?t.create("span",o,"&#xFEFF;"):t.create("span",o)},lj=(t,r)=>{let n=t.dom,o=t.getRng(),a=n.uniqueId(),l=t.isCollapsed(),i=t.getNode(),s=i.nodeName,d=t.isForward();if("IMG"===s)return{name:s,index:lL(n,s,i)};let c=lF(o.cloneRange());if(!l){c.collapse(!1);let t=lz(n,a+"_end",r);l_(n,c,t)}(o=lF(o)).collapse(!0);let u=lz(n,a+"_start",r);return l_(n,o,u),t.moveToBookmark({id:a,keep:!0,forward:d}),{id:a,forward:d}},lH=q(lU,$,!0),l$=t=>{let r=r=>r(t),n=H(t),o={tag:!0,inner:t,fold:(r,n)=>n(t),isValue:Q,isError:X,map:r=>lq.value(r(t)),mapError:()=>o,bind:r,exists:r,forall:r,getOr:n,or:()=>o,getOrThunk:n,orThunk:()=>o,getOrDie:n,each:r=>{r(t)},toOptional:()=>J.some(t)};return o},lV=t=>{let r={tag:!1,inner:t,fold:(r,n)=>r(t),isValue:X,isError:Q,map:()=>r,mapError:r=>lq.error(r(t)),bind:()=>r,exists:X,forall:Q,getOr:$,or:$,getOrThunk:G,orThunk:G,getOrDie:K(String(t)),each:U,toOptional:J.none};return r},lq={value:l$,error:lV,fromOption:(t,r)=>t.fold(()=>lV(r),l$)},lW=t=>{if(!O(t))throw Error("cases must be an array");if(0===t.length)throw Error("there must be at least one case");let r=[],n={};return el(t,(o,a)=>{let l=eN(o);if(1!==l.length)throw Error("one and only one name per case");let i=l[0],s=o[i];if(void 0!==n[i])throw Error("duplicate key detected:"+i);if("cata"===i)throw Error("cannot have a case named cata (sorry)");if(!O(s))throw Error("case arguments must be an array");r.push(i),n[i]=(...n)=>{let o=n.length;if(o!==s.length)throw Error("Wrong number of arguments to case "+i+". Expected "+s.length+" ("+s+"), got "+o);return{fold:(...r)=>{if(r.length!==t.length)throw Error("Wrong number of arguments to fold. Expected "+t.length+", got "+r.length);return r[a].apply(null,n)},match:t=>{let o=eN(t);if(r.length!==o.length)throw Error("Wrong number of arguments to match. Expected: "+r.join(",")+"\nActual: "+o.join(","));if(!eb(r,t=>en(o,t)))throw Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+r.join(", "));return t[i].apply(null,n)},log:t=>{console.log(t,{constructors:r,constructor:i,params:n})}}}}),n};lW([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let lK=t=>"inline-command"===t.type||"inline-format"===t.type,lG=t=>"block-command"===t.type||"block-format"===t.type,lY=t=>{let r=r=>lq.error({message:r,pattern:t}),n=(n,o,a)=>{if(void 0!==t.format){let a;if(O(t.format)){if(!eb(t.format,N))return r(n+" pattern has non-string items in the `format` array");a=t.format}else{if(!N(t.format))return r(n+" pattern has non-string `format` parameter");a=[t.format]}return lq.value(o(a))}return void 0!==t.cmd?N(t.cmd)?lq.value(a(t.cmd,t.value)):r(n+" pattern has non-string `cmd` parameter"):r(n+" pattern is missing both `format` and `cmd` parameters")};if(!R(t))return r("Raw pattern is not an object");if(!N(t.start))return r("Raw pattern is missing `start` parameter");if(void 0!==t.end){if(!N(t.end))return r("Inline pattern has non-string `end` parameter");if(0===t.start.length&&0===t.end.length)return r("Inline pattern has empty `start` and `end` parameters");let o=t.start,a=t.end;return 0===a.length&&(a=o,o=""),n("Inline",t=>({type:"inline-format",start:o,end:a,format:t}),(t,r)=>({type:"inline-command",start:o,end:a,cmd:t,value:r}))}return void 0!==t.replacement?N(t.replacement)?0===t.start.length?r("Replacement pattern has empty `start` parameter"):lq.value({type:"inline-command",start:"",end:t.start,cmd:"mceInsertContent",value:t.replacement}):r("Replacement pattern has non-string `replacement` parameter"):0===t.start.length?r("Block pattern has empty `start` parameter"):n("Block",r=>({type:"block-format",start:t.start,format:r[0]}),(r,n)=>({type:"block-command",start:t.start,cmd:r,value:n}))},lX=t=>ed(t,lG),lQ=t=>ed(t,lK),lJ=t=>{let r=(t=>{let r=[],n=[];return el(t,t=>{t.fold(t=>{r.push(t)},t=>{n.push(t)})}),{errors:r,values:n}})(ea(t,lY));return el(r.errors,t=>console.error(t.message,t.pattern)),r.values},lZ=tS().deviceType,l0=lZ.isTouch(),l1=aB.DOM,l2=t=>_(t,RegExp),l3=t=>r=>r.options.get(t),l8=t=>N(t)||R(t),l5=(t,r="")=>n=>{let o=N(n);if(o){if(-1!==n.indexOf("=")){let a=(t=>{let r=t.indexOf("=")>0?t.split(/[;,](?![^=;,]*(?:[;,]|$))/):t.split(",");return eu(r,(t,r)=>{let n=r.split("="),o=n[0],a=n.length>1?n[1]:o;return t[e6(o)]=e6(a),t},{})})(n);return{value:eF(a,t.id).getOr(r),valid:o}}return{value:n,valid:o}}return{valid:!1,message:"Must be a string."}},l6=l3("iframe_attrs"),l9=l3("doctype"),l4=l3("document_base_url"),l7=l3("body_id"),ie=l3("body_class"),it=l3("content_security_policy"),ir=l3("br_in_pre"),io=l3("forced_root_block"),ia=l3("forced_root_block_attrs"),il=l3("newline_behavior"),ii=l3("br_newline_selector"),is=l3("no_newline_selector"),id=l3("keep_styles"),ic=l3("end_container_on_empty_block"),iu=l3("automatic_uploads"),im=l3("images_reuse_filename"),ig=l3("images_replace_blob_uris"),ip=l3("icons"),ih=l3("icons_url"),ib=l3("images_upload_url"),iv=l3("images_upload_base_path"),iy=l3("images_upload_credentials"),iC=l3("images_upload_handler"),ix=l3("content_css_cors"),iw=l3("referrer_policy"),iE=l3("language"),ik=l3("language_url"),iS=l3("indent_use_margin"),i_=l3("indentation"),iN=l3("content_css"),iR=l3("content_style"),iA=l3("font_css"),iO=l3("directionality"),iT=l3("inline_boundaries_selector"),iB=l3("object_resizing"),iD=l3("resize_img_proportional"),iP=l3("placeholder"),iL=l3("event_root"),iM=l3("service_message"),iF=l3("theme"),iI=l3("theme_url"),iU=l3("model"),iz=l3("model_url"),ij=l3("inline_boundaries"),iH=l3("formats"),i$=l3("preview_styles"),iV=l3("format_empty_lines"),iq=l3("format_noneditable_selector"),iW=l3("custom_ui_selector"),iK=l3("inline"),iG=l3("hidden_input"),iY=l3("submit_patch"),iX=l3("add_form_submit_trigger"),iQ=l3("add_unload_trigger"),iJ=l3("custom_undo_redo_levels"),iZ=l3("disable_nodechange"),i0=l3("readonly"),i1=l3("editable_root"),i2=l3("content_css_cors"),i3=l3("plugins"),i8=l3("external_plugins"),i5=l3("block_unsupported_drop"),i6=l3("visual"),i9=l3("visual_table_class"),i4=l3("visual_anchor_class"),i7=l3("iframe_aria_text"),se=l3("setup"),st=l3("init_instance_callback"),sr=l3("urlconverter_callback"),sn=l3("auto_focus"),so=l3("browser_spellcheck"),sa=l3("protect"),sl=l3("paste_block_drop"),si=l3("paste_data_images"),ss=l3("paste_preprocess"),sd=l3("paste_postprocess"),sc=l3("newdocument_content"),su=l3("paste_webkit_styles"),sm=l3("paste_remove_styles_if_webkit"),sf=l3("paste_merge_formats"),sg=l3("smart_paste"),sp=l3("paste_as_text"),sh=l3("paste_tab_spaces"),sb=l3("allow_html_data_urls"),sv=l3("text_patterns"),sy=l3("text_patterns_lookup"),sC=l3("noneditable_class"),sx=l3("editable_class"),sw=l3("noneditable_regexp"),sE=l3("preserve_cdata"),sk=l3("highlight_on_focus"),sS=l3("xss_sanitization"),s_=l3("init_content_sync"),sN=t=>tM.explode(t.options.get("images_file_types")),sR=l3("table_tab_navigation"),sA=l3("details_initial_state"),sO=l3("details_serialized_state"),sT=t=>{let r=t.parentNode;r&&r.removeChild(t)},sB=t=>{let r=ot(t);return{count:t.length-r.length,text:r}},sD=t=>{let r;for(;-1!==(r=t.data.lastIndexOf("\uFEFF"));)t.deleteData(r,1)},sP=(t,r)=>(sM(t),r),sL=(t,r)=>lk.isTextPosition(r)?nA(t)&&r.container()===t?((t,r)=>{let n=sB(t.data.substr(0,r.offset())),o=sB(t.data.substr(r.offset()));return(n.text+o.text).length>0?(sD(t),lk(t,r.offset()-n.count)):r})(t,r):sP(t,r):r.container()===t.parentNode?((t,r)=>{let n=r.container(),o=((t,r)=>{let n=er(t,r);return -1===n?J.none():J.some(n)})(eS(n.childNodes),t).map(t=>t<r.offset()?lk(n,r.offset()-1):r).getOr(r);return sM(t),o})(t,r):sP(t,r),sM=t=>{nC(t)&&oo(t)&&(oa(t)?t.removeAttribute("data-mce-caret"):sT(t)),nA(t)&&(sD(t),0===t.data.length&&sT(t))},sF=(t,r,n)=>{let o,a;let l=lr(r.getBoundingClientRect(),n);if("BODY"===t.tagName){let r=t.ownerDocument.documentElement;o=t.scrollLeft||r.scrollLeft,a=t.scrollTop||r.scrollTop}else{let r=t.getBoundingClientRect();o=t.scrollLeft-r.left,a=t.scrollTop-r.top}l.left+=o,l.right+=o,l.top+=a,l.bottom+=a,l.width=1;let i=r.offsetWidth-r.clientWidth;return i>0&&(n&&(i*=-1),l.left+=i,l.right+=i),l},sI=(t,r,n,o)=>{let a,l;let i=aH(),s=io(t),d=t.dom,c=()=>{(t=>{var r,n;let o=np(rl(t),"*[contentEditable=false],video,audio,embed,object");for(let t=0;t<o.length;t++){let a=o[t].dom,l=a.previousSibling;if(od(l)){let t=l.data;1===t.length?null===(r=l.parentNode)||void 0===r||r.removeChild(l):l.deleteData(t.length-1,1)}os(l=a.nextSibling)&&(1===l.data.length?null===(n=l.parentNode)||void 0===n||n.removeChild(l):l.deleteData(0,1))}})(r),l&&(sM(l),l=null),i.on(t=>{d.remove(t.caret),i.clear()}),a&&(clearInterval(a),a=void 0)};return{show:(t,u)=>{let m;if(c(),nU(u))return null;if(!n(u))return l=((t,r)=>{var n;let o=(null!==(n=t.ownerDocument)&&void 0!==n?n:document).createTextNode("\uFEFF"),a=t.parentNode;if(r){let r=t.previousSibling;if(nA(r)){if(oo(r))return r;if(od(r))return r.splitText(r.data.length-1)}null==a||a.insertBefore(o,t)}else{let r=t.nextSibling;if(nA(r)){if(oo(r))return r;if(os(r))return r.splitText(1),r}t.nextSibling?null==a||a.insertBefore(o,t.nextSibling):null==a||a.appendChild(o)}return o})(u,t),m=u.ownerDocument.createRange(),sz(l.nextSibling)?(m.setStart(l,0),m.setEnd(l,0)):(m.setStart(l,1),m.setEnd(l,1)),m;{let n=((t,r,n)=>{var o;let a=(null!==(o=r.ownerDocument)&&void 0!==o?o:document).createElement(t);a.setAttribute("data-mce-caret",n?"before":"after"),a.setAttribute("data-mce-bogus","all"),a.appendChild(n4().dom);let l=r.parentNode;return n?null==l||l.insertBefore(a,r):r.nextSibling?null==l||l.insertBefore(a,r.nextSibling):null==l||l.appendChild(a),a})(s,u,t),c=sF(r,u,t);d.setStyle(n,"top",c.top),l=n;let f=d.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});d.setStyles(f,{...c}),d.add(r,f),i.set({caret:f,element:u,before:t}),t&&d.addClass(f,"mce-visual-caret-before"),a=setInterval(()=>{i.on(t=>{o()?d.toggleClass(t.caret,"mce-visual-caret-hidden"):d.addClass(t.caret,"mce-visual-caret-hidden")})},500),(m=u.ownerDocument.createRange()).setStart(n,0),m.setEnd(n,0)}return m},hide:c,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{i.on(t=>{let n=sF(r,t.element,t.before);d.setStyles(t.caret,{...n})})},destroy:()=>clearInterval(a)}},sU=()=>tB.browser.isFirefox(),sz=t=>nI(t)||nj(t),sj=t=>(sz(t)||n_(t)&&sU())&&rC(rl(t)).exists(rW),sH=nE("display","block table table-cell table-caption list-item"),s$=t=>t>0,sV=t=>t<0,sq=(t,r)=>{let n;for(;n=t(r);)if(!or(n))return n;return null},sW=(t,r,n,o,a)=>{let l;let i=new nb(t,o),s=nI(t)||or(t);if(sV(r)){if(s&&n(l=sq(i.prev.bind(i),!0)))return l;for(;l=sq(i.prev.bind(i),a);)if(n(l))return l}if(s$(r)){if(s&&n(l=sq(i.next.bind(i),!0)))return l;for(;l=sq(i.next.bind(i),a);)if(n(l))return l}return null},sK=(t,r)=>{for(;t&&t!==r;){if(sH(t))return t;t=t.parentNode}return null},sG=(t,r,n)=>sK(t.container(),n)===sK(r.container(),n),sY=(t,r)=>{if(!r)return J.none();let n=r.container(),o=r.offset();return nC(n)?J.from(n.childNodes[o+t]):J.none()},sX=(t,r)=>{var n;let o=(null!==(n=r.ownerDocument)&&void 0!==n?n:document).createRange();return t?(o.setStartBefore(r),o.setEndBefore(r)):(o.setStartAfter(r),o.setEndAfter(r)),o},sQ=(t,r,n)=>sK(r,t)===sK(n,t),sJ=(t,r,n)=>{let o=t?"previousSibling":"nextSibling",a=n;for(;a&&a!==r;){let t=a[o];if(t&&oo(t)&&(t=t[o]),nI(t)||nj(t)){if(sQ(r,t,a))return t;break}if(op(t))break;a=a.parentNode}return null},sZ=q(sX,!0),s0=q(sX,!1),s1=(t,r,n)=>{let o;let a=q(sJ,!0,r),l=q(sJ,!1,r),i=n.startContainer,s=n.startOffset;if(or(i)){let t=nA(i)?i.parentNode:i,r=t.getAttribute("data-mce-caret");if("before"===r&&sj(o=t.nextSibling))return sZ(o);if("after"===r&&sj(o=t.previousSibling))return s0(o)}if(!n.collapsed)return n;if(nA(i)){if(oo(i)){if(1===t){if(o=l(i))return sZ(o);if(o=a(i))return s0(o)}if(-1===t){if(o=a(i))return s0(o);if(o=l(i))return sZ(o)}return n}if(od(i)&&s>=i.data.length-1)return 1===t&&(o=l(i))?sZ(o):n;if(os(i)&&s<=1)return -1===t&&(o=a(i))?s0(o):n;if(s===i.data.length)return(o=l(i))?sZ(o):n;if(0===s)return(o=a(i))?s0(o):n}return n},s2=(t,r)=>sY(t?0:-1,r).filter(nI),s3=(t,r,n)=>{let o=s1(t,r,n);return -1===t?lk.fromRangeStart(o):lk.fromRangeEnd(o)},s8=t=>J.from(t.getNode()).map(rl),s5=(t,r)=>{let n=r;for(;(n=t(n))&&!n.isVisible(););return n},s6=(t,r)=>{let n=sG(t,r);return!(n||!nL(t.getNode()))||n};(pA=pO||(pO={}))[pA.Backwards=-1]="Backwards",pA[pA.Forwards=1]="Forwards";let s9=t=>of(t)||!!oh(t)&&!eu(eS(t.getElementsByTagName("*")),(t,r)=>t||nF(r),!1),s4=(t,r)=>t.hasChildNodes()&&r<t.childNodes.length?t.childNodes[r]:null,s7=(t,r)=>{if(s$(t)){if(op(r.previousSibling)&&!nA(r.previousSibling))return lk.before(r);if(nA(r))return lk(r,0)}if(sV(t)){if(op(r.nextSibling)&&!nA(r.nextSibling))return lk.after(r);if(nA(r))return lk(r,r.data.length)}return sV(t)?nL(r)?lk.before(r):lk.after(r):lk.before(r)},de=(t,r,n)=>{let o,a,l,i;if(!nC(n)||!r)return null;if(r.isEqual(lk.after(n))&&n.lastChild){if(i=lk.after(n.lastChild),sV(t)&&op(n.lastChild)&&nC(n.lastChild))return nL(n.lastChild)?lk.before(n.lastChild):i}else i=r;let s=i.container(),d=i.offset();if(nA(s)){if(sV(t)&&d>0)return lk(s,--d);if(s$(t)&&d<s.length)return lk(s,++d);o=s}else{if(sV(t)&&d>0&&op(a=s4(s,d-1)))return!s9(a)&&(l=sW(a,t,ob,a))?nA(l)?lk(l,l.data.length):lk.after(l):nA(a)?lk(a,a.data.length):lk.before(a);if(s$(t)&&d<s.childNodes.length&&op(a=s4(s,d)))return nL(a)?((t,r)=>{let n=r.nextSibling;return n&&op(n)?nA(n)?lk(n,0):lk.before(n):de(pO.Forwards,lk.after(r),t)})(n,a):!s9(a)&&(l=sW(a,t,ob,a))?nA(l)?lk(l,0):lk.before(l):nA(a)?lk(a,0):lk.after(a);o=a||i.getNode()}if(o&&(s$(t)&&i.isAtEnd()||sV(t)&&i.isAtStart())&&(o=sW(o,t,Q,n,!0),ob(o,n)))return s7(t,o);a=o?sW(o,t,ob,n):o;let c=eG(ed(((t,r)=>{let n=[],o=t;for(;o&&o!==r;)n.push(o),o=o.parentNode;return n})(s,n),nI));return!c||a&&c.contains(a)?a?s7(t,a):null:i=s$(t)?lk.after(c):lk.before(c)},dt=t=>({next:r=>de(pO.Forwards,r,t),prev:r=>de(pO.Backwards,r,t)}),dr=t=>lk.isTextPosition(t)?0===t.offset():op(t.getNode()),dn=t=>{if(lk.isTextPosition(t)){let r=t.container();return t.offset()===r.data.length}return op(t.getNode(!0))},da=(t,r)=>!lk.isTextPosition(t)&&!lk.isTextPosition(r)&&t.getNode()===r.getNode(!0),dl=(t,r,n)=>{let o=dt(r);return J.from(t?o.next(n):o.prev(n))},di=(t,r,n)=>dl(t,r,n).bind(o=>sG(n,o,r)&&(t?!da(n,o)&&!(!lk.isTextPosition(n)&&nL(n.getNode()))&&dn(n)&&dr(o):!da(o,n)&&dr(n)&&dn(o))?dl(t,r,o):J.some(o)),ds=(t,r,n,o)=>di(t,r,n).bind(n=>o(n)?ds(t,r,n,o):J.some(n)),dd=(t,r)=>{let n=t?r.firstChild:r.lastChild;return nA(n)?J.some(lk(n,t?0:n.data.length)):n?op(n)?J.some(t?lk.before(n):nL(n)?lk.before(n):lk.after(n)):((t,r,n)=>{let o=t?lk.before(n):lk.after(n);return dl(t,r,o)})(t,r,n):J.none()},dc=q(dl,!0),du=q(dl,!1),dm=q(dd,!0),df=q(dd,!1),dg="_mce_caret",dp=t=>nC(t)&&t.id===dg,dh=(t,r)=>{let n=r;for(;n&&n!==t;){if(dp(n))return n;n=n.parentNode}return null},db=t=>eI(t,"name"),dv=t=>tM.isArray(t.start),dy=t=>!(!db(t)&&B(t.forward))||t.forward,dC=(t,r)=>(nC(r)&&t.isBlock(r)&&!r.innerHTML&&(r.innerHTML='<br data-mce-bogus="1" />'),r),dx=(t,r)=>df(t).fold(X,t=>(r.setStart(t.container(),t.offset()),r.setEnd(t.container(),t.offset()),!0)),dw=(t,r,n)=>!r.hasChildNodes()&&!!dh(t,r)&&(((t,r)=>{var n;let o=(null!==(n=t.ownerDocument)&&void 0!==n?n:document).createTextNode("\uFEFF");t.appendChild(o),r.setStart(o,0),r.setEnd(o,0)})(r,n),!0),dE=(t,r,n,o)=>{let a=n[r?"start":"end"],l=t.getRoot();if(a){let t=l,n=a[0];for(let r=a.length-1;t&&r>=1;r--){let n=t.childNodes;if(dw(l,t,o))return!0;if(a[r]>n.length-1)return!!dw(l,t,o)||dx(t,o);t=n[a[r]]}nA(t)&&(n=Math.min(a[0],t.data.length)),nC(t)&&(n=Math.min(a[0],t.childNodes.length)),r?o.setStart(t,n):o.setEnd(t,n)}return!0},dk=t=>nA(t)&&t.data.length>0,dS=(t,r,n)=>{let o=t.get(n.id+"_"+r),a=null==o?void 0:o.parentNode,l=n.keep;if(o&&a){let i,s;if("start"===r?l?o.hasChildNodes()?(i=o.firstChild,s=1):dk(o.nextSibling)?(i=o.nextSibling,s=0):dk(o.previousSibling)?(i=o.previousSibling,s=o.previousSibling.data.length):(i=a,s=t.nodeIndex(o)+1):(i=a,s=t.nodeIndex(o)):l?o.hasChildNodes()?(i=o.firstChild,s=1):dk(o.previousSibling)?(i=o.previousSibling,s=o.previousSibling.data.length):(i=a,s=t.nodeIndex(o)):(i=a,s=t.nodeIndex(o)),!l){let a;let l=o.previousSibling,d=o.nextSibling;for(tM.each(tM.grep(o.childNodes),t=>{nA(t)&&(t.data=t.data.replace(/\uFEFF/g,""))});a=t.get(n.id+"_"+r);)t.remove(a,!0);if(nA(d)&&nA(l)&&!tB.browser.isOpera()){let r=l.data.length;l.appendData(d.data),t.remove(d),i=l,s=r}}return J.some(lk(i,s))}return J.none()},d_=(t,r,n)=>((t,r,n=!1)=>2===r?lU(ot,n,t):3===r?(t=>{let r=t.getRng();return{start:lB(t.dom.getRoot(),lk.fromRangeStart(r)),end:lB(t.dom.getRoot(),lk.fromRangeEnd(r)),forward:t.isForward()}})(t):r?{rng:t.getRng(),forward:t.isForward()}:lj(t,!1))(t,r,n),dN=(t,r)=>{((t,r)=>{let n=t.dom;if(r){if(dv(r))return((t,r)=>{let n=t.createRng();return dE(t,!0,r,n)&&dE(t,!1,r,n)?J.some({range:n,forward:dy(r)}):J.none()})(n,r);if(N(r.start))return((t,r)=>{let n=J.from(lD(t.getRoot(),r.start)),o=J.from(lD(t.getRoot(),r.end));return tI(n,o,(n,o)=>{let a=t.createRng();return a.setStart(n.container(),n.offset()),a.setEnd(o.container(),o.offset()),{range:a,forward:dy(r)}})})(n,r);if(eI(r,"id"))return((t,r)=>{let n=dS(t,"start",r),o=dS(t,"end",r);return tI(n,o.or(n),(n,o)=>{let a=t.createRng();return a.setStart(dC(t,n.container()),n.offset()),a.setEnd(dC(t,o.container()),o.offset()),{range:a,forward:dy(r)}})})(n,r);if(db(r))return J.from(n.select(r.name)[r.index]).map(t=>{let r=n.createRng();return r.selectNode(t),{range:r,forward:!0}});if(eI(r,"rng"))return J.some({range:r.rng,forward:dy(r)})}return J.none()})(t,r).each(({range:r,forward:n})=>{t.setRng(r,n)})},dR=t=>nC(t)&&"SPAN"===t.tagName&&"bookmark"===t.getAttribute("data-mce-type"),dA=t=>"\xa0"===t,dO=t=>""!==t&&-1!==" \f\n\r	\v".indexOf(t),dT=t=>!dO(t)&&!dA(t)&&!nq(t),dB=t=>{let r=t.toString(16);return(1===r.length?"0"+r:r).toUpperCase()},dD=t=>({value:e1(dB(t.red)+dB(t.green)+dB(t.blue),"#").toUpperCase()}),dP=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,dL=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,dM=(t,r,n,o)=>({red:t,green:r,blue:n,alpha:o}),dF=(t,r,n,o)=>{let a=parseInt(t,10),l=parseInt(r,10),i=parseInt(n,10),s=parseFloat(o);return dM(a,l,i,s)},dI=t=>(t=>{if("transparent"===t)return J.some(dM(0,0,0,0));let r=dP.exec(t);if(null!==r)return J.some(dF(r[1],r[2],r[3],"1"));let n=dL.exec(t);return null!==n?J.some(dF(n[1],n[2],n[3],n[4])):J.none()})(t).map(dD).map(t=>"#"+t.value).getOr(t),dU=t=>{let r=[];if(t)for(let n=0;n<t.rangeCount;n++)r.push(t.getRangeAt(n));return r},dz=(t,r)=>{let n=np(r,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:ed(eh(t,t=>{let r=li(t);return r?[rl(r)]:[]}),n8)},dj=t=>dz(dU(t.selection.getSel()),rl(t.getBody())),dH=(t,r)=>r$(t,"table",r),d$=t=>rR(t).fold(H([t]),r=>[t].concat(d$(r))),dV=t=>rA(t).fold(H([t]),r=>"br"===tV(r)?rw(r).map(r=>[t].concat(dV(r))).getOr([]):[t].concat(dV(r))),dq=(t,r)=>tI((t=>{let r=t.startContainer,n=t.startOffset;return nA(r)?0===n?J.some(rl(r)):J.none():J.from(r.childNodes[n]).map(rl)})(r),(t=>{let r=t.endContainer,n=t.endOffset;return nA(r)?n===r.data.length?J.some(rl(r)):J.none():J.from(r.childNodes[n-1]).map(rl)})(r),(r,n)=>{let o=ef(d$(t),q(rg,r)),a=ef(dV(t),q(rg,n));return o.isSome()&&a.isSome()}).getOr(!1),dW=(t,r,n,o)=>{let a=new nb(n,n),l=eP(t.schema.getMoveCaretBeforeOnEnterElements(),(t,r)=>!en(["td","th","table"],r.toLowerCase())),i=n;do{if(nA(i)&&0!==tM.trim(i.data).length)return void(o?r.setStart(i,0):r.setEnd(i,i.data.length));if(l[i.nodeName])return void(o?r.setStartBefore(i):"BR"===i.nodeName?r.setEndBefore(i):r.setEndAfter(i))}while(i=o?a.next():a.prev());"BODY"===n.nodeName&&(o?r.setStart(n,0):r.setEnd(n,n.childNodes.length))},dK=t=>{let r=t.selection.getSel();return L(r)&&r.rangeCount>0},dG=(t,r)=>{let n=dj(t);n.length>0?el(n,n=>{let o=n.dom,a=t.dom.createRng();a.setStartBefore(o),a.setEndAfter(o),r(a,!0)}):r(t.selection.getRng(),!1)},dY=(t,r,n)=>{let o=lj(t,r);n(o),t.moveToBookmark(o)},dX=t=>F(null==t?void 0:t.nodeType),dQ=t=>nC(t)&&!dR(t)&&!dp(t)&&!nS(t),dJ=t=>!0===t.isContentEditable,dZ=(t,r,n)=>{let{selection:o,dom:a}=t,l=o.getNode(),i=nI(l);dY(o,!0,()=>{r()}),i&&nI(l)&&a.isChildOf(l,t.getBody())?t.selection.select(l):n(o.getStart())&&d0(a,o)},d0=(t,r)=>{var n,o;let a=r.getRng(),{startContainer:l,startOffset:i}=a;if(!((t,r)=>{if(dQ(r)&&!/^(TD|TH)$/.test(r.nodeName)){let n=t.getAttrib(r,"data-mce-selected"),o=parseInt(n,10);return!isNaN(o)&&o>0}return!1})(t,r.getNode())&&nC(l)){let s;let d=l.childNodes,c=t.getRoot();if(i<d.length){let r=d[i];s=new nb(r,null!==(n=t.getParent(r,t.isBlock))&&void 0!==n?n:c)}else{let r=d[d.length-1];(s=new nb(r,null!==(o=t.getParent(r,t.isBlock))&&void 0!==o?o:c)).next(!0)}for(let n=s.current();n;n=s.next()){if("false"===t.getContentEditable(n))return;if(nA(n)&&!d8(n))return a.setStart(n,0),void r.setRng(a)}}},d1=(t,r,n)=>{if(t){let o=r?"nextSibling":"previousSibling";for(t=n?t:t[o];t;t=t[o])if(nC(t)||!d8(t))return t}},d2=(t,r)=>!!t.getTextBlockElements()[r.nodeName.toLowerCase()]||oU(t,r),d3=(t,r,n)=>t.schema.isValidChild(r,n),d8=(t,r=!1)=>{if(L(t)&&nA(t)){let n=r?t.data.replace(/ /g,"\xa0"):t.data;return oy(n)}return!1},d5=(t,r)=>{let n=t.dom;return dQ(r)&&"false"===n.getContentEditable(r)&&((t,r)=>{let n="[data-mce-cef-wrappable]",o=iq(t),a=te(o)?n:`${n},${o}`;return rm(rl(r),a)})(t,r)&&0===n.select('[contenteditable="true"]',r).length},d6=(t,r)=>M(t)?t(r):(L(r)&&(t=t.replace(/%(\w+)/g,(t,n)=>r[n]||t)),t),d9=(t,r)=>(r=r||"",t=""+((t=t||"").nodeName||t),r=""+(r.nodeName||r),t.toLowerCase()===r.toLowerCase()),d4=(t,r)=>{if(P(t))return null;{let n=String(t);return"color"!==r&&"backgroundColor"!==r||(n=dI(n)),"fontWeight"===r&&700===t&&(n="bold"),"fontFamily"===r&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},d7=(t,r,n)=>{let o=t.getStyle(r,n);return d4(o,n)},ce=(t,r)=>{let n;return t.getParent(r,r=>!!nC(r)&&!!(n=t.getStyle(r,"text-decoration"))&&"none"!==n),n},ct=(t,r,n)=>t.getParents(r,n,t.getRoot()),cr=(t,r,n)=>{let o=t.formatter.get(r);return L(o)&&eo(o,n)},cn=t=>eU(t,"block"),co=t=>eU(t,"selector"),ca=t=>eU(t,"inline"),cl=t=>co(t)&&!1!==t.expand&&!ca(t),ci=(t,r)=>{let n=r;for(;n;){if(nC(n)&&t.getContentEditable(n))return"false"===t.getContentEditable(n)?n:r;n=n.parentNode}return r},cs=(t,r,n,o)=>{let a=r.data;if(t){for(let t=n;t>0;t--)if(o(a.charAt(t-1)))return t}else for(let t=n;t<a.length;t++)if(o(a.charAt(t)))return t;return -1},cd=(t,r,n)=>cs(t,r,n,t=>dA(t)||dO(t)),cc=(t,r,n)=>cs(t,r,n,dT),cu=(t,r,n,o,a,l)=>{let i;let s=t.getParent(n,t.isBlock)||r,d=(r,n,o)=>{let l=a7(t),d=a?l.backwards:l.forwards;return J.from(d(r,n,(t,r)=>dR(t.parentNode)?-1:(i=t,o(a,t,r)),s))};return d(n,o,cd).bind(t=>l?d(t.container,t.offset+(a?-1:0),cc):J.some(t)).orThunk(()=>i?J.some({container:i,offset:a?0:i.length}):J.none())},cm=(t,r,n,o,a)=>{let l=o[a];nA(o)&&te(o.data)&&l&&(o=l);let i=ct(t,o);for(let o=0;o<i.length;o++)for(let a=0;a<r.length;a++){let l=r[a];if((!L(l.collapsed)||l.collapsed===n.collapsed)&&co(l)&&t.is(i[o],l.selector))return i[o]}return o},cf=(t,r,n,o)=>{var a;let l=n,i=t.getRoot(),s=r[0];if(cn(s)&&(l=s.wrapper?null:t.getParent(n,s.block,i)),!l){let r=null!==(a=t.getParent(n,"LI,TD,TH"))&&void 0!==a?a:i;l=t.getParent(nA(n)?n.parentNode:n,r=>r!==i&&d2(t.schema,r),r)}if(l&&cn(s)&&s.wrapper&&(l=ct(t,l,"ul,ol").reverse()[0]||l),!l)for(l=n;l&&l[o]&&!t.isBlock(l[o])&&!d9(l=l[o],"br"););return l||n},cg=(t,r,n,o)=>{let a=n.parentNode;return!L(n[o])&&(!(a!==r&&!P(a)&&!t.isBlock(a))||cg(t,r,a,o))},cp=(t,r,n,o,a)=>{var l;let i=n,s=a?"previousSibling":"nextSibling",d=t.getRoot();if(nA(n)&&!d8(n)&&(a?o>0:o<n.data.length))return n;for(;i;){if(!r[0].block_expand&&t.isBlock(i))return i;for(let r=i[s];r;r=r[s]){let n=nA(r)&&!cg(t,d,r,s);if(!dR(r)&&(!nL(l=r)||!l.getAttribute("data-mce-bogus")||l.nextSibling)&&!d8(r,n))return i}if(i===d||i.parentNode===d){n=i;break}i=i.parentNode}return n},ch=t=>dR(t.parentNode)||dR(t),cb=(t,r,n,o=!1)=>{let{startContainer:a,startOffset:l,endContainer:i,endOffset:s}=r,d=n[0];return nC(a)&&a.hasChildNodes()&&nA(a=ls(a,l))&&(l=0),nC(i)&&i.hasChildNodes()&&nA(i=ls(i,r.collapsed?s:s-1))&&(s=i.data.length),a=ci(t,a),i=ci(t,i),ch(a)&&(a=dR(a)?a:a.parentNode,nA(a=r.collapsed?a.previousSibling||a:a.nextSibling||a)&&(l=r.collapsed?a.length:0)),ch(i)&&(i=dR(i)?i:i.parentNode,nA(i=r.collapsed?i.nextSibling||i:i.previousSibling||i)&&(s=r.collapsed?0:i.length)),r.collapsed&&(cu(t,t.getRoot(),a,l,!0,o).each(({container:t,offset:r})=>{a=t,l=r}),cu(t,t.getRoot(),i,s,!1,o).each(({container:t,offset:r})=>{i=t,s=r})),(ca(d)||d.block_expand)&&(ca(d)&&nA(a)&&0!==l||(a=cp(t,n,a,l,!0)),ca(d)&&nA(i)&&s!==i.data.length||(i=cp(t,n,i,s,!1))),cl(d)&&(a=cm(t,n,r,a,"previousSibling"),i=cm(t,n,r,i,"nextSibling")),(cn(d)||co(d))&&(a=cf(t,n,a,"previousSibling"),i=cf(t,n,i,"nextSibling"),cn(d)&&(t.isBlock(a)||(a=cp(t,n,a,l,!0)),t.isBlock(i)||(i=cp(t,n,i,s,!1)))),nC(a)&&a.parentNode&&(l=t.nodeIndex(a),a=a.parentNode),nC(i)&&i.parentNode&&(s=t.nodeIndex(i)+1,i=i.parentNode),{startContainer:a,startOffset:l,endContainer:i,endOffset:s}},cv=(t,r,n)=>{var o;let a=r.startOffset,l=ls(r.startContainer,a),i=r.endOffset,s=ls(r.endContainer,i-1),d=t=>{let r=t[0];nA(r)&&r===l&&a>=r.data.length&&t.splice(0,1);let n=t[t.length-1];return 0===i&&t.length>0&&n===s&&nA(n)&&t.splice(t.length-1,1),t},c=(t,r,n)=>{let o=[];for(;t&&t!==n;t=t[r])o.push(t);return o},u=(r,n)=>t.getParent(r,t=>t.parentNode===n,n),m=(t,r,o)=>{let a=o?"nextSibling":"previousSibling";for(let l=t,i=l.parentNode;l&&l!==r;l=i){i=l.parentNode;let r=c(l===t?l:l[a],a);r.length&&(o||r.reverse(),n(d(r)))}};if(l===s)return n(d([l]));let f=null!==(o=t.findCommonAncestor(l,s))&&void 0!==o?o:t.getRoot();if(t.isChildOf(l,s))return m(l,f,!0);if(t.isChildOf(s,l))return m(s,f);let g=u(l,f)||l,p=u(s,f)||s;m(l,g,!0);let h=c(g===l?g:g.nextSibling,"nextSibling",p===s?p.nextSibling:p);h.length&&n(d(h)),m(s,p)},cy=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],cC=(t,r,n,o,a,l)=>{let{uid:i=r,...s}=n;rr(t,aq()),t0(t,`${aK()}`,i),t0(t,`${aW()}`,o);let{attributes:d={},classes:c=[]}=a(i,s);if(t1(t,d),el(c,r=>{rr(t,r)}),l){c.length>0&&t0(t,`${aY()}`,c.join(","));let r=eN(d);r.length>0&&t0(t,`${aX()}`,r.join(","))}},cx=(t,r,n,o,a)=>{let l=rs("span",t);return cC(l,r,n,o,a,!1),l},cw=(t,r,n,o,a,l)=>{let i=[],s=cx(t.getDoc(),n,l,o,a),d=aH(),c=()=>{d.clear()},u=t=>{el(t,m)},m=r=>{var m,f;switch(m="span",f=tV(r),ry(r).fold(()=>"skipping",n=>"br"===f||tY(r)&&"\uFEFF"===nK(r)?"valid":tG(r)&&ra(r,aq())?"existing":dp(r.dom)?"caret":eo(cy,t=>rm(r,t))?"valid-block":d3(t,m,f)&&d3(t,tV(n),m)?"valid":"invalid-child")){case"invalid-child":{c();let t=r_(r);u(t),c();break}case"valid-block":c(),cC(r,n,l,o,a,!0);break;case"valid":{let t=d.get().getOrThunk(()=>{let t=a5(s);return i.push(t),d.set(t),t});r9(r,t)}}};return cv(t.dom,r,t=>{c(),(t=>{let r=ea(t,rl);u(r)})(t)}),i},cE=t=>{let r=(()=>{let t={};return{register:(r,n)=>{t[r]={name:r,settings:n}},lookup:r=>eF(t,r).map(t=>t.settings),getNames:()=>eN(t)}})();((t,r)=>{let n=aW(),o=t=>J.from(t.attr(n)).bind(r.lookup),a=t=>{var r,n;t.attr(aK(),null),t.attr(aW(),null),t.attr(aG(),null);let o=J.from(t.attr(aX())).map(t=>t.split(",")).getOr([]),a=J.from(t.attr(aY())).map(t=>t.split(",")).getOr([]);el(o,r=>t.attr(r,null));let l=null!==(n=null===(r=t.attr("class"))||void 0===r?void 0:r.split(" "))&&void 0!==n?n:[],i=ey(l,[aq()].concat(a));t.attr("class",i.length>0?i.join(" "):null),t.attr(aY(),null),t.attr(aX(),null)};t.serializer.addTempAttr(aG()),t.serializer.addAttributeFilter(n,t=>{for(let r of t)o(r).each(t=>{!1===t.persistent&&("span"===r.name?r.unwrap():a(r))})})})(t,r);let n=((t,r)=>{let n=aL({}),o=()=>({listeners:[],previous:aH()}),a=(t,r)=>{l(t,t=>(r(t),t))},l=(t,r)=>{let a=n.get(),l=r(eF(a,t).getOrThunk(o));a[t]=l,n.set(a)},i=(r,n)=>{el(a0(t,r),t=>{n?t0(t,aG(),"true"):t5(t,aG())})},s=aV(()=>{let n=ex(r.getNames());el(n,r=>{l(r,n=>{let o=n.previous.get();return aJ(t,J.some(r)).fold(()=>{o.each(t=>{a(r,t=>{el(t.listeners,t=>t(!1,r))}),n.previous.clear(),i(t,!1)})},({uid:t,name:r,elements:l})=>{tF(o,t)||(o.each(t=>i(t,!1)),a(r,n=>{el(n.listeners,n=>n(!0,r,{uid:t,nodes:ea(l,t=>t.dom)}))}),n.previous.set(t),i(t,!0))}),{previous:n.previous,listeners:n.listeners}})})},30);return t.on("remove",()=>{s.cancel()}),t.on("NodeChange",()=>{s.throttle()}),{addListener:(t,r)=>{l(t,t=>({previous:t.previous,listeners:t.listeners.concat([r])}))}}})(t,r),o=tJ("span"),a=t=>{el(t,t=>{o(t)?nt(t):(t=>{ro(t,aq()),t5(t,`${aK()}`),t5(t,`${aW()}`),t5(t,`${aG()}`);let r=t3(t,`${aX()}`).map(t=>t.split(",")).getOr([]),n=t3(t,`${aY()}`).map(t=>t.split(",")).getOr([]);el(r,r=>t5(t,r)),el(n,r=>{ro(t,r)}),t5(t,`${aY()}`),t5(t,`${aX()}`)})(t)})};return{register:(t,n)=>{r.register(t,n)},annotate:(n,o)=>{r.lookup(n).each(r=>{((t,r,n,o)=>{t.undoManager.transact(()=>{let a=t.selection,l=a.getRng(),i=dj(t).length>0,s=a3("mce-annotation");if(l.collapsed&&!i&&((t,r)=>{let n=cb(t.dom,r,[{inline:"span"}]);r.setStart(n.startContainer,n.startOffset),r.setEnd(n.endContainer,n.endOffset),t.selection.setRng(r)})(t,l),a.getRng().collapsed&&!i){let l=cx(t.getDoc(),s,o,r,n.decorate);no(l,"\xa0"),a.getRng().insertNode(l.dom),a.select(l.dom)}else dY(a,!1,()=>{dG(t,a=>{cw(t,a,s,r,n.decorate,o)})})})})(t,n,r,o)})},annotationChanged:(t,r)=>{n.addListener(t,r)},remove:r=>{aJ(t,J.some(r)).each(({elements:r})=>{let n=t.selection.getBookmark();a(r),t.selection.moveToBookmark(n)})},removeAll:r=>{let n=t.selection.getBookmark();eA(a1(t,r),(t,r)=>{a(t)}),t.selection.moveToBookmark(n)},getAll:r=>{let n=a1(t,r);return eO(n,t=>ea(t,t=>t.dom))}}},ck=t=>({getBookmark:q(d_,t),moveToBookmark:q(dN,t)});ck.isBookmarkNode=dR;let cS=(t,r,n)=>!n.collapsed&&eo(n.getClientRects(),n=>t>=n.left&&t<=n.right&&r>=n.top&&r<=n.bottom),c_=(t,r,n)=>{t.dispatch(r,n)},cN=(t,r,n,o)=>{t.dispatch("FormatApply",{format:r,node:n,vars:o})},cR=(t,r,n,o)=>{t.dispatch("FormatRemove",{format:r,node:n,vars:o})},cA=(t,r)=>t.dispatch("SetContent",r),cO=(t,r)=>t.dispatch("GetContent",r),cT=(t,r)=>t.dispatch("PastePlainTextToggle",{state:r}),cB={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:t=>t.shiftKey||t.ctrlKey||t.altKey||cB.metaKeyPressed(t),metaKeyPressed:t=>tB.os.isMacOS()||tB.os.isiOS()?t.metaKey:t.ctrlKey&&!t.altKey},cD="data-mce-selected",cP=Math.abs,cL=Math.round,cM={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},cF=(t,r)=>{let n,o,a,l,i,s,d,c,u,m,f,g,p,h,b;let v=r.dom,y=r.getDoc(),C=document,x=r.getBody(),w=t=>L(t)&&(nM(t)||v.is(t,"figure.image")),E=t=>nj(t)||v.hasClass(t,"mce-preview-object"),k=t=>{let n=t.target;((t,r)=>{if("longpress"===t.type||0===t.type.indexOf("touch")){let n=t.touches[0];return w(t.target)&&!cS(n.clientX,n.clientY,r)}return w(t.target)&&!cS(t.clientX,t.clientY,r)})(t,r.selection.getRng())&&!t.isDefaultPrevented()&&r.selection.select(n)},S=t=>v.hasClass(t,"mce-preview-object")&&L(t.firstElementChild)?[t,t.firstElementChild]:v.is(t,"figure.image")?[t.querySelector("img")]:[t],_=t=>{let n=iB(r);return!!n&&"false"!==t.getAttribute("data-mce-resize")&&t!==r.getBody()&&(v.hasClass(t,"mce-preview-object")&&L(t.firstElementChild)?rm(rl(t.firstElementChild),n):rm(rl(t),n))},N=(t,n,o)=>{if(L(o)){let a=S(t);el(a,t=>{t.style[n]||!r.schema.isValid(t.nodeName.toLowerCase(),n)?v.setStyle(t,n,o):v.setAttrib(t,n,""+o)})}},R=(t,r,n)=>{N(t,"width",r),N(t,"height",n)},A=t=>{let i,y,C,k;i=t.screenX-s,y=t.screenY-d,g=i*l[2]+c,p=y*l[3]+u,g=g<5?5:g,p=p<5?5:p,((w(n)||E(n))&&!1!==iD(r)?!cB.modifierPressed(t):cB.modifierPressed(t))&&(cP(i)>cP(y)?(p=cL(g*m),g=cL(p/m)):(g=cL(p/m),p=cL(g*m))),R(o,g,p),C=l.startPos.x+i,k=l.startPos.y+y,C=C>0?C:0,k=k>0?k:0,v.setStyles(a,{left:C,top:k,display:"block"}),a.innerHTML=g+" &times; "+p,l[2]<0&&o.clientWidth<=g&&v.setStyle(o,"left",(void 0)+(c-g)),l[3]<0&&o.clientHeight<=p&&v.setStyle(o,"top",(void 0)+(u-p)),(i=x.scrollWidth-h)+(y=x.scrollHeight-b)!=0&&v.setStyles(a,{left:C-i,top:k-y}),f||(((t,r,n,o,a)=>{t.dispatch("ObjectResizeStart",{target:r,width:n,height:o,origin:a})})(r,n,c,u,"corner-"+l.name),f=!0)},O=()=>{let t=f;f=!1,t&&(N(n,"width",g),N(n,"height",p)),v.unbind(y,"mousemove",A),v.unbind(y,"mouseup",O),C!==y&&(v.unbind(C,"mousemove",A),v.unbind(C,"mouseup",O)),v.remove(o),v.remove(a),v.remove(i),T(n),t&&(((t,r,n,o,a)=>{t.dispatch("ObjectResized",{target:r,width:n,height:o,origin:a})})(r,n,g,p,"corner-"+l.name),v.setAttrib(n,"style",v.getAttrib(n,"style"))),r.nodeChanged()},T=t=>{F();let f=v.getPos(t,x),w=f.x,k=f.y,N=t.getBoundingClientRect(),T=N.width||N.right-N.left,B=N.height||N.bottom-N.top;n!==t&&(D(),n=t,g=p=0);let P=r.dispatch("ObjectSelected",{target:t});_(t)&&!P.isDefaultPrevented()?eA(cM,(t,r)=>{let f=v.get("mceResizeHandle"+r);f&&v.remove(f),f=v.add(x,"div",{id:"mceResizeHandle"+r,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+r+"-resize; margin:0; padding:0"}),v.bind(f,"mousedown",f=>{f.stopImmediatePropagation(),f.preventDefault(),(f=>{var g;let p=S(n)[0];s=f.screenX,d=f.screenY,c=p.clientWidth,m=(u=p.clientHeight)/c,(l=t).name=r,l.startPos={x:T*t[0]+w,y:B*t[1]+k},h=x.scrollWidth,b=x.scrollHeight,i=v.add(x,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),v.setStyles(i,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),o=E(g=n)?v.create("img",{src:tB.transparentSrc}):g.cloneNode(!0),v.addClass(o,"mce-clonedresizable"),v.setAttrib(o,"data-mce-bogus","all"),o.contentEditable="false",v.setStyles(o,{left:w,top:k,margin:0}),R(o,T,B),o.removeAttribute(cD),x.appendChild(o),v.bind(y,"mousemove",A),v.bind(y,"mouseup",O),C!==y&&(v.bind(C,"mousemove",A),v.bind(C,"mouseup",O)),a=v.add(x,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},c+" &times; "+u)})(f)}),t.elm=f,v.setStyles(f,{left:T*t[0]+w-f.offsetWidth/2,top:B*t[1]+k-f.offsetHeight/2})}):D(!1)},B=a$(T,0),D=(t=!0)=>{B.cancel(),F(),n&&t&&n.removeAttribute(cD),eA(cM,(t,r)=>{let n=v.get("mceResizeHandle"+r);n&&(v.unbind(n),v.remove(n))})},P=(t,r)=>v.isChildOf(t,r),M=n=>{if(f||r.removed||r.composing)return;let o="mousedown"===n.type?n.target:t.getNode(),a=rq(rl(o),"table,img,figure.image,hr,video,span.mce-preview-object,details").map(t=>t.dom).filter(t=>v.isEditable(t.parentElement)).getOrUndefined(),l=L(a)?v.getAttrib(a,cD,"1"):"1";if(el(v.select(`img[${cD}],hr[${cD}]`),t=>{t.removeAttribute(cD)}),L(a)&&P(a,x)&&r.hasFocus()){I();let r=t.getStart(!0);if(P(r,a)&&P(t.getEnd(!0),a))return v.setAttrib(a,cD,l),void B.throttle(a)}D()},F=()=>{eA(cM,t=>{t.elm&&(v.unbind(t.elm),delete t.elm)})},I=()=>{try{r.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(t){}};return r.on("init",()=>{I(),r.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",M),r.on("keyup compositionend",t=>{n&&"TABLE"===n.nodeName&&M(t)}),r.on("hide blur",D),r.on("contextmenu longpress",k,!0)}),r.on("remove",F),{isResizable:_,showResizeRect:T,hideResizeRect:D,updateResizeRect:M,destroy:()=>{B.cancel(),n=o=i=null}}},cI=(t,r,n)=>{let o=t.document.createRange();return r.fold(t=>{o.setStartBefore(t.dom)},(t,r)=>{o.setStart(t.dom,r)},t=>{o.setStartAfter(t.dom)}),((t,r)=>{r.fold(r=>{t.setEndBefore(r.dom)},(r,n)=>{t.setEnd(r.dom,n)},r=>{t.setEndAfter(r.dom)})})(o,n),o},cU=(t,r,n,o,a)=>{let l=t.document.createRange();return l.setStart(r.dom,n),l.setEnd(o.dom,a),l},cz=lW([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),cj=(t,r,n)=>r(rl(n.startContainer),n.startOffset,rl(n.endContainer),n.endOffset);cz.ltr,cz.rtl;let cH=(t,r,n,o)=>({start:t,soffset:r,finish:n,foffset:o}),c$=document.caretPositionFromPoint?(t,r,n)=>{var o,a;return J.from(null===(a=(o=t.dom).caretPositionFromPoint)||void 0===a?void 0:a.call(o,r,n)).bind(r=>{if(null===r.offsetNode)return J.none();let n=t.dom.createRange();return n.setStart(r.offsetNode,r.offset),n.collapse(),J.some(n)})}:document.caretRangeFromPoint?(t,r,n)=>{var o,a;return J.from(null===(a=(o=t.dom).caretRangeFromPoint)||void 0===a?void 0:a.call(o,r,n))}:J.none,cV=lW([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),cq={before:cV.before,on:cV.on,after:cV.after,cata:(t,r,n,o)=>t.fold(r,n,o),getStart:t=>t.fold($,$,$)},cW=lW([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),cK={domRange:cW.domRange,relative:cW.relative,exact:cW.exact,exactFromRange:t=>cW.exact(t.start,t.soffset,t.finish,t.foffset),getWin:t=>{let r=t.match({domRange:t=>rl(t.startContainer),relative:(t,r)=>cq.getStart(t),exact:(t,r,n,o)=>t});return rv(r)},range:cH},cG=(t,r)=>{let n=tV(t);return"input"===n?cq.after(t):en(["br","img"],n)?0===r?cq.before(t):cq.after(t):cq.on(t,r)},cY=(t,r)=>{let n=t.fold(cq.before,cG,cq.after),o=r.fold(cq.before,cG,cq.after);return cK.relative(n,o)},cX=(t,r,n,o)=>{let a=cG(t,r),l=cG(n,o);return cK.relative(a,l)},cQ=(t,r)=>{let n=(r||document).createDocumentFragment();return el(t,t=>{n.appendChild(t.dom)}),rl(n)},cJ=t=>{let r=cK.getWin(t).dom,n=(t,n,o,a)=>cU(r,t,n,o,a),o=t.match({domRange:t=>{let r=rl(t.startContainer),n=rl(t.endContainer);return cX(r,t.startOffset,n,t.endOffset)},relative:cY,exact:cX});return((t,r)=>{let n=r.match({domRange:t=>({ltr:H(t),rtl:J.none}),relative:(r,n)=>({ltr:eY(()=>cI(t,r,n)),rtl:eY(()=>J.some(cI(t,n,r)))}),exact:(r,n,o,a)=>({ltr:eY(()=>cU(t,r,n,o,a)),rtl:eY(()=>J.some(cU(t,o,a,r,n)))})});return((t,r)=>{let n=r.ltr();return n.collapsed?r.rtl().filter(t=>!1===t.collapsed).map(t=>cz.rtl(rl(t.endContainer),t.endOffset,rl(t.startContainer),t.startOffset)).getOrThunk(()=>cj(0,cz.ltr,n)):cj(0,cz.ltr,n)})(0,n)})(r,o).match({ltr:n,rtl:n})},cZ=(t,r,n)=>((t,r,n)=>{let o=rl(t.document);return c$(o,r,n).map(t=>cH(rl(t.startContainer),t.startOffset,rl(t.endContainer),t.endOffset))})(rv(rl(n)).dom,t,r).map(t=>{let r=n.createRange();return r.setStart(t.start.dom,t.soffset),r.setEnd(t.finish.dom,t.foffset),r}).getOrUndefined(),c0=(t,r)=>L(t)&&L(r)&&t.startContainer===r.startContainer&&t.startOffset===r.startOffset&&t.endContainer===r.endContainer&&t.endOffset===r.endOffset,c1=(t,r,n)=>null!==((t,r,n)=>{let o=t;for(;o&&o!==r;){if(n(o))return o;o=o.parentNode}return null})(t,r,n),c2=(t,r,n)=>c1(t,r,t=>t.nodeName===n),c3=(t,r)=>oo(t)&&!c1(t,r,dp),c8=(t,r,n)=>{let o=r.parentNode;if(o){let a;let l=new nb(r,t.getParent(o,t.isBlock)||t.getRoot());for(;a=l[n?"prev":"next"]();)if(nL(a))return!0}return!1},c5=(t,r,n,o,a)=>{let l,i;let s=t.getRoot(),d=t.schema.getNonEmptyElements(),c=a.parentNode;if(!c)return J.none();let u=t.getParent(c,t.isBlock)||s;if(o&&nL(a)&&r&&t.isEmpty(u))return J.some(lk(c,t.nodeIndex(a)));let m=new nb(a,u);for(;i=m[o?"prev":"next"]();){if("false"===t.getContentEditableParent(i)||c3(i,s))return J.none();if(nA(i)&&i.data.length>0)return c2(i,s,"A")?J.none():J.some(lk(i,o?i.data.length:0));if(t.isBlock(i)||d[i.nodeName.toLowerCase()])return J.none();l=i}return nB(l)?J.none():n&&l?J.some(lk(l,0)):J.none()},c6=(t,r,n,o)=>{var a;let l=t.getRoot(),i,s=!1,d=n?o.startContainer:o.endContainer,c=n?o.startOffset:o.endOffset,u=nC(d)&&c===d.childNodes.length,m=t.schema.getNonEmptyElements(),f=n;if(oo(d))return J.none();if(nC(d)&&c>d.childNodes.length-1&&(f=!1),nD(d)&&(d=l,c=0),d===l){if(f&&(i=d.childNodes[c>0?c-1:0])&&(oo(i)||m[i.nodeName]||n_(i)))return J.none();if(d.hasChildNodes()){if(c=Math.min(!f&&c>0?c-1:c,d.childNodes.length-1),c=nA(d=d.childNodes[c])&&u?d.data.length:0,!r&&d===l.lastChild&&n_(d)||((t,r)=>{let n=r;for(;n&&n!==t;){if(nI(n))return!0;n=n.parentNode}return!1})(l,d)||oo(d))return J.none();if(d.hasChildNodes()&&!n_(d)){i=d;let r=new nb(d,l);do{if(nI(i)||oo(i)){s=!1;break}if(nA(i)&&i.data.length>0){c=f?0:i.data.length,d=i,s=!0;break}if(m[i.nodeName.toLowerCase()]&&!nz(i)){c=t.nodeIndex(i),d=i.parentNode,f||c++,s=!0;break}}while(i=f?r.next():r.prev())}}}return r&&(nA(d)&&0===c&&c5(t,u,r,!0,d).each(t=>{d=t.container(),c=t.offset(),s=!0}),nC(d)&&((i=d.childNodes[c])||(i=d.childNodes[c-1]),!i||!nL(i)||"A"===(null===(a=i.previousSibling)||void 0===a?void 0:a.nodeName)||c8(t,i,!1)||c8(t,i,!0)||c5(t,u,r,!0,i).each(t=>{d=t.container(),c=t.offset(),s=!0}))),f&&!r&&nA(d)&&c===d.data.length&&c5(t,u,r,!1,d).each(t=>{d=t.container(),c=t.offset(),s=!0}),s&&d?J.some(lk(d,c)):J.none()},c9=(t,r)=>{let n=r.collapsed,o=r.cloneRange(),a=lk.fromRangeStart(r);return c6(t,n,!0,o).each(t=>{n&&lk.isAbove(a,t)||o.setStart(t.container(),t.offset())}),n||c6(t,n,!1,o).each(t=>{o.setEnd(t.container(),t.offset())}),n&&o.collapse(!0),c0(r,o)?J.none():J.some(o)},c4=(t,r)=>t.splitText(r),c7=t=>{let r=t.startContainer,n=t.startOffset,o=t.endContainer,a=t.endOffset;if(r===o&&nA(r)){if(n>0&&n<r.data.length){if(r=(o=c4(r,n)).previousSibling,a>n){a-=n;let t=c4(o,a).previousSibling;r=o=t,a=t.data.length,n=0}else a=0}}else if(nA(r)&&n>0&&n<r.data.length&&(r=c4(r,n),n=0),nA(o)&&a>0&&a<o.data.length){let t=c4(o,a).previousSibling;o=t,a=t.data.length}return{startContainer:r,startOffset:n,endContainer:o,endOffset:a}},ue=t=>({walk:(r,n)=>cv(t,r,n),split:c7,expand:(r,n={type:"word"})=>{if("word"===n.type){let n=cb(t,r,[{inline:"span"}]),o=t.createRng();return o.setStart(n.startContainer,n.startOffset),o.setEnd(n.endContainer,n.endOffset),o}return r},normalize:r=>c9(t,r).fold(X,t=>(r.setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset),!0))});ue.compareRanges=c0,ue.getCaretRangeFromPoint=cZ,ue.getSelectedNode=li,ue.getNode=ls;let ut=((t,r)=>{let n=r=>{let n=(t=>{let r=t.dom;return rU(t)?r.getBoundingClientRect().height:r.offsetHeight})(r);if(n<=0||null===n){let n=rJ(r,t);return parseFloat(n)||0}return n},o=(t,r)=>eu(r,(r,n)=>{let o=rJ(t,n),a=void 0===o?0:parseInt(o,10);return isNaN(a)?r:r+a},0);return{set:(r,n)=>{if(!F(n)&&!n.match(/^[0-9]+$/))throw Error(t+".set accepts only positive integer values. Value was "+n);let o=r.dom;rG(o)&&(o.style[t]=n+"px")},get:n,getOuter:n,aggregate:o,max:(t,r,n)=>{let a=o(t,n);return r>a?r-a:0}}})("height"),ur=()=>rl(document),un=(t,r)=>t.view(r).fold(H([]),r=>{let n=t.owner(r),o=un(t,n);return[r].concat(o)});var uo=Object.freeze({__proto__:null,view:t=>{var r;return(t.dom===document?J.none():J.from(null===(r=t.dom.defaultView)||void 0===r?void 0:r.frameElement)).map(rl)},owner:t=>rb(t)});let ua=t=>"textarea"===tV(t),ul=(t,r)=>{let n=(t=>{let r=t.dom.ownerDocument,n=r.body,o=r.defaultView,a=r.documentElement;if(n===t.dom)return ni(n.offsetLeft,n.offsetTop);let l=ns(null==o?void 0:o.pageYOffset,a.scrollTop),i=ns(null==o?void 0:o.pageXOffset,a.scrollLeft),s=ns(a.clientTop,n.clientTop),d=ns(a.clientLeft,n.clientLeft);return nd(t).translate(i-d,l-s)})(t),o=ut.get(t);return{element:t,bottom:n.top+o,height:o,pos:n,cleanup:r}},ui=(t,r,n,o)=>{uu(t,(a,l)=>ud(t,r,n,o),n)},us=(t,r,n,o,a)=>{let l={elm:o.element.dom,alignToTop:a};t.dispatch("ScrollIntoView",l).isDefaultPrevented()||(n(r,nc(r).top,o,a),((t,r)=>{t.dispatch("AfterScrollIntoView",r)})(t,l))},ud=(t,r,n,o)=>{let a=rl(t.getBody()),l=rl(t.getDoc());a.dom.offsetWidth;let i=((t,r)=>{let n=((t,r)=>{let n=r_(t);if(0===n.length||ua(t))return{element:t,offset:r};if(r<n.length&&!ua(n[r]))return{element:n[r],offset:0};{let o=n[n.length-1];return ua(o)?{element:t,offset:r}:"img"===tV(o)?{element:o,offset:1}:tY(o)?{element:o,offset:nK(o).length}:{element:o,offset:r_(o).length}}})(t,r),o=ri('<span data-mce-bogus="all" style="display: inline-block;">\uFEFF</span>');return r3(n.element,o),ul(o,()=>ne(o))})(rl(n.startContainer),n.startOffset);us(t,l,r,i,o),i.cleanup()},uc=(t,r,n,o)=>{let a=rl(t.getDoc());us(t,a,n,ul(rl(r),U),o)},uu=(t,r,n)=>{let o=n.startContainer,a=n.startOffset,l=n.endContainer,i=n.endOffset;r(rl(o),rl(l));let s=t.dom.createRng();s.setStart(o,a),s.setEnd(l,i),t.selection.setRng(n)},um=(t,r)=>t.element.dom.scrollIntoView({block:r?"start":"end"}),uf=(t,r,n,o)=>{let a=r+t,l=n.pos.top,i=n.bottom,s=i-l>=r;l<t?um(n,!1!==o):l>a?um(n,s?!1!==o:!0===o):i>a&&!s&&um(n,!0===o)},ug=(t,r,n,o)=>{let a=rv(t).dom.innerHeight;uf(r,a,n,o)},up=(t,r,n,o)=>{let a=rv(t).dom.innerHeight;uf(r,a,n,o);let l=(t=>{let r=ur(),n=nc(r),o=((t,r)=>{let n=r.owner(t);return un(r,n)})(t,uo),a=nd(t),l=ec(o,(t,r)=>{let n=nd(r);return{left:t.left+n.left,top:t.top+n.top}},{left:0,top:0});return ni(l.left+a.left+n.left,l.top+a.top+n.top)})(n.element),i=nf(window);l.top<i.y?nu(n.element,!1!==o):l.top>i.bottom&&nu(n.element,!0===o)},uh=(t,r,n)=>ui(t,ug,r,n),ub=(t,r,n)=>uc(t,r,ug,n),uv=(t,r,n)=>ui(t,up,r,n),uy=(t,r,n)=>uc(t,r,up,n),uC=(t,r,n)=>{(t.inline?uh:uv)(t,r,n)},ux=t=>t.dom.focus(),uw=t=>{let r=rP(t).dom;return t.dom===r.activeElement},uE=(t=ur())=>J.from(t.dom.activeElement).map(rl),uk=(t,r)=>{let n=tY(r)?nK(r).length:r_(r).length+1;return t>n?n:t<0?0:t},uS=t=>cK.range(t.start,uk(t.soffset,t.start),t.finish,uk(t.foffset,t.finish)),u_=(t,r)=>!ny(r.dom)&&(rp(t,r)||rg(t,r)),uN=t=>r=>u_(t,r.start)&&u_(t,r.finish),uR=t=>cK.range(rl(t.startContainer),t.startOffset,rl(t.endContainer),t.endOffset),uA=t=>{let r=document.createRange();try{return r.setStart(t.start.dom,t.soffset),r.setEnd(t.finish.dom,t.foffset),J.some(r)}catch(t){return J.none()}},uO=t=>{var r;let n=t.inline||tB.browser.isFirefox()?(t=>{let r=t.getSelection();return(r&&0!==r.rangeCount?J.from(r.getRangeAt(0)):J.none()).map(uR)})(rv(r=rl(t.getBody())).dom).filter(uN(r)):J.none();t.bookmark=n.isSome()?n:t.bookmark},uT=t=>(t.bookmark?t.bookmark:J.none()).bind(r=>{var n;return n=rl(t.getBody()),J.from(r).filter(uN(n)).map(uS)}).bind(uA),uB={isEditorUIElement:t=>{let r=t.className.toString();return -1!==r.indexOf("tox-")||-1!==r.indexOf("mce-")}},uD={setEditorTimeout:(t,r,n)=>{var o;return F(o=n)||(o=0),setTimeout(()=>{t.removed||r()},o)},setEditorInterval:(t,r,n)=>{var o;let a=(F(o=n)||(o=0),setInterval(()=>{t.removed?clearInterval(a):r()},o));return a}},uP=aB.DOM,uL=t=>{let r=t.classList;return void 0!==r&&(r.contains("tox-edit-area")||r.contains("tox-edit-area__iframe")||r.contains("mce-content-body"))},uM=(t,r)=>{let n=iW(t),o=uP.getParent(r,r=>nC(r)&&uB.isEditorUIElement(r)||!!n&&t.dom.is(r,n));return null!==o},uF=t=>{try{let r=rP(rl(t.getElement()));return uE(r).fold(()=>document.body,t=>t.dom)}catch(t){return document.body}},uI=(r,n)=>{let o=n.editor;(t=>{let r=a$(()=>{uO(t)},0);t.on("init",()=>{t.inline&&((t,r)=>{let n=()=>{r.throttle()};aB.DOM.bind(document,"mouseup",n),t.on("remove",()=>{aB.DOM.unbind(document,"mouseup",n)})})(t,r),((t,r)=>{t.on("mouseup touchend",t=>{r.throttle()})})(t,r),t.on("keyup NodeChange AfterSetSelectionRange",r=>{"nodechange"===r.type&&r.selectionChange||uO(t)})}),t.on("remove",()=>{r.cancel()})})(o);let a=(t,r)=>{sk(t)&&!0!==t.inline&&r(rl(t.getContainer()),"tox-edit-focus")};o.on("focusin",()=>{let t=r.focusedEditor;uL(uF(o))&&a(o,rr),t!==o&&(t&&t.dispatch("blur",{focusedEditor:o}),r.setActive(o),r.focusedEditor=o,o.dispatch("focus",{blurredEditor:t}),o.focus(!0))}),o.on("focusout",()=>{uD.setEditorTimeout(o,()=>{let t=r.focusedEditor;uL(uF(o))&&t===o||a(o,ro),uM(o,uF(o))||t!==o||(o.dispatch("blur",{focusedEditor:null}),r.focusedEditor=null)})}),t||(t=t=>{let n=r.activeEditor;n&&rF(t).each(t=>{t.ownerDocument===document&&(t===document.body||uM(n,t)||r.focusedEditor!==n||(n.dispatch("blur",{focusedEditor:null}),r.focusedEditor=null))})},uP.bind(document,"focusin",t))},uU=(r,n)=>{r.focusedEditor===n.editor&&(r.focusedEditor=null),!r.activeEditor&&t&&(uP.unbind(document,"focusin",t),t=null)},uz=(t,r)=>{var n;(n=rl(t.getBody()),(r.collapsed?J.from(ls(r.startContainer,r.startOffset)).map(rl):J.none()).bind(t=>n3(t)?J.some(t):rp(n,t)?J.none():J.some(n))).bind(t=>dm(t.dom)).fold(()=>{t.selection.normalize()},r=>t.selection.setRng(r.toRange()))},uj=t=>{if(t.setActive)try{t.setActive()}catch(r){t.focus()}else t.focus()},uH=t=>t.inline?(t=>{var r;let n=t.getBody();return n&&(uw(r=rl(n))||uE(rP(r)).filter(t=>r.dom.contains(t.dom)).isSome())})(t):L(t.iframeElement)&&uw(rl(t.iframeElement)),u$=t=>t.editorManager.setActive(t),uV=(t,r,n,o,a)=>{let l=n?r.startContainer:r.endContainer,i=n?r.startOffset:r.endOffset;return J.from(l).map(rl).map(t=>o&&r.collapsed?t:rN(t,a(t,i)).getOr(t)).bind(t=>tG(t)?J.some(t):ry(t).filter(tG)).map(t=>t.dom).getOr(t)},uq=(t,r,n=!1)=>uV(t,r,!0,n,(t,r)=>Math.min(rO(t),r)),uW=(t,r,n=!1)=>uV(t,r,!1,n,(t,r)=>r>0?r-1:r),uK=(t,r)=>{let n=t;for(;t&&nA(t)&&0===t.length;)t=r?t.nextSibling:t.previousSibling;return t||n},uG=(t,r)=>ea(r,r=>{let n=t.dispatch("GetSelectionRange",{range:r});return n.range!==r?n.range:r}),uY=["img","br"],uX=t=>{let r=nG(t).filter(t=>0!==t.trim().length||t.indexOf("\xa0")>-1).isSome();return r||en(uY,tV(t))||tK(t)&&"false"===t2(t,"contenteditable")},uQ="[data-mce-autocompleter]",uJ=(t,r)=>{if(uZ(rl(t.getBody())).isNone()){let n=ri('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());r6(n,rl(r.extractContents())),r.insertNode(n.dom),ry(n).each(t=>t.dom.normalize()),((t,r)=>{let n=t=>{let o=r_(t);for(let t=o.length-1;t>=0;t--){let a=o[t];if(r(a))return J.some(a);let l=n(a);if(l.isSome())return l}return J.none()};return n(t)})(n,uX).map(r=>{t.selection.setCursorLocation(r.dom,"img"===tV(r)?1:nG(r).fold(()=>r_(r).length,t=>t.length))})}},uZ=t=>rV(t,uQ),u0={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},u1=(t,r,n)=>{let o=n?"lastChild":"firstChild",a=n?"prev":"next";if(t[o])return t[o];if(t!==r){let n=t[a];if(n)return n;for(let o=t.parent;o&&o!==r;o=o.parent)if(n=o[a])return n}},u2=t=>{var r;let n=null!==(r=t.value)&&void 0!==r?r:"";if(!oy(n))return!1;let o=t.parent;return!o||"span"===o.name&&!o.attr("style")||!/^[ ]+$/.test(n)},u3=t=>{let r="a"===t.name&&!t.attr("href")&&t.attr("id");return t.attr("name")||t.attr("id")&&!t.firstChild||t.attr("data-mce-bookmark")||r};class u8{static create(t,r){let n=new u8(t,u0[t]||1);return r&&eA(r,(t,r)=>{n.attr(r,t)}),n}constructor(t,r){this.name=t,this.type=r,1===r&&(this.attributes=[],this.attributes.map={})}replace(t){return t.parent&&t.remove(),this.insert(t,this),this.remove(),this}attr(t,r){let n=this;if(!N(t))return L(t)&&eA(t,(t,r)=>{n.attr(r,t)}),n;let o=n.attributes;if(o){if(void 0!==r){if(null===r){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),n}return n}if(t in o.map){let n=o.length;for(;n--;)if(o[n].name===t){o[n].value=r;break}}else o.push({name:t,value:r});return o.map[t]=r,n}return o.map[t]}}clone(){let t=new u8(this.name,this.type),r=this.attributes;if(r){let n=[];n.map={};for(let t=0,o=r.length;t<o;t++){let o=r[t];"id"!==o.name&&(n[n.length]={name:o.name,value:o.value},n.map[o.name]=o.value)}t.attributes=n}return t.value=this.value,t}wrap(t){return this.parent&&(this.parent.insert(t,this),t.append(this)),this}unwrap(){for(let t=this.firstChild;t;){let r=t.next;this.insert(t,this,!0),t=r}this.remove()}remove(){let t=this.parent,r=this.next,n=this.prev;return t&&(t.firstChild===this?(t.firstChild=r,r&&(r.prev=null)):n&&(n.next=r),t.lastChild===this?(t.lastChild=n,n&&(n.next=null)):r&&(r.prev=n),this.parent=this.next=this.prev=null),this}append(t){t.parent&&t.remove();let r=this.lastChild;return r?(r.next=t,t.prev=r,this.lastChild=t):this.lastChild=this.firstChild=t,t.parent=this,t}insert(t,r,n){t.parent&&t.remove();let o=r.parent||this;return n?(r===o.firstChild?o.firstChild=t:r.prev&&(r.prev.next=t),t.prev=r.prev,t.next=r,r.prev=t):(r===o.lastChild?o.lastChild=t:r.next&&(r.next.prev=t),t.next=r.next,t.prev=r,r.next=t),t.parent=o,t}getAll(t){let r=[];for(let n=this.firstChild;n;n=u1(n,this))n.name===t&&r.push(n);return r}children(){let t=[];for(let r=this.firstChild;r;r=r.next)t.push(r);return t}empty(){if(this.firstChild){let t=[];for(let r=this.firstChild;r;r=u1(r,this))t.push(r);let r=t.length;for(;r--;){let n=t[r];n.parent=n.firstChild=n.lastChild=n.next=n.prev=null}}return this.firstChild=this.lastChild=null,this}isEmpty(t,r={},n){var o;let a=this.firstChild;if(u3(this))return!1;if(a)do{if(1===a.type){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||u3(a))return!1}if(8===a.type||3===a.type&&!u2(a)||3===a.type&&a.parent&&r[a.parent.name]&&oy(null!==(o=a.value)&&void 0!==o?o:"")||n&&n(a))return!1}while(a=u1(a,this));return!0}walk(t){return u1(this,null,t)}}let u5=(t,r,n=0)=>{let o=t.toLowerCase();if(-1!==o.indexOf("[if ",n)&&/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(o.substr(n))){let t=o.indexOf("[endif]",n);return o.indexOf(">",t)}if(r){let t=o.indexOf(">",n);return -1!==t?t:o.length}{let r=/--!?>/g;r.lastIndex=n;let a=r.exec(t);return a?a.index+a[0].length:o.length}},u6=(t,r,n)=>{let o=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,a=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,l=t.getVoidElements(),i=1,s=n;for(;0!==i;)for(o.lastIndex=s;;){let t=o.exec(r);if(null===t)return s;if("!"===t[1]){s=e3(t[2],"--")?u5(r,!1,t.index+3):u5(r,!0,t.index+1);break}{a.lastIndex=o.lastIndex;let n=a.exec(r);if(T(n)||n.index!==o.lastIndex)continue;"/"===t[1]?i-=1:eI(l,t[2])||(i+=1),s=o.lastIndex+n[0].length;break}}return s},u9=(t,r)=>{let n;let o=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,a=t.schema,l=((t,r)=>{let n=RegExp(["\\s?("+t.join("|")+')="[^"]+"'].join("|"),"gi");return r.replace(n,"")})(t.getTempAttrs(),r),i=a.getVoidElements();for(;n=o.exec(l);){let t;let r=o.lastIndex,s=n[0].length;t=i[n[1]]?r:u6(a,l,r),l=l.substring(0,r-s)+l.substring(t),o.lastIndex=r-s}return ot(l)},u4=t=>{let r=np(t,"[data-mce-bogus]");el(r,t=>{"all"===t2(t,"data-mce-bogus")?ne(t):nZ(t)?(r3(t,rd("\uFEFF")),ne(t)):nt(t)})},u7=t=>{let r=np(t,"input");el(r,t=>{t5(t,"name")})},me=(t,r,n)=>{let o;return o="raw"===r.format?tM.trim(u9(t.serializer,n.innerHTML)):"text"===r.format?((t,r)=>{let n=t.getDoc(),o=rP(rl(t.getBody())),a=rs("div",n);t0(a,"data-mce-bogus","all"),rQ(a,{position:"fixed",left:"-9999999px",top:"0"}),no(a,r.innerHTML),u4(a),u7(a);let l=rT(o)?o:rl(rb(o).dom.body);r6(l,a);let i=ot(a.dom.innerText);return ne(a),i})(t,n):"tree"===r.format?t.serializer.serialize(n,r):((t,r)=>{let n=io(t),o=RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s|\xa0|<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return r.replace(o,"")})(t,t.serializer.serialize(n,r)),"text"!==r.format&&!n5(rl(n))&&N(o)?tM.trim(o):o},mt=tM.makeMap,mr=t=>{let r=[],n=(t=t||{}).indent,o=mt(t.indent_before||""),a=mt(t.indent_after||""),l=o7.getEncodeFunc(t.entity_encoding||"raw",t.entities),i="xhtml"!==t.element_format;return{start:(t,s,d)=>{if(n&&o[t]&&r.length>0){let t=r[r.length-1];t.length>0&&"\n"!==t&&r.push("\n")}if(r.push("<",t),s)for(let t=0,n=s.length;t<n;t++){let n=s[t];r.push(" ",n.name,'="',l(n.value,!0),'"')}if(r[r.length]=!d||i?">":" />",d&&n&&a[t]&&r.length>0){let t=r[r.length-1];t.length>0&&"\n"!==t&&r.push("\n")}},end:t=>{let o;r.push("</",t,">"),n&&a[t]&&r.length>0&&(o=r[r.length-1]).length>0&&"\n"!==o&&r.push("\n")},text:(t,n)=>{t.length>0&&(r[r.length]=n?t:l(t))},cdata:t=>{r.push("<![CDATA[",t,"]]>")},comment:t=>{r.push("<!--",t,"-->")},pi:(t,o)=>{o?r.push("<?",t," ",l(o),"?>"):r.push("<?",t,"?>"),n&&r.push("\n")},doctype:t=>{r.push("<!DOCTYPE",t,">",n?"\n":"")},reset:()=>{r.length=0},getContent:()=>r.join("").replace(/\n$/,"")}},mn=(t={},r=am())=>{let n=mr(t);return t.validate=!("validate"in t)||t.validate,{serialize:o=>{let a=t.validate,l={3:t=>{var r;n.text(null!==(r=t.value)&&void 0!==r?r:"",t.raw)},8:t=>{var r;n.comment(null!==(r=t.value)&&void 0!==r?r:"")},7:t=>{n.pi(t.name,t.value)},10:t=>{var r;n.doctype(null!==(r=t.value)&&void 0!==r?r:"")},4:t=>{var r;n.cdata(null!==(r=t.value)&&void 0!==r?r:"")},11:t=>{let r=t;if(r=r.firstChild)do i(r);while(r=r.next)}};n.reset();let i=t=>{var o;let s=l[t.type];if(s)s(t);else{let l=t.name,s=l in r.getVoidElements(),d=t.attributes;if(a&&d&&d.length>1){let n=[];n.map={};let o=r.getElementRule(t.name);if(o){for(let t=0,r=o.attributesOrder.length;t<r;t++){let r=o.attributesOrder[t];if(r in d.map){let t=d.map[r];n.map[r]=t,n.push({name:r,value:t})}}for(let t=0,r=d.length;t<r;t++){let r=d[t].name;if(!(r in n.map)){let t=d.map[r];n.map[r]=t,n.push({name:r,value:t})}}d=n}}if(n.start(l,d,s),!s){let r=t.firstChild;if(r){"pre"!==l&&"textarea"!==l||3!==r.type||"\n"!==(null===(o=r.value)||void 0===o?void 0:o[0])||n.text("\n",!0);do i(r);while(r=r.next)}n.end(l)}}};return 1!==o.type||t.inner?3===o.type?l[3](o):l[11](o):i(o),n.getContent()}}},mo=new Set;el(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{mo.add(t)});let ma=["font","text-decoration","text-emphasis"],ml=(t,r)=>eN(t.parseStyle(t.getAttrib(r,"style"))),mi=(t,r,n)=>{let o=ml(t,r),a=ml(t,n),l=o=>{var a,l;let i=null!==(a=t.getStyle(r,o))&&void 0!==a?a:"",s=null!==(l=t.getStyle(n,o))&&void 0!==l?l:"";return e7(i)&&e7(s)&&i!==s};return eo(o,t=>{let r=r=>eo(r,r=>r===t);if(!r(a)&&r(ma)){let t=ed(a,t=>eo(ma,r=>e3(t,r)));return eo(t,l)}return l(t)})},ms=(t,r,n)=>J.from(n.container()).filter(nA).exists(o=>r(o.data.charAt(n.offset()+(t?0:-1)))),md=q(ms,!0,dO),mc=q(ms,!1,dO),mu=t=>{let r=t.container();return nA(r)&&(0===r.data.length||nq(r.data)&&ck.isBookmarkNode(r.parentNode))},mm=(t,r)=>n=>sY(t?0:-1,n).filter(r).isSome(),mf=t=>nM(t)&&"block"===rJ(rl(t),"display"),mg=t=>nI(t)&&(!nC(t)||"all"!==t.getAttribute("data-mce-bogus")),mp=mm(!0,mf),mh=mm(!1,mf),mb=mm(!0,nj),mv=mm(!1,nj),my=mm(!0,n_),mC=mm(!1,n_),mx=mm(!0,mg),mw=mm(!1,mg),mE=(t,r)=>rp(r,t)?rx(t,t=>X(t)||rg(t,r)).slice(0,-1):[],mk=(t,r)=>[t].concat(mE(t,r)),mS=(t,r,n)=>ds(t,r,n,mu),m_=(t,r)=>ef(mk(rl(r.container()),t),nQ),mN=(t,r,n)=>mS(t,r.dom,n).forall(t=>m_(r,n).fold(()=>!sG(t,n,r.dom),o=>!sG(t,n,r.dom)&&rp(o,rl(t.container())))),mR=(t,r,n)=>m_(r,n).fold(()=>mS(t,r.dom,n).forall(t=>!sG(t,n,r.dom)),r=>mS(t,r.dom,n).isNone()),mA=q(mR,!1),mO=q(mR,!0),mT=q(mN,!1),mB=q(mN,!0),mD=t=>s8(t).exists(nZ),mP=(t,r,n)=>{let o=ed(mk(rl(n.container()),r),nQ),a=eE(o).getOr(r);return dl(t,a.dom,n).filter(mD)},mL=(t,r)=>s8(r).exists(nZ)||mP(!0,t,r).isSome(),mM=(t,r)=>J.from(r.getNode(!0)).map(rl).exists(nZ)||mP(!1,t,r).isSome(),mF=q(mP,!1),mI=q(mP,!0),mU=t=>lk.isTextPosition(t)&&!t.isAtStart()&&!t.isAtEnd(),mz=(t,r)=>{let n=ed(mk(rl(r.container()),t),nQ);return eE(n).getOr(t)},mj=(t,r)=>mU(r)?mc(r):mc(r)||du(mz(t,r).dom,r).exists(mc),mH=(t,r)=>mU(r)?md(r):md(r)||dc(mz(t,r).dom,r).exists(md),m$=t=>s8(t).bind(t=>rH(t,tG)).exists(t=>en(["pre","pre-wrap"],rJ(t,"white-space"))),mV=(t,r)=>n=>{var o;return L(o=new nb(n,t)[r]())&&nI(o)&&sH(o)},mq=(t,r)=>!m$(r)&&(du(t.dom,r).isNone()||dc(t.dom,r).isNone()||mA(t,r)||mO(t,r)||mM(t,r)||mL(t,r)||mj(t,r)||mH(t,r)),mW=(t,r)=>!m$(r)&&(mA(t,r)||mT(t,r)||mM(t,r)||mj(t,r)||((t,r)=>{let n=du(t.dom,r).getOr(r),o=mV(t.dom,"prev");return r.isAtStart()&&(o(r.container())||o(n.container()))})(t,r)),mK=(t,r)=>!m$(r)&&(mO(t,r)||mB(t,r)||mL(t,r)||mH(t,r)||((t,r)=>{let n=dc(t.dom,r).getOr(r),o=mV(t.dom,"next");return r.isAtEnd()&&(o(r.container())||o(n.container()))})(t,r)),mG=(t,r)=>mW(t,r)||mK(t,(t=>{let r=t.container(),n=t.offset();return nA(r)&&n<r.data.length?lk(r,n+1):t})(r)),mY=(t,r)=>dA(t.charAt(r)),mX=(t,r)=>dO(t.charAt(r)),mQ=(t,r,n)=>{let o=r.data,a=lk(r,0);return n||!mY(o,0)||mG(t,a)?!!(n&&mX(o,0)&&mW(t,a))&&(r.data="\xa0"+o.slice(1),!0):(r.data=" "+o.slice(1),!0)},mJ=(t,r,n)=>{let o=r.data,a=lk(r,o.length-1);return n||!mY(o,o.length-1)||mG(t,a)?!!(n&&mX(o,o.length-1)&&mK(t,a))&&(r.data=o.slice(0,-1)+"\xa0",!0):(r.data=o.slice(0,-1)+" ",!0)},mZ=(t,r)=>{let n=r.container();if(!nA(n))return J.none();if((t=>{let r=t.container();return nA(r)&&e2(r.data,"\xa0")})(r)){let o=mQ(t,n,!1)||(t=>{let r=t.data,n=(t=>{let r=t.split("");return ea(r,(t,n)=>dA(t)&&n>0&&n<r.length-1&&dT(r[n-1])&&dT(r[n+1])?" ":t).join("")})(r);return n!==r&&(t.data=n,!0)})(n)||mJ(t,n,!1);return tU(o,r)}if(mG(t,r)){let o=mQ(t,n,!0)||mJ(t,n,!0);return tU(o,r)}return J.none()},m0=(t,r,n)=>{if(0===n)return;let o=rl(t),a=rj(o,nQ).getOr(o),l=t.data.slice(r,r+n),i=r+n>=t.data.length&&mK(a,lk(t,t.data.length)),s=0===r&&mW(a,lk(t,0));t.replaceData(r,n,ow(l,4,s,i))},m1=(t,r)=>{let n=t.data.slice(r),o=n.length-e9(n).length;m0(t,r,o)},m2=(t,r)=>{let n=t.data.slice(0,r),o=n.length-e4(n).length;m0(t,r-o,o)},m3=(t,r,n,o=!0)=>{let a=e4(t.data).length,l=o?t:r,i=o?r:t;return o?l.appendData(i.data):l.insertData(0,i.data),ne(rl(i)),n&&m1(l,a),l},m8=(t,r)=>((t,r)=>{let n=t.container(),o=t.offset();return!lk.isTextPosition(t)&&n===r.parentNode&&o>lk.before(r).offset()})(r,t)?lk(r.container(),r.offset()-1):r,m5=t=>{var r;return op(t.previousSibling)?J.some(nA(r=t.previousSibling)?lk(r,r.data.length):lk.after(r)):t.previousSibling?df(t.previousSibling):J.none()},m6=t=>{var r;return op(t.nextSibling)?J.some(nA(r=t.nextSibling)?lk(r,0):lk.before(r)):t.nextSibling?dm(t.nextSibling):J.none()},m9=(t,r,n)=>(t?m6(n).orThunk(()=>m5(n)).orThunk(()=>dc(r,lk.after(n)).orThunk(()=>du(r,lk.before(n)))):m5(n).orThunk(()=>m6(n)).orThunk(()=>J.from(n.previousSibling?n.previousSibling:n.parentNode).bind(t=>du(r,lk.before(t))).orThunk(()=>dc(r,lk.after(n))))).map(q(m8,n)),m4=(t,r,n)=>{n.fold(()=>{t.focus()},n=>{t.selection.setRng(n.toRange(),r)})},m7=(t,r)=>r&&eI(t.schema.getBlockElements(),tV(r)),fe=t=>{if(oN(t)){let r=ri('<br data-mce-bogus="1">');return r7(t),r6(t,r),J.some(lk.before(r.dom))}return J.none()},ft=(t,r,n,o=!0)=>{var a;let l=m9(r,t.getBody(),n.dom),i=rj(n,q(m7,t),(a=t.getBody(),t=>t.dom===a)),s=((t,r,n)=>{let o=rw(t).filter(tY),a=rE(t).filter(tY);return ne(t),(o.isSome()&&a.isSome()&&r.isSome()?J.some(((t,r,o)=>{let a=t.dom,l=r.dom,i=a.data.length;return m3(a,l,n),o.container()===l?lk(a,i):o})(o.getOrDie(),a.getOrDie(),r.getOrDie())):J.none()).orThunk(()=>(n&&(o.each(t=>m2(t.dom,t.dom.length)),a.each(t=>m1(t.dom,0))),r))})(n,l,eI(t.schema.getTextInlineElements(),tV(n)));t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):i.bind(fe).fold(()=>{o&&m4(t,r,s)},n=>{o&&m4(t,r,J.some(n))})},fr=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,fn=(t,r)=>rm(rl(r),iT(t))&&!oU(t.schema,r)&&t.dom.isEditable(r),fo=t=>{var r,n;return"rtl"===aB.DOM.getStyle(t,"direction",!0)||(n=null!==(r=t.textContent)&&void 0!==r?r:"",fr.test(n))},fa=(t,r,n)=>{let o=ed(aB.DOM.getParents(n.container(),"*",r),t);return J.from(o[o.length-1])},fl=(t,r)=>{let n=r.container(),o=r.offset();return t?on(n)?nA(n.nextSibling)?lk(n.nextSibling,0):lk.after(n):ol(r)?lk(n,o+1):r:on(n)?nA(n.previousSibling)?lk(n.previousSibling,n.previousSibling.data.length):lk.before(n):oi(r)?lk(n,o-1):r},fi=q(fl,!0),fs=q(fl,!1),fd=(t,r)=>{let n=t=>t.stopImmediatePropagation();t.on("beforeinput input",n,!0),t.getDoc().execCommand(r),t.off("beforeinput input",n)},fc=t=>fd(t,"Delete"),fu=t=>n0(t)||n2(t),fm=(t,r)=>rp(t,r)?rH(r,fu,r=>tF(ry(r),t,rg)):J.none(),ff=(t,r=!0)=>{t.dom.isEmpty(t.getBody())&&t.setContent("",{no_selection:!r})},fg=(t,r,n)=>tI(dm(n),df(n),(o,a)=>{let l=fl(!0,o),i=fl(!1,a),s=fl(!1,r);return t?dc(n,s).exists(t=>t.isEqual(i)&&r.isEqual(l)):du(n,s).exists(t=>t.isEqual(l)&&r.isEqual(i))}).getOr(!0),fp=t=>(8===tq(t)||"#comment"===tV(t)?rw(t):rA(t)).bind(fp).orThunk(()=>J.some(t)),fh=(t,r,n,o=!0)=>{var a;r.deleteContents();let l=fp(n).getOr(n),i=rl(null!==(a=t.dom.getParent(l.dom,t.dom.isBlock))&&void 0!==a?a:n.dom);if(i.dom===t.getBody()?ff(t,o):oN(i)&&(n7(i),o&&t.selection.setCursorLocation(i.dom,0)),!rg(n,i)){let t=tF(ry(i),n)?[]:ry(i).map(r_).map(t=>ed(t,t=>!rg(i,t))).getOr([]);el(t.concat(r_(n)),t=>{rg(t,i)||rp(t,i)||!oN(t)||ne(t)})}},fb=t=>np(t,"td,th"),fv=(t,r)=>({start:t,end:r}),fy=lW([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),fC=(t,r)=>rq(rl(t),"td,th",r),fx=t=>!rg(t.start,t.end),fw=(t,r)=>dH(t.start,r).bind(n=>dH(t.end,r).bind(t=>tU(rg(n,t),n))),fE=t=>r=>fw(r,t).map(t=>{var n;return n=fb(t),{rng:r,table:t,cells:n}}),fk=(t,r,n,o)=>{if(n.collapsed||!t.forall(fx))return J.none();if(r.isSameTable){let r=t.bind(fE(o));return J.some({start:r,end:r})}{let t=fC(n.startContainer,o),r=fC(n.endContainer,o),a=t.bind(t=>dH(t,o).bind(r=>ek(fb(r)).map(r=>fv(t,r)))).bind(fE(o)),l=r.bind(t=>dH(t,o).bind(r=>eE(fb(r)).map(r=>fv(r,t)))).bind(fE(o));return J.some({start:a,end:l})}},fS=(t,r)=>eg(t,t=>rg(t,r)),f_=t=>tI(fS(t.cells,t.rng.start),fS(t.cells,t.rng.end),(r,n)=>t.cells.slice(r,n+1)),fN=(t,r)=>{let{startTable:n,endTable:o}=r,a=t.cloneRange();return n.each(t=>a.setStartAfter(t.dom)),o.each(t=>a.setEndBefore(t.dom)),a},fR=(t,r)=>{let n=r=>rg(t,r),o=((t,r)=>{let n=fC(t.startContainer,r),o=fC(t.endContainer,r);return tI(n,o,fv)})(r,n),a=((t,r)=>{let n=t=>dH(rl(t),r),o=n(t.startContainer),a=n(t.endContainer),l=o.isSome(),i=a.isSome(),s=tI(o,a,rg).getOr(!1);return{startTable:o,endTable:a,isStartInTable:l,isEndInTable:i,isSameTable:s,isMultiTable:!s&&l&&i}})(r,n);return o.exists(t=>!fx(t)&&fw(t,n).exists(t=>{let r=t.dom.rows;return 1===r.length&&1===r[0].cells.length})&&dq(t.start,r))?o.map(t=>fy.singleCellTable(r,t.start)):a.isMultiTable?fk(o,a,r,n).bind(({start:t,end:n})=>{let o=t.bind(f_).getOr([]),l=n.bind(f_).getOr([]);if(o.length>0&&l.length>0){let t=fN(r,a);return J.some(fy.multiTable(o,l,t))}return J.none()}):fk(o,a,r,n).bind(({start:t,end:r})=>t.or(r)).bind(t=>{let{isSameTable:n}=a,o=f_(t).getOr([]);if(n&&t.cells.length===o.length)return J.some(fy.fullTable(t.table));if(o.length>0){if(n)return J.some(fy.partialTable(o,J.none()));{let t=fN(r,a);return J.some(fy.partialTable(o,J.some({...a,rng:t})))}}return J.none()})},fA=t=>el(t,t=>{t5(t,"contenteditable"),n7(t)}),fO=(t,r,n,o)=>{let a=n.cloneRange();o?(a.setStart(n.startContainer,n.startOffset),a.setEndAfter(r.dom.lastChild)):(a.setStartBefore(r.dom.firstChild),a.setEnd(n.endContainer,n.endOffset)),fP(t,a,r,!1).each(t=>t())},fT=t=>{let r=dj(t),n=rl(t.selection.getNode());nU(n.dom)&&oN(n)?t.selection.setCursorLocation(n.dom,0):t.selection.collapse(!0),r.length>1&&eo(r,t=>rg(t,n))&&t0(n,"data-mce-selected","1")},fB=(t,r,n)=>J.some(()=>{let o=t.selection.getRng(),a=n.bind(({rng:n,isStartInTable:a})=>{var l;let i=(l=a?n.endContainer:n.startContainer,J.from(t.dom.getParent(l,t.dom.isBlock)).map(rl));n.deleteContents(),((t,r,n)=>{n.each(n=>{r?ne(n):(n7(n),t.selection.setCursorLocation(n.dom,0))})})(t,a,i.filter(oN));let s=a?r[0]:r[r.length-1];return fO(t,s,o,a),oN(s)?J.none():J.some(a?r.slice(1):r.slice(0,-1))}).getOr(r);fA(a),fT(t)}),fD=(t,r,n,o)=>J.some(()=>{let a=t.selection.getRng(),l=r[0],i=n[n.length-1];fO(t,l,a,!0),fO(t,i,a,!1);let s=oN(l)?r:r.slice(1),d=oN(i)?n:n.slice(0,-1);fA(s.concat(d)),o.deleteContents(),fT(t)}),fP=(t,r,n,o=!0)=>J.some(()=>{fh(t,r,n,o)}),fL=(t,r)=>J.some(()=>ft(t,!1,r)),fM=(t,r)=>ef(mk(r,t),n8),fF=(t,r)=>ef(mk(r,t),tJ("caption")),fI=(t,r)=>J.some(()=>{n7(r),t.selection.setCursorLocation(r.dom,0)}),fU=(t,r)=>t?my(r):mC(r),fz=(t,r,n)=>{let o=rl(t.getBody());return fF(o,n).fold(()=>((t,r,n,o)=>{let a=lk.fromRangeStart(t.selection.getRng());return fM(n,o).bind(o=>oN(o)?fI(t,o):di(r,t.getBody(),a).bind(t=>fM(n,rl(t.getNode())).bind(t=>rg(t,o)?J.none():J.some(U))))})(t,r,o,n).orThunk(()=>tU(((t,r)=>{let n=lk.fromRangeStart(t.selection.getRng());return fU(r,n)||dl(r,t.getBody(),n).exists(t=>fU(r,t))})(t,r),U)),n=>((t,r,n,o)=>{let a=lk.fromRangeStart(t.selection.getRng());return oN(o)?fI(t,o):di(r,t.getBody(),a).fold(()=>J.some(U),l=>dm(o.dom).bind(t=>df(o.dom).map(n=>r?a.isEqual(t)&&l.isEqual(n):a.isEqual(n)&&l.isEqual(t))).getOr(!0)?fI(t,o):fF(n,rl(l.getNode())).fold(()=>J.some(U),t=>tU(!rg(t,o),U)))})(t,r,o,n))},fj=(t,r)=>{let n=rl(t.selection.getStart(!0)),o=dj(t);return t.selection.isCollapsed()&&0===o.length?fz(t,r,n):((t,r,n)=>{let o=rl(t.getBody()),a=t.selection.getRng();return 0!==n.length?fB(t,n,J.none()):fF(o,r).fold(()=>fR(o,a).bind(r=>r.fold(q(fP,t),q(fL,t),q(fB,t),q(fD,t))),r=>fI(t,r))})(t,n,o)},fH=(t,r)=>{let n=r;for(;n&&n!==t;){if(nF(n)||nI(n))return n;n=n.parentNode}return null},f$=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],fV=tM.each,fq=t=>{let r=t.dom,n=new Set(t.serializer.getTempAttrs()),o=t=>eo(f$,r=>e3(t,r))||n.has(t);return{compare:(t,n)=>{if(t.nodeName!==n.nodeName||t.nodeType!==n.nodeType)return!1;let a=t=>{let n={};return fV(r.getAttribs(t),a=>{let l=a.nodeName.toLowerCase();"style"===l||o(l)||(n[l]=r.getAttrib(t,l))}),n},l=(t,r)=>{for(let n in t)if(eI(t,n)){let o=r[n];if(D(o)||t[n]!==o)return!1;delete r[n]}for(let t in r)if(eI(r,t))return!1;return!0};return(!(nC(t)&&nC(n))||!!l(a(t),a(n))&&!!l(r.parseStyle(r.getAttrib(t,"style")),r.parseStyle(r.getAttrib(n,"style"))))&&!dR(t)&&!dR(n)},isAttributeInternal:o}},fW=(t,r,n,o)=>{let a=n.name;for(let r=0,l=t.length;r<l;r++){let l=t[r];if(l.name===a){let t=o.nodes[a];t?t.nodes.push(n):o.nodes[a]={filter:l,nodes:[n]}}}if(n.attributes)for(let t=0,a=r.length;t<a;t++){let a=r[t],l=a.name;if(l in n.attributes.map){let t=o.attributes[l];t?t.nodes.push(n):o.attributes[l]={filter:a,nodes:[n]}}}},fK=(t,r)=>{let n=(t,n)=>{eA(t,t=>{let o=eS(t.nodes);el(t.filter.callbacks,a=>{for(let r=o.length-1;r>=0;r--){let a=o[r];((n?void 0===a.attr(t.filter.name):a.name!==t.filter.name)||P(a.parent))&&o.splice(r,1)}o.length>0&&a(o,t.filter.name,r)})})};n(t.nodes,!1),n(t.attributes,!0)},fG=(t,r,n,o={})=>{let a=((t,r,n)=>{let o={nodes:{},attributes:{}};return n.firstChild&&((n,a)=>{let l=n;for(;l=l.walk();)fW(t,r,l,o)})(n),o})(t,r,n);fK(a,o)},fY=(t,r,n)=>{if(t.insert&&r(n)){let t=new u8("br",1);t.attr("data-mce-bogus","1"),n.empty().append(t)}else n.empty().append(new u8("#text",3)).value="\xa0"},fX=(t,r)=>{let n=null==t?void 0:t.firstChild;return L(n)&&n===t.lastChild&&n.name===r},fQ=(t,r,n,o)=>o.isEmpty(r,n,r=>((t,r)=>{let n=t.getElementRule(r.name);return!0===(null==n?void 0:n.paddEmpty)})(t,r)),fJ=t=>{let r;for(let n=t;n;n=n.parent){let t=n.attr("contenteditable");if("false"===t)break;"true"===t&&(r=n)}return J.from(r)},fZ=(t,r,n=t.parent)=>{if(r.getSpecialElements()[t.name])t.empty().remove();else{let o=t.children();for(let t of o)n&&!r.isValidChild(n.name,t.name)&&fZ(t,r,n);t.unwrap()}},f0=(t,r,n,o=U)=>{let a=r.getTextBlockElements(),l=r.getNonEmptyElements(),i=r.getWhitespaceElements(),s=tM.makeMap("tr,td,th,tbody,thead,tfoot,table"),d=new Set,c=t=>t!==n&&!s[t.name];for(let n=0;n<t.length;n++){let s,u,m;let f=t[n];if(!f.parent||d.has(f))continue;if(a[f.name]&&"li"===f.parent.name){let t=f.next;for(;t&&a[t.name];)t.name="li",d.add(t),f.parent.insert(t,f.parent),t=t.next;f.unwrap();continue}let g=[f];for(s=f.parent;s&&!r.isValidChild(s.name,f.name)&&c(s);s=s.parent)g.push(s);if(s&&g.length>1){if(r.isValidChild(s.name,f.name)){g.reverse(),o(u=g[0].clone());let t=u;for(let n=0;n<g.length-1;n++){r.isValidChild(t.name,g[n].name)&&n>0?(o(m=g[n].clone()),t.append(m)):m=t;for(let t=g[n].firstChild;t&&t!==g[n+1];){let r=t.next;m.append(t),t=r}t=m}fQ(r,l,i,u)?s.insert(f,g[0],!0):(s.insert(u,g[0],!0),s.insert(f,u)),(fQ(r,l,i,s=g[0])||fX(s,"br"))&&s.empty().remove()}else fZ(f,r)}else if(f.parent){if("li"===f.name){let t=f.prev;if(t&&("ul"===t.name||"ol"===t.name)){t.append(f);continue}if((t=f.next)&&("ul"===t.name||"ol"===t.name)&&t.firstChild){t.insert(f,t.firstChild,!0);continue}let r=new u8("ul",1);o(r),f.wrap(r);continue}if(r.isValidChild(f.parent.name,"div")&&r.isValidChild("div",f.name)){let t=new u8("div",1);o(t),f.wrap(t)}else fZ(f,r)}}},f1=(t,r,n=r.parent)=>!(!n||!t.children[r.name]||t.isValidChild(n.name,r.name))||!(!n||"a"!==r.name||!((t,r)=>{let n=t;for(;n;){if("a"===n.name)return!0;n=n.parent}return!1})(n)),f2=t=>t.collapsed?t:(t=>{let r=lk.fromRangeStart(t),n=lk.fromRangeEnd(t),o=t.commonAncestorContainer;return dl(!1,o,n).map(a=>!sG(r,n,o)&&sG(r,a,o)?((t,r,n,o)=>{let a=document.createRange();return a.setStart(t,r),a.setEnd(n,o),a})(r.container(),r.offset(),a.container(),a.offset()):t).getOr(t)})(t),f3=(t,r)=>{let n=r.firstChild,o=r.lastChild;return n&&"meta"===n.name&&(n=n.next),o&&"mce_marker"===o.attr("id")&&(o=o.prev),((t,r)=>{var n;let o=t.getNonEmptyElements();return L(r)&&(r.isEmpty(o)||t.getBlockElements()[r.name]&&L(r.firstChild)&&r.firstChild===r.lastChild&&("br"===(n=r.firstChild).name||"\xa0"===n.value))})(t,o)&&(o=null==o?void 0:o.prev),!(!n||n!==o||"ul"!==n.name&&"ol"!==n.name)},f8=t=>{var r,n;return t.length>0&&(!(r=t[t.length-1]).firstChild||L(null==r?void 0:r.firstChild)&&r.firstChild===r.lastChild&&("\xa0"===(n=r.firstChild).data||nL(n)))?t.slice(0,-1):t},f5=(t,r)=>{let n=t.getParent(r,t.isBlock);return n&&"LI"===n.nodeName?n:null},f6=(t,r)=>{let n=lk.after(t),o=dt(r).prev(n);return o?o.toRange():null},f9=(t,r,n,o)=>{var a,l;let i=((t,r,n)=>{let o=r.serialize(n);return(t=>{var r,n;let o=t.firstChild,a=t.lastChild;return o&&"META"===o.nodeName&&(null===(r=o.parentNode)||void 0===r||r.removeChild(o)),a&&"mce_marker"===a.id&&(null===(n=a.parentNode)||void 0===n||n.removeChild(a)),t})(t.createFragment(o))})(r,t,o),s=f5(r,n.startContainer),d=f8(ed(null!==(l=null==(a=i.firstChild)?void 0:a.childNodes)&&void 0!==l?l:[],t=>"LI"===t.nodeName)),c=r.getRoot(),u=t=>{let o=lk.fromRangeStart(n),a=dt(r.getRoot()),l=1===t?a.prev(o):a.next(o),i=null==l?void 0:l.getNode();return!i||f5(r,i)!==s};return s?u(1)?((t,r,n)=>{let o=t.parentNode;return o&&tM.each(r,r=>{o.insertBefore(r,t)}),((t,r)=>{let n=lk.before(t),o=dt(r).next(n);return o?o.toRange():null})(t,n)})(s,d,c):u(2)?(r.insertAfter(d.reverse(),s),f6(d[0],c)):((t,r,n,o)=>{let a=((t,r)=>{let n=r.cloneRange(),o=r.cloneRange();return n.setStartBefore(t),o.setEndAfter(t),[n.cloneContents(),o.cloneContents()]})(t,o),l=t.parentNode;return l&&(l.insertBefore(a[0],t),tM.each(r,r=>{l.insertBefore(r,t)}),l.insertBefore(a[1],t),l.removeChild(t)),f6(r[r.length-1],n)})(s,d,c,n):null},f4=["pre"],f7=(t,r,n)=>{var o,a,l,i;let s=t.selection,d=t.dom,c=t.parser,u=n.merge,m=mn({validate:!0},t.schema),f='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';-1===r.indexOf("{$caret}")&&(r+="{$caret}"),r=r.replace(/\{\$caret\}/,f);let g=s.getRng(),p=g.startContainer,h=t.getBody();p===h&&s.isCollapsed()&&d.isBlock(h.firstChild)&&L(i=h.firstChild)&&!t.schema.getVoidElements()[i.nodeName]&&d.isEmpty(h.firstChild)&&((g=d.createRng()).setStart(h.firstChild,0),g.setEnd(h.firstChild,0),s.setRng(g)),s.isCollapsed()||(t=>{let r=t.dom,n=f2(t.selection.getRng());t.selection.setRng(n);let o=r.getParent(n.startContainer,nU);L(o)&&o===r.getParent(n.endContainer,nU)&&dq(rl(o),n)?fP(t,n,rl(o)):n.startContainer===n.endContainer&&n.endOffset-n.startOffset==1&&nA(n.startContainer.childNodes[n.startOffset])?n.deleteContents():t.getDoc().execCommand("Delete",!1)})(t);let b=s.getNode(),v={context:b.nodeName.toLowerCase(),data:n.data,insert:!0},y=c.parse(r,v);if(!0===n.paste&&f3(t.schema,y)&&f5(d,b))return(g=f9(m,d,s.getRng(),y))&&s.setRng(g),r;!0===n.paste&&((t,r,n,o)=>{var a;let l=r.firstChild,i=r.lastChild,s=l===("bookmark"===i.attr("data-mce-type")?i.prev:i),d=en(f4,l.name);if(s&&d){let r="false"!==l.attr("contenteditable"),i=(null===(a=t.getParent(n,t.isBlock))||void 0===a?void 0:a.nodeName.toLowerCase())===l.name,s=J.from(fH(o,n)).forall(nF);return r&&i&&s}return!1})(d,y,b,t.getBody())&&(null===(o=y.firstChild)||void 0===o||o.unwrap()),(t=>{let r=t;for(;r=r.walk();)1===r.type&&r.attr("data-mce-fragment","1")})(y);let C=y.lastChild;if(C&&"mce_marker"===C.attr("id")){let r=C;for(C=C.prev;C;C=C.walk(!0))if(3===C.type||!d.isBlock(C.name)){C.parent&&t.schema.isValidChild(C.parent.name,"span")&&C.parent.insert(r,C,"br"===C.name);break}}if(t._selectionOverrides.showBlockCaretContainer(b),v.invalid){t.selection.setContent(f);let n,o=s.getNode(),l=t.getBody();for(nD(o)?o=n=l:n=o;n&&n!==l;)o=n,n=n.parentNode;r=o===l?l.innerHTML:d.getOuterHTML(o);let i=c.parse(r),u=(t=>{for(let r=t;r;r=r.walk())if("mce_marker"===r.attr("id"))return J.some(r);return J.none()})(i),g=u.bind(fJ).getOr(i);u.each(t=>t.replace(y));let p=y.children(),h=null!==(a=y.parent)&&void 0!==a?a:i;y.unwrap();let b=ed(p,r=>f1(t.schema,r,h));f0(b,t.schema,g),fG(c.getNodeFilters(),c.getAttributeFilters(),i),r=m.serialize(i),o===l?d.setHTML(l,r):d.setOuterHTML(o,r)}else((t,r,n)=>{var o;if("all"===n.getAttribute("data-mce-bogus"))null===(o=n.parentNode)||void 0===o||o.insertBefore(t.dom.createFragment(r),n);else{let o=n.firstChild,a=n.lastChild;o&&(o!==a||"BR"!==o.nodeName)?t.selection.setContent(r,{no_events:!0}):t.dom.setHTML(n,r)}})(t,r=m.serialize(y),b);return((t,r)=>{let n=t.schema.getTextInlineElements(),o=t.dom;if(r){let r=t.getBody(),a=fq(t);tM.each(o.select("*[data-mce-fragment]"),t=>{if(L(n[t.nodeName.toLowerCase()])&&eb(ml(o,t),t=>!mo.has(t))){for(let n=t.parentElement;L(n)&&n!==r&&!mi(o,t,n);n=n.parentElement)if(a.compare(n,t)){o.remove(t,!0);break}}})}})(t,u),((t,r)=>{var n,o,a,l;let i,s;let d=t.dom,c=t.selection;if(!r)return;c.scrollIntoView(r);let u=fH(t.getBody(),r);if(u&&"false"===d.getContentEditable(u))return d.remove(r),void c.select(u);let m=d.createRng(),f=r.previousSibling;if(nA(f)){m.setStart(f,null!==(o=null===(n=f.nodeValue)||void 0===n?void 0:n.length)&&void 0!==o?o:0);let t=r.nextSibling;nA(t)&&(f.appendData(t.data),null===(a=t.parentNode)||void 0===a||a.removeChild(t))}else m.setStartBefore(r),m.setEndBefore(r);let g=d.getParent(r,d.isBlock);d.remove(r),g&&d.isEmpty(g)&&(r7(rl(g)),m.setStart(g,0),m.setEnd(g,0),nU(g)||g.getAttribute("data-mce-fragment")||(l=m,s=lk.fromRangeStart(l),!(i=null==(s=dt(t.getBody()).next(s))?void 0:s.toRange()))?d.add(g,d.create("br",{"data-mce-bogus":"1"})):(m=i,d.remove(g))),c.setRng(m)})(t,d.get("mce_marker")),l=t.getBody(),tM.each(l.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")}),((t,r)=>{J.from(t.getParent(r,"td,th")).map(rl).each(oe)})(d,s.getStart()),el(eS(t.getBody().querySelectorAll("details")),t=>{let r=ed(eS(t.children),t=>"SUMMARY"===t.nodeName);r.length>1&&el(r.slice(1),t=>{let r=rl(t);ro(r,"mce-accordion-summary"),a9(r,"p")})}),((t,r,n)=>{let o=rx(rl(n),t=>rg(t,rl(r)));ew(o,o.length-2).filter(tG).fold(()=>oP(t,r),r=>oP(t,r.dom))})(t.schema,t.getBody(),s.getStart()),r},ge=t=>t instanceof u8,gt=(t,r,n)=>{t.dom.setHTML(t.getBody(),r),!0!==n&&uH(t)&&dm(t.getBody()).each(r=>{let n=r.getNode(),o=n_(n)?dm(n).getOr(r):r;t.selection.setRng(o.toRange())})},gr=(t,r)=>((t,r)=>{var n,o;let a=t.dom;return a.parentNode?(n=rl(a.parentNode),o=n=>!rg(t,n)&&r(n),ef(n.dom.childNodes,t=>o(rl(t))).map(rl)):J.none()})(t,r).isSome(),gn=t=>M(t)?t:X,go=(t,r,n)=>{let o=r(t),a=gn(n);return o.orThunk(()=>a(t)?J.none():((t,r,n)=>{let o=t.dom,a=gn(n);for(;o.parentNode;){o=o.parentNode;let t=rl(o),n=r(t);if(n.isSome())return n;if(a(t))break}return J.none()})(t,r,a))},ga=(t,r,n)=>{let o=t.formatter.get(n);if(o)for(let n=0;n<o.length;n++){let a=o[n];if(co(a)&&!1===a.inherit&&t.dom.is(r,a.selector))return!0}return!1},gl=(t,r,n,o,a)=>{let l=t.dom.getRoot();if(r===l)return!1;let i=t.dom.getParent(r,r=>!!ga(t,r,n)||r.parentNode===l||!!gd(t,r,n,o,!0));return!!gd(t,i,n,o,a)},gi=(t,r,n)=>!(!ca(n)||!d9(r,n.inline))||!(!cn(n)||!d9(r,n.block))||!!co(n)&&nC(r)&&t.is(r,n.selector),gs=(t,r,n,o,a,l)=>{let i=n[o],s="attributes"===o;if(M(n.onmatch))return n.onmatch(r,n,o);if(i){if(ej(i))for(let n=0;n<i.length&&(s?!t.getAttrib(r,i[n]):!d7(t,r,i[n]));n++);else for(let o in i)if(eI(i,o)){let d=s?t.getAttrib(r,o):d7(t,r,o),c=d6(i[o],l),u=P(d)||te(d);if(u&&P(c))continue;if(a&&u&&!n.exact||(!a||n.exact)&&!d9(d,d4(c,o)))return!1}}return!0},gd=(t,r,n,o,a)=>{let l=t.formatter.get(n),i=t.dom;if(l&&nC(r))for(let n=0;n<l.length;n++){let s=l[n];if(gi(t.dom,r,s)&&gs(i,r,s,"attributes",a,o)&&gs(i,r,s,"styles",a,o)){let n=s.classes;if(n){for(let a=0;a<n.length;a++)if(!t.dom.hasClass(r,d6(n[a],o)))return}return s}}},gc=(t,r,n,o,a)=>{if(o)return gl(t,o,r,n,a);if(o=t.selection.getNode(),gl(t,o,r,n,a))return!0;let l=t.selection.getStart();return!(l===o||!gl(t,l,r,n,a))},gu=t=>(t=>{let r=[],n=t;for(;n;){if(nA(n)&&"\uFEFF"!==n.data||n.childNodes.length>1)return[];nC(n)&&r.push(n),n=n.firstChild}return r})(t).length>0,gm=t=>{if(t){let r=new nb(t,t);for(let t=r.current();t;t=r.next())if(nA(t))return t}return null},gf=t=>{let r=rs("span");return t1(r,{id:dg,"data-mce-bogus":"1","data-mce-type":"format-caret"}),t&&r6(r,rd("\uFEFF")),r},gg=(t,r,n=!0)=>{let o=t.dom,a=t.selection;if(gu(r))ft(t,!1,rl(r),n);else{let t=a.getRng(),n=o.getParent(r,o.isBlock),l=t.startContainer,i=t.startOffset,s=t.endContainer,d=t.endOffset,c=(t=>{let r=gm(t);return r&&"\uFEFF"===r.data.charAt(0)&&r.deleteData(0,1),r})(r);o.remove(r,!0),l===c&&i>0&&t.setStart(c,i-1),s===c&&d>0&&t.setEnd(c,d-1),n&&o.isEmpty(n)&&n7(rl(n)),a.setRng(t)}},gp=(t,r,n=!0)=>{let o=t.dom,a=t.selection;if(r)gg(t,r,n);else if(!(r=dh(t.getBody(),a.getStart())))for(;r=o.get(dg);)gg(t,r,n)},gh=(t,r)=>(t.appendChild(r),r),gb=(t,r)=>{var n;let o=ec(t,(t,r)=>gh(t,r.cloneNode(!1)),r),a=null!==(n=o.ownerDocument)&&void 0!==n?n:document;return gh(o,a.createTextNode("\uFEFF"))},gv=(t,r,n,o)=>{let a;let l=t.dom,i=t.selection,s=!1,d=t.formatter.get(r);if(!d)return;let c=i.getRng(),u=c.startContainer,m=c.startOffset,f=u;nA(u)&&(m!==u.data.length&&(s=!0),f=f.parentNode);let g=[];for(;f;){if(gd(t,f,r,n,o)){a=f;break}f.nextSibling&&(s=!0),g.push(f),f=f.parentNode}if(a){if(s){let a=i.getBookmark();c.collapse(!0);let s=cb(l,c,d,!0);s=c7(s),t.formatter.remove(r,n,s,o),i.moveToBookmark(a)}else{let s=dh(t.getBody(),a),d=gf(!1).dom;((t,r,n)=>{var o,a;let l=t.dom,i=l.getParent(n,q(d2,t.schema));i&&l.isEmpty(i)?null===(o=n.parentNode)||void 0===o||o.replaceChild(r,n):((t=>{let r=np(t,"br"),n=ed((t=>{let r=[],n=t.dom;for(;n;)r.push(rl(n)),n=n.lastChild;return r})(t).slice(-1),nZ);r.length===n.length&&el(n,ne)})(rl(n)),l.isEmpty(n)?null===(a=n.parentNode)||void 0===a||a.replaceChild(r,n):l.insertAfter(r,n))})(t,d,null!=s?s:a);let c=((t,r,n,o,a,l)=>{let i=t.formatter,s=t.dom,d=ed(eN(i.get()),t=>t!==o&&!e2(t,"removeformat")),c=eu(d,(r,o)=>{let a=cr(t,o,t=>{let r=t=>M(t)||t.length>1&&"%"===t.charAt(0);return eo(["styles","attributes"],n=>eF(t,n).exists(t=>{let n=O(t)?t:eM(t);return eo(n,r)}))});return t.formatter.matchNode(n,o,{},a)?r.concat([o]):r},[]);if(ed(c,r=>!((t,r,n)=>{let o=["inline","block","selector","attributes","styles","classes"],a=t=>eP(t,(t,r)=>eo(o,t=>t===r));return cr(t,r,r=>{let o=a(r);return cr(t,n,t=>{let r=a(t);return((t,r,n=C)=>y(n).eq(t,r))(o,r)})})})(t,r,o)).length>0){let t=n.cloneNode(!1);return s.add(r,t),i.remove(o,a,t,l),s.remove(t),J.some(t)}return J.none()})(t,d,a,r,n,o),u=gb(g.concat(c.toArray()),d);s&&gg(t,s,!1),i.setCursorLocation(u,1),l.isEmpty(a)&&l.remove(a)}}},gy=t=>{let r=gf(!1),n=gb(t,r.dom);return{caretContainer:r,caretPosition:lk(n,0)}},gC=(t,r)=>{let{caretContainer:n,caretPosition:o}=gy(r);return r3(rl(t),n),ne(rl(t)),o},gx=(t,r)=>{let n=t.schema.getTextInlineElements();return eI(n,tV(r))&&!dp(r.dom)&&!nS(r.dom)},gw=t=>dp(t.dom)&&gu(t.dom),gE={},gk=nw(["pre"]);gE.pre||(gE.pre=[]),gE.pre.push(t=>{if(!t.selection.getRng().collapsed){let r=t.selection.getSelectedBlocks(),n=ed(ed(r,gk),t=>{let n=t.previousSibling;return gk(n)&&en(r,n)});el(n,t=>{((t,r)=>{let n=rl(r),o=rb(n).dom;ne(n),r4(rl(t),[rs("br",o),rs("br",o),...r_(n)])})(t.previousSibling,t)})}});let gS=["fontWeight","fontStyle","color","fontSize","fontFamily"],g_=(t,r)=>{let n=t.get(r);return O(n)?ef(n,t=>ca(t)&&"span"===t.inline&&R(t.styles)&&eo(eN(t.styles),t=>en(gS,t))):J.none()},gN=(t,r)=>du(r,lk.fromRangeStart(t)).isNone(),gR=(t,r)=>!1===dc(r,lk.fromRangeEnd(t)).exists(t=>!nL(t.getNode())||dc(r,t).isSome()),gA=t=>r=>nH(r)&&t.isEditable(r),gO=t=>ed(t.getSelectedBlocks(),gA(t.dom)),gT=tM.each,gB=t=>nC(t)&&!dR(t)&&!dp(t)&&!nS(t),gD=(t,r)=>{for(let n=t;n&&!(nA(n)&&e7(n.data));n=n[r])if(nC(n)&&!dR(n))return n;return t},gP=(t,r,n)=>{let o=fq(t),a=nC(r)&&dJ(r),l=nC(n)&&dJ(n);if(a&&l){let a=gD(r,"previousSibling"),l=gD(n,"nextSibling");if(o.compare(a,l)){for(let t=a.nextSibling;t&&t!==l;){let r=t;t=t.nextSibling,a.appendChild(r)}return t.dom.remove(l),tM.each(tM.grep(l.childNodes),t=>{a.appendChild(t)}),a}}return n},gL=(t,r,n,o)=>{var a;if(o&&!1!==r.merge_siblings){let r=null!==(a=gP(t,d1(o),o))&&void 0!==a?a:o;gP(t,r,d1(r,!0))}},gM=(t,r,n)=>{gT(t.childNodes,t=>{gB(t)&&(r(t)&&n(t),t.hasChildNodes()&&gM(t,r,n))})},gF=(t,r)=>n=>!(!n||!d7(t,n,r)),gI=(t,r,n)=>o=>{t.setStyle(o,r,n),""===o.getAttribute("style")&&o.removeAttribute("style"),"SPAN"===o.nodeName&&0===t.getAttribs(o).length&&t.remove(o,!0)},gU=lW([{keep:[]},{rename:["name"]},{removed:[]}]),gz=/^(src|href|style)$/,gj=tM.each,gH=(t,r,n)=>t.isChildOf(r,n)&&r!==n&&!t.isBlock(n),g$=(t,r,n)=>{let o=r[n?"startContainer":"endContainer"],a=r[n?"startOffset":"endOffset"];if(nC(o)){let t=o.childNodes.length-1;!n&&a&&a--,o=o.childNodes[a>t?t:a]}return nA(o)&&n&&a>=o.data.length&&(o=new nb(o,t.getBody()).next()||o),nA(o)&&!n&&0===a&&(o=new nb(o,t.getBody()).prev()||o),o},gV=(t,r)=>{let n=r?"firstChild":"lastChild",o=t[n];return/^(TR|TH|TD)$/.test(t.nodeName)&&o?"TR"===t.nodeName&&o[n]||o:t},gq=(t,r,n,o)=>{var a;let l=t.create(n,o);return null===(a=r.parentNode)||void 0===a||a.insertBefore(l,r),l.appendChild(r),l},gW=(t,r,n,o,a)=>{let l=rl(r),i=rl(t.create(o,a)),s=n?rS(l):rk(l);return r4(i,s),n?(r3(l,i),r5(i,l)):(r8(l,i),r6(i,l)),i.dom},gK=(t,r,n)=>{let o;let a=r.parentNode,l=t.dom,i=io(t);cn(n)&&a===l.getRoot()&&(n.list_block&&d9(r,n.list_block)||el(eS(r.childNodes),r=>{d3(t,i,r.nodeName.toLowerCase())?o?o.appendChild(r):(o=gq(l,r,i),l.setAttribs(o,ia(t))):o=null})),co(n)&&ca(n)&&tF(eF(n,"mixed"),!0)&&!d9(n.inline,r)||l.remove(r,!0)},gG=(t,r,n)=>F(t)?{name:r,value:null}:{name:t,value:d6(r,n)},gY=(t,r)=>{""===t.getAttrib(r,"style")&&(r.removeAttribute("style"),r.removeAttribute("data-mce-style"))},gX=(t,r,n,o,a)=>{let l=!1;gj(n.styles,(i,s)=>{let{name:d,value:c}=gG(s,i,o),u=d4(c,d);(n.remove_similar||T(c)||!nC(a)||d9(d7(t,a,d),u))&&t.setStyle(r,d,""),l=!0}),l&&gY(t,r)},gQ=(t,r,n,o,a)=>{let l=t.dom,i=fq(t),s=t.schema;if(ca(r)&&oF(s,r.inline)&&oU(s,o)&&o.parentElement===t.getBody())return gK(t,o,r),gU.removed();if(!r.ceFalseOverride&&o&&"false"===l.getContentEditableParent(o)||o&&!gi(l,o,r)&&(!r.links||"A"!==o.nodeName))return gU.keep();let d=r.preserve_attributes;if(ca(r)&&"all"===r.remove&&O(d)){let t=ed(l.getAttribs(o),t=>en(d,t.name.toLowerCase()));if(l.removeAllAttribs(o),el(t,t=>l.setAttrib(o,t.name,t.value)),t.length>0)return gU.rename("span")}if("all"!==r.remove){gX(l,o,r,n,a),gj(r.attributes,(t,i)=>{let{name:s,value:d}=gG(i,t,n);if(r.remove_similar||T(d)||!nC(a)||d9(l.getAttrib(a,s),d)){if("class"===s){let t=l.getAttrib(o,s);if(t){let r="";if(el(t.split(/\s+/),t=>{/mce\-\w+/.test(t)&&(r+=(r?" ":"")+t)}),r)return void l.setAttrib(o,s,r)}}if(gz.test(s)&&o.removeAttribute("data-mce-"+s),"style"===s&&nw(["li"])(o)&&"none"===l.getStyle(o,"list-style-type"))return o.removeAttribute(s),void l.setStyle(o,"list-style-type","none");"class"===s&&o.removeAttribute("className"),o.removeAttribute(s)}}),gj(r.classes,t=>{t=d6(t,n),nC(a)&&!l.hasClass(a,t)||l.removeClass(o,t)});let t=l.getAttribs(o);for(let r=0;r<t.length;r++){let n=t[r].nodeName;if(!i.isAttributeInternal(n))return gU.keep()}}return"none"!==r.remove?(gK(t,o,r),gU.removed()):gU.keep()},gJ=(t,r,n,o)=>gQ(t,r,n,o,o).fold(H(o),r=>(t.dom.createFragment().appendChild(o),t.dom.rename(o,r)),H(null)),gZ=(t,r,n,o,a)=>{(o||t.selection.isEditable())&&((t,r,n,o,a)=>{let l=t.formatter.get(r),i=l[0],s=t.dom,d=t.selection,c=o=>{let s;let d=(o.parentNode&&el(ct(t.dom,o.parentNode).reverse(),o=>{if(!s&&nC(o)&&"_start"!==o.id&&"_end"!==o.id){let l=gd(t,o,r,n,a);l&&!1!==l.split&&(s=o)}}),s);return((t,r,n,o,a,l,i,s)=>{var d,c;let u,m;let f=t.dom;if(n){let l=n.parentNode;for(let n=o.parentNode;n&&n!==l;n=n.parentNode){let o=f.clone(n,!1);for(let n=0;n<r.length&&null!==(o=gJ(t,r[n],s,o));n++);o&&(u&&o.appendChild(u),m||(m=o),u=o)}i.mixed&&f.isBlock(n)||(o=null!==(d=f.split(n,o))&&void 0!==d?d:o),u&&m&&(null===(c=a.parentNode)||void 0===c||c.insertBefore(u,a),m.appendChild(a),ca(i)&&gL(t,i,0,u))}return o})(t,l,d,o,o,0,i,n)},u=r=>eo(l,o=>g0(t,o,n,r,r)),m=r=>{let n=eS(r.childNodes),o=u(r)||eo(l,t=>gi(s,r,t)),a=r.parentNode;if(!o&&L(a)&&cl(i)&&u(a),i.deep&&n.length)for(let t=0;t<n.length;t++)m(n[t]);el(["underline","line-through","overline"],n=>{nC(r)&&t.dom.getStyle(r,"text-decoration")===n&&r.parentNode&&ce(s,r.parentNode)===n&&g0(t,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},void 0,r)})},f=t=>{let r=s.get(t?"_start":"_end");if(r){var n;let o=r[t?"firstChild":"lastChild"];return dR(n=o)&&nC(n)&&("_start"===n.id||"_end"===n.id)&&(o=o[t?"firstChild":"lastChild"]),nA(o)&&0===o.data.length&&(o=t?r.previousSibling||r.nextSibling:r.nextSibling||r.previousSibling),s.remove(r,!0),o}return null},g=r=>{let n,o,a=cb(s,r,l,r.collapsed);if(i.split){if(a=c7(a),n=g$(t,a,!0),o=g$(t,a),n!==o){if(n=gV(n,!0),o=gV(o,!1),gH(s,n,o)){let t=J.from(n.firstChild).getOr(n);return c(gW(s,t,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void f(!0)}if(gH(s,o,n)){let t=J.from(o.lastChild).getOr(o);return c(gW(s,t,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void f(!1)}n=gq(s,n,"span",{id:"_start","data-mce-type":"bookmark"}),o=gq(s,o,"span",{id:"_end","data-mce-type":"bookmark"});let t=s.createRng();t.setStartAfter(n),t.setEndBefore(o),cv(s,t,t=>{el(t,t=>{dR(t)||dR(t.parentNode)||c(t)})}),c(n),c(o),n=f(!0),o=f()}else n=o=c(n);a.startContainer=n.parentNode?n.parentNode:n,a.startOffset=s.nodeIndex(n),a.endContainer=o.parentNode?o.parentNode:o,a.endOffset=s.nodeIndex(o)+1}cv(s,a,t=>{el(t,m)})};if(o){if(dX(o)){let t=s.createRng();t.setStartBefore(o),t.setEndAfter(o),g(t)}else g(o);cR(t,r,o,n)}else d.isCollapsed()&&ca(i)&&!dj(t).length?gv(t,r,n,a):(dZ(t,()=>dG(t,g),o=>ca(i)&&gc(t,r,n,o)),t.nodeChanged()),"removeformat"===r?el(gO(t.selection),r=>{el(gS,n=>t.dom.setStyle(r,n,"")),gY(t.dom,r)}):g_(t.formatter,r).each(r=>{el(gO(t.selection),o=>gX(t.dom,o,r,n,null))}),cR(t,r,o,n)})(t,r,n,o,a)},g0=(t,r,n,o,a)=>gQ(t,r,n,o,a).fold(X,r=>(t.dom.rename(o,r),!0),Q),g1=tM.each,g2=tM.each,g3=(t,r,n,o)=>{if(g2(n.styles,(n,a)=>{t.setStyle(r,a,d6(n,o))}),n.styles){let n=t.getAttrib(r,"style");n&&t.setAttrib(r,"data-mce-style",n)}},g8=(t,r,n,o)=>{let a=t.formatter.get(r),l=a[0],i=!o&&t.selection.isCollapsed(),s=t.dom,d=t.selection,c=(t,r=l)=>{M(r.onformat)&&r.onformat(t,r,n,o),g3(s,t,r,n),g2(r.attributes,(r,o)=>{s.setAttrib(t,o,d6(r,n))}),g2(r.classes,r=>{let o=d6(r,n);s.hasClass(t,o)||s.addClass(t,o)})},u=(t,r)=>{let n=!1;return g2(t,t=>!(!co(t)||("false"!==s.getContentEditable(r)||t.ceFalseOverride)&&(!L(t.collapsed)||t.collapsed===i)&&s.is(r,t.selector)&&!dp(r)&&(c(r,t),n=!0,1))),n},m=t=>{if(N(t)){let r=s.create(t);return c(r),r}return null},f=(o,i,s)=>{let d=[],f=!0,g=l.inline||l.block,p=m(g);cv(o,i,i=>{let m;let h=i=>{let b=!1,v=f,y=!1,C=i.parentNode,x=C.nodeName.toLowerCase(),w=o.getContentEditable(i);L(w)&&(v=f,f="true"===w,b=!0,y=d5(t,i));let E=f&&!b;if(nL(i)&&!((t,r,n,o)=>{if(iV(t)&&ca(r)&&n.parentNode){let r=ac(t.schema),a=gr(rl(n),t=>dp(t.dom));return eU(r,o)&&oN(rl(n.parentNode),!1)&&!a}return!1})(t,l,i,x))return m=null,void(cn(l)&&o.remove(i));if(cn(l)&&!0===l.wrapper&&gd(t,i,r,n))m=null;else{if(((r,n,o)=>{let a=cn(l)&&!0!==l.wrapper&&d2(t.schema,r)&&d3(t,n,g);return o&&a})(i,x,E)){let t=o.rename(i,g);return c(t),d.push(t),void(m=null)}if(co(l)){let t=u(a,i);if(!t&&L(C)&&cl(l)&&(t=u(a,C)),!ca(l)||t)return void(m=null)}L(p)&&((r,n,a,i)=>{let d=r.nodeName.toLowerCase(),c=d3(t,g,d)&&d3(t,n,g),u=!s&&nA(r)&&nq(r.data),m=dp(r),f=!ca(l)||!o.isBlock(r);return(a||i)&&c&&!u&&!m&&f})(i,x,E,y)?(m||(m=o.clone(p,!1),C.insertBefore(m,i),d.push(m)),y&&b&&(f=v),m.appendChild(i)):(m=null,el(eS(i.childNodes),h),b&&(f=v),m=null)}};el(i,h)}),!0===l.links&&el(d,t=>{let r=t=>{"A"===t.nodeName&&c(t,l),el(eS(t.childNodes),r)};r(t)}),el(d,i=>{var s;let u;let m=(u=0,el(i.childNodes,t=>{L(t)&&nA(t)&&0===t.length||dR(t)||u++}),u);!(d.length>1)&&o.isBlock(i)||0!==m?(ca(l)||cn(l)&&l.wrapper)&&(l.exact||1!==m||(i=(t=>{let r=ef(t.childNodes,dQ).filter(t=>"false"!==o.getContentEditable(t)&&gi(o,t,l));return r.map(r=>{let n=o.clone(r,!1);return c(n),o.replace(n,t,!0),o.remove(r,!0),n}).getOr(t)})(i)),s=i,g1(a,r=>{ca(r)&&g1(t.dom.select(r.inline,s),o=>{gB(o)&&g0(t,r,n,o,r.exact?o:null)}),((t,r,n)=>{if(r.clear_child_styles){let o=r.links?"*:not(a)":"*";gT(t.select(o,n),n=>{gB(n)&&dJ(n)&&gT(r.styles,(r,o)=>{t.setStyle(n,o,"")})})}})(t.dom,r,s)}),((t,r,n,o,a)=>{let l=a.parentNode;gd(t,l,n,o)&&g0(t,r,o,a)||r.merge_with_parents&&l&&t.dom.getParent(l,l=>!!gd(t,l,n,o)&&(g0(t,r,o,a),!0))})(t,l,r,n,i),((t,r,n,o)=>{if(r.styles&&r.styles.backgroundColor){let a=gF(t,"fontSize");gM(o,t=>a(t)&&dJ(t),gI(t,"backgroundColor",d6(r.styles.backgroundColor,n)))}})(o,l,n,i),((t,r,n,o)=>{let a=r=>{if(nC(r)&&nC(r.parentNode)&&dJ(r)){let n=ce(t,r.parentNode);t.getStyle(r,"color")&&n?t.setStyle(r,"text-decoration",n):t.getStyle(r,"text-decoration")===n&&t.setStyle(r,"text-decoration",null)}};r.styles&&(r.styles.color||r.styles.textDecoration)&&(tM.walk(o,a,"childNodes"),a(o))})(o,l,0,i),((t,r,n,o)=>{if(ca(r)&&("sub"===r.inline||"sup"===r.inline)){let n=gF(t,"fontSize");gM(o,t=>n(t)&&dJ(t),gI(t,"fontSize",""));let a=ed(t.select("sup"===r.inline?"sub":"sup",o),dJ);t.remove(a,!0)}})(o,l,0,i),gL(t,l,0,i)):o.remove(i,!0)})},g=dX(o)?o:d.getNode();if("false"===s.getContentEditable(g)&&!d5(t,g))return u(a,o=g),void cN(t,r,o,n);if(l){if(o){if(dX(o)){if(!u(a,o)){let t=s.createRng();t.setStartBefore(o),t.setEndAfter(o),f(s,cb(s,t,a),!0)}}else f(s,o,!0)}else i&&ca(l)&&!dj(t).length?((t,r,n)=>{var o,a;let l;let i=t.selection,s=t.formatter.get(r);if(!s)return;let d=i.getRng(),c=d.startOffset,u=d.startContainer.nodeValue;l=dh(t.getBody(),i.getStart());let m=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(u&&c>0&&c<u.length&&m.test(u.charAt(c))&&m.test(u.charAt(c-1))){let o=i.getBookmark();d.collapse(!0);let a=cb(t.dom,d,s);a=c7(a),t.formatter.apply(r,n,a),i.moveToBookmark(o)}else{let s=l?gm(l):null;l&&(null==s?void 0:s.data)==="\uFEFF"||(o=t.getDoc(),a=gf(!0).dom,s=(l=o.importNode(a,!0)).firstChild,d.insertNode(l),c=1),t.formatter.apply(r,n,l),i.setCursorLocation(s,c)}})(t,r,n):(d.setRng(f2(d.getRng())),dZ(t,()=>{dG(t,(t,r)=>{let n=r?t:cb(s,t,a);f(s,n,!1)})},Q),t.nodeChanged()),g_(t.formatter,r).each(r=>{var o;el(ed((t=>{let r=t.getSelectedBlocks(),n=t.getRng();if(t.isCollapsed())return[];if(1===r.length)return gN(n,r[0])&&gR(n,r[0])?r:[];{let t=eE(r).filter(t=>gN(n,t)).toArray(),o=ek(r).filter(t=>gR(n,t)).toArray(),a=r.slice(1,-1);return t.concat(a).concat(o)}})(o=t.selection),gA(o.dom)),t=>g3(s,t,r,n))});eI(gE,r)&&el(gE[r],r=>{r(t)})}cN(t,r,o,n)},g5=(t,r,n,o)=>{(o||t.selection.isEditable())&&g8(t,r,n,o)},g6=t=>eI(t,"vars"),g9=t=>t.selection.getStart(),g4=(t,r,n,o,a)=>em(r,r=>{let l=t.formatter.matchNode(r,n,null!=a?a:{},o);return!D(l)},r=>!!ga(t,r,n)||!o&&L(t.formatter.matchNode(r,n,a,!0))),g7=(t,r)=>{let n=null!=r?r:g9(t);return ed(ct(t.dom,n),t=>nC(t)&&!nS(t))},pe=(t,r,n)=>{let o=g7(t,r);eA(n,(n,a)=>{let l=n=>{let l=g4(t,o,a,n.similar,g6(n)?n.vars:void 0),i=l.isSome();if(n.state.get()!==i){n.state.set(i);let t=l.getOr(r);g6(n)?n.callback(i,{node:t,format:a,parents:o}):el(n.callbacks,r=>r(i,{node:t,format:a,parents:o}))}};el([n.withSimilar,n.withoutSimilar],l),el(n.withVars,l)})},pt=tM.explode,pr=()=>{let t={};return{addFilter:(r,n)=>{el(pt(r),r=>{eI(t,r)||(t[r]={name:r,callbacks:[]}),t[r].callbacks.push(n)})},getFilters:()=>eM(t),removeFilter:(r,n)=>{el(pt(r),r=>{if(eI(t,r)){if(L(n)){let o=t[r],a=ed(o.callbacks,t=>t!==n);a.length>0?o.callbacks=a:delete t[r]}else delete t[r]}})}}},pn=(t,r,n)=>{var o;let a=af();r.convert_fonts_to_spans&&((t,r,n)=>{t.addNodeFilter("font",t=>{el(t,t=>{let o=r.parse(t.attr("style")),a=t.attr("color"),l=t.attr("face"),i=t.attr("size");a&&(o.color=a),l&&(o["font-family"]=l),i&&tt(i).each(t=>{o["font-size"]=n[t-1]}),t.name="span",t.attr("style",r.serialize(o)),el(["color","face","size"],r=>{t.attr(r,null)})})})})(t,a,tM.explode(null!==(o=r.font_size_legacy_values)&&void 0!==o?o:"")),((t,r,n)=>{t.addNodeFilter("strike",t=>{let o="html4"!==r.type;el(t,t=>{if(o)t.name="s";else{let r=n.parse(t.attr("style"));r["text-decoration"]="line-through",t.name="span",t.attr("style",n.serialize(r))}})})})(t,n,a)},po=(t,r)=>{t.addNodeFilter("br",(t,n,o)=>{let a=tM.extend({},r.getBlockElements()),l=r.getNonEmptyElements(),i=r.getWhitespaceElements();a.body=1;let s=t=>t.name in a&&1===t.type&&oF(r,t.name)&&D(t.attr(oR));for(let n=0,d=t.length;n<d;n++){let d=t[n],c=d.parent;if(c&&a[c.name]&&d===c.lastChild){let t=d.prev;for(;t;){let r=t.name;if("span"!==r||"bookmark"!==t.attr("data-mce-type")){"br"===r&&(d=null);break}t=t.prev}if(d&&(d.remove(),fQ(r,l,i,c))){let t=r.getElementRule(c.name);t&&(t.removeEmpty?c.remove():t.paddEmpty&&fY(o,s,c))}}else{let t=d;for(;c&&c.firstChild===t&&c.lastChild===t&&(t=c,!a[c.name]);)c=c.parent;if(t===c){let t=new u8("#text",3);t.value="\xa0",d.replace(t)}}}})},pa=t=>{let[r,...n]=t.split(","),o=n.join(","),a=/data:([^/]+\/[^;]+)(;.+)?/.exec(r);if(a){let t=";base64"===a[2],r=t?(t=>{let r=/([a-z0-9+\/=\s]+)/i.exec(t);return r?r[1]:""})(o):decodeURIComponent(o);return J.some({type:a[1],data:r,base64Encoded:t})}return J.none()},pl=(t,r,n=!0)=>{let o=r;if(n)try{o=atob(r)}catch(t){return J.none()}let a=new Uint8Array(o.length);for(let t=0;t<a.length;t++)a[t]=o.charCodeAt(t);return J.some(new Blob([a],{type:t}))},pi=t=>new Promise((r,n)=>{let o=new FileReader;o.onloadend=()=>{r(o.result)},o.onerror=()=>{var t;n(null===(t=o.error)||void 0===t?void 0:t.message)},o.readAsDataURL(t)}),ps=0,pd=(t,r,n)=>pa(t).bind(({data:t,type:o,base64Encoded:a})=>{if(r&&!a)return J.none();{let r=a?t:btoa(t);return n(r,o)}}),pc=(t,r,n)=>{let o=t.create("blobid"+ps++,r,n);return t.add(o),o},pu=(t,r,n=!1)=>pd(r,n,(r,n)=>J.from(t.getByData(r,n)).orThunk(()=>pl(n,r).map(n=>pc(t,n,r)))),pm=(t,r)=>{let n=t.schema;r.remove_trailing_brs&&po(t,n),t.addAttributeFilter("href",t=>{let n=t.length,o=t=>{let r=t?tM.trim(t):"";return/\b(noopener)\b/g.test(r)?r:r.split(" ").filter(t=>t.length>0).concat(["noopener"]).sort().join(" ")};if(!r.allow_unsafe_link_target)for(;n--;){let r=t[n];"a"===r.name&&"_blank"===r.attr("target")&&r.attr("rel",o(r.attr("rel")))}}),r.allow_html_in_named_anchor||t.addAttributeFilter("id,name",t=>{let r,n,o,a,l=t.length;for(;l--;)if("a"===(a=t[l]).name&&a.firstChild&&!a.attr("href"))for(o=a.parent,r=a.lastChild;r&&o;)n=r.prev,o.insert(r,a),r=n}),r.fix_list_elements&&t.addNodeFilter("ul,ol",t=>{let r,n,o=t.length;for(;o--;)if((n=(r=t[o]).parent)&&("ul"===n.name||"ol"===n.name)){if(r.prev&&"li"===r.prev.name)r.prev.append(r);else{let t=new u8("li",1);t.attr("style","list-style-type: none"),r.wrap(t)}}});let o=n.getValidClasses();r.validate&&o&&t.addAttributeFilter("class",t=>{var r;let n=t.length;for(;n--;){let a=t[n],l=null!==(r=a.attr("class"))&&void 0!==r?r:"",i=tM.explode(l," "),s="";for(let t=0;t<i.length;t++){let r=i[t],n=!1,l=o["*"];l&&l[r]&&(n=!0),l=o[a.name],!n&&l&&l[r]&&(n=!0),n&&(s&&(s+=" "),s+=r)}s.length||(s=null),a.attr("class",s)}}),((t,r)=>{let{blob_cache:n}=r;if(n){let r=t=>{let r=t.attr("src");t.attr("src")===tB.transparentSrc||L(t.attr("data-mce-placeholder"))||L(t.attr("data-mce-bogus"))||P(r)||pu(n,r,!0).each(r=>{t.attr("src",r.blobUri())})};t.addAttributeFilter("src",t=>el(t,r))}})(t,r)};function pf(t){return(pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pg(t,r){return(pg=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function pp(t,r,n){return(pp=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,r,n){var o=[null];o.push.apply(o,r);var a=new(Function.bind.apply(t,o));return n&&pg(a,n.prototype),a}:Reflect.construct).apply(null,arguments)}function ph(t){return function(t){if(Array.isArray(t))return pb(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return pb(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pb(t,r):void 0}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pb(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,o=Array(r);n<r;n++)o[n]=t[n];return o}var pv=Object.hasOwnProperty,py=Object.setPrototypeOf,pC=Object.isFrozen,px=Object.getPrototypeOf,pw=Object.getOwnPropertyDescriptor,pE=Object.freeze,pk=Object.seal,pS=Object.create,p_="undefined"!=typeof Reflect&&Reflect,pN=p_.apply,pR=p_.construct;pN||(pN=function(t,r,n){return t.apply(r,n)}),pE||(pE=function(t){return t}),pk||(pk=function(t){return t}),pR||(pR=function(t,r){return pp(t,ph(r))});var pA,pO,pT,pB=pH(Array.prototype.forEach),pD=pH(Array.prototype.pop),pP=pH(Array.prototype.push),pL=pH(String.prototype.toLowerCase),pM=pH(String.prototype.match),pF=pH(String.prototype.replace),pI=pH(String.prototype.indexOf),pU=pH(String.prototype.trim),pz=pH(RegExp.prototype.test),pj=(pT=TypeError,function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return pR(pT,r)});function pH(t){return function(r){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return pN(t,r,o)}}function p$(t,r){py&&py(t,null);for(var n=r.length;n--;){var o=r[n];if("string"==typeof o){var a=pL(o);a!==o&&(pC(r)||(r[n]=a),o=a)}t[o]=!0}return t}function pV(t){var r,n=pS(null);for(r in t)pN(pv,t,[r])&&(n[r]=t[r]);return n}function pq(t,r){for(;null!==t;){var n=pw(t,r);if(n){if(n.get)return pH(n.get);if("function"==typeof n.value)return pH(n.value)}t=px(t)}return function(t){return console.warn("fallback value for",t),null}}var pW=pE(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),pK=pE(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),pG=pE(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pY=pE(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),pX=pE(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),pQ=pE(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),pJ=pE(["#text"]),pZ=pE(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),p0=pE(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),p1=pE(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),p2=pE(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),p3=pk(/\{\{[\w\W]*|[\w\W]*\}\}/gm),p8=pk(/<%[\w\W]*|[\w\W]*%>/gm),p5=pk(/^data-[\-\w.\u00B7-\uFFFF]/),p6=pk(/^aria-[\-\w]+$/),p9=pk(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),p4=pk(/^(?:\w+script|data):/i),p7=pk(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),he=pk(/^html$/i),ht=function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,n=function(r){return t(r)};if(n.version="2.3.8",n.removed=[],!r||!r.document||9!==r.document.nodeType)return n.isSupported=!1,n;var o=r.document,a=r.document,l=r.DocumentFragment,i=r.HTMLTemplateElement,s=r.Node,d=r.Element,c=r.NodeFilter,u=r.NamedNodeMap,m=void 0===u?r.NamedNodeMap||r.MozNamedAttrMap:u,f=r.HTMLFormElement,g=r.DOMParser,p=r.trustedTypes,h=d.prototype,b=pq(h,"cloneNode"),v=pq(h,"nextSibling"),y=pq(h,"childNodes"),C=pq(h,"parentNode");if("function"==typeof i){var x=a.createElement("template");x.content&&x.content.ownerDocument&&(a=x.content.ownerDocument)}var w=function(t,r){if("object"!==pf(t)||"function"!=typeof t.createPolicy)return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var a="dompurify"+(n?"#"+n:"");try{return t.createPolicy(a,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+a+" could not be created."),null}}(p,o),E=w?w.createHTML(""):"",k=a,S=k.implementation,_=k.createNodeIterator,N=k.createDocumentFragment,R=k.getElementsByTagName,A=o.importNode,O={};try{O=pV(a).documentMode?a.documentMode:{}}catch(t){}var T={};n.isSupported="function"==typeof C&&S&&void 0!==S.createHTMLDocument&&9!==O;var B,D,P=p9,L=null,M=p$({},[].concat(ph(pW),ph(pK),ph(pG),ph(pX),ph(pJ))),F=null,I=p$({},[].concat(ph(pZ),ph(p0),ph(p1),ph(p2))),U=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,j=null,H=!0,$=!0,V=!1,q=!1,W=!1,K=!1,G=!1,Y=!1,X=!1,Q=!1,J=!0,Z=!0,ee=!1,et={},er=null,en=p$({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eo=null,ea=p$({},["audio","video","img","source","image","track"]),el=null,ei=p$({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),es="http://www.w3.org/1998/Math/MathML",ed="http://www.w3.org/2000/svg",ec="http://www.w3.org/1999/xhtml",eu=ec,em=!1,ef=["application/xhtml+xml","text/html"],eg=null,ep=a.createElement("form"),eh=function(t){return t instanceof RegExp||t instanceof Function},eb=function(t){eg&&eg===t||(t&&"object"===pf(t)||(t={}),L="ALLOWED_TAGS"in(t=pV(t))?p$({},t.ALLOWED_TAGS):M,F="ALLOWED_ATTR"in t?p$({},t.ALLOWED_ATTR):I,el="ADD_URI_SAFE_ATTR"in t?p$(pV(ei),t.ADD_URI_SAFE_ATTR):ei,eo="ADD_DATA_URI_TAGS"in t?p$(pV(ea),t.ADD_DATA_URI_TAGS):ea,er="FORBID_CONTENTS"in t?p$({},t.FORBID_CONTENTS):en,z="FORBID_TAGS"in t?p$({},t.FORBID_TAGS):{},j="FORBID_ATTR"in t?p$({},t.FORBID_ATTR):{},et="USE_PROFILES"in t&&t.USE_PROFILES,H=!1!==t.ALLOW_ARIA_ATTR,$=!1!==t.ALLOW_DATA_ATTR,V=t.ALLOW_UNKNOWN_PROTOCOLS||!1,q=t.SAFE_FOR_TEMPLATES||!1,W=t.WHOLE_DOCUMENT||!1,Y=t.RETURN_DOM||!1,X=t.RETURN_DOM_FRAGMENT||!1,Q=t.RETURN_TRUSTED_TYPE||!1,G=t.FORCE_BODY||!1,J=!1!==t.SANITIZE_DOM,Z=!1!==t.KEEP_CONTENT,ee=t.IN_PLACE||!1,P=t.ALLOWED_URI_REGEXP||P,eu=t.NAMESPACE||ec,t.CUSTOM_ELEMENT_HANDLING&&eh(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&eh(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(U.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),D="application/xhtml+xml"===(B=B=-1===ef.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE)?function(t){return t}:pL,q&&($=!1),X&&(Y=!0),et&&(L=p$({},ph(pJ)),F=[],!0===et.html&&(p$(L,pW),p$(F,pZ)),!0===et.svg&&(p$(L,pK),p$(F,p0),p$(F,p2)),!0===et.svgFilters&&(p$(L,pG),p$(F,p0),p$(F,p2)),!0===et.mathMl&&(p$(L,pX),p$(F,p1),p$(F,p2))),t.ADD_TAGS&&(L===M&&(L=pV(L)),p$(L,t.ADD_TAGS)),t.ADD_ATTR&&(F===I&&(F=pV(F)),p$(F,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&p$(el,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(er===en&&(er=pV(er)),p$(er,t.FORBID_CONTENTS)),Z&&(L["#text"]=!0),W&&p$(L,["html","head","body"]),L.table&&(p$(L,["tbody"]),delete z.tbody),pE&&pE(t),eg=t)},ev=p$({},["mi","mo","mn","ms","mtext"]),ey=p$({},["foreignobject","desc","title","annotation-xml"]),eC=p$({},["title","style","font","a","script"]),ex=p$({},pK);p$(ex,pG),p$(ex,pY);var ew=p$({},pX);p$(ew,pQ);var eE=function(t){pP(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(r){try{t.outerHTML=E}catch(r){t.remove()}}},ek=function(t,r){try{pP(n.removed,{attribute:r.getAttributeNode(t),from:r})}catch(t){pP(n.removed,{attribute:null,from:r})}if(r.removeAttribute(t),"is"===t&&!F[t]){if(Y||X)try{eE(r)}catch(t){}else try{r.setAttribute(t,"")}catch(t){}}},eS=function(t){if(G)t="<remove></remove>"+t;else{var r,n,o=pM(t,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===B&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var l=w?w.createHTML(t):t;if(eu===ec)try{r=(new g).parseFromString(l,B)}catch(t){}if(!r||!r.documentElement){r=S.createDocument(eu,"template",null);try{r.documentElement.innerHTML=em?"":l}catch(t){}}var i=r.body||r.documentElement;return t&&n&&i.insertBefore(a.createTextNode(n),i.childNodes[0]||null),eu===ec?R.call(r,W?"html":"body")[0]:W?r.documentElement:i},e_=function(t){return _.call(t.ownerDocument||t,t,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},eN=function(t){return"object"===pf(s)?t instanceof s:t&&"object"===pf(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},eR=function(t,r,o){T[t]&&pB(T[t],function(t){t.call(n,r,o,eg)})},eA=function(t){if(eR("beforeSanitizeElements",t,null),t instanceof f&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof m)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore)||pz(/[\u0080-\uFFFF]/,t.nodeName))return eE(t),!0;var r,o,a,l,i=D(t.nodeName);if(eR("uponSanitizeElement",t,{tagName:i,allowedTags:L}),t.hasChildNodes()&&!eN(t.firstElementChild)&&(!eN(t.content)||!eN(t.content.firstElementChild))&&pz(/<[/\w]/g,t.innerHTML)&&pz(/<[/\w]/g,t.textContent)||"select"===i&&pz(/<template/i,t.innerHTML))return eE(t),!0;if(!L[i]||z[i]){if(!z[i]&&eT(i)&&(U.tagNameCheck instanceof RegExp&&pz(U.tagNameCheck,i)||U.tagNameCheck instanceof Function&&U.tagNameCheck(i)))return!1;if(Z&&!er[i]){var s=C(t)||t.parentNode,c=y(t)||t.childNodes;if(c&&s)for(var u=c.length-1;u>=0;--u)s.insertBefore(b(c[u],!0),v(t))}return eE(t),!0}return!(t instanceof d)||((r=C(t))&&r.tagName||(r={namespaceURI:ec,tagName:"template"}),o=pL(t.tagName),a=pL(r.tagName),t.namespaceURI===ed?r.namespaceURI===ec?"svg"===o:r.namespaceURI===es?"svg"===o&&("annotation-xml"===a||ev[a]):ex[o]:t.namespaceURI===es?r.namespaceURI===ec?"math"===o:r.namespaceURI===ed?"math"===o&&ey[a]:ew[o]:t.namespaceURI===ec&&(r.namespaceURI!==ed||ey[a])&&(r.namespaceURI!==es||ev[a])&&!ew[o]&&(eC[o]||!ex[o]))?("noscript"===i||"noembed"===i)&&pz(/<\/no(script|embed)/i,t.innerHTML)?(eE(t),!0):(q&&3===t.nodeType&&(l=pF(l=t.textContent,p3," "),l=pF(l,p8," "),t.textContent!==l&&(pP(n.removed,{element:t.cloneNode()}),t.textContent=l)),eR("afterSanitizeElements",t,null),!1):(eE(t),!0)},eO=function(t,r,n){if(J&&("id"===r||"name"===r)&&(n in a||n in ep))return!1;if($&&!j[r]&&pz(p5,r));else if(H&&pz(p6,r));else if(!F[r]||j[r]){if(!(eT(t)&&(U.tagNameCheck instanceof RegExp&&pz(U.tagNameCheck,t)||U.tagNameCheck instanceof Function&&U.tagNameCheck(t))&&(U.attributeNameCheck instanceof RegExp&&pz(U.attributeNameCheck,r)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(r))||"is"===r&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&pz(U.tagNameCheck,n)||U.tagNameCheck instanceof Function&&U.tagNameCheck(n))))return!1}else if(el[r]);else if(pz(P,pF(n,p7,"")));else if("src"!==r&&"xlink:href"!==r&&"href"!==r||"script"===t||0!==pI(n,"data:")||!eo[t]){if(V&&!pz(p4,pF(n,p7,"")));else if(n)return!1}return!0},eT=function(t){return t.indexOf("-")>0},eB=function(t){eR("beforeSanitizeAttributes",t,null);var r,n,o,a,l=t.attributes;if(l){var i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:F};for(a=l.length;a--;){var s=r=l[a],d=s.name,c=s.namespaceURI;n="value"===d?r.value:pU(r.value),o=D(d);var u=n;if(i.attrName=o,i.attrValue=n,i.keepAttr=!0,i.forceKeepAttr=void 0,eR("uponSanitizeAttribute",t,i),n=i.attrValue,!i.forceKeepAttr){if(i.keepAttr){if(pz(/\/>/i,n))ek(d,t);else if(q&&(n=pF(n,p3," "),n=pF(n,p8," ")),eO(D(t.nodeName),o,n)){if(n!==u)try{c?t.setAttributeNS(c,d,n):t.setAttribute(d,n)}catch(r){ek(d,t)}}else ek(d,t)}else ek(d,t)}}eR("afterSanitizeAttributes",t,null)}},eD=function t(r){var n,o=e_(r);for(eR("beforeSanitizeShadowDOM",r,null);n=o.nextNode();)eR("uponSanitizeShadowNode",n,null),eA(n)||(n.content instanceof l&&t(n.content),eB(n));eR("afterSanitizeShadowDOM",r,null)};return n.sanitize=function(t,a){if((em=!t)&&(t="<!-->"),"string"!=typeof t&&!eN(t)){if("function"!=typeof t.toString)throw pj("toString is not a function");if("string"!=typeof(t=t.toString()))throw pj("dirty is not a string, aborting")}if(!n.isSupported){if("object"===pf(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(eN(t))return r.toStaticHTML(t.outerHTML)}return t}if(K||eb(a),n.removed=[],"string"==typeof t&&(ee=!1),ee){if(t.nodeName){var i,d,c,u,m,f=D(t.nodeName);if(!L[f]||z[f])throw pj("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof s)1===(d=(i=eS("<!---->")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===d.nodeName||"HTML"===d.nodeName?i=d:i.appendChild(d);else{if(!Y&&!q&&!W&&-1===t.indexOf("<"))return w&&Q?w.createHTML(t):t;if(!(i=eS(t)))return Y?null:Q?E:""}i&&G&&eE(i.firstChild);for(var g=e_(ee?t:i);c=g.nextNode();)3===c.nodeType&&c===u||eA(c)||(c.content instanceof l&&eD(c.content),eB(c),u=c);if(u=null,ee)return t;if(Y){if(X)for(m=N.call(i.ownerDocument);i.firstChild;)m.appendChild(i.firstChild);else m=i;return F.shadowroot&&(m=A.call(o,m,!0)),m}var p=W?i.outerHTML:i.innerHTML;return W&&L["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&pz(he,i.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+p),q&&(p=pF(p,p3," "),p=pF(p,p8," ")),w&&Q?w.createHTML(p):p},n.setConfig=function(t){eb(t),K=!0},n.clearConfig=function(){eg=null,K=!1},n.isValidAttribute=function(t,r,n){return eg||eb({}),eO(D(t),D(r),n)},n.addHook=function(t,r){"function"==typeof r&&(T[t]=T[t]||[],pP(T[t],r))},n.removeHook=function(t){if(T[t])return pD(T[t])},n.removeHooks=function(t){T[t]&&(T[t]=[])},n.removeAllHooks=function(){T={}},n}();let hr=tM.each,hn=tM.trim,ho=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ha={ftp:21,http:80,https:443,mailto:25},hl=["img","video"],hi=(t,r,n)=>{var o;let a=(t=>{try{return decodeURIComponent(t)}catch(r){return unescape(t)}})(r).replace(/\s/g,"");return!t.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(a)||!t.allow_html_data_urls&&(/^data:image\//i.test(a)?(L(o=t.allow_svg_data_urls)?!o:!L(n)||!en(hl,n))&&/^data:image\/svg\+xml/i.test(a):/^data:/i.test(a)))};class hs{static parseDataUri(t){let r;let n=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(n[0]);return o&&(r=o[1]),{type:r,data:n[1]}}static isDomSafe(t,r,n={}){if(n.allow_script_urls)return!0;{let o=o7.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!hi(n,o,r)}}static getDocumentBaseUrl(t){var r;let n;return n=0!==t.protocol.indexOf("http")&&"file:"!==t.protocol?null!==(r=t.href)&&void 0!==r?r:"":t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/")),n}constructor(t,r={}){this.path="",this.directory="",t=hn(t),this.settings=r;let n=r.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))return void(o.source=t);let a=0===t.indexOf("//");if(0!==t.indexOf("/")||a||(t=(n&&n.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){let r=n?n.path:new hs(document.location.href).directory;if(""===(null==n?void 0:n.protocol))t="//mce_host"+o.toAbsPath(r,t);else{let a=/([^#?]*)([#?]?.*)/.exec(t);a&&(t=(n&&n.protocol||"http")+"://mce_host"+o.toAbsPath(r,a[1])+a[2])}}t=t.replace(/@@/g,"(mce_at)");let l=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);l&&hr(ho,(t,r)=>{let n=l[r];n&&(n=n.replace(/\(mce_at\)/g,"@@")),o[t]=n}),n&&(o.protocol||(o.protocol=n.protocol),o.userInfo||(o.userInfo=n.userInfo),o.port||"mce_host"!==o.host||(o.port=n.port),o.host&&"mce_host"!==o.host||(o.host=n.host),o.source=""),a&&(o.protocol="")}setPath(t){let r=/^(.*?)\/?(\w+)?$/.exec(t);r&&(this.path=r[0],this.directory=r[1],this.file=r[2]),this.source="",this.getURI()}toRelative(t){if("./"===t)return t;let r=new hs(t,{base_uri:this});if("mce_host"!==r.host&&this.host!==r.host&&r.host||this.port!==r.port||this.protocol!==r.protocol&&""!==r.protocol)return r.getURI();let n=this.getURI(),o=r.getURI();if(n===o||"/"===n.charAt(n.length-1)&&n.substr(0,n.length-1)===o)return n;let a=this.toRelPath(this.path,r.path);return r.query&&(a+="?"+r.query),r.anchor&&(a+="#"+r.anchor),a}toAbsolute(t,r){let n=new hs(t,{base_uri:this});return n.getURI(r&&this.isSameOrigin(n))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;let r=this.protocol?ha[this.protocol]:null;if(r&&(this.port||r)==(t.port||r))return!0}return!1}toRelPath(t,r){let n,o,a=0,l="",i=t.substring(0,t.lastIndexOf("/")).split("/"),s=r.split("/");if(i.length>=s.length){for(n=0,o=i.length;n<o;n++)if(n>=s.length||i[n]!==s[n]){a=n+1;break}}if(i.length<s.length){for(n=0,o=s.length;n<o;n++)if(n>=i.length||i[n]!==s[n]){a=n+1;break}}if(1===a)return r;for(n=0,o=i.length-(a-1);n<o;n++)l+="../";for(n=a-1,o=s.length;n<o;n++)l+=n!==a-1?"/"+s[n]:s[n];return l}toAbsPath(t,r){let n,o=0,a=/\/$/.test(r)?"/":"",l=t.split("/"),i=r.split("/"),s=[];hr(l,t=>{t&&s.push(t)});let d=[];for(let t=i.length-1;t>=0;t--)0!==i[t].length&&"."!==i[t]&&(".."!==i[t]?o>0?o--:d.push(i[t]):o++);let c=s.length-o;return 0!==(n=c<=0?ev(d).join("/"):s.slice(0,c).join("/")+"/"+ev(d).join("/")).indexOf("/")&&(n="/"+n),a&&n.lastIndexOf("/")!==n.length-1&&(n+=a),n}getURI(t=!1){let r;return this.source&&!t||(r="",t||(this.protocol?r+=this.protocol+"://":r+="//",this.userInfo&&(r+=this.userInfo+"@"),this.host&&(r+=this.host),this.port&&(r+=":"+this.port)),this.path&&(r+=this.path),this.query&&(r+="?"+this.query),this.anchor&&(r+="#"+this.anchor),this.source=r),this.source}}let hd=tM.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),hc="data-mce-type",hu=0,hm=(t,r,n,o)=>{var a,l,i,s;let d=r.validate,c=n.getSpecialElements();8===t.nodeType&&!r.allow_conditional_comments&&/^\[if/i.test(null!==(a=t.nodeValue)&&void 0!==a?a:"")&&(t.nodeValue=" "+t.nodeValue);let u=null!==(l=null==o?void 0:o.tagName)&&void 0!==l?l:t.nodeName.toLowerCase();if(1!==t.nodeType||"body"===u)return;let m=rl(t),f=t8(m,hc),g=t2(m,"data-mce-bogus");if(!f&&N(g))return void("all"===g?ne(m):nt(m));let p=n.getElementRule(u);if(!d||p){if(L(o)&&(o.allowedTags[u]=!0),d&&p&&!f){if(el(null!==(i=p.attributesForced)&&void 0!==i?i:[],t=>{t0(m,t.name,"{$uid}"===t.value?"mce_"+hu++:t.value)}),el(null!==(s=p.attributesDefault)&&void 0!==s?s:[],t=>{t8(m,t.name)||t0(m,t.name,"{$uid}"===t.value?"mce_"+hu++:t.value)}),p.attributesRequired&&!eo(p.attributesRequired,t=>t8(m,t))||p.removeEmptyAttrs&&(t=>{let r=t.dom.attributes;return null==r||0===r.length})(m))return void nt(m);p.outputName&&p.outputName!==u&&a9(m,p.outputName)}}else eI(c,u)?ne(m):nt(m)},hf=(t,r,n,o,a)=>!(o in hd&&hi(t,a,n))&&(!t.validate||r.isValid(n,o)||e3(o,"data-")||e3(o,"aria-")),hg=(t,r)=>t.hasAttribute(hc)&&("id"===r||"class"===r||"style"===r),hp=(t,r)=>t in r.getBoolAttrs(),hh=(t,r,n)=>{let{attributes:o}=t;for(let a=o.length-1;a>=0;a--){let l=o[a],i=l.name,s=l.value;hf(r,n,t.tagName.toLowerCase(),i,s)||hg(t,i)?hp(i,n)&&t.setAttribute(i,i):t.removeAttribute(i)}},hb=(t,r)=>{let n=ht();return n.addHook("uponSanitizeElement",(n,o)=>{hm(n,t,r,o)}),n.addHook("uponSanitizeAttribute",(n,o)=>{let a=n.tagName.toLowerCase(),{attrName:l,attrValue:i}=o;o.keepAttr=hf(t,r,a,l,i),o.keepAttr?(o.allowedAttributes[l]=!0,hp(l,r)&&(o.attrValue=l),t.allow_svg_data_urls&&e3(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):hg(n,l)&&(o.forceKeepAttr=!0)}),n},hv=tM.makeMap,hy=tM.extend,hC=(t,r,n)=>{let o=t.name,a=o in n&&"title"!==o&&"textarea"!==o,l=r.childNodes;for(let r=0,o=l.length;r<o;r++){let o=l[r],i=new u8(o.nodeName.toLowerCase(),o.nodeType);if(nC(o)){let t=o.attributes;for(let r=0,n=t.length;r<n;r++){let n=t[r];i.attr(n.name,n.value)}}else nA(o)?(i.value=o.data,a&&(i.raw=!0)):(nB(o)||nO(o)||nT(o))&&(i.value=o.data);hC(i,o,n),t.append(i)}},hx=(t={},r=am())=>{let n=pr(),o=pr(),a={validate:!0,root_name:"body",sanitize:!0,...t},l=new DOMParser,i=((t,r)=>{if(t.sanitize){let n=hb(t,r);return(r,o)=>{n.sanitize(r,((t,r)=>{let n={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]};return n.PARSER_MEDIA_TYPE=r,t.allow_script_urls?n.ALLOWED_URI_REGEXP=/.*/:t.allow_html_data_urls&&(n.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),n})(t,o)),n.removed=[]}}return(n,o)=>{let a;let l=document.createNodeIterator(n,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);for(;a=l.nextNode();)hm(a,t,r),nC(a)&&hh(a,t,r)}})(a,r),s=n.addFilter,d=n.getFilters,c=n.removeFilter,u=o.addFilter,m=o.getFilters,f=o.removeFilter,g=(t,n)=>{let o=N(n.attr(hc)),a=1===n.type&&!eI(t,n.name)&&!oj(r,n);return 3===n.type||a&&!o},p={schema:r,addAttributeFilter:u,getAttributeFilters:m,removeAttributeFilter:f,addNodeFilter:s,getNodeFilters:d,removeNodeFilter:c,parse:(t,n={})=>{var o;let s=a.validate,c=null!==(o=n.context)&&void 0!==o?o:a.root_name,u=((t,n,o="html")=>{let a="xhtml"===o?"application/xhtml+xml":"text/html",s=eI(r.getSpecialElements(),n.toLowerCase()),d=s?`<${n}>${t}</${n}>`:t,c="xhtml"===o?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${d}</body></html>`:`<body>${d}</body>`,u=l.parseFromString(c,a).body;return i(u,a),s?u.firstChild:u})(t,c,n.format);oP(r,u);let f=new u8(c,11);hC(f,u,r.getSpecialElements()),u.innerHTML="";let[p,h]=((t,r,n,o)=>{let a=n.validate,l=r.getNonEmptyElements(),i=r.getWhitespaceElements(),s=hy(hv("script,style,head,html,body,title,meta,param"),r.getBlockElements()),d=ac(r),c=/[ \t\r\n]+/g,u=/^[ \t\r\n]+/,m=/[ \t\r\n]+$/,f=t=>{let r=t.parent;for(;L(r);){if(r.name in i)return!0;r=r.parent}return!1},g=t=>t.name in s||oj(r,t),p=(r,n)=>{let a=n?r.prev:r.next;return!L(a)&&!P(r.parent)&&g(r.parent)&&(r.parent!==t||!0===o.isRootContent)};return[t=>{var r,n;if(3===t.type&&!f(t)){let o=null!==(r=t.value)&&void 0!==r?r:"";o=o.replace(c," "),(L(n=t.prev)&&(g(n)||"br"===n.name)||p(t,!0))&&(o=o.replace(u,"")),0===o.length?t.remove():t.value=o}},t=>{var n,s;if(1===t.type){let n=r.getElementRule(t.name);if(a&&n){let a=fQ(r,l,i,t);n.paddInEmptyBlock&&a&&(t=>{let n=t;for(;L(n);){if(n.name in d)return fQ(r,l,i,n);n=n.parent}return!1})(t)?fY(o,g,t):n.removeEmpty&&a?g(t)?t.remove():t.unwrap():n.paddEmpty&&(a||fX(t,"#text")&&(null===(s=null==t?void 0:t.firstChild)||void 0===s?void 0:s.value)==="\xa0")&&fY(o,g,t)}}else if(3===t.type&&!f(t)){let r=null!==(n=t.value)&&void 0!==n?n:"";(t.next&&g(t.next)||p(t,!1))&&(r=r.replace(m,"")),0===r.length?t.remove():t.value=r}}]})(f,r,a,n),b=[],v=s?t=>{f1(r,t)&&b.push(t)}:U,y={nodes:{},attributes:{}},C=t=>fW(d(),m(),t,y);if(((t,r,n)=>{let o=[];for(let n=t,a=n;n;a=n,n=n.walk()){let l=n;el(r,t=>t(l)),P(l.parent)&&l!==t?n=a:o.push(l)}for(let t=o.length-1;t>=0;t--){let r=o[t];el(n,t=>t(r))}})(f,[p,C],[h,v]),b.reverse(),s&&b.length>0){if(n.context){let{pass:t,fail:o}=es(b,t=>t.parent===f);f0(o,r,f,C),n.invalid=t.length>0}else f0(b,r,f,C)}let x=((t,r)=>{var n;let o=null!==(n=r.forced_root_block)&&void 0!==n?n:t.forced_root_block;return!1===o?"":!0===o?"p":o})(a,n);return x&&("body"===f.name||n.isRootContent)&&((t,n)=>{let o=hy(hv("script,style,head,html,body,title,meta,param"),r.getBlockElements()),l=/^[ \t\r\n]+/,i=/[ \t\r\n]+$/,s=t.firstChild,d=null,c=t=>{var r,n;t&&((s=t.firstChild)&&3===s.type&&(s.value=null===(r=s.value)||void 0===r?void 0:r.replace(l,"")),(s=t.lastChild)&&3===s.type&&(s.value=null===(n=s.value)||void 0===n?void 0:n.replace(i,"")))};if(r.isValidChild(t.name,n.toLowerCase())){for(;s;){let r=s.next;g(o,s)?(d||((d=new u8(n,1)).attr(a.forced_root_block_attrs),t.insert(d,s)),d.append(s)):(c(d),d=null),s=r}c(d)}})(f,x),n.invalid||fK(y,n),f}};return pm(p,a),a.inline_styles&&pn(p,a,r),p},hw=(t,r,n)=>{let o=ge(t)?mn({validate:!1}).serialize(t):t,a=r(o);if(a.isDefaultPrevented())return a;if(ge(t)){if(a.content!==o){let r=hx({validate:!1,forced_root_block:!1,sanitize:n}).parse(a.content,{context:t.name});return{...a,content:r}}return{...a,content:t}}return a},hE=(t,r)=>{if(r.no_events)return lq.value(r);{let n=t.dispatch("BeforeGetContent",r);return n.isDefaultPrevented()?lq.error(cO(t,{content:"",...n}).content):lq.value(n)}},hk=(t,r,n)=>{if(n.no_events)return r;{let o=hw(r,r=>cO(t,{...n,content:r}),sS(t));return o.content}},hS=(t,r)=>{if(r.no_events)return lq.value(r);{let n=hw(r.content,n=>{var o;return o={...r,content:n},t.dispatch("BeforeSetContent",o)},sS(t));return n.isDefaultPrevented()?(cA(t,n),lq.error(void 0)):lq.value(n)}},h_=(t,r,n)=>{n.no_events||cA(t,{...n,content:r})},hN=(t,r,n)=>({element:t,width:r,rows:n}),hR=(t,r)=>({element:t,cells:r}),hA=(t,r)=>({x:t,y:r}),hO=(t,r)=>t3(t,r).bind(tt).getOr(1),hT=(t,r,n)=>{let o=t.rows;return!!(o[n]?o[n].cells:[])[r]},hB=t=>eu(t,(t,r)=>r.cells.length>t?r.cells.length:t,0),hD=(t,r)=>{let n=t.rows;for(let t=0;t<n.length;t++){let o=n[t].cells;for(let n=0;n<o.length;n++)if(rg(o[n],r))return J.some(hA(n,t))}return J.none()},hP=(t,r,n,o,a)=>{let l=[],i=t.rows;for(let t=n;t<=a;t++){let n=i[t].cells,a=r<o?n.slice(r,o+1):n.slice(o,r+1);l.push(hR(i[t].element,a))}return l},hL=t=>((t,r)=>{let n=a5(t.element),o=rs("tbody");return r4(o,r),r6(n,o),n})(t,ea(t.rows,t=>{let r=ea(t.cells,t=>{let r=a6(t);return t5(r,"colspan"),t5(r,"rowspan"),r}),n=a5(t.element);return r4(n,r),n})),hM=(t,r)=>{let n=rl(r.commonAncestorContainer),o=mk(n,t),a=ed(o,n9),l=ef(o,t=>"li"===tV(t)&&dq(t,r)).fold(H([]),t=>ef(o,t=>"ul"===tV(t)||"ol"===tV(t)).map(t=>{let r=rs(tV(t)),n=eP(r1(t),(t,r)=>e3(r,"list-style"));return rQ(r,n),[rs("li"),r]}).getOr([])),i=a.concat(l.length?l:n2(n)?ry(n).filter(n1).fold(H([]),t=>[n,t]):n1(n)?[n]:[]);return ea(i,a5)},hF=()=>cQ([]),hI=(t,r)=>r$(r[0],"table",q(rg,t)).bind(t=>{let n=r[0],o=r[r.length-1],a=(t=>{let r=hN(a5(t),0,[]);return el(np(t,"tr"),(t,n)=>{el(np(t,"td,th"),(o,a)=>{((t,r,n,o,a)=>{let l=hO(a,"rowspan"),i=hO(a,"colspan"),s=t.rows;for(let t=n;t<n+l;t++){s[t]||(s[t]=hR(a6(o),[]));for(let o=r;o<r+i;o++)s[t].cells[o]=t===n&&o===r?a:a5(a)}})(r,((t,r,n)=>{for(;hT(t,r,n);)r++;return r})(r,a,n),n,t,o)})}),hN(r.element,hB(r.rows),r.rows)})(t);return hD(a,n).bind(t=>hD(a,o).map(r=>((t,r,n)=>{let o=r.x,a=r.y,l=n.x,i=n.y,s=a<i?hP(t,o,a,l,i):hP(t,o,i,l,a);return hN(t.element,hB(s),s)})(a,t,r))).map(t=>cQ([hL(t)]))}).getOrThunk(hF),hU=(t,r)=>{var n;let o=dz(r,t);return o.length>0?hI(t,o):r.length>0&&r[0].collapsed?hF():((t,r)=>{let n=eu(r,(t,r)=>(r6(r,t),r),t);return r.length>0?cQ([n]):n})(rl((n=r[0]).cloneContents()),hM(t,n))},hz=(t,r)=>r>=0&&r<t.length&&dO(t.charAt(r)),hj=t=>ot(t.innerText),hH=t=>nC(t)?t.outerHTML:nA(t)?o7.encodeRaw(t.data,!1):nB(t)?"<!--"+t.data+"-->":"",h$=(t,r)=>{var n;let o;return n=((t,r)=>{let n=t.length+r.length+2,o=Array(n),a=Array(n),l=(n,o,a,i,d)=>{let c=s(n,o,a,i);if(null===c||c.start===o&&c.diag===o-i||c.end===n&&c.diag===n-a){let l=n,s=a;for(;l<o||s<i;)l<o&&s<i&&t[l]===r[s]?(d.push([0,t[l]]),++l,++s):o-n>i-a?(d.push([2,t[l]]),++l):(d.push([1,r[s]]),++s)}else{l(n,c.start,a,c.start-c.diag,d);for(let r=c.start;r<c.end;++r)d.push([0,t[r]]);l(c.end,o,c.end-c.diag,i,d)}},i=(n,o,a,l)=>{var i;let s=n;for(;s-o<l&&s<a&&t[s]===r[s-o];)++s;return i=s,{start:n,end:i,diag:o}},s=(n,l,s,d)=>{let c,u,m,f,g;let p=l-n,h=d-s;if(0===p||0===h)return null;let b=p-h,v=h+p,y=(v%2==0?v:v+1)/2;for(o[1+y]=n,a[1+y]=l+1,c=0;c<=y;++c){for(u=-c;u<=c;u+=2){for(m=u+y,u===-c||u!==c&&o[m-1]<o[m+1]?o[m]=o[m+1]:o[m]=o[m-1]+1,g=(f=o[m])-n+s-u;f<l&&g<d&&t[f]===r[g];)o[m]=++f,++g;if(b%2!=0&&b-c<=u&&u<=b+c&&a[m-b]<=o[m])return i(a[m-b],u+n-s,l,d)}for(u=b-c;u<=b+c;u+=2){for(m=u+y-b,u===b-c||u!==b+c&&a[m+1]<=a[m-1]?a[m]=a[m+1]-1:a[m]=a[m-1],g=(f=a[m]-1)-n+s-u;f>=n&&g>=s&&t[f]===r[g];)a[m]=f--,g--;if(b%2==0&&-c<=u&&u<=c&&a[m]<=o[m+b])return i(a[m],u+n-s,l,d)}}return null},d=[];return l(0,t.length,0,r.length,d),d})(ea(eS(r.childNodes),hH),t),o=0,el(n,t=>{0===t[0]?o++:1===t[0]?(((t,r,n)=>{let o=(t=>{let r;let n=document.createElement("div"),o=document.createDocumentFragment();for(t&&(n.innerHTML=t);r=n.firstChild;)o.appendChild(r);return o})(r);if(t.hasChildNodes()&&n<t.childNodes.length){let r=t.childNodes[n];t.insertBefore(o,r)}else t.appendChild(o)})(r,t[1],o),o++):2===t[0]&&((t,r)=>{if(t.hasChildNodes()&&r<t.childNodes.length){let n=t.childNodes[r];t.removeChild(n)}})(r,o)}),r},hV=eY(()=>document.implementation.createHTMLDocument("undo")),hq=t=>{let r=ed(ea(eS(t.getBody().childNodes),hH),t=>t.length>0),n=eh(r,r=>{let n=u9(t.serializer,r);return n.length>0?[n]:[]}),o=n.join("");return -1!==o.indexOf("</iframe>")?{type:"fragmented",fragments:n,content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:o,bookmark:null,beforeBookmark:null}},hW=(t,r,n)=>{let o=n?r.beforeBookmark:r.bookmark;"fragmented"===r.type?h$(r.fragments,t.getBody()):t.setContent(r.content,{format:"raw",no_selection:!L(o)||!dv(o)||!o.isFakeCaret}),o&&(t.selection.moveToBookmark(o),t.selection.scrollIntoView())},hK=t=>"fragmented"===t.type?t.fragments.join(""):t.content,hG=t=>{let r=rs("body",hV());return no(r,hK(t)),el(np(r,"*[data-mce-bogus]"),nt),nn(r)},hY=(t,r)=>!(!t||!r)&&(hK(t)===hK(r)||hG(t)===hG(r)),hX=t=>0===t.get(),hQ=(t,r,n)=>{hX(n)&&(t.typing=r)},hJ=(t,r)=>{t.typing&&(hQ(t,!1,r),t.add())},hZ=t=>({init:{bindEvents:U},undoManager:{beforeChange:(r,n)=>{hX(r)&&n.set(lH(t.selection))},add:(r,n,o,a,l,i)=>((t,r,n,o,a,l,i)=>{let s=hq(t),d=tM.extend(l||{},s);if(!hX(o)||t.removed)return null;let c=r.data[n.get()];if(t.dispatch("BeforeAddUndo",{level:d,lastLevel:c,originalEvent:i}).isDefaultPrevented()||c&&hY(c,d))return null;r.data[n.get()]&&a.get().each(t=>{r.data[n.get()].beforeBookmark=t});let u=iJ(t);if(u&&r.data.length>u){for(let t=0;t<r.data.length-1;t++)r.data[t]=r.data[t+1];r.data.length--,n.set(r.data.length)}d.bookmark=lH(t.selection),n.get()<r.data.length-1&&(r.data.length=n.get()+1),r.data.push(d),n.set(r.data.length-1);let m={level:d,lastLevel:c,originalEvent:i};return n.get()>0?(t.setDirty(!0),t.dispatch("AddUndo",m),t.dispatch("change",m)):t.dispatch("AddUndo",m),d})(t,r,n,o,a,l,i),undo:(r,n,o)=>{let a;return r.typing&&(r.add(),r.typing=!1,hQ(r,!1,n)),o.get()>0&&(o.set(o.get()-1),hW(t,a=r.data[o.get()],!0),t.setDirty(!0),t.dispatch("Undo",{level:a})),a},redo:(r,n)=>{let o;return r.get()<n.length-1&&(r.set(r.get()+1),hW(t,o=n[r.get()],!1),t.setDirty(!0),t.dispatch("Redo",{level:o})),o},clear:(r,n)=>{r.data=[],n.set(0),r.typing=!1,t.dispatch("ClearUndos")},reset:t=>{t.clear(),t.add()},hasUndo:(r,n)=>n.get()>0||r.typing&&r.data[0]&&!hY(hq(t),r.data[0]),hasRedo:(t,r)=>r.get()<t.data.length-1&&!t.typing,transact:(t,r,n)=>(hJ(t,r),t.beforeChange(),t.ignore(n),t.add()),ignore:(t,r)=>((t,r)=>{try{t.set(t.get()+1),r()}finally{t.set(t.get()-1)}})(t,r),extra:(r,n,o,a)=>((t,r,n,o,a)=>{if(r.transact(o)){let o=r.data[n.get()].bookmark,l=r.data[n.get()-1];hW(t,l,!0),r.transact(a)&&(r.data[n.get()-1].beforeBookmark=o)}})(t,r,n,o,a)},formatter:{match:(r,n,o,a)=>gc(t,r,n,o,a),matchAll:(r,n)=>((t,r,n)=>{let o=[],a={},l=t.selection.getStart();return t.dom.getParent(l,l=>{for(let i=0;i<r.length;i++){let s=r[i];!a[s]&&gd(t,l,s,n)&&(a[s]=!0,o.push(s))}},t.dom.getRoot()),o})(t,r,n),matchNode:(r,n,o,a)=>gd(t,r,n,o,a),canApply:r=>((t,r)=>{let n=t.formatter.get(r),o=t.dom;if(n&&t.selection.isEditable()){let r=t.selection.getStart(),a=ct(o,r);for(let t=n.length-1;t>=0;t--){let r=n[t];if(!co(r))return!0;for(let t=a.length-1;t>=0;t--)if(o.is(a[t],r.selector))return!0}}return!1})(t,r),closest:r=>((t,r)=>{let n=r=>rg(r,rl(t.getBody()));return J.from(t.selection.getStart(!0)).bind(o=>go(rl(o),n=>e_(r,r=>gd(t,n.dom,r)?J.some(r):J.none()),n)).getOrNull()})(t,r),apply:(r,n,o)=>g5(t,r,n,o),remove:(r,n,o,a)=>gZ(t,r,n,o,a),toggle:(r,n,o)=>((t,r,n,o)=>{let a=t.formatter.get(r);a&&(!gc(t,r,n,o)||"toggle"in a[0]&&!a[0].toggle?g5(t,r,n,o):gZ(t,r,n,o))})(t,r,n,o),formatChanged:(r,n,o,a,l)=>(((t,r,n,o,a,l)=>{let i=r.get();el(n.split(","),r=>{let n=eF(i,r).getOrThunk(()=>{let t={withSimilar:{state:aL(!1),similar:!0,callbacks:[]},withoutSimilar:{state:aL(!1),similar:!1,callbacks:[]},withVars:[]};return i[r]=t,t}),s=()=>{let n=g7(t);return g4(t,n,r,a,l).isSome()};if(D(l)){let t=a?n.withSimilar:n.withoutSimilar;t.callbacks.push(o),1===t.callbacks.length&&t.state.set(s())}else n.withVars.push({state:aL(s()),similar:a,vars:l,callback:o})}),r.set(i)})(t,r,n,o,a,l),{unbind:()=>((t,r,n)=>{let o=t.get();el(r.split(","),t=>eF(o,t).each(r=>{o[t]={withSimilar:{...r.withSimilar,callbacks:ed(r.withSimilar.callbacks,t=>t!==n)},withoutSimilar:{...r.withoutSimilar,callbacks:ed(r.withoutSimilar.callbacks,t=>t!==n)},withVars:ed(r.withVars,t=>t.callback!==n)}})),t.set(o)})(r,n,o)})},editor:{getContent:r=>J.from(t.getBody()).fold(H("tree"===r.format?new u8("body",11):""),n=>me(t,r,n)),setContent:(r,n)=>J.from(t.getBody()).map(o=>ge(r)?((t,r,n,o)=>{fG(t.parser.getNodeFilters(),t.parser.getAttributeFilters(),n);let a=mn({validate:!1},t.schema).serialize(n),l=n5(rl(r))?a:tM.trim(a);return gt(t,l,o.no_selection),{content:n,html:l}})(t,o,r,n):((t,r,n,o)=>{if(0===n.length||/^\s+$/.test(n)){let a='<br data-mce-bogus="1">';"TABLE"===r.nodeName?n="<tr><td>"+a+"</td></tr>":/^(UL|OL)$/.test(r.nodeName)&&(n="<li>"+a+"</li>");let l=io(t);return t.schema.isValidChild(r.nodeName.toLowerCase(),l.toLowerCase())?(n=a,n=t.dom.createHTML(l,ia(t),n)):n||(n=a),gt(t,n,o.no_selection),{content:n,html:n}}{"raw"!==o.format&&(n=mn({validate:!1},t.schema).serialize(t.parser.parse(n,{isRootContent:!0,insert:!0})));let a=n5(rl(r))?n:tM.trim(n);return gt(t,a,o.no_selection),{content:a,html:a}}})(t,o,r,n)).getOr({content:r,html:ge(n.content)?"":n.content}),insertContent:(r,n)=>f7(t,r,n),addVisual:r=>((t,r)=>{let n=t.dom,o=L(r)?r:t.getBody();el(n.select("table,a",o),r=>{switch(r.nodeName){case"TABLE":let o=i9(t),a=n.getAttrib(r,"border");a&&"0"!==a||!t.hasVisual?n.removeClass(r,o):n.addClass(r,o);break;case"A":if(!n.getAttrib(r,"href")){let o=n.getAttrib(r,"name")||r.id,a=i4(t);o&&t.hasVisual?n.addClass(r,a):n.removeClass(r,a)}}}),t.dispatch("VisualAid",{element:r,hasVisual:t.hasVisual})})(t,r)},selection:{getContent:(r,n)=>((t,r,n={})=>{let o={...n,format:r,get:!0,selection:!0,getInner:!0};return hE(t,o).fold($,r=>{let n=((t,r)=>{if("text"===r.format)return J.from(t.selection.getRng()).map(r=>{var n;let o=J.from(t.dom.getParent(r.commonAncestorContainer,t.dom.isBlock)),a=t.getBody(),l=o.map(t=>t.nodeName).getOr("div").toLowerCase(),i=rl(r.cloneContents());u4(i),u7(i);let s=t.dom.add(a,l,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},i.dom),d=hj(s),c=ot(null!==(n=s.textContent)&&void 0!==n?n:"");if(t.dom.remove(s),hz(c,0)||hz(c,c.length-1)){let t=o.getOr(a),r=hj(t),n=r.indexOf(d);return -1===n?d:(hz(r,n-1)?" ":"")+d+(hz(r,n+d.length)?" ":"")}return d}).getOr("");{let n=((t,r)=>{let n=t.selection.getRng(),o=t.dom.create("body"),a=t.selection.getSel(),l=uG(t,dU(a)),i=r.contextual?hU(rl(t.getBody()),l).dom:n.cloneContents();return i&&o.appendChild(i),t.selection.serializer.serialize(o,r)})(t,r);return"tree"===r.format?n:t.selection.isCollapsed()?"":n}})(t,r);return hk(t,n,r)})})(t,r,n)},autocompleter:{addDecoration:r=>uJ(t,r),removeDecoration:()=>uZ(rl(t.getBody())).each(r=>{let n=t.selection.getBookmark();nt(r),t.selection.moveToBookmark(n)})},raw:{getModel:()=>J.none()}}),h0=t=>eI(t.plugins,"rtc"),h1=t=>t.rtcInstance?t.rtcInstance:hZ(t),h2=t=>{let r=t.rtcInstance;if(r)return r;throw Error("Failed to get RTC instance not yet initialized.")},h3=t=>h2(t).init.bindEvents(),h8=t=>0===t.dom.length?(ne(t),J.none()):J.some(t),h5=(t,r,n,o)=>{t.bind(t=>((o?m2:m1)(t.dom,o?t.dom.length:0),r.filter(tY).map(r=>((t,r,n,o)=>{let a=t.dom,l=r.dom,i=o?a.length:l.length;o?(m3(a,l,!1,!o),n.setStart(l,i)):(m3(l,a,!1,!o),n.setEnd(l,i))})(t,r,n,o)))).orThunk(()=>{let t=r.filter(t=>ck.isBookmarkNode(t.dom)).bind(o?rE:rw).or(r).filter(tY);return t.map(t=>((t,r)=>{ry(t).each(n=>{let o=t.dom;r&&mW(n,lk(o,0))?m1(o,0):!r&&mK(n,lk(o,o.length))&&m2(o,o.length)})})(t,o))})},h6=(t,r,n)=>{if(eI(t,r)){let o=ed(t[r],t=>t!==n);0===o.length?delete t[r]:t[r]=o}},h9=t=>!(!t||!t.ownerDocument)&&rp(rl(t.ownerDocument),rl(t)),h4=(t,r,n,o)=>{let a,l;let{selectorChangedWithUnbind:i}=((t,r)=>{let n,o;let a=(r,n)=>ef(n,n=>t.is(n,r)),l=r=>t.getParents(r,void 0,t.getRoot());return{selectorChangedWithUnbind:(t,i)=>(n||(n={},o={},r.on("NodeChange",t=>{let r=t.element,i=l(r),s={};eA(n,(t,r)=>{a(r,i).each(n=>{o[r]||(el(t,t=>{t(!0,{node:n,selector:r,parents:i})}),o[r]=t),s[r]=t})}),eA(o,(t,n)=>{s[n]||(delete o[n],el(t,t=>{t(!1,{node:r,selector:n,parents:i})}))})})),n[t]||(n[t]=[]),n[t].push(i),a(t,l(r.selection.getStart())).each(()=>{o[t]=n[t]}),{unbind:()=>{h6(n,t,i),h6(o,t,i)}})}})(t,o),s=(t,r)=>((t,r,n={})=>{let o={format:"html",...n,set:!0,selection:!0,content:r};hS(t,o).each(r=>{let n=((t,r)=>{if("raw"!==r.format){let n=t.selection.getRng(),o=t.dom.getParent(n.commonAncestorContainer,t.dom.isBlock),a=o?{context:o.nodeName.toLowerCase()}:{},l=t.parser.parse(r.content,{forced_root_block:!1,...a,...r});return mn({validate:!1},t.schema).serialize(l)}return r.content})(t,r),o=t.selection.getRng();((t,r)=>{let n=J.from(r.firstChild).map(rl),o=J.from(r.lastChild).map(rl);t.deleteContents(),t.insertNode(r);let a=n.bind(rw).filter(tY).bind(h8),l=o.bind(rE).filter(tY).bind(h8);h5(a,n,t,!0),h5(l,o,t,!1),t.collapse(!1)})(o,o.createContextualFragment(n)),t.selection.setRng(o),uC(t,o),h_(t,n,r)})})(o,t,r),d=t=>{let r=u();r.collapse(!!t),m(r)},c=()=>r.getSelection?r.getSelection():r.document.selection,u=()=>{let n;let i=(t,r,n)=>{try{return r.compareBoundaryPoints(t,n)}catch(t){return -1}},s=r.document;if(L(o.bookmark)&&!uH(o)){let t=uT(o);if(t.isSome())return t.map(t=>uG(o,[t])[0]).getOr(s.createRange())}try{let t=c();t&&!ny(t.anchorNode)&&(n=t.rangeCount>0?t.getRangeAt(0):s.createRange(),n=uG(o,[n])[0])}catch(t){}if(n||(n=s.createRange()),nD(n.startContainer)&&n.collapsed){let r=t.getRoot();n.setStart(r,0),n.setEnd(r,0)}return a&&l&&(0===i(n.START_TO_START,n,a)&&0===i(n.END_TO_END,n,a)?n=l:(a=null,l=null)),n},m=(t,r)=>{var n;if(!((n=t)&&h9(n.startContainer)&&h9(n.endContainer)))return;let i=c();if(t=o.dispatch("SetSelectionRange",{range:t,forward:r}).range,i){l=t;try{i.removeAllRanges(),i.addRange(t)}catch(t){}!1===r&&i.extend&&(i.collapse(t.endContainer,t.endOffset),i.extend(t.startContainer,t.startOffset)),a=i.rangeCount>0?i.getRangeAt(0):null}if(!t.collapsed&&t.startContainer===t.endContainer&&(null==i?void 0:i.setBaseAndExtent)&&t.endOffset-t.startOffset<2&&t.startContainer.hasChildNodes()){let r=t.startContainer.childNodes[t.startOffset];r&&"IMG"===r.nodeName&&(i.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),i.anchorNode===t.startContainer&&i.focusNode===t.endContainer||i.setBaseAndExtent(r,0,r,1))}o.dispatch("AfterSetSelectionRange",{range:t,forward:r})},f=()=>{let r=c(),n=null==r?void 0:r.anchorNode,o=null==r?void 0:r.focusNode;if(!r||!n||!o||ny(n)||ny(o))return!0;let a=t.createRng(),l=t.createRng();try{a.setStart(n,r.anchorOffset),a.collapse(!0),l.setStart(o,r.focusOffset),l.collapse(!0)}catch(t){return!0}return 0>=a.compareBoundaryPoints(a.START_TO_START,l)},g={dom:t,win:r,serializer:n,editor:o,expand:(r={type:"word"})=>m(ue(t).expand(u(),r)),collapse:d,setCursorLocation:(r,n)=>{let a=t.createRng();L(r)&&L(n)?(a.setStart(r,n),a.setEnd(r,n),m(a),d(!1)):(dW(t,a,o.getBody(),!0),m(a))},getContent:t=>((t,r={})=>{var n;return n=r.format?r.format:"html",h2(t).selection.getContent(n,r)})(o,t),setContent:s,getBookmark:(t,r)=>p.getBookmark(t,r),moveToBookmark:t=>p.moveToBookmark(t),select:(r,n)=>(J.from(r).bind(r=>J.from(r.parentNode).map(o=>{let a=t.nodeIndex(r),l=t.createRng();return l.setStart(o,a),l.setEnd(o,a+1),n&&(dW(t,l,r,!0),dW(t,l,r,!1)),l})).each(m),r),isCollapsed:()=>{let t=u(),r=c();return!(!t||t.item)&&(t.compareEndPoints?0===t.compareEndPoints("StartToEnd",t):!r||t.collapsed)},isEditable:()=>{let r=u(),n=o.getBody().querySelectorAll('[data-mce-selected="1"]');return n.length>0?eb(n,r=>t.isEditable(r.parentElement)):r.startContainer===r.endContainer?t.isEditable(r.startContainer):t.isEditable(r.startContainer)&&t.isEditable(r.endContainer)},isForward:f,setNode:r=>(s(t.getOuterHTML(r)),r),getNode:()=>((t,r)=>{if(!r)return t;let n=r.startContainer,o=r.endContainer,a=r.startOffset,l=r.endOffset,i=r.commonAncestorContainer;r.collapsed||(n===o&&l-a<2&&n.hasChildNodes()&&(i=n.childNodes[a]),nA(n)&&nA(o)&&(n=n.length===a?uK(n.nextSibling,!0):n.parentNode,o=0===l?uK(o.previousSibling,!1):o.parentNode,n&&n===o&&(i=n)));let s=nA(i)?i.parentNode:i;return nC(s)?s:t})(o.getBody(),u()),getSel:c,setRng:m,getRng:u,getStart:t=>uq(o.getBody(),u(),t),getEnd:t=>uW(o.getBody(),u(),t),getSelectedBlocks:(r,n)=>((t,r,n,o)=>{let a=[],l=t.getRoot(),i=t.getParent(n||uq(l,r,r.collapsed),t.isBlock),s=t.getParent(o||uW(l,r,r.collapsed),t.isBlock);if(i&&i!==l&&a.push(i),i&&s&&i!==s){let r;let n=new nb(i,l);for(;(r=n.next())&&r!==s;)t.isBlock(r)&&a.push(r)}return s&&i!==s&&s!==l&&a.push(s),a})(t,u(),r,n),normalize:()=>{let r=u(),n=c();if(!(dU(n).length>1)&&dK(o)){let n=c9(t,r);return n.each(t=>{m(t,f())}),n.getOr(r)}return r},selectorChanged:(t,r)=>(i(t,r),g),selectorChangedWithUnbind:i,getScrollContainer:()=>{let r,n=t.getRoot();for(;n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){r=n;break}n=n.parentNode}return r},scrollIntoView:(t,r)=>{L(t)?((t,r,n)=>{(t.inline?ub:uy)(t,r,n)})(o,t,r):uC(o,u(),r)},placeCaretAt:(t,r)=>m(cZ(t,r,o.getDoc())),getBoundingClientRect:()=>{let t=u();return t.collapsed?lk.fromRangeStart(t).getClientRects()[0]:t.getBoundingClientRect()},destroy:()=>{r=a=l=null,h.destroy()}},p=ck(g),h=cF(g,o);return g.bookmarkManager=p,g.controlSelection=h,g},h7=(t,r,n)=>{-1===tM.inArray(r,n)&&(t.addAttributeFilter(n,(t,r)=>{let n=t.length;for(;n--;)t[n].attr(r,null)}),r.push(n))},be=(t,r)=>{let n=["data-mce-selected"],o={entity_encoding:"named",remove_trailing_brs:!0,...t},a=r&&r.dom?r.dom:aB.DOM,l=r&&r.schema?r.schema:am(o),i=hx(o,l);return i.addAttributeFilter("data-mce-tabindex",(t,r)=>{let n=t.length;for(;n--;){let o=t[n];o.attr("tabindex",o.attr("data-mce-tabindex")),o.attr(r,null)}}),i.addAttributeFilter("src,href,style",(t,r)=>{let n="data-mce-"+r,l=o.url_converter,i=o.url_converter_scope,s=t.length;for(;s--;){let o=t[s],d=o.attr(n);void 0!==d?(o.attr(r,d.length>0?d:null),o.attr(n,null)):(d=o.attr(r),"style"===r?d=a.serializeStyle(a.parseStyle(d),o.name):l&&(d=l.call(i,d,r,o.name)),o.attr(r,d.length>0?d:null))}}),i.addAttributeFilter("class",t=>{let r=t.length;for(;r--;){let n=t[r],o=n.attr("class");o&&(o=o.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),n.attr("class",o.length>0?o:null))}}),i.addAttributeFilter("data-mce-type",(t,r,n)=>{let o=t.length;for(;o--;){let r=t[o];if("bookmark"===r.attr("data-mce-type")&&!n.cleanup){let t=J.from(r.firstChild).exists(t=>{var r;return!nq(null!==(r=t.value)&&void 0!==r?r:"")});t?r.unwrap():r.remove()}}}),i.addNodeFilter("noscript",t=>{var r;let n=t.length;for(;n--;){let o=t[n].firstChild;o&&(o.value=o7.decode(null!==(r=o.value)&&void 0!==r?r:""))}}),i.addNodeFilter("script,style",(t,r)=>{var n;let a=t=>t.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,""),l=t.length;for(;l--;){let i=t[l],s=i.firstChild,d=null!==(n=null==s?void 0:s.value)&&void 0!==n?n:"";if("script"===r){let t=i.attr("type");t&&i.attr("type","mce-no/type"===t?null:t.replace(/^mce\-/,"")),"xhtml"===o.element_format&&s&&d.length>0&&(s.value="// <![CDATA[\n"+a(d)+"\n// ]]>")}else"xhtml"===o.element_format&&s&&d.length>0&&(s.value="<!--\n"+a(d)+"\n-->")}}),i.addNodeFilter("#comment",t=>{let r=t.length;for(;r--;){let n=t[r],l=n.value;o.preserve_cdata&&0===(null==l?void 0:l.indexOf("[CDATA["))?(n.name="#cdata",n.type=4,n.value=a.decode(l.replace(/^\[CDATA\[|\]\]$/g,""))):0===(null==l?void 0:l.indexOf("mce:protected "))&&(n.name="#text",n.type=3,n.raw=!0,n.value=unescape(l).substr(14))}}),i.addNodeFilter("xml:namespace,input",(t,r)=>{let n=t.length;for(;n--;){let o=t[n];7===o.type?o.remove():1===o.type&&("input"!==r||o.attr("type")||o.attr("type","text"))}}),i.addAttributeFilter("data-mce-type",t=>{el(t,t=>{"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(i.schema.getNonEmptyElements())?t.remove():t.unwrap())})}),i.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(t,r)=>{let n=t.length;for(;n--;)t[n].attr(r,null)}),o.remove_trailing_brs&&po(i,i.schema),{schema:l,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,serialize:(t,n={})=>{let s={format:"html",...n},d=L(r)&&r.hasEventListeners("PreProcess")&&!s.no_events?((t,r,n)=>{let o;let a=t.dom,l=r.cloneNode(!0),i=document.implementation;if(i.createHTMLDocument){let t=i.createHTMLDocument("");tM.each("BODY"===l.nodeName?l.childNodes:[l],r=>{t.body.appendChild(t.importNode(r,!0))}),l="BODY"!==l.nodeName?t.body.firstChild:t.body,o=a.doc,a.doc=t}return((t,r)=>{t.dispatch("PreProcess",r)})(t,{...n,node:l}),o&&(a.doc=o),l})(r,t,s):t,c=((t,r,n)=>{let o=ot(n.getInner?r.innerHTML:t.getOuterHTML(r));return n.selection||n5(rl(r))?o:tM.trim(o)})(a,d,s),u=((t,r,n)=>{let o=n.selection?{forced_root_block:!1,...n}:n,a=t.parse(r,o);return(t=>{let r=t=>"br"===(null==t?void 0:t.name),n=t.lastChild;if(r(n)){let t=n.prev;r(t)&&(n.remove(),t.remove())}})(a),a})(i,c,s);return"tree"===s.format?u:((t,r,n,o,a)=>{let l=mn(r,n).serialize(o);return((t,r,n)=>{if(!r.no_events&&t){var o;let a=(o={...r,content:n},t.dispatch("PostProcess",o));return a.content}return n})(t,a,l)})(r,o,l,u,s)},addRules:l.addValidElements,setRules:l.setValidElements,addTempAttr:q(h7,i,n),getTempAttrs:H(n),getNodeFilters:i.getNodeFilters,getAttributeFilters:i.getAttributeFilters,removeNodeFilter:i.removeNodeFilter,removeAttributeFilter:i.removeAttributeFilter}},bt=(t,r)=>{let n=be(t,r);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},br=(t,r,n={})=>{let o={format:"html",...n,set:!0,content:r};return hS(t,o).map(r=>{var n;let o=(n=r.content,h1(t).editor.setContent(n,r));return h_(t,o.html,r),o.content}).getOr(r)},bn="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),bo="template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),ba="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),bl=[{name:"template",replacedWith:"Advanced Template"},{name:"rtc"}],bi=(t,r)=>{let n=ed(r,r=>eI(t,r));return ex(n)},bs=t=>{let r=bi(t,bn),n=t.forced_root_block;return!1!==n&&""!==n||r.push("forced_root_block (false only)"),ex(r)},bd=t=>bi(t,bo),bc=(t,r)=>{let n=tM.makeMap(t.plugins," "),o=ed(r,t=>eI(n,t));return ex(o)},bu=t=>bc(t,ba),bm=t=>bc(t,bl.map(t=>t.name)),bf=t=>ef(bl,r=>r.name===t).fold(()=>t,r=>r.replacedWith?`${t}, replaced by ${r.replacedWith}`:t),bg=aB.DOM,bp=t=>J.from(t).each(t=>t.destroy()),bh=(()=>{let t={};return{add:(r,n)=>{t[r]=n},get:r=>t[r]?t[r]:{icons:{}},has:r=>eI(t,r)}})(),bb=az.ModelManager,bv=(t,r)=>r.dom[t],by=(t,r)=>parseInt(rJ(r,t),10),bC=q(bv,"clientWidth"),bx=q(bv,"clientHeight"),bw=q(by,"margin-top"),bE=q(by,"margin-left"),bk=t=>{let r=[],n=()=>{let r=t.theme;return r&&r.getNotificationManagerImpl?r.getNotificationManagerImpl():(()=>{let t=()=>{throw Error("Theme did not provide a NotificationManager implementation.")};return{open:t,close:t,getArgs:t}})()},o=()=>J.from(r[0]),a=()=>{el(r,t=>{t.reposition()})},l=t=>{eg(r,r=>r===t).each(t=>{r.splice(t,1)})},i=(i,s=!0)=>{var d;return t.removed||!(d=t.inline?t.getBody():t.getContentAreaContainer(),J.from(d).map(rl)).map(rU).getOr(!1)?{}:(s&&t.dispatch("BeforeOpenNotification",{notification:i}),ef(r,t=>{var r;return!((r=n().getArgs(t)).type!==i.type||r.text!==i.text||r.progressBar||r.timeout||i.progressBar||i.timeout)}).getOrThunk(()=>{t.editorManager.setActive(t);let s=n().open(i,()=>{l(s),a(),o().fold(()=>t.focus(),t=>ux(rl(t.getEl())))});return r.push(s),a(),t.dispatch("OpenNotification",{notification:{...s}}),s}))},s=H(r);return t.on("SkinLoaded",()=>{let r=iM(t);r&&i({text:r,type:"warning",timeout:0},!1),a()}),t.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(a)}),t.on("remove",()=>{el(r.slice(),t=>{n().close(t)})}),{open:i,close:()=>{o().each(t=>{n().close(t),l(t),a()})},getNotifications:s}},bS=az.PluginManager,b_=az.ThemeManager,bN=t=>{let r=[],n=()=>{let r=t.theme;return r&&r.getWindowManagerImpl?r.getWindowManagerImpl():(()=>{let t=()=>{throw Error("Theme did not provide a WindowManager implementation.")};return{open:t,openUrl:t,alert:t,confirm:t,close:t}})()},o=(t,r)=>(...n)=>r?r.apply(t,n):void 0,a=n=>{t.dispatch("CloseWindow",{dialog:n}),0===(r=ed(r,t=>t!==n)).length&&t.focus()},l=n=>{t.editorManager.setActive(t),uO(t),t.ui.show();let o=n();return r.push(o),t.dispatch("OpenWindow",{dialog:o}),o};return t.on("remove",()=>{el(r,t=>{n().close(t)})}),{open:(t,r)=>l(()=>n().open(t,r,a)),openUrl:t=>l(()=>n().openUrl(t,a)),alert:(t,r,a)=>{let l=n();l.alert(t,o(a||l,r))},confirm:(t,r,a)=>{let l=n();l.confirm(t,o(a||l,r))},close:()=>{J.from(r[r.length-1]).each(t=>{n().close(t),a(t)})}}},bR=(t,r)=>{t.notificationManager.open({type:"error",text:r})},bA=(t,r)=>{t._skinLoaded?bR(t,r):t.on("SkinLoaded",()=>{bR(t,r)})},bO=(t,r,n)=>{c_(t,r,{message:n}),console.error(n)},bT=(t,r,n)=>n?`Failed to load ${t}: ${n} from url ${r}`:`Failed to load ${t} url: ${r}`,bB=(t,...r)=>{let n=window.console;n&&(n.error?n.error(t,...r):n.log(t,...r))},bD=(t,r)=>{let n=t.editorManager.baseURL+"/skins/content",o=`content${t.editorManager.suffix}.css`;return ea(r,r=>/^[a-z0-9\-]+$/i.test(r)&&!t.inline?`${n}/${r}/${o}`:t.documentBaseURI.toAbsolute(r))},bP=(t,r)=>{let n={};return{findAll:(o,a=Q)=>{let l=ed(o?eS(o.getElementsByTagName("img")):[],r=>{let n=r.src;return!r.hasAttribute("data-mce-bogus")&&!r.hasAttribute("data-mce-placeholder")&&!(!n||n===tB.transparentSrc)&&(e3(n,"blob:")?!t.isUploaded(n)&&a(r):!!e3(n,"data:")&&a(r))}),i=ea(l,t=>{let o=t.src;if(eI(n,o))return n[o].then(r=>N(r)?r:{image:t,blobInfo:r.blobInfo});{let a=((t,r)=>{let n=()=>Promise.reject("Invalid data URI");if(e3(r,"blob:")){let o=t.getByUri(r);return L(o)?Promise.resolve(o):(e3(r,"blob:")?fetch(r).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${r} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})):e3(r,"data:")?new Promise((t,n)=>{pa(r).bind(({type:t,data:r,base64Encoded:n})=>pl(t,r,n)).fold(()=>n("Invalid data URI"),t)}):Promise.reject("Unknown URI format")).then(r=>pi(r).then(o=>pd(o,!1,n=>J.some(pc(t,r,n))).getOrThunk(n)))}return e3(r,"data:")?pu(t,r).fold(n,t=>Promise.resolve(t)):Promise.reject("Unknown image data format")})(r,o).then(r=>(delete n[o],{image:t,blobInfo:r})).catch(t=>(delete n[o],t));return n[o]=a,a}});return Promise.all(i)}}},bL=()=>{let t={},r=(t,r)=>({status:t,resultUri:r}),n=r=>r in t;return{hasBlobUri:n,getResultUri:r=>{let n=t[r];return n?n.resultUri:null},isPending:r=>!!n(r)&&1===t[r].status,isUploaded:r=>!!n(r)&&2===t[r].status,markPending:n=>{t[n]=r(1,null)},markUploaded:(n,o)=>{t[n]=r(2,o)},removeFailed:r=>{delete t[r]},destroy:()=>{t={}}}},bM=0,bF=(t,r)=>{let n={},o=(t,n)=>new Promise((o,a)=>{let l=new XMLHttpRequest;l.open("POST",r.url),l.withCredentials=r.credentials,l.upload.onprogress=t=>{n(t.loaded/t.total*100)},l.onerror=()=>{a("Image upload failed due to a XHR Transport error. Code: "+l.status)},l.onload=()=>{var t,n;if(l.status<200||l.status>=300)return void a("HTTP Error: "+l.status);let i=JSON.parse(l.responseText);i&&N(i.location)?o((t=r.basePath,n=i.location,t?t.replace(/\/$/,"")+"/"+n.replace(/^\//,""):n)):a("Invalid JSON: "+l.responseText)};let i=new FormData;i.append("file",t.blob(),t.filename()),l.send(i)}),a=M(r.handler)?r.handler:o,l=(t,r)=>({url:r,blobInfo:t,status:!0}),i=(t,r)=>({url:"",blobInfo:t,status:!1,error:r}),s=(t,r)=>{tM.each(n[t],t=>{t(r)}),delete n[t]};return{upload:(d,c)=>{var u;return r.url||a!==o?(u=d,u=tM.grep(u,r=>!t.isUploaded(r.blobUri())),Promise.all(tM.map(u,r=>t.isPending(r.blobUri())?(t=>{let r=t.blobUri();return new Promise(t=>{n[r]=n[r]||[],n[r].push(t)})})(r):(t.markPending(r.blobUri()),new Promise(n=>{let o,d;try{let u=()=>{o&&(o.close(),d=U)},m=o=>{u(),t.removeFailed(r.blobUri()),s(r.blobUri(),i(r,o)),n(i(r,o))};d=t=>{t<0||t>100||J.from(o).orThunk(()=>J.from(c).map(G)).each(r=>{o=r,r.progressBar.value(t)})},a(r,d).then(o=>{u(),t.markUploaded(r.blobUri(),o),s(r.blobUri(),l(r,o)),n(l(r,o))},t=>{m(N(t)?{message:t}:t)})}catch(t){n(i(r,t))}}))))):new Promise(t=>{t([])})}}},bI=t=>()=>t.notificationManager.open({text:t.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),bU=(t,r)=>bF(r,{url:ib(t),basePath:iv(t),credentials:iy(t),handler:iC(t)}),bz=t=>{let r,n;let o=(()=>{let t=[],r=t=>{if(!t.blob||!t.base64)throw Error("blob and base64 representations of the image are required for BlobInfo to be created");let r=t.id||"blobid"+bM+++(()=>{let t=()=>Math.round(4294967295*Math.random()).toString(36);return"s"+(new Date).getTime().toString(36)+t()+t()+t()})(),n=t.name||r,o=t.blob;return{id:H(r),name:H(n),filename:H(t.filename||n+"."+(({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[o.type.toLowerCase()]||"dat")),blob:H(o),base64:H(t.base64),blobUri:H(t.blobUri||URL.createObjectURL(o)),uri:H(t.uri)}},n=r=>ef(t,r).getOrUndefined(),o=t=>n(r=>r.id()===t);return{create:(t,n,o,a,l)=>{if(N(t))return r({id:t,name:a,filename:l,blob:n,base64:o});if(R(t))return r(t);throw Error("Unknown input type")},add:r=>{o(r.id())||t.push(r)},get:o,getByUri:t=>n(r=>r.blobUri()===t),getByData:(t,r)=>n(n=>n.base64()===t&&n.blob().type===r),findFirst:n,removeByUri:r=>{t=ed(t,t=>t.blobUri()!==r||(URL.revokeObjectURL(t.blobUri()),!1))},destroy:()=>{el(t,t=>{URL.revokeObjectURL(t.blobUri())}),t=[]}}})(),a=bL(),l=[],i=r=>n=>t.selection?r(n):[],s=(t,r,n)=>{let o=0;do -1!==(o=t.indexOf(r,o))&&(t=t.substring(0,o)+n+t.substr(o+r.length),o+=n.length-r.length+1);while(-1!==o);return t},d=(t,r,n)=>{let o=`src="${n}"${n===tB.transparentSrc?' data-mce-placeholder="1"':""}`;return t=s(t,`src="${r}"`,o),s(t,'data-mce-src="'+r+'"','data-mce-src="'+n+'"')},c=(r,n)=>{el(t.undoManager.data,t=>{"fragmented"===t.type?t.fragments=ea(t.fragments,t=>d(t,r,n)):t.content=d(t.content,r,n)})},u=()=>(r||(r=bU(t,a)),g().then(i(n=>{let a=ea(n,t=>t.blobInfo);return r.upload(a,bI(t)).then(i(r=>{let a=[],l=!1,i=ea(r,(r,i)=>{var s;let{blobInfo:d,image:u}=n[i],m=!1;return r.status&&ig(t)?(r.url&&!e2(u.src,r.url)&&(l=!0),o.removeByUri(u.src),h0(t)||((r,n)=>{let o=t.convertURL(n,"src");c(r.src,n),t1(rl(r),{src:im(t)?n+(-1===n.indexOf("?")?"?":"&")+(new Date).getTime():n,"data-mce-src":o})})(u,r.url)):r.error&&(r.error.remove&&(c(u.src,tB.transparentSrc),a.push(u),m=!0),s=r.error.message,bA(t,aU.translate(["Failed to upload image: {0}",s]))),{element:u,status:r.status,uploadUri:r.url,blobInfo:d,removed:m}});return a.length>0&&!h0(t)?t.undoManager.transact(()=>{el(nr(a),r=>{let n=ry(r);ne(r),n.each(r=>{t.dom.isEmpty(r.dom)&&L(t.schema.getTextBlockElements()[tV(r)])&&r6(r,ri('<br data-mce-bogus="1" />'))}),o.removeByUri(r.dom.src)})}):l&&t.undoManager.dispatchChange(),i}))}))),m=()=>iu(t)?u():Promise.resolve([]),f=t=>eb(l,r=>r(t)),g=()=>(n||(n=bP(a,o)),n.findAll(t.getBody(),f).then(i(r=>{let n=ed(r,r=>N(r)?(bA(t,r),!1):"blob"!==r.uriType);return h0(t)||el(n,t=>{c(t.image.src,t.blobInfo.blobUri()),t.image.src=t.blobInfo.blobUri(),t.image.removeAttribute("data-mce-src")}),n}))),p=r=>r.replace(/src="(blob:[^"]+)"/g,(r,n)=>{let l=a.getResultUri(n);if(l)return'src="'+l+'"';let i=o.getByUri(n);return i||(i=eu(t.editorManager.get(),(t,r)=>t||r.editorUpload&&r.editorUpload.blobCache.getByUri(n),void 0)),i?'src="data:'+i.blob().type+";base64,"+i.base64()+'"':r});return t.on("SetContent",()=>{iu(t)?m():g()}),t.on("RawSaveContent",t=>{t.content=p(t.content)}),t.on("GetContent",t=>{t.source_view||"raw"===t.format||"tree"===t.format||(t.content=p(t.content))}),t.on("PostRender",()=>{t.parser.addNodeFilter("img",t=>{el(t,t=>{let r=t.attr("src");if(!r||o.getByUri(r))return;let n=a.getResultUri(r);n&&t.attr("src",n)})})}),{blobCache:o,addFilter:t=>{l.push(t)},uploadImages:u,uploadImagesAuto:m,scanForImages:g,destroy:()=>{o.destroy(),a.destroy(),n=r=null}}},bj={remove_similar:!0,inherit:!1},bH={selector:"td,th",...bj},b$={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...bH},tablecellverticalalign:{styles:{"vertical-align":"%value"},...bH},tablecellbordercolor:{styles:{borderColor:"%value"},...bH},tablecellclass:{classes:["%value"],...bH},tableclass:{selector:"table",classes:["%value"],...bj},tablecellborderstyle:{styles:{borderStyle:"%value"},...bH},tablecellborderwidth:{styles:{borderWidth:"%value"},...bH}},bV=H(b$),bq=tM.each,bW=aB.DOM,bK=t=>L(t)&&R(t),bG=(t,r)=>{let n=r&&r.schema||am({}),o=t=>{let r=N(t)?{name:t,classes:[],attrs:{}}:t,n=bW.create(r.name);return r.classes.length>0&&bW.addClass(n,r.classes.join(" ")),bW.setAttribs(n,r.attrs),n},a=(t,r,l)=>{let i;let s=r[0],d=bK(s)?s.name:void 0,c=((t,r)=>{let o=n.getElementRule(t.nodeName.toLowerCase()),a=null==o?void 0:o.parentsRequired;return!(!a||!a.length)&&(r&&en(a,r)?r:a[0])})(t,d);if(c)d===c?(i=s,r=r.slice(1)):i=c;else if(s)i=s,r=r.slice(1);else if(!l)return t;let u=i?o(i):bW.create("div");u.appendChild(t),l&&tM.each(l,r=>{let n=o(r);u.insertBefore(n,t)});let m=bK(i)?i.siblings:void 0;return a(u,r,m)},l=bW.create("div");if(t.length>0){let r=t[0],n=o(r),i=bK(r)?r.siblings:void 0;l.appendChild(a(n,t.slice(1),i))}return l},bY=t=>{let r="div",n={name:r,classes:[],attrs:{},selector:t=tM.trim(t)};return"*"!==t&&(r=t.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(t,r,o,a,l)=>{switch(r){case"#":n.attrs.id=o;break;case".":n.classes.push(o);break;case":":-1!==tM.inArray("checked disabled enabled read-only required".split(" "),o)&&(n.attrs[o]=o)}if("["===a){let t=l.match(/([\w\-]+)(?:\=\"([^\"]+))?/);t&&(n.attrs[t[1]]=t[2])}return""})),n.name=r||"div",n},bX=(t,r)=>{var n;let o="",a=i$(t);if(""===a)return"";let l=t=>N(t)?t.replace(/%(\w+)/g,""):"",i=(r,n)=>bW.getStyle(null!=n?n:t.getBody(),r,!0);if(N(r)){let n=t.formatter.get(r);if(!n)return"";r=n[0]}if("preview"in r){let t=r.preview;if(!1===t)return"";a=t||a}let s,d=r.block||r.inline||"span",c=N(n=r.selector)?(n=(n=n.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),tM.map(n.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{let r=tM.map(t.split(/(?:~\+|~|\+)/),bY),n=r.pop();return r.length&&(n.siblings=r),n}).reverse()):[];c.length>0?(c[0].name||(c[0].name=d),d=r.selector,s=bG(c,t)):s=bG([d],t);let u=bW.select(d,s)[0]||s.firstChild;bq(r.styles,(t,r)=>{let n=l(t);n&&bW.setStyle(u,r,n)}),bq(r.attributes,(t,r)=>{let n=l(t);n&&bW.setAttrib(u,r,n)}),bq(r.classes,t=>{let r=l(t);bW.hasClass(u,r)||bW.addClass(u,r)}),t.dispatch("PreviewFormats"),bW.setStyles(s,{position:"absolute",left:-65535}),t.getBody().appendChild(s);let m=i("fontSize"),f=/px$/.test(m)?parseInt(m,10):0;return bq(a.split(" "),t=>{let r=i(t,u);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(r)&&"#ffffff"===dI(r=i(t)).toLowerCase()||"color"===t&&"#000000"===dI(r).toLowerCase())){if("font-size"===t&&/em|%$/.test(r)){if(0===f)return;r=parseFloat(r)/(/%$/.test(r)?100:1)*f+"px"}"border"===t&&r&&(o+="padding:0 2px;"),o+=t+":"+r+";"}}),t.dispatch("AfterPreviewFormats"),bW.remove(s),o},bQ=t=>{let r=(t=>{let r={},n=(t,o)=>{t&&(N(t)?(O(o)||(o=[o]),el(o,t=>{D(t.deep)&&(t.deep=!co(t)),D(t.split)&&(t.split=!co(t)||ca(t)),D(t.remove)&&co(t)&&!ca(t)&&(t.remove="none"),co(t)&&ca(t)&&(t.mixed=!0,t.block_expand=!0),N(t.classes)&&(t.classes=t.classes.split(/\s+/))}),r[t]=o):eA(t,(t,r)=>{n(r,t)}))};return n((t=>{let r=t.dom,n=t.schema.type,o={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:t=>{r.setStyle(t,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:t=>{r.setStyle(t,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{let t={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},o={inline:"s",remove:"all",preserve_attributes:["class","style"]};return"html4"!==n?[o,t,r]:[t,o,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(t,r,n)=>nC(t)&&t.hasAttribute("href"),onformat:(t,n,o)=>{tM.each(o,(n,o)=>{r.setAttrib(t,o,n)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":t=>{var r;return null!==(r=null==t?void 0:t.customValue)&&void 0!==r?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return tM.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),t=>{o[t]={block:t,remove:"all"}}),o})(t)),n(bV()),n(iH(t)),{get:t=>L(t)?r[t]:r,has:t=>eI(r,t),register:n,unregister:t=>(t&&r[t]&&delete r[t],r)}})(t),n=aL({});return(t=>{t.addShortcut("meta+b","","Bold"),t.addShortcut("meta+i","","Italic"),t.addShortcut("meta+u","","Underline");for(let r=1;r<=6;r++)t.addShortcut("access+"+r,"",["FormatBlock",!1,"h"+r]);t.addShortcut("access+7","",["FormatBlock",!1,"p"]),t.addShortcut("access+8","",["FormatBlock",!1,"div"]),t.addShortcut("access+9","",["FormatBlock",!1,"address"])})(t),(t=>{t.on("mouseup keydown",r=>{var n;((t,r,n)=>{let o=t.selection,a=t.getBody();gp(t,null,n),(8===r||46===r)&&o.isCollapsed()&&"\uFEFF"===o.getStart().innerHTML&&gp(t,dh(a,o.getStart())),37!==r&&39!==r||gp(t,dh(a,o.getStart()))})(t,r.keyCode,nA(n=t.selection.getRng().endContainer)&&e8(n.data,"\xa0"))})})(t),h0(t)||(n.set({}),t.on("NodeChange",r=>{pe(t,r.element,n.get())}),t.on("FormatApply FormatRemove",r=>{let o=J.from(r.node).map(t=>dX(t)?t:t.startContainer).bind(t=>nC(t)?J.some(t):J.from(t.parentElement)).getOrThunk(()=>g9(t));pe(t,o,n.get())})),{get:r.get,has:r.has,register:r.register,unregister:r.unregister,apply:(r,n,o)=>{((t,r,n,o)=>{h2(t).formatter.apply(r,n,o)})(t,r,n,o)},remove:(r,n,o,a)=>{((t,r,n,o,a)=>{h2(t).formatter.remove(r,n,o,a)})(t,r,n,o,a)},toggle:(r,n,o)=>{((t,r,n,o)=>{h2(t).formatter.toggle(r,n,o)})(t,r,n,o)},match:(r,n,o,a)=>h2(t).formatter.match(r,n,o,a),closest:r=>h2(t).formatter.closest(r),matchAll:(r,n)=>h2(t).formatter.matchAll(r,n),matchNode:(r,n,o,a)=>h2(t).formatter.matchNode(r,n,o,a),canApply:r=>h2(t).formatter.canApply(r),formatChanged:(r,o,a,l)=>h2(t).formatter.formatChanged(n,r,o,a,l),getCssText:q(bX,t)}},bJ=t=>{switch(t.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},bZ=t=>{let r=aH(),n=aL(0),o=aL(0),a={data:[],typing:!1,beforeChange:()=>{((t,r,n)=>{h2(t).undoManager.beforeChange(r,n)})(t,n,r)},add:(l,i)=>h2(t).undoManager.add(a,o,n,r,l,i),dispatchChange:()=>{t.setDirty(!0);let r=hq(t);r.bookmark=lH(t.selection),t.dispatch("change",{level:r,lastLevel:ew(a.data,o.get()).getOrUndefined()})},undo:()=>h2(t).undoManager.undo(a,n,o),redo:()=>{var r;return r=a.data,h2(t).undoManager.redo(o,r)},clear:()=>{((t,r,n)=>{h2(t).undoManager.clear(r,n)})(t,a,o)},reset:()=>{((t,r)=>{h2(t).undoManager.reset(r)})(t,a)},hasUndo:()=>h2(t).undoManager.hasUndo(a,o),hasRedo:()=>h2(t).undoManager.hasRedo(a,o),transact:r=>h2(t).undoManager.transact(a,n,r),ignore:r=>{((t,r,n)=>{h2(t).undoManager.ignore(r,n)})(t,n,r)},extra:(r,n)=>{((t,r,n,o,a)=>{h2(t).undoManager.extra(r,n,o,a)})(t,a,o,r,n)}};return h0(t)||((t,r,n)=>{let o=aL(!1),a=t=>{hQ(r,!1,n),r.add({},t)};t.on("init",()=>{r.add()}),t.on("BeforeExecCommand",t=>{let o=t.command;bJ(o)||(hJ(r,n),r.beforeChange())}),t.on("ExecCommand",t=>{let r=t.command;bJ(r)||a(t)}),t.on("ObjectResizeStart cut",()=>{r.beforeChange()}),t.on("SaveContent ObjectResized blur",a),t.on("dragend",a),t.on("keyup",n=>{let l=n.keyCode;if(n.isDefaultPrevented())return;let i=tB.os.isMacOS()&&"Meta"===n.key;(l>=33&&l<=36||l>=37&&l<=40||45===l||n.ctrlKey||i)&&(a(),t.nodeChanged()),46!==l&&8!==l||t.nodeChanged(),o.get()&&r.typing&&!hY(hq(t),r.data[0])&&(t.isDirty()||t.setDirty(!0),t.dispatch("TypingUndo"),o.set(!1),t.nodeChanged())}),t.on("keydown",t=>{let l=t.keyCode;if(t.isDefaultPrevented())return;if(l>=33&&l<=36||l>=37&&l<=40||45===l)return void(r.typing&&a(t));let i=t.ctrlKey&&!t.altKey||t.metaKey;if((l<16||l>20)&&224!==l&&91!==l&&!r.typing&&!i)return r.beforeChange(),hQ(r,!0,n),r.add({},t),void o.set(!0);(tB.os.isMacOS()?t.metaKey:t.ctrlKey&&!t.altKey)&&r.beforeChange()}),t.on("mousedown",t=>{r.typing&&a(t)}),t.on("input",t=>{t.inputType&&("insertReplacementText"===t.inputType||"insertText"===t.inputType&&null===t.data||"insertFromPaste"===t.inputType||"insertFromDrop"===t.inputType)&&a(t)}),t.on("AddUndo Undo Redo ClearUndos",r=>{r.isDefaultPrevented()||t.nodeChanged()})})(t,a,n),t.addShortcut("meta+z","","Undo"),t.addShortcut("meta+y,meta+shift+z","","Redo"),a},b0=[9,27,cB.HOME,cB.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,cB.DOWN,cB.UP,cB.LEFT,cB.RIGHT].concat(tB.browser.isFirefox()?[224]:[]),b1="data-mce-placeholder",b2=t=>"keydown"===t.type||"keyup"===t.type,b3=t=>{let r=t.keyCode;return r===cB.BACKSPACE||r===cB.DELETE},b8=(t,r)=>({from:t,to:r}),b5=(t,r)=>{let n=rl(t),o=rl(r.container());return fm(n,o).map(t=>({block:t,position:r}))},b6=(t,r)=>rH(r,t=>n8(t)||nF(t.dom),r=>rg(r,t)).filter(tG).getOr(t),b9=t=>{let r=(t=>{let r=r_(t);return eg(r,nQ).fold(H(r),t=>r.slice(0,t))})(t);return el(r,ne),r},b4=(t,r)=>{let n=mk(r,t);return ef(n.reverse(),t=>oN(t)).each(ne)},b7=(t,r,n,o)=>{if(oN(n))return n7(n),dm(n.dom);0===ed(rk(o),t=>!oN(t)).length&&oN(r)&&r3(o,rs("br"));let a=du(n.dom,lk.before(o.dom));return el(b9(r),t=>{r3(o,t)}),b4(t,r),a},ve=(t,r,n)=>{if(oN(n)){if(oN(r)){let t=ec((t=>{let r=(t,n)=>rR(t).fold(()=>n,t=>nJ(t)?r(t,n.concat(a5(t))):n);return r(t,[])})(n),(t,r)=>(r9(t,r),r),n4());r7(r),r6(r,t)}return ne(n),dm(r.dom)}let o=df(n.dom);return el(b9(r),t=>{r6(n,t)}),b4(t,r),o},vt=(t,r)=>{dd(t,r.dom).bind(t=>J.from(t.getNode())).map(rl).filter(nZ).each(ne)},vr=(t,r,n)=>(vt(!0,r),vt(!1,n),(rp(n,r)?((t,r)=>{let n=mk(r,t);return J.from(n[n.length-1])})(n,r):J.none()).fold(q(ve,t,r,n),q(b7,t,r,n))),vn=(t,r,n,o)=>r?vr(t,o,n):vr(t,n,o),vo=(t,r)=>{var n,o;let a=rl(t.getBody()),l=(n=a.dom,(o=t.selection.getRng()).collapsed?((t,r,n)=>{let o=b5(t,lk.fromRangeStart(n)),a=o.bind(n=>dl(r,t,n.position).bind(n=>b5(t,n).map(n=>nL(n.position.getNode())&&!oN(n.block)?dd(!1,n.block.dom).bind(o=>o.isEqual(n.position)?dl(r,t,o).bind(r=>b5(t,r)):J.some(n)).getOr(n):n)));return tI(o,a,b8).filter(r=>!rg(r.from.block,r.to.block)&&((t,r)=>{let n=rl(t);return rg(b6(n,r.from.block),b6(n,r.to.block))})(t,r)&&!1===nI(r.from.block.dom)&&!1===nI(r.to.block.dom)&&(t=>{let r=t=>n0(t)||oM(t.dom);return r(t.from.block)&&r(t.to.block)})(r))})(n,r,o):J.none()).map(n=>()=>{vn(a,r,n.from.block,n.to.block).each(r=>{t.selection.setRng(r.toRange())})});return l},va=(t,r)=>{let n=rl(r),o=q(rg,t);return rj(n,n8,o).isSome()},vl=t=>{let r=rl(t.getBody());return((t,r)=>{let n=du(t.dom,lk.fromRangeStart(r)).isNone(),o=dc(t.dom,lk.fromRangeEnd(r)).isNone();return!(va(t,r.startContainer)||va(t,r.endContainer))&&n&&o})(r,t.selection.getRng())?J.some(()=>{t.setContent(""),t.selection.setCursorLocation()}):((t,r)=>{let n=r.getRng();return tI(fm(t,rl(n.startContainer)),fm(t,rl(n.endContainer)),(o,a)=>rg(o,a)?J.none():J.some(()=>{n.deleteContents(),vn(t,!0,o,a).each(t=>{r.setRng(t.toRange())})})).getOr(J.none())})(r,t.selection)},vi=(t,r)=>t.selection.isCollapsed()?J.none():vl(t),vs=(t,r,n,o,a)=>J.from(r._selectionOverrides.showCaret(t,n,o,a)),vd=(t,r)=>t.dispatch("BeforeObjectSelected",{target:r}).isDefaultPrevented()?J.none():J.some((t=>{let r=t.ownerDocument.createRange();return r.selectNode(t),r})(r)),vc=(t,r,n)=>r.collapsed?((t,r,n)=>{let o=s1(1,t.getBody(),r),a=lk.fromRangeStart(o),l=a.getNode();if(sz(l))return vs(1,t,l,!a.isAtEnd(),!1);let i=a.getNode(!0);if(sz(i))return vs(1,t,i,!1,!1);let s=fH(t.dom.getRoot(),a.getNode());return sz(s)?vs(1,t,s,!1,n):J.none()})(t,r,n).getOr(r):r,vu=t=>mx(t)||mb(t),vm=t=>mw(t)||mv(t),vf=(t,r,n,o,a,l)=>{var i;vs(o,t,l.getNode(!a),a,!0).each(n=>{if(r.collapsed){let t=r.cloneRange();a?t.setEnd(n.startContainer,n.startOffset):t.setStart(n.endContainer,n.endOffset),t.deleteContents()}else r.deleteContents();t.selection.setRng(n)}),i=t.dom,nA(n)&&0===n.data.length&&i.remove(n)},vg=(t,r)=>((t,r)=>{let n=t.selection.getRng();if(!nA(n.commonAncestorContainer))return J.none();let o=r?pO.Forwards:pO.Backwards,a=dt(t.getBody()),l=q(s5,r?a.next:a.prev),i=r?vu:vm,s=s3(o,t.getBody(),n),d=l(s),c=d?fl(r,d):d;if(!c||!s6(s,c))return J.none();if(i(c))return J.some(()=>vf(t,n,s.getNode(),o,r,c));let u=l(c);return u&&i(u)&&s6(c,u)?J.some(()=>vf(t,n,s.getNode(),o,r,u)):J.none()})(t,r),vp=(t,r)=>{let n=t.getBody();return r?dm(n).filter(mx):df(n).filter(mw)},vh=t=>{let r=t.selection.getRng();return!r.collapsed&&(vp(t,!0).exists(t=>t.isEqual(lk.fromRangeStart(r)))||vp(t,!1).exists(t=>t.isEqual(lk.fromRangeEnd(r))))},vb=lW([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),vv=(t,r,n)=>dl(r,t,n).bind(o=>{var a;return L(a=o.getNode())&&(n8(rl(a))||n2(rl(a)))||((t,r,n,o)=>{let a=r=>nJ(rl(r))&&!sG(n,o,t);return s2(!r,n).fold(()=>s2(r,o).fold(X,a),a)})(t,r,n,o)?J.none():r&&nI(o.getNode())||!r&&nI(o.getNode(!0))?((t,r,n,o)=>{let a=o.getNode(!r);return fm(rl(t),rl(n.getNode())).map(t=>oN(t)?vb.remove(t.dom):vb.moveToElement(a)).orThunk(()=>J.some(vb.moveToElement(a)))})(t,r,n,o):r&&mw(n)||!r&&mx(n)?J.some(vb.moveToPosition(o)):J.none()}),vy=(t,r)=>J.from(fH(t.getBody(),r)),vC=(t,r)=>{let n=t.selection.getNode();return vy(t,n).filter(nI).fold(()=>((t,r,n)=>{var o;let a=s1(r?1:-1,t,n),l=lk.fromRangeStart(a),i=rl(t);return!r&&mw(l)?J.some(vb.remove(l.getNode(!0))):r&&mx(l)?J.some(vb.remove(l.getNode())):!r&&mx(l)&&mM(i,l)?mF(i,l).map(t=>vb.remove(t.getNode())):r&&mw(l)&&mL(i,l)?mI(i,l).map(t=>vb.remove(t.getNode())):((t,r)=>{let n=r.getNode(!t),o=t?"after":"before";return nC(n)&&n.getAttribute("data-mce-caret")===o})(r,l)?(P(o=l.getNode(!r))?J.none():r&&nI(o.nextSibling)?J.some(vb.moveToElement(o.nextSibling)):!r&&nI(o.previousSibling)?J.some(vb.moveToElement(o.previousSibling)):J.none()).orThunk(()=>vv(t,r,l)):vv(t,r,l).bind(r=>r.fold(t=>J.some(vb.remove(t)),t=>J.some(vb.moveToElement(t)),r=>sG(l,r,t)?J.none():J.some(vb.moveToPosition(r))))})(t.getBody(),r,t.selection.getRng()).map(n=>()=>n.fold(n=>(t._selectionOverrides.hideFakeCaret(),ft(t,r,rl(n)),!0),n=>{let o=r?lk.before(n):lk.after(n);return t.selection.setRng(o.toRange()),!0},r=>(t.selection.setRng(r.toRange()),!0))),()=>J.some(U))},vx=t=>{let r=t.dom,n=t.selection,o=fH(t.getBody(),n.getNode());if(nF(o)&&r.isBlock(o)&&r.isEmpty(o)){let t=r.create("br",{"data-mce-bogus":"1"});r.setHTML(o,""),o.appendChild(t),n.setRng(lk.before(t).toRange())}return!0},vw=(t,r)=>t.selection.isCollapsed()?vC(t,r):((t,r)=>{let n=t.selection.getNode();return nI(n)&&!nU(n)?vy(t,n.parentNode).filter(nI).fold(()=>J.some(()=>{el(np(rl(t.getBody()),".mce-offscreen-selection"),ne),ft(t,r,rl(t.selection.getNode())),ff(t)}),()=>J.some(U)):vh(t)?J.some(()=>{fh(t,t.selection.getRng(),rl(t.getBody()))}):J.none()})(t,r),vE=(t,r)=>t.selection.isCollapsed()?((t,r)=>{let n=lk.fromRangeStart(t.selection.getRng());return dl(r,t.getBody(),n).filter(t=>r?mp(t):mh(t)).bind(t=>sY(r?0:-1,t)).map(r=>()=>t.selection.select(r))})(t,r):J.none(),vk=t=>nA(t)&&"\uFEFF"===t.data[0],vS=t=>nA(t)&&"\uFEFF"===t.data[t.data.length-1],v_=t=>{var r;return(null!==(r=t.ownerDocument)&&void 0!==r?r:document).createTextNode("\uFEFF")},vN=(t,r)=>t?(t=>{var r;if(nA(t.previousSibling))return vS(t.previousSibling)||t.previousSibling.appendData("\uFEFF"),t.previousSibling;if(nA(t))return vk(t)||t.insertData(0,"\uFEFF"),t;{let n=v_(t);return null===(r=t.parentNode)||void 0===r||r.insertBefore(n,t),n}})(r):(t=>{var r,n;if(nA(t.nextSibling))return vk(t.nextSibling)||t.nextSibling.insertData(0,"\uFEFF"),t.nextSibling;if(nA(t))return vS(t)||t.appendData("\uFEFF"),t;{let o=v_(t);return t.nextSibling?null===(r=t.parentNode)||void 0===r||r.insertBefore(o,t.nextSibling):null===(n=t.parentNode)||void 0===n||n.appendChild(o),o}})(r),vR=q(vN,!0),vA=q(vN,!1),vO=(t,r)=>nA(t.container())?vN(r,t.container()):vN(r,t.getNode()),vT=(t,r)=>{let n=r.get();return n&&t.container()===n&&on(n)},vB=(t,r)=>r.fold(r=>{sM(t.get());let n=vR(r);return t.set(n),J.some(lk(n,n.length-1))},r=>dm(r).map(r=>{if(vT(r,t)){let r=t.get();return lk(r,1)}{sM(t.get());let n=vO(r,!0);return t.set(n),lk(n,1)}}),r=>df(r).map(r=>{if(vT(r,t)){let r=t.get();return lk(r,r.length-1)}{sM(t.get());let n=vO(r,!1);return t.set(n),lk(n,n.length-1)}}),r=>{sM(t.get());let n=vA(r);return t.set(n),J.some(lk(n,1))}),vD=(t,r)=>{for(let n=0;n<t.length;n++){let o=t[n].apply(null,r);if(o.isSome())return o}return J.none()},vP=lW([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),vL=(t,r)=>sK(r,t)||t,vM=(t,r,n)=>{let o=fi(n),a=vL(r,o.container());return fa(t,a,o).fold(()=>dc(a,o).bind(q(fa,t,a)).map(t=>vP.before(t)),J.none)},vF=(t,r)=>null===dh(t,r),vI=(t,r,n)=>fa(t,r,n).filter(q(vF,r)),vU=(t,r,n)=>{let o=fs(n);return vI(t,r,o).bind(t=>du(t,o).isNone()?J.some(vP.start(t)):J.none())},vz=(t,r,n)=>{let o=fi(n);return vI(t,r,o).bind(t=>dc(t,o).isNone()?J.some(vP.end(t)):J.none())},vj=(t,r,n)=>{let o=fs(n),a=vL(r,o.container());return fa(t,a,o).fold(()=>du(a,o).bind(q(fa,t,a)).map(t=>vP.after(t)),J.none)},vH=t=>!fo(vV(t)),v$=(t,r,n)=>vD([vM,vU,vz,vj],[t,r,n]).filter(vH),vV=t=>t.fold($,$,$,$),vq=t=>t.fold(H("before"),H("start"),H("end"),H("after")),vW=t=>t.fold(vP.before,vP.before,vP.after,vP.after),vK=t=>t.fold(vP.start,vP.start,vP.end,vP.end),vG=(t,r,n,o,a,l)=>tI(fa(r,n,o),fa(r,n,a),(r,o)=>r!==o&&((t,r,n)=>{let o=sK(r,t),a=sK(n,t);return L(o)&&o===a})(n,r,o)?vP.after(t?r:o):l).getOr(l),vY=(t,r)=>t.fold(Q,t=>!(vq(t)===vq(r)&&vV(t)===vV(r))),vX=(t,r)=>t?r.fold(z(J.some,vP.start),J.none,z(J.some,vP.after),J.none):r.fold(J.none,z(J.some,vP.before),J.none,z(J.some,vP.end)),vQ=(t,r,n)=>{let o=t?1:-1;return r.setRng(lk(n.container(),n.offset()+o).toRange()),r.getSel().modify("move",t?"forward":"backward","word"),!0};(a=u||(u={}))[a.Br=0]="Br",a[a.Block=1]="Block",a[a.Wrap=2]="Wrap",a[a.Eol=3]="Eol";let vJ=(t,r)=>t===pO.Backwards?ev(r):r,vZ=(t,r,n)=>t===pO.Forwards?r.next(n):r.prev(n),v0=(t,r,n,o)=>nL(o.getNode(r===pO.Forwards))?u.Br:!1===sG(n,o)?u.Block:u.Wrap,v1=(t,r,n,o)=>{let a=dt(n),l=o,i=[];for(;l;){let n=vZ(r,a,l);if(!n)break;if(nL(n.getNode(!1)))return r===pO.Forwards?{positions:vJ(r,i).concat([n]),breakType:u.Br,breakAt:J.some(n)}:{positions:vJ(r,i),breakType:u.Br,breakAt:J.some(n)};if(n.isVisible()){if(t(l,n)){let t=v0(0,r,l,n);return{positions:vJ(r,i),breakType:t,breakAt:J.some(n)}}i.push(n),l=n}else l=n}return{positions:vJ(r,i),breakType:u.Eol,breakAt:J.none()}},v2=(t,r,n,o)=>r(n,o).breakAt.map(o=>{let a=r(n,o).positions;return t===pO.Backwards?a.concat(o):[o].concat(a)}).getOr([]),v3=(t,r)=>eu(t,(t,n)=>t.fold(()=>J.some(n),o=>tI(eE(o.getClientRects()),eE(n.getClientRects()),(t,a)=>{let l=Math.abs(r-t.left);return Math.abs(r-a.left)<=l?n:o}).or(t)),J.none()),v8=(t,r)=>eE(r.getClientRects()).bind(r=>v3(t,r.left)),v5=q(v1,lk.isAbove,-1),v6=q(v1,lk.isBelow,1),v9=q(v2,-1,v5),v4=q(v2,1,v6),v7=(t,r)=>v8(v9(t,r),r),ye=(t,r)=>v8(v4(t,r),r),yt=(t,r)=>Math.abs(t.left-r),yr=(t,r)=>Math.abs(t.right-r),yn=(t,r)=>eW(t,(t,n)=>{let o=Math.min(yt(t,r),yr(t,r)),a=Math.min(yt(n,r),yr(n,r));return a===o&&eU(n,"node")&&nI(n.node)||a<o?n:t}),yo=t=>{let r=r=>ea(r,r=>{let n=lt(r);return n.node=t,n});if(nC(t))return r(t.getClientRects());if(nA(t)){let n=t.ownerDocument.createRange();return n.setStart(t,0),n.setEnd(t,t.data.length),r(n.getClientRects())}return[]},ya=t=>eh(t,yo);(l=m||(m={}))[l.Up=-1]="Up",l[l.Down=1]="Down";let yl=(t,r,n,o,a,l)=>{let i=0,s=[],d=o=>{let l=ya([o]);-1===t&&(l=l.reverse());for(let t=0;t<l.length;t++){let o=l[t];if(!n(o,c)){if(s.length>0&&r(o,eG(s))&&i++,o.line=i,a(o))return!0;s.push(o)}}return!1},c=eG(l.getClientRects());if(!c)return s;let u=l.getNode();return u&&(d(u),((t,r,n,o)=>{let a=o;for(;a=sW(a,t,ob,r);)if(n(a))return})(t,o,d,u)),s},yi=q(yl,m.Up,lo,la),ys=q(yl,m.Down,la,lo),yd=t=>eG(t.getClientRects()),yc=t=>r=>r.line>t,yu=t=>r=>r.line===t,ym=(t,r)=>{t.selection.setRng(r),uC(t,t.selection.getRng())},yf=(t,r,n)=>J.some(vc(t,r,n)),yg=(t,r,n,o,a,l)=>{let i=r===pO.Forwards,s=dt(t.getBody()),d=q(s5,i?s.next:s.prev),c=i?o:a;if(!n.collapsed){let o=li(n);if(l(o))return vs(r,t,o,r===pO.Backwards,!1);if(vh(t)){let t=n.cloneRange();return t.collapse(r===pO.Backwards),J.from(t)}}let u=s3(r,t.getBody(),n);if(c(u))return vd(t,u.getNode(!i));let m=d(u),f=ou(n);if(!m)return f?J.some(n):J.none();if(c(m=fl(i,m)))return vs(r,t,m.getNode(!i),i,!1);let g=d(m);return g&&c(g)&&s6(m,g)?vs(r,t,g.getNode(!i),i,!1):f?yf(t,m.toRange(),!1):J.none()},yp=(t,r,n,o,a,l)=>{let i;let s=s3(r,t.getBody(),n),d=eG(s.getClientRects()),c=r===m.Down,u=t.getBody();if(!d)return J.none();if(vh(t)){let t=c?lk.fromRangeEnd(n):lk.fromRangeStart(n);return(c?ye:v7)(u,t).orThunk(()=>J.from(t)).map(t=>t.toRange())}let f=(c?ys:yi)(u,yc(1),s),g=ed(f,yu(1)),p=d.left,h=yn(g,p);if(h&&l(h.node)){let n=Math.abs(p-h.left),o=Math.abs(p-h.right);return vs(r,t,h.node,n<o,!1)}if(i=o(s)?s.getNode():a(s)?s.getNode(!0):li(n)){let n=((t,r,n,o)=>{let a,l,i,s;let d=dt(r),c=[],u=0;1===t?(a=d.next,l=la,i=lo,s=lk.after(o)):(a=d.prev,l=lo,i=la,s=lk.before(o));let m=yd(s);do{if(!s.isVisible())continue;let t=yd(s);if(i(t,m))continue;c.length>0&&l(t,eG(c))&&u++;let r=lt(t);if(r.position=s,r.line=u,n(r))break;c.push(r)}while(s=a(s));return c})(r,u,yc(1),i),o=yn(ed(n,yu(1)),p);if(o||(o=eG(ed(n,yu(0)))))return yf(t,o.position.toRange(),!1)}return 0===g.length?yh(t,c).filter(c?a:o).map(r=>vc(t,r.toRange(),!1)):J.none()},yh=(t,r)=>{var n,o;let a=t.selection.getRng(),l=r?lk.fromRangeEnd(a):lk.fromRangeStart(a),i=(n=l.container(),o=t.getBody(),rj(rl(n),t=>nF(t.dom),t=>t.dom===o).map(t=>t.dom).getOr(o));if(r){let t=v6(i,l);return ek(t.positions)}{let t=v5(i,l);return eE(t.positions)}},yb=(t,r,n)=>yh(t,r).filter(n).exists(r=>(t.selection.setRng(r.toRange()),!0)),yv=(t,r)=>{let n=t.dom.createRng();n.setStart(r.container(),r.offset()),n.setEnd(r.container(),r.offset()),t.selection.setRng(n)},yy=(t,r)=>{t?r.setAttribute("data-mce-selected","inline-boundary"):r.removeAttribute("data-mce-selected")},yC=(t,r,n)=>vB(r,n).map(r=>(yv(t,r),n)),yx=(t,r,n)=>{let o=t.getBody(),a=((t,r,n)=>{let o=lk.fromRangeStart(t);if(t.collapsed)return o;{let a=lk.fromRangeEnd(t);return n?du(r,a).getOr(a):dc(r,o).getOr(o)}})(t.selection.getRng(),o,n);return((t,r,n,o)=>{let a=fl(t,o),l=v$(r,n,a);return v$(r,n,a).bind(q(vX,t)).orThunk(()=>((t,r,n,o,a)=>{let l=fl(t,a);return dl(t,n,l).map(q(fl,t)).fold(()=>o.map(vW),a=>v$(r,n,a).map(q(vG,t,r,n,l,a)).filter(q(vY,o))).filter(vH)})(t,r,n,l,o))})(n,q(fn,t),o,a).bind(n=>yC(t,r,n))},yw=(t,r,n)=>!!ij(t)&&yx(t,r,n).isSome(),yE=(t,r,n)=>!!ij(r)&&((t,r)=>{let n=r.selection.getRng(),o=t?lk.fromRangeEnd(n):lk.fromRangeStart(n);return!!M(r.selection.getSel().modify)&&(t&&ol(o)?vQ(!0,r.selection,o):!(t||!oi(o))&&vQ(!1,r.selection,o))})(t,r),yk=t=>{let r=aL(null),n=q(fn,t);return t.on("NodeChange",o=>{ij(t)&&(((t,r,n)=>{let o=ea(np(rl(r.getRoot()),'*[data-mce-selected="inline-boundary"]'),t=>t.dom),a=ed(o,t),l=ed(n,t);el(ey(a,l),q(yy,!1)),el(ey(l,a),q(yy,!0))})(n,t.dom,o.parents),((t,r)=>{let n=r.get();if(t.selection.isCollapsed()&&!t.composing&&n){let o=lk.fromRangeStart(t.selection.getRng());!lk.isTextPosition(o)||ol(o)||oi(o)||(yv(t,sL(n,o)),r.set(null))}})(t,r),((t,r,n,o)=>{if(r.selection.isCollapsed()){let a=ed(o,t);el(a,o=>{let a=lk.fromRangeStart(r.selection.getRng());v$(t,r.getBody(),a).bind(t=>yC(r,n,t))})}})(n,t,r,o.parents))}),r},yS=q(yE,!0),y_=q(yE,!1),yN=(t,r,n)=>{if(ij(t)){let o=yh(t,r).getOrThunk(()=>{let n=t.selection.getRng();return r?lk.fromRangeEnd(n):lk.fromRangeStart(n)});return v$(q(fn,t),t.getBody(),o).exists(r=>{let o=vW(r);return vB(n,o).exists(r=>(yv(t,r),!0))})}return!1},yR=(t,r)=>n=>vB(r,n).map(r=>()=>yv(t,r)),yA=(t,r,n,o)=>{let a=t.getBody(),l=q(fn,t);t.undoManager.ignore(()=>{t.selection.setRng(((t,r)=>{let n=document.createRange();return n.setStart(t.container(),t.offset()),n.setEnd(r.container(),r.offset()),n})(n,o)),fc(t),v$(l,a,lk.fromRangeStart(t.selection.getRng())).map(vK).bind(yR(t,r)).each(Y)}),t.nodeChanged()},yO=(t,r,n)=>{if(t.selection.isCollapsed()&&ij(t)){let o=lk.fromRangeStart(t.selection.getRng());return((t,r,n,o)=>{var a;let l=(a=t.getBody(),sK(o.container(),a)||a),i=q(fn,t),s=v$(i,l,o);return s.bind(t=>n?t.fold(H(J.some(vK(t))),J.none,H(J.some(vW(t))),J.none):t.fold(J.none,H(J.some(vW(t))),J.none,H(J.some(vK(t))))).map(yR(t,r)).getOrThunk(()=>{let a=di(n,l,o),d=a.bind(t=>v$(i,l,t));return tI(s,d,()=>fa(i,l,o).bind(r=>tI(dm(r),df(r),(t,n)=>{let o=fl(!0,t),a=fl(!1,n);return dc(r,o).forall(t=>t.isEqual(a))}).getOr(!0)?J.some(()=>{ft(t,n,rl(r))}):J.none())).getOrThunk(()=>d.bind(()=>a.map(a=>()=>{n?yA(t,r,o,a):yA(t,r,a,o)})))})})(t,r,n,o)}return J.none()},yT=(t,r)=>{let n=rl(t.getBody()),o=rl(t.selection.getStart()),a=mk(o,n);return eg(a,r).fold(H(a),t=>a.slice(0,t))},yB=t=>1===rO(t),yD=(t,r)=>{let n=q(gx,t);return eh(r,t=>n(t)?[t.dom]:[])},yP=t=>{let r=yT(t,nQ);return yD(t,r)},yL=(t,r)=>{let n=ed(yT(t,t=>nQ(t)||rO(t)>1),yB);return ek(n).bind(o=>{let a=lk.fromRangeStart(t.selection.getRng());return fg(r,a,o.dom)&&!gw(o)?J.some(()=>((t,r,n,o)=>{let a=yD(r,o);if(0===a.length)ft(r,t,n);else{let t=gC(n.dom,a);r.selection.setRng(t.toRange())}})(r,t,o,n)):J.none()})},yM=(t,r)=>{let n=t.selection.getStart(),o=((t,r)=>{let n=r.parentElement;return nL(r)&&!T(n)&&t.dom.isEmpty(n)})(t,n)||gw(rl(n))?gC(n,r):((t,r)=>{let{caretContainer:n,caretPosition:o}=gy(r);return t.insertNode(n.dom),o})(t.selection.getRng(),r);t.selection.setRng(o.toRange())},yF=t=>nA(t.startContainer),yI=t=>{let r=t.selection.getRng();return 0===r.startOffset&&yF(r)&&((t,r)=>{let n=r.startContainer.parentElement;return!T(n)&&gx(t,rl(n))})(t,r)&&((t=>{let r=t.startContainer.parentNode,n=t.endContainer.parentNode;return!T(r)&&!T(n)&&r.isEqualNode(n)})(r)&&(t=>{let r=t.endContainer;return t.endOffset===(nA(r)?r.length:r.childNodes.length)})(r)||!r.endContainer.isEqualNode(r.commonAncestorContainer))},yU=(t,r)=>t.selection.isCollapsed()?yL(t,r):(t=>{if(yI(t)){let r=yP(t);return J.some(()=>{fc(t),((t,r)=>{let n=ey(r,yP(t));n.length>0&&yM(t,n)})(t,r)})}return J.none()})(t),yz=t=>rj(t,t=>dp(t.dom),nQ).isSome(),yj=t=>((t=>{let r=t.selection.getRng();return r.collapsed&&(yF(r)||t.dom.isEmpty(r.startContainer))&&!yz(rl(t.selection.getStart()))})(t)&&yM(t,[]),!0),yH=(t,r,n)=>L(n)?J.some(()=>{t._selectionOverrides.hideFakeCaret(),ft(t,r,rl(n))}):J.none(),y$=(t,r)=>t.selection.isCollapsed()?((t,r)=>{let n=r?mb:mv,o=r?pO.Forwards:pO.Backwards,a=s3(o,t.getBody(),t.selection.getRng());return n(a)?yH(t,r,a.getNode(!r)):J.from(fl(r,a)).filter(t=>n(t)&&s6(a,t)).bind(n=>yH(t,r,n.getNode(!r)))})(t,r):((t,r)=>{let n=t.selection.getNode();return nj(n)?yH(t,r,n):J.none()})(t,r),yV=t=>tt(null!=t?t:"").getOr(0),yq=(t,r)=>(t||"table"===tV(r)?"margin":"padding")+("rtl"===rJ(r,"direction")?"-right":"-left"),yW=t=>{let r=yG(t);return!t.mode.isReadOnly()&&(r.length>1||eb(r,r=>{let n=yq(iS(t),r),o=r0(r,n).map(yV).getOr(0);return"false"!==t.dom.getContentEditable(r.dom)&&o>0}))},yK=t=>n1(t)||n2(t),yG=t=>ed(nr(t.selection.getSelectedBlocks()),t=>!yK(t)&&!ry(t).exists(yK)&&rH(t,t=>nF(t.dom)||nI(t.dom)).exists(t=>nF(t.dom))),yY=(t,r)=>{var n,o;let{dom:a}=t,l=i_(t),i=null!==(o=null===(n=/[a-z%]+$/i.exec(l))||void 0===n?void 0:n[0])&&void 0!==o?o:"px",s=yV(l),d=iS(t);el(yG(t),t=>{((t,r,n,o,a,l)=>{let i=yq(n,rl(l)),s=yV(t.getStyle(l,i));if("outdent"===r){let r=Math.max(0,s-o);t.setStyle(l,i,r?r+a:"")}else{let r=s+o+a;t.setStyle(l,i,r)}})(a,r,d,s,i,t.dom)})},yX=t=>yY(t,"outdent"),yQ=t=>{if(t.selection.isCollapsed()&&yW(t)){let r=t.dom,n=t.selection.getRng(),o=lk.fromRangeStart(n),a=r.getParent(n.startContainer,r.isBlock);if(null!==a&&mA(rl(a),o))return J.some(()=>yX(t))}return J.none()},yJ=(t,r,n)=>e_([yQ,vw,vg,(t,n)=>yO(t,r,n),vo,fj,vE,y$,vi,yU],r=>r(t,n)).filter(r=>t.selection.isEditable()),yZ=(t,r)=>{t.addCommand("delete",()=>{((t,r)=>{yJ(t,r,!1).fold(()=>{fc(t),ff(t)},Y)})(t,r)}),t.addCommand("forwardDelete",()=>{((t,r)=>{yJ(t,r,!0).fold(()=>fd(t,"ForwardDelete"),Y)})(t,r)})},y0=t=>void 0===t.touches||1!==t.touches.length?J.none():J.some(t.touches[0]),y1=(t,r)=>eI(t,r.nodeName),y2=(t,r)=>!!nA(r)||!!nC(r)&&!y1(t.getBlockElements(),r)&&!dR(r)&&!oU(t,r),y3=(t,r)=>!!(nA(r)&&(0===r.data.length||/^\s+$/.test(r.data)&&(!r.nextSibling||y1(t,r.nextSibling)))),y8=t=>t.dom.create(io(t),ia(t)),y5=t=>{let r=t.dom,n=t.selection,o=t.schema,a=o.getBlockElements(),l=n.getStart(),i=t.getBody(),s,d,c=!1,u=io(t);if(!l||!nC(l))return;let m=i.nodeName.toLowerCase();if(!o.isValidChild(m,u.toLowerCase())||eo(mE(rl(l),rl(i)),t=>y1(a,t.dom)))return;let f=n.getRng(),{startContainer:g,startOffset:p,endContainer:h,endOffset:b}=f,v=uH(t),y=i.firstChild;for(;y;)if(nC(y)&&oL(o,y),y2(o,y)){if(y3(a,y)){d=y,y=y.nextSibling,r.remove(d);continue}s||(s=y8(t),i.insertBefore(s,y),c=!0),d=y,y=y.nextSibling,s.appendChild(d)}else s=null,y=y.nextSibling;c&&v&&(f.setStart(g,p),f.setEnd(h,b),n.setRng(f),t.nodeChanged())},y6=(t,r,n)=>{let o=rl(y8(t)),a=n4();r6(o,a),n(r,o);let l=document.createRange();return l.setStartBefore(a.dom),l.setEndBefore(a.dom),l},y9=t=>r=>-1!==(" "+r.attr("class")+" ").indexOf(t),y4=(t,r,n)=>function(o){let a=arguments,l=a[a.length-2],i=l>0?r.charAt(l-1):"";if('"'===i)return o;if(">"===i){let t=r.lastIndexOf("<",l);if(-1!==t&&-1!==r.substring(t,l).indexOf('contenteditable="false"'))return o}return'<span class="'+n+'" data-mce-content="'+t.dom.encode(a[0])+'">'+t.dom.encode("string"==typeof a[1]?a[1]:a[0])+"</span>"},y7=(t,r)=>{r.hasAttribute("data-mce-caret")&&(oc(r),t.selection.setRng(t.selection.getRng()),t.selection.scrollIntoView(r))},Ce=(t,r)=>{let n=rV(rl(t.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull();if(n)return"compositionstart"===r.type?(r.preventDefault(),r.stopPropagation(),void y7(t,n)):void(oa(n)&&(y7(t,n),t.undoManager.add()))},Ct=(t,r,n)=>{let o=dt(t.getBody()),a=q(s5,1===r?o.next:o.prev);if(n.collapsed){let o=t.dom.getParent(n.startContainer,"PRE");if(!o)return;if(!a(lk.fromRangeStart(n))){let n=rl((t=>{let r=t.dom.create(io(t));return r.innerHTML='<br data-mce-bogus="1">',r})(t));1===r?r8(rl(o),n):r3(rl(o),n),t.selection.select(n.dom,!0),t.selection.collapse()}}},Cr=(t,r)=>((t,r)=>{let n=r?pO.Forwards:pO.Backwards,o=t.selection.getRng();return yg(t,n,o,mx,mw,nI).orThunk(()=>(Ct(t,n,o),J.none()))})(t,((t,r)=>{let n=r?t.getEnd(!0):t.getStart(!0);return fo(n)?!r:r})(t.selection,r)).exists(r=>(ym(t,r),!0)),Cn=(t,r)=>((t,r)=>{let n=r?1:-1,o=t.selection.getRng();return yp(t,n,o,t=>mx(t)||my(t),t=>mw(t)||mC(t),nI).orThunk(()=>(Ct(t,n,o),J.none()))})(t,r).exists(r=>(ym(t,r),!0)),Co=(t,r)=>yb(t,r,r?mw:mx),Ca=(t,r)=>vp(t,!r).map(n=>{let o=n.toRange(),a=t.selection.getRng();return r?o.setStart(a.startContainer,a.startOffset):o.setEnd(a.endContainer,a.endOffset),o}).exists(r=>(ym(t,r),!0)),Cl=t=>en(["figcaption"],tV(t)),Ci=(t,r)=>{let n=rl(t.getBody()),o=lk.fromRangeStart(t.selection.getRng());return((t,r)=>{let n=q(rg,r);return rH(rl(t.container()),nQ,n).filter(Cl)})(o,n).exists(()=>{if(r?v6(n.dom,o).breakAt.isNone():v5(n.dom,o).breakAt.isNone()){let o=y6(t,n,r?r6:r5);return t.selection.setRng(o),!0}return!1})},Cs=(t,r)=>!!t.selection.isCollapsed()&&Ci(t,r),Cd={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},Cc=(t,r)=>r.keyCode===t.keyCode&&r.shiftKey===t.shiftKey&&r.altKey===t.altKey&&r.ctrlKey===t.ctrlKey&&r.metaKey===t.metaKey,Cu=(t,...r)=>()=>t.apply(null,r),Cm=(t,r)=>ef(eh(ea(t,t=>({...Cd,...t})),t=>Cc(t,r)?[t]:[]),t=>t.action()),Cf=(t,r)=>e_(eh(ea(t,t=>({...Cd,...t})),t=>Cc(t,r)?[t]:[]),t=>t.action()),Cg=(t,r)=>{let n=r?pO.Forwards:pO.Backwards,o=t.selection.getRng();return yg(t,n,o,mb,mv,nj).exists(r=>(ym(t,r),!0))},Cp=(t,r)=>{let n=t.selection.getRng();return yp(t,r?1:-1,n,mb,mv,nj).exists(r=>(ym(t,r),!0))},Ch=(t,r)=>yb(t,r,r?mv:mb),Cb=lW([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Cv={...Cb,none:t=>Cb.none(t)},Cy=(t,r,n)=>eh(r_(t),t=>rm(t,r)?n(t)?[t]:[]:Cy(t,r,n)),CC=(t,r)=>rq(t,"table",r),Cx=(t,r,n,o,a=Q)=>{let l=1===o;if(!l&&n<=0)return Cv.first(t[0]);if(l&&n>=t.length-1)return Cv.last(t[t.length-1]);{let l=n+o,i=t[l];return a(i)?Cv.middle(r,i):Cx(t,r,l,o,a)}},Cw=(t,r)=>CC(t,r).bind(r=>{let n=Cy(r,"th,td",Q);return eg(n,r=>rg(t,r)).map(t=>({index:t,all:n}))}),CE=(t,r,n,o,a)=>{let l=np(rl(n),"td,th,caption").map(t=>t.dom),i=ed(eh(l,r=>{var n;let o={left:(n=lt(r.getBoundingClientRect())).left- -1,top:n.top- -1,right:n.right+-2,bottom:n.bottom+-2,width:n.width+-1,height:n.height+-1};return[{x:o.left,y:t(o),cell:r},{x:o.right,y:t(o),cell:r}]}),t=>r(t,a));return eu(i,(t,r)=>t.fold(()=>J.some(r),t=>{let n=Math.sqrt(Math.abs(t.x-o)+Math.abs(t.y-a)),l=Math.sqrt(Math.abs(r.x-o)+Math.abs(r.y-a));return J.some(l<n?r:t)}),J.none()).map(t=>t.cell)},Ck=q(CE,t=>t.bottom,(t,r)=>t.y<r),CS=q(CE,t=>t.top,(t,r)=>t.y>r),C_=(t,r,n)=>{let o=t(r,n);return(o.breakType!==u.Wrap||0!==o.positions.length)&&(nL(n.getNode())||o.breakType!==u.Br||1!==o.positions.length)?o.breakAt.isNone():!o.breakAt.exists(n=>t(r,n).breakAt.isSome())},CN=q(C_,v5),CR=q(C_,v6),CA=(t,r,n,o)=>{let a=t.selection.getRng(),l=r?1:-1;return!(!sU()||!((t,r,n)=>{let o=lk.fromRangeStart(r);return dd(!t,n).exists(t=>t.isEqual(o))})(r,a,n)||(vs(l,t,n,!r,!1).each(r=>{ym(t,r)}),0))},CO=(t,r,n)=>{let o=((t,r)=>{let n=r.getNode(t);return n_(n)?J.some(n):J.none()})(!!r,n),a=!1===r;o.fold(()=>ym(t,n.toRange()),o=>dd(a,t.getBody()).filter(t=>t.isEqual(n)).fold(()=>ym(t,n.toRange()),n=>((t,r,n)=>{r.undoManager.transact(()=>{let o=y6(r,rl(n),t?r8:r3);ym(r,o)})})(r,t,o)))},CT=(t,r,n,o)=>{let a=t.selection.getRng(),l=lk.fromRangeStart(a),i=t.getBody();if(!r&&CN(o,l)){let o=eE(l.getClientRects()).bind(t=>Ck(n,t.left,t.top)).bind(t=>v8(df(t).map(r=>v5(t,r).positions.concat(r)).getOr([]),l)).orThunk(()=>eE(l.getClientRects()).bind(t=>v3(v9(i,lk.before(n)),t.left))).getOr(lk.before(n));return CO(t,r,o),!0}if(r&&CR(o,l)){let o=ek(l.getClientRects()).bind(t=>CS(n,t.left,t.top)).bind(t=>v8(dm(t).map(r=>[r].concat(v6(t,r).positions)).getOr([]),l)).orThunk(()=>eE(l.getClientRects()).bind(t=>v3(v4(i,lk.after(n)),t.left))).getOr(lk.after(n));return CO(t,r,o),!0}return!1},CB=(t,r,n)=>J.from(t.dom.getParent(t.selection.getNode(),"td,th")).bind(o=>J.from(t.dom.getParent(o,"table")).map(a=>n(t,r,a,o))).getOr(!1),CD=(t,r)=>CB(t,r,CA),CP=(t,r)=>CB(t,r,CT),CL=(t,r,n)=>n.fold(J.none,J.none,(t,r)=>((t,r)=>{let n=t=>{for(let o=0;o<t.childNodes.length;o++){let a=rl(t.childNodes[o]);if(r(a))return J.some(a);let l=n(t.childNodes[o]);if(l.isSome())return l}return J.none()};return n(t.dom)})(r,uX).map(t=>(t=>{let r=cK.exact(t,0,t,0);return cJ(r)})(t)),n=>(t.execCommand("mceTableInsertRowAfter"),CM(t,r,n))),CM=(t,r,n)=>CL(t,r,Cw(n,void 0).fold(()=>Cv.none(n),t=>Cx(t.all,n,t.index,1,rW))),CF=(t,r,n)=>CL(t,r,Cw(n,void 0).fold(()=>Cv.none(),t=>Cx(t.all,n,t.index,-1,rW))),CI=(t,r)=>{let n=["table","li","dl"],o=rl(t.getBody()),a=t=>{let r=tV(t);return rg(t,o)||en(n,r)},l=t.selection.getRng();return((t,r,n=X)=>n(r)?J.none():en(t,tV(r))?J.some(r):r$(r,t.join(","),t=>rm(t,"table")||n(t)))(["td","th"],rl(r?l.endContainer:l.startContainer),a).map(n=>(CC(n,a).each(r=>{t.model.table.clearSelectedCells(r.dom)}),t.selection.collapse(!r),(r?CM:CF)(t,a,n).each(r=>{t.selection.setRng(r)}),!0)).getOr(!1)},CU=(t,r)=>({container:t,offset:r}),Cz=aB.DOM,Cj=t=>r=>t===r?-1:0,CH=(t,r,n)=>{if(nA(t)&&r>=0)return J.some(CU(t,r));{let o=a7(Cz);return J.from(o.backwards(t,r,Cj(t),n)).map(t=>CU(t.container,t.container.data.length))}},C$=(t,r,n)=>{if(!nA(t))return J.none();let o=t.data;if(r>=0&&r<=o.length)return J.some(CU(t,r));{let o=a7(Cz);return J.from(o.backwards(t,r,Cj(t),n)).bind(t=>{let o=t.container.data;return C$(t.container,r+o.length,n)})}},CV=(t,r,n)=>{if(!nA(t))return J.none();let o=t.data;if(r<=o.length)return J.some(CU(t,r));{let a=a7(Cz);return J.from(a.forwards(t,r,Cj(t),n)).bind(t=>CV(t.container,r-o.length,n))}},Cq=(t,r,n,o,a)=>{let l=a7(t,r=>t.isBlock(r)||en(["BR","IMG","HR","INPUT"],r.nodeName)||"false"===t.getContentEditable(r));return J.from(l.backwards(r,n,o,a))},CW=t=>ot(t.toString().replace(/\u00A0/g," ")),CK=t=>""!==t&&-1!==" \xa0\f\n\r	\v".indexOf(t),CG=(t,r)=>t.substring(r.length),CY=(t,r,n,o=0)=>rq(rl(r.startContainer),uQ).fold(()=>((t,r,n,o=0)=>{if(!r.collapsed||!nA(r.startContainer))return J.none();let a={text:"",offset:0},l=t.getParent(r.startContainer,t.isBlock)||t.getRoot();return Cq(t,r.startContainer,r.startOffset,(t,r,o)=>(a.text=o+a.text,a.offset+=r,((t,r,n)=>{let o;let a=n.charAt(0);for(o=r-1;o>=0;o--){let l=t.charAt(o);if(CK(l))return J.none();if(a===l&&e2(t,n,o,r))break}return J.some(o)})(a.text,a.offset,n).getOr(r)),l).bind(t=>{let a=r.cloneRange();if(a.setStart(t.container,t.offset),a.setEnd(r.endContainer,r.endOffset),a.collapsed)return J.none();let l=CW(a);return 0!==l.lastIndexOf(n)||CG(l,n).length<o?J.none():J.some({text:CG(l,n),range:a,trigger:n})})})(t,r,n,o),r=>{let o=t.createRng();o.selectNode(r.dom);let a=CW(o);return J.some({range:o,text:CG(a,n),trigger:n})}),CX=t=>{if(3===t.nodeType)return CU(t,t.data.length);{let r=t.childNodes;return r.length>0?CX(r[r.length-1]):CU(t,r.length)}},CQ=(t,r)=>{let n=t.childNodes;return n.length>0&&r<n.length?CQ(n[r],0):n.length>0&&1===t.nodeType&&n.length===r?CX(n[n.length-1]):CU(t,r)},CJ=(t,r,n,o={})=>{var a;let l=r(),i=null!==(a=t.selection.getRng().startContainer.nodeValue)&&void 0!==a?a:"",s=ed(l.lookupByTrigger(n.trigger),r=>n.text.length>=r.minChars&&r.matches.getOrThunk(()=>{var r;return r=t.dom,t=>{let n=CQ(t.startContainer,t.startOffset);return!((t,r)=>{var n;let o=null!==(n=t.getParent(r.container,t.isBlock))&&void 0!==n?n:t.getRoot();return Cq(t,r.container,r.offset,(t,r)=>0===r?-1:r,o).filter(t=>{let r=t.container.data.charAt(t.offset-1);return!CK(r)}).isSome()})(r,n)}})(n.range,i,n.text));if(0===s.length)return J.none();let d=Promise.all(ea(s,t=>t.fetch(n.text,t.maxResults,o).then(r=>({matchText:n.text,items:r,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}))));return J.some({lookupData:d,context:n})};(i=f||(f={}))[i.Error=0]="Error",i[i.Value=1]="Value";let CZ=(t,r,n)=>t.stype===f.Error?r(t.serror):n(t.svalue),C0=t=>({stype:f.Value,svalue:t}),C1=t=>({stype:f.Error,serror:t}),C2=t=>R(t)&&eN(t).length>100?" removed due to size":JSON.stringify(t,null,2),C3=(t,r)=>C1([{path:t,getErrorInfo:r}]),C8=(t,r)=>({extract:(n,o)=>eF(o,t).fold(()=>C3(n,()=>'Choice schema did not contain choice key: "'+t+'"'),t=>eF(r,t).fold(()=>C3(n,()=>'The chosen schema: "'+t+'" did not exist in branches: '+C2(r)),r=>r.extract(n.concat(["branch: "+t]),o))),toString:()=>"chooseOn("+t+"). Possible values: "+eN(r)}),C5=t=>(...r)=>{if(0===r.length)throw Error("Can't merge zero objects");let n={};for(let o=0;o<r.length;o++){let a=r[o];for(let r in a)eI(a,r)&&(n[r]=t(n[r],a[r]))}return n},C6=C5((t,r)=>A(t)&&A(r)?C6(t,r):r),C9=(C5((t,r)=>r),t=>({tag:"defaultedThunk",process:H(t)})),C4=t=>{var r;let n=(t=>{let r=[],n=[];return el(t,t=>{CZ(t,t=>n.push(t),t=>r.push(t))}),{values:r,errors:n}})(t);return n.errors.length>0?(r=n.errors,z(C1,ep)(r)):C0(n.values)},C7=(t,r,n)=>{switch(t.tag){case"field":return r(t.key,t.newKey,t.presence,t.prop);case"custom":return n(t.newKey,t.instantiator)}},xe=t=>({extract:(r,n)=>{var o,a;return(o=t(n)).stype===f.Error?C3(r,H(o.serror)):o},toString:H("val")}),xt=xe(C0),xr=(t,r,n,o)=>o(eF(t,r).getOrThunk(()=>n(t))),xn=(t,r,n,o,a)=>{var l;let i=t=>a.extract(r.concat([o]),t),s=t=>t.fold(()=>C0(J.none()),t=>{var n;let l=a.extract(r.concat([o]),t);return n=J.some,l.stype===f.Value?{stype:f.Value,svalue:n(l.svalue)}:l});switch(t.tag){case"required":return eF(n,o).fold(()=>C3(r,()=>'Could not find valid *required* value for "'+o+'" in '+C2(n)),i);case"defaultedThunk":return xr(n,o,t.process,i);case"option":return s(eF(n,o));case"defaultedOptionThunk":return l=t.process,s(eF(n,o).map(t=>!0===t?l(n):t));case"mergeWithThunk":return xr(n,o,H({}),r=>{let o=C6(t.process(n),r);return i(o)})}},xo=t=>({extract:(r,n)=>((t,r,n)=>{let o={},a=[];for(let l of n)C7(l,(n,l,i,s)=>{let d=xn(i,t,r,n,s);CZ(d,t=>{a.push(...t)},t=>{o[l]=t})},(t,n)=>{o[t]=n(r)});return a.length>0?C1(a):C0(o)})(r,n,t),toString:()=>{let r=ea(t,t=>C7(t,(t,r,n,o)=>t+" -> "+o.toString(),(t,r)=>"state("+t+")"));return"obj{\n"+r.join("\n")+"}"}}),xa=t=>({extract:(r,n)=>{let o=ea(n,(n,o)=>t.extract(r.concat(["["+o+"]"]),n));return C4(o)},toString:()=>"array("+t.toString()+")"}),xl=(t,r,n)=>{var o,a;return CZ((o=r.extract([t],n)).stype===f.Error?{stype:f.Error,serror:(a=o.serror,{input:n,errors:a})}:o,lq.error,lq.value)},xi=(t,r)=>C8(t,eO(r,xo)),xs=H(xt),xd=(t,r)=>xe(n=>{let o=typeof n;return t(n)?C0(n):C1(`Expected type: ${r} but got: ${o}`)}),xc=xd(F,"number"),xu=xd(N,"string"),xm=xd(B,"boolean"),xf=xd(M,"function"),xg=(t,r,n,o)=>({tag:"field",key:t,newKey:r,presence:n,prop:o}),xp=(t,r)=>({tag:"custom",newKey:t,instantiator:r}),xh=(t,r)=>xg(t,t,{tag:"required",process:{}},r),xb=t=>xh(t,xu),xv=t=>xh(t,xf),xy=(t,r)=>xg(t,t,{tag:"option",process:{}},r),xC=t=>xy(t,xu),xx=(t,r,n)=>xg(t,t,C9(r),n),xw=(t,r)=>xx(t,r,xc),xE=(t,r,n)=>{var o;return xx(t,r,(o=t=>en(n,t)?lq.value(t):lq.error(`Unsupported value: "${t}", choose one of "${n.join(", ")}".`),xe(t=>o(t).fold(C1,C0))))},xk=(t,r)=>xx(t,r,xm),xS=(t,r)=>xx(t,r,xf),x_=xb("type"),xN=xv("fetch"),xR=xv("onAction"),xA=xS("onSetup",()=>U),xO=xC("text"),xT=xC("icon"),xB=xC("tooltip"),xD=xC("label"),xP=xk("active",!1),xL=xk("enabled",!0),xM=xk("primary",!1),xF=t=>xx("type",t,xu),xI=xo([x_,xb("trigger"),xw("minChars",1),xg(s="columns",s,C9(1),xs()),xw("maxResults",10),xy("matches",xf),xN,xR,xx("highlightOn",[],xa(xu))]),xU=[xL,xB,xT,xO,xA],xz=[xP].concat(xU),xj=[xS("predicate",X),xE("scope","node",["node","editor"]),xE("position","selection",["node","selection","line"])],xH=xU.concat([xF("contextformbutton"),xM,xR,xp("original",$)]),x$=xz.concat([xF("contextformbutton"),xM,xR,xp("original",$)]),xV=xU.concat([xF("contextformbutton")]),xq=xz.concat([xF("contextformtogglebutton")]),xW=xi("type",{contextformbutton:xH,contextformtogglebutton:x$});xo([xF("contextform"),xS("initValue",H("")),xD,xg(d="commands",d,{tag:"required",process:{}},xa(xW)),xy("launch",xi("type",{contextformbutton:xV,contextformtogglebutton:xq}))].concat(xj));let xK=t=>{let r=t.ui.registry.getAll().popups,n=eO(r,t=>xl("Autocompleter",xI,{trigger:t.ch,...t}).fold(t=>{throw Error("Errors: \n"+(t=>{let r=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:H("... (only showing first ten failures)")}]):t;return ea(r,t=>"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo())})(t.errors).join("\n")+"\n\nInput object: "+C2(t.input))},$)),o=ez(eL(n,t=>t.trigger)),a=eM(n);return{dataset:n,triggers:o,lookupByTrigger:t=>ed(a,r=>r.trigger===t)}},xG=t=>{let r=aH(),n=aL(!1),o=r.isSet,a=()=>{o()&&((t=>{h2(t).autocompleter.removeDecoration()})(t),(t=>{t.dispatch("AutocompleterEnd")})(t),n.set(!1),r.clear())},l=eY(()=>xK(t)),i=i=>{r.get().map(r=>CY(t.dom,t.selection.getRng(),r.trigger).bind(r=>CJ(t,l,r,i))).getOrThunk(()=>((t,r)=>{var n;let o=r(),a=t.selection.getRng();return(n=t.dom,e_(o.triggers,t=>CY(n,a,t))).bind(n=>CJ(t,r,n))})(t,l)).fold(a,l=>{var i;i=l.context,o()||(((t,r)=>{h2(t).autocompleter.addDecoration(r)})(t,i.range),r.set({trigger:i.trigger,matchLength:i.text.length})),l.lookupData.then(o=>{r.get().map(i=>{let s=l.context;i.trigger===s.trigger&&(s.text.length-i.matchLength>=10?a():(r.set({...i,matchLength:s.text.length}),n.get()?((t,r)=>{t.dispatch("AutocompleterUpdate",r)})(t,{lookupData:o}):(n.set(!0),((t,r)=>{t.dispatch("AutocompleterStart",r)})(t,{lookupData:o}))))})})})};t.addCommand("mceAutocompleterReload",(t,r)=>{let n=R(r)?r.fetchOptions:{};i(n)}),t.addCommand("mceAutocompleterClose",a),((t,r)=>{let n=aV(r.load,50);t.on("keypress compositionend",t=>{27!==t.which&&n.throttle()}),t.on("keydown",t=>{let o=t.which;8===o?n.throttle():27===o&&r.cancelIfNecessary()}),t.on("remove",n.cancel)})(t,{cancelIfNecessary:a,load:i})},xY=t=>(r,n,o={})=>{let a=r.getBody(),l={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:a,currentTarget:a,eventPhase:Event.AT_TARGET,originalTarget:a,explicitOriginalTarget:a,isTrusted:!1,srcElement:a,cancelable:!1,preventDefault:U,inputType:n},i=ap(new InputEvent(t));return r.dispatch(t,{...i,...l,...o})},xX=xY("input"),xQ=xY("beforeinput"),xJ=(t,r)=>{let n=t.dom,o=t.schema.getMoveCaretBeforeOnEnterElements();if(!r)return;if(/^(LI|DT|DD)$/.test(r.nodeName)){let t=(t=>{for(;t;){if(nC(t)||nA(t)&&t.data&&/[\r\n\s]/.test(t.data))return t;t=t.nextSibling}return null})(r.firstChild);t&&/^(UL|OL|DL)$/.test(t.nodeName)&&r.insertBefore(n.doc.createTextNode("\xa0"),r.firstChild)}let a=n.createRng();if(r.normalize(),r.hasChildNodes()){let t=new nb(r,r),n,l=r;for(;n=t.current();){if(nA(n)){a.setStart(n,0),a.setEnd(n,0);break}if(o[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}l=n,n=t.next()}n||(a.setStart(l,0),a.setEnd(l,0))}else nL(r)?r.nextSibling&&n.isBlock(r.nextSibling)?(a.setStartBefore(r),a.setEndBefore(r)):(a.setStartAfter(r),a.setEndAfter(r)):(a.setStart(r,0),a.setEnd(r,0));t.selection.setRng(a),uC(t,a)},xZ=(t,r)=>{let n=t.getRoot(),o,a=r;for(;a!==n&&a&&"false"!==t.getContentEditable(a);)"true"===t.getContentEditable(a)&&(o=a),a=a.parentNode;return a!==n?o:n},x0=t=>J.from(t.dom.getParent(t.selection.getStart(!0),t.dom.isBlock)),x1=(t,r)=>{let n=null==t?void 0:t.parentNode;return L(n)&&n.nodeName===r},x2=t=>L(t)&&/^(OL|UL|LI)$/.test(t.nodeName),x3=t=>{let r=t.parentNode;return L(r)&&/^(LI|DT|DD)$/.test(r.nodeName)?r:t},x8=(t,r,n)=>{let o=t[n?"firstChild":"lastChild"];for(;o&&!nC(o);)o=o[n?"nextSibling":"previousSibling"];return o===r},x5=(t,r)=>r&&"A"===r.nodeName&&t.isEmpty(r),x6=t=>{t.innerHTML='<br data-mce-bogus="1">'},x9=(t,r)=>t.nodeName===r||t.previousSibling&&t.previousSibling.nodeName===r,x4=(t,r)=>L(r)&&t.isBlock(r)&&!/^(TD|TH|CAPTION|FORM)$/.test(r.nodeName)&&!/^(fixed|absolute)/i.test(r.style.position)&&t.isEditable(r.parentNode)&&"false"!==t.getContentEditable(r),x7=(t,r,n)=>nA(r)?t?1===n&&"\uFEFF"===r.data.charAt(n-1)?0:n:n===r.data.length-1&&"\uFEFF"===r.data.charAt(n)?r.data.length:n:n,we=(t,r)=>{io(t).toLowerCase()===r.tagName.toLowerCase()&&((t,r,n)=>{let o=t.dom;J.from(n.style).map(o.parseStyle).each(t=>{let n={...r1(rl(r)),...t};o.setStyles(r,n)});let a=J.from(n.class).map(t=>t.split(/\s+/)),l=J.from(r.className).map(t=>ed(t.split(/\s+/),t=>""!==t));tI(a,l,(t,n)=>{let a=ed(n,r=>!en(t,r)),l=[...t,...a];o.setAttrib(r,"class",l.join(" "))});let i=["style","class"],s=eP(n,(t,r)=>!en(i,r));o.setAttribs(r,s)})(t,r,ia(t))},wt={insert:(t,r)=>{var n;let o,a,l,i,s,d=!1,c=t.dom,u=t.schema,m=u.getNonEmptyElements(),f=t.selection.getRng(),g=io(t),p=f.collapsed&&f.startContainer===t.dom.getRoot(),h=rl(f.startContainer),b=rN(h,f.startOffset),v=b.exists(t=>tK(t)&&!rW(t)),y=p&&v,C=r=>{let n,o=a,l=u.getTextInlineElements(),s=n=r||"TABLE"===i||"HR"===i?c.create(r||g):_.cloneNode(!1);if(!1===id(t))c.setAttrib(n,"style",null),c.setAttrib(n,"class",null);else do if(l[o.nodeName]){if(dp(o)||dR(o))continue;let t=o.cloneNode(!1);c.setAttrib(t,"id",""),n.hasChildNodes()?(t.appendChild(n.firstChild),n.appendChild(t)):(s=t,n.appendChild(t))}while((o=o.parentNode)&&o!==S);return we(t,n),x6(s),n},x=t=>{let r;let n=x7(t,a,l);if(nA(a)&&(t?n>0:n<a.data.length))return!1;if(a.parentNode===_&&d&&!t||t&&nC(a)&&a===_.firstChild)return!0;if(x9(a,"TABLE")||x9(a,"HR"))return d&&!t||!d&&t;let o=new nb(a,_);for(nA(a)&&(t&&0===n?o.prev():t||n!==a.data.length||o.next());r=o.current();){if(nC(r)){if(!r.getAttribute("data-mce-bogus")){let t=r.nodeName.toLowerCase();if(m[t]&&"br"!==t)return!1}}else if(nA(r)&&!oy(r.data))return!1;t?o.prev():o.next()}return!0},w=()=>{let r;return r=/^(H[1-6]|PRE|FIGURE)$/.test(i)&&"HGROUP"!==R?C(g):C(),((t,r)=>{let n=ic(t);return!P(r)&&(N(n)?en(tM.explode(n),r.nodeName.toLowerCase()):n)})(t,s)&&x4(c,s)&&c.isEmpty(_,void 0,{includeZwsp:!0})?r=c.split(s,_):c.insertAfter(r,_),xJ(t,r),r};c9(c,f).each(t=>{f.setStart(t.startContainer,t.startOffset),f.setEnd(t.endContainer,t.endOffset)}),a=f.startContainer,l=f.startOffset;let E=!(!r||!r.shiftKey),k=!(!r||!r.ctrlKey);nC(a)&&a.hasChildNodes()&&!y&&(d=l>a.childNodes.length-1,a=a.childNodes[Math.min(l,a.childNodes.length-1)]||a,l=d&&nA(a)?a.data.length:0);let S=xZ(c,a);if(!S||((t,r)=>{let n=t.dom.getParent(r,"ol,ul,dl");return null!==n&&"false"===t.dom.getContentEditableParent(n)})(t,a))return;E||(a=((t,r,n,o,a)=>{var l,i;let s=t.dom,d=null!==(l=xZ(s,o))&&void 0!==l?l:s.getRoot(),c=s.getParent(o,s.isBlock);if(!c||!x4(s,c)){if(!(c=c||d).hasChildNodes()){let o=s.create(r);return we(t,o),c.appendChild(o),n.setStart(o,0),n.setEnd(o,0),o}let l,u=o;for(;u&&u.parentNode!==c;)u=u.parentNode;for(;u&&!s.isBlock(u);)l=u,u=u.previousSibling;let m=null===(i=null==l?void 0:l.parentElement)||void 0===i?void 0:i.nodeName;if(l&&m&&t.schema.isValidChild(m,r.toLowerCase())){let i=l.parentNode,d=s.create(r);for(we(t,d),i.insertBefore(d,l),u=l;u&&!s.isBlock(u);){let t=u.nextSibling;d.appendChild(u),u=t}n.setStart(o,a),n.setEnd(o,a)}}return o})(t,g,f,a,l));let _=c.getParent(a,c.isBlock)||c.getRoot();s=L(null==_?void 0:_.parentNode)?c.getParent(_.parentNode,c.isBlock):null,i=_?_.nodeName.toUpperCase():"";let R=s?s.nodeName.toUpperCase():"";if("LI"!==R||k||(_=s,s=s.parentNode,i=R),nC(s)&&(n=_,!E&&n.nodeName.toLowerCase()===io(t)&&t.dom.isEmpty(n)&&((r,n,o)=>{let a=n;for(;a&&a!==r&&T(a.nextSibling);){let r=a.parentElement;if(!r||!eI(t.schema.getTextBlockElements(),r.nodeName.toLowerCase()))return n$(r);a=r}return!1})(t.getBody(),n)))return((t,r,n)=>{var o,a,l;let i=r(io(t)),s=t.dom.getParent(n,n$);s&&(t.dom.insertAfter(i,s),xJ(t,i),(null!==(l=null===(a=null===(o=n.parentElement)||void 0===o?void 0:o.childNodes)||void 0===a?void 0:a.length)&&void 0!==l?l:0)>1&&t.dom.remove(n))})(t,C,_);if(/^(LI|DT|DD)$/.test(i)&&nC(s)&&c.isEmpty(_))return void((t,r,n,o,a)=>{var l,i,s;let d=t.dom,c=t.selection.getRng(),u=n.parentNode;if(n===t.getBody()||!u)return;x2(l=n)&&x2(l.parentNode)&&(a="LI");let m=r(a);if(x8(n,o,!0)&&x8(n,o,!1)){if(x1(n,"LI")){let t=x3(n);d.insertAfter(m,t),(null===(s=(i=n).parentNode)||void 0===s?void 0:s.firstChild)===i?d.remove(t):d.remove(n)}else d.replace(m,n)}else if(x8(n,o,!0))x1(n,"LI")?(d.insertAfter(m,x3(n)),m.appendChild(d.doc.createTextNode(" ")),m.appendChild(n)):u.insertBefore(m,n),d.remove(o);else if(x8(n,o,!1))d.insertAfter(m,x3(n)),d.remove(o);else{n=x3(n);let t=c.cloneRange();t.setStartAfter(o),t.setEndAfter(n);let r=t.extractContents();"LI"===a&&r.firstChild&&"LI"===r.firstChild.nodeName?(m=r.firstChild,d.insertAfter(r,n)):(d.insertAfter(r,n),d.insertAfter(m,n)),d.remove(o)}xJ(t,m)})(t,C,s,_,g);if(!(y||_!==t.getBody()&&x4(c,_)))return;let A=_.parentNode;if(y)o=C(g),b.fold(()=>{r6(h,rl(o))},t=>{r3(t,rl(o))}),t.selection.setCursorLocation(o,0);else if(or(_))o=oc(_),c.isEmpty(_)&&x6(_),we(t,o),xJ(t,o);else if(x(!1))o=w();else if(x(!0)&&A){o=A.insertBefore(C(),_);let r=rl(f.startContainer).dom.hasChildNodes()&&f.collapsed;xJ(t,x9(_,"HR")||r?o:_)}else{let r=(t=>{let r=t.cloneRange();return r.setStart(t.startContainer,x7(!0,t.startContainer,t.startOffset)),r.setEnd(t.endContainer,x7(!1,t.endContainer,t.endOffset)),r})(f).cloneRange();r.setEndAfter(_);let n=r.extractContents();el(ng(rl(n),tY),t=>{let r=t.dom;r.nodeValue=ot(r.data)}),(t=>{let r=t;do nA(r)&&(r.data=r.data.replace(/^[\r\n]+/,"")),r=r.firstChild;while(r)})(n),o=n.firstChild,c.insertAfter(n,_),((t,r,n)=>{var o;let a=[];if(!n)return;let l=n;for(;l=l.firstChild;){if(t.isBlock(l))return;nC(l)&&!r[l.nodeName.toLowerCase()]&&a.push(l)}let i=a.length;for(;i--;)(!(l=a[i]).hasChildNodes()||l.firstChild===l.lastChild&&""===(null===(o=l.firstChild)||void 0===o?void 0:o.nodeValue)||x5(t,l))&&t.remove(l)})(c,m,o),((t,r)=>{r.normalize();let n=r.lastChild;(!n||nC(n)&&/^(left|right)$/gi.test(t.getStyle(n,"float",!0)))&&t.add(r,"br")})(c,_),c.isEmpty(_)&&x6(_),o.normalize(),c.isEmpty(o)?(c.remove(o),w()):(we(t,o),xJ(t,o))}c.setAttrib(o,"id",""),t.dispatch("NewBlock",{newBlock:o})},fakeEventName:"insertParagraph"},wr=(t,r,n)=>{let o=t.dom.createRng();n?(o.setStartBefore(r),o.setEndBefore(r)):(o.setStartAfter(r),o.setEndAfter(r)),t.selection.setRng(o),uC(t,o)},wn=(t,r)=>{let n=rs("br");r3(rl(r),n),t.undoManager.add()},wo=(t,r)=>{wa(t.getBody(),r)||r8(rl(r),rs("br"));let n=rs("br");r8(rl(r),n),wr(t,n.dom,!1),t.undoManager.add()},wa=(t,r)=>{var n;return n=lk.after(r),!!nL(n.getNode())||dc(t,lk.after(r)).map(t=>nL(t.getNode())).getOr(!1)},wl=t=>t&&"A"===t.nodeName&&"href"in t,wi=t=>t.fold(X,wl,wl,X),ws=(t,r)=>{r.fold(U,q(wn,t),q(wo,t),U)},wd={insert:(t,r)=>{let n=(t=>{let r=q(fn,t),n=lk.fromRangeStart(t.selection.getRng());return v$(r,t.getBody(),n).filter(wi)})(t);n.isSome()?n.each(q(ws,t)):((t,r)=>{let n=t.selection,o=t.dom,a=n.getRng(),l,i=!1;c9(o,a).each(t=>{a.setStart(t.startContainer,t.startOffset),a.setEnd(t.endContainer,t.endOffset)});let s=a.startOffset,d=a.startContainer;if(nC(d)&&d.hasChildNodes()){let t=s>d.childNodes.length-1;d=d.childNodes[Math.min(s,d.childNodes.length-1)]||d,s=t&&nA(d)?d.data.length:0}let c=o.getParent(d,o.isBlock),u=c&&c.parentNode?o.getParent(c.parentNode,o.isBlock):null,m=u?u.nodeName.toUpperCase():"",f=!(!r||!r.ctrlKey);"LI"!==m||f||(c=u),nA(d)&&s>=d.data.length&&(((t,r,n)=>{let o;let a=new nb(r,n),l=t.getNonEmptyElements();for(;o=a.next();)if(l[o.nodeName.toLowerCase()]||nA(o)&&o.length>0)return!0;return!1})(t.schema,d,c||o.getRoot())||(l=o.create("br"),a.insertNode(l),a.setStartAfter(l),a.setEndAfter(l),i=!0)),l=o.create("br"),l_(o,a,l),wr(t,l,i),t.undoManager.add()})(t,r)},fakeEventName:"insertLineBreak"},wc=(t,r)=>x0(t).filter(t=>r.length>0&&rm(rl(t),r)).isSome(),wu=lW([{br:[]},{block:[]},{none:[]}]),wm=(t,r)=>wc(t,is(t)),wf=t=>(r,n)=>x0(r).filter(t=>n2(rl(t))).isSome()===t,wg=(t,r)=>(n,o)=>{let a=x0(n).fold(H(""),t=>t.nodeName.toUpperCase())===t.toUpperCase();return a===r},wp=t=>{let r=xZ(t.dom,t.selection.getStart());return P(r)},wh=t=>wg("pre",t),wb=t=>(r,n)=>ir(r)===t,wv=(t,r)=>wc(t,ii(t)),wy=(t,r)=>r,wC=t=>{let r=io(t),n=xZ(t.dom,t.selection.getStart());return L(n)&&t.schema.isValidChild(n.nodeName,r)},wx=t=>{let r=t.selection.getRng(),n=r.collapsed&&r.startContainer===t.dom.getRoot(),o=rl(r.startContainer),a=rN(o,r.startOffset).map(t=>tK(t)&&!rW(t));return n&&a.getOr(!0)},ww=(t,r)=>(n,o)=>eu(t,(t,r)=>t&&r(n,o),!0)?J.some(r):J.none(),wE=(t,r,n)=>{r.selection.isCollapsed()||(t=>{t.execCommand("delete")})(r),L(n)&&xQ(r,t.fakeEventName).isDefaultPrevented()||(t.insert(r,n),L(n)&&xX(r,t.fakeEventName))},wk=(t,r)=>{let n=()=>wE(wd,t,r),o=()=>wE(wt,t,r),a=vD([ww([wm],wu.none()),ww([wh(!0),wp],wu.none()),ww([wg("summary",!0)],wu.br()),ww([wh(!0),wb(!1),wy],wu.br()),ww([wh(!0),wb(!1)],wu.block()),ww([wh(!0),wb(!0),wy],wu.block()),ww([wh(!0),wb(!0)],wu.br()),ww([wf(!0),wy],wu.br()),ww([wf(!0)],wu.block()),ww([wv],wu.br()),ww([wy],wu.br()),ww([wC],wu.block()),ww([wx],wu.block())],[t,!(!r||!r.shiftKey)]).getOr(wu.none());switch(il(t)){case"linebreak":a.fold(n,n,U);break;case"block":a.fold(o,o,U);break;case"invert":a.fold(o,n,U);break;default:a.fold(n,o,U)}},wS=tS(),w_=wS.os.isiOS()&&wS.browser.isSafari(),wN=(t,r)=>{var n;r.isDefaultPrevented()||(r.preventDefault(),(n=t.undoManager).typing&&(n.typing=!1,n.add()),t.undoManager.transact(()=>{wk(t,r)}))},wR=tS(),wA=t=>t.stopImmediatePropagation(),wO=t=>t.keyCode===cB.PAGE_UP||t.keyCode===cB.PAGE_DOWN,wT=(t,r,n)=>{n&&!t.get()?r.on("NodeChange",wA,!0):!n&&t.get()&&r.off("NodeChange",wA),t.set(n)},wB=(t,r)=>{let n=r.container(),o=r.offset();return nA(n)?(n.insertData(o,t),J.some(lk(n,o+t.length))):s8(r).map(n=>{let o=rd(t);return r.isAtEnd()?r8(n,o):r3(n,o),lk(o.dom,t.length)})},wD=q(wB,"\xa0"),wP=q(wB," "),wL=t=>r=>{t.selection.setRng(r.toRange()),t.nodeChanged()},wM=t=>{let r=lk.fromRangeStart(t.selection.getRng()),n=rl(t.getBody());if(t.selection.isCollapsed()){let o=q(fn,t),a=lk.fromRangeStart(t.selection.getRng());return v$(o,t.getBody(),a).bind(t=>t.fold(t=>du(n.dom,lk.before(t)),t=>dm(t),t=>df(t),t=>dc(n.dom,lk.after(t)))).map(o=>()=>(mq(n,o)?wD(r):wP(r)).each(wL(t)))}return J.none()},wF=t=>{var r,n;return tU(tB.browser.isFirefox()&&t.selection.isEditable()&&(r=t.dom,n=t.selection.getRng().startContainer,r.isEditable(r.getParent(n,"summary"))),()=>{var r;let n=rl(t.getBody());t.selection.isCollapsed()||t.getDoc().execCommand("Delete"),(mq(n,r=lk.fromRangeStart(t.selection.getRng()))?wD(r):wP(r)).each(wL(t))})},wI=t=>sR(t)?[{keyCode:cB.TAB,action:Cu(CI,t,!0)},{keyCode:cB.TAB,shiftKey:!0,action:Cu(CI,t,!1)}]:[],wU=t=>{if(t.addShortcut("Meta+P","","mcePrint"),xG(t),h0(t))return aL(null);{let r,n;let o=yk(t);return(t=>{t.on("keyup compositionstart",q(Ce,t))})(t),((t,r)=>{t.on("keydown",n=>{n.isDefaultPrevented()||((t,r,n)=>{let o=tB.os.isMacOS()||tB.os.isiOS();Cm([{keyCode:cB.RIGHT,action:Cu(Cr,t,!0)},{keyCode:cB.LEFT,action:Cu(Cr,t,!1)},{keyCode:cB.UP,action:Cu(Cn,t,!1)},{keyCode:cB.DOWN,action:Cu(Cn,t,!0)},...o?[{keyCode:cB.UP,action:Cu(Ca,t,!1),metaKey:!0,shiftKey:!0},{keyCode:cB.DOWN,action:Cu(Ca,t,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:cB.RIGHT,action:Cu(CD,t,!0)},{keyCode:cB.LEFT,action:Cu(CD,t,!1)},{keyCode:cB.UP,action:Cu(CP,t,!1)},{keyCode:cB.DOWN,action:Cu(CP,t,!0)},{keyCode:cB.RIGHT,action:Cu(Cg,t,!0)},{keyCode:cB.LEFT,action:Cu(Cg,t,!1)},{keyCode:cB.UP,action:Cu(Cp,t,!1)},{keyCode:cB.DOWN,action:Cu(Cp,t,!0)},{keyCode:cB.RIGHT,action:Cu(yw,t,r,!0)},{keyCode:cB.LEFT,action:Cu(yw,t,r,!1)},{keyCode:cB.RIGHT,ctrlKey:!o,altKey:o,action:Cu(yS,t,r)},{keyCode:cB.LEFT,ctrlKey:!o,altKey:o,action:Cu(y_,t,r)},{keyCode:cB.UP,action:Cu(Cs,t,!1)},{keyCode:cB.DOWN,action:Cu(Cs,t,!0)}],n).each(t=>{n.preventDefault()})})(t,r,n)})})(t,o),r=!1,t.on("keydown",n=>{r=n.keyCode===cB.BACKSPACE,n.isDefaultPrevented()||((t,r,n)=>{let o=n.keyCode===cB.BACKSPACE?"deleteContentBackward":"deleteContentForward";Cf([{keyCode:cB.BACKSPACE,action:Cu(yQ,t)},{keyCode:cB.BACKSPACE,action:Cu(vw,t,!1)},{keyCode:cB.DELETE,action:Cu(vw,t,!0)},{keyCode:cB.BACKSPACE,action:Cu(vg,t,!1)},{keyCode:cB.DELETE,action:Cu(vg,t,!0)},{keyCode:cB.BACKSPACE,action:Cu(yO,t,r,!1)},{keyCode:cB.DELETE,action:Cu(yO,t,r,!0)},{keyCode:cB.BACKSPACE,action:Cu(fj,t,!1)},{keyCode:cB.DELETE,action:Cu(fj,t,!0)},{keyCode:cB.BACKSPACE,action:Cu(vE,t,!1)},{keyCode:cB.DELETE,action:Cu(vE,t,!0)},{keyCode:cB.BACKSPACE,action:Cu(y$,t,!1)},{keyCode:cB.DELETE,action:Cu(y$,t,!0)},{keyCode:cB.BACKSPACE,action:Cu(vi,t,!1)},{keyCode:cB.DELETE,action:Cu(vi,t,!0)},{keyCode:cB.BACKSPACE,action:Cu(vo,t,!1)},{keyCode:cB.DELETE,action:Cu(vo,t,!0)},{keyCode:cB.BACKSPACE,action:Cu(yU,t,!1)},{keyCode:cB.DELETE,action:Cu(yU,t,!0)}],n).filter(r=>t.selection.isEditable()).each(r=>{n.preventDefault(),xQ(t,o).isDefaultPrevented()||(r(),xX(t,o))})})(t,o,n)}),t.on("keyup",n=>{n.isDefaultPrevented()||((t,r,n)=>{let o=tS(),a=o.os,l=o.browser,i=a.isMacOS()?[{keyCode:cB.BACKSPACE,altKey:!0,action:Cu(yj,t)},{keyCode:cB.DELETE,altKey:!0,action:Cu(yj,t)}]:[{keyCode:cB.BACKSPACE,ctrlKey:!0,action:Cu(yj,t)},{keyCode:cB.DELETE,ctrlKey:!0,action:Cu(yj,t)}];a.isMacOS()&&n&&i.push({keyCode:l.isFirefox()?224:91,action:Cu(yj,t)}),Cm([{keyCode:cB.BACKSPACE,action:Cu(vx,t)},{keyCode:cB.DELETE,action:Cu(vx,t)},...i],r)})(t,n,r),r=!1}),n=J.none(),t.on("keydown",r=>{r.keyCode===cB.ENTER&&(w_&&(t=>{if(!t.collapsed)return!1;let r=t.startContainer;if(nA(r)){let n=r.data.charAt(t.startOffset-1);return/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/.test(n)}return!1})(t.selection.getRng())?(n=J.some(t.selection.getBookmark()),t.undoManager.add()):wN(t,r))}),t.on("keyup",r=>{r.keyCode===cB.ENTER&&n.each(()=>{t.undoManager.undo(),n.fold(U,r=>t.selection.moveToBookmark(r)),wN(t,r),n=J.none()})}),(t=>{t.on("keydown",r=>{r.isDefaultPrevented()||((t,r)=>{Cf([{keyCode:cB.SPACEBAR,action:Cu(wM,t)},{keyCode:cB.SPACEBAR,action:Cu(wF,t)}],r).each(n=>{r.preventDefault(),xQ(t,"insertText",{data:" "}).isDefaultPrevented()||(n(),xX(t,"insertText",{data:" "}))})})(t,r)})})(t),(t=>{t.on("input",r=>{r.isComposing||(t=>{let r=rl(t.getBody());t.selection.isCollapsed()&&mZ(r,lk.fromRangeStart(t.selection.getRng())).each(r=>{t.selection.setRng(r.toRange())})})(t)})})(t),(t=>{t.on("keydown",r=>{r.isDefaultPrevented()||((t,r)=>{Cm([...wI(t)],r).each(t=>{r.preventDefault()})})(t,r)})})(t),((t,r)=>{t.on("keydown",n=>{n.isDefaultPrevented()||((t,r,n)=>{let o=tB.os.isMacOS()||tB.os.isiOS();Cm([{keyCode:cB.END,action:Cu(Co,t,!0)},{keyCode:cB.HOME,action:Cu(Co,t,!1)},...o?[]:[{keyCode:cB.HOME,action:Cu(Ca,t,!1),ctrlKey:!0,shiftKey:!0},{keyCode:cB.END,action:Cu(Ca,t,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:cB.END,action:Cu(Ch,t,!0)},{keyCode:cB.HOME,action:Cu(Ch,t,!1)},{keyCode:cB.END,action:Cu(yN,t,!0,r)},{keyCode:cB.HOME,action:Cu(yN,t,!1,r)}],n).each(t=>{n.preventDefault()})})(t,r,n)})})(t,o),((t,r)=>{if(wR.os.isMacOS())return;let n=aL(!1);t.on("keydown",r=>{wO(r)&&wT(n,t,!0)}),t.on("keyup",o=>{o.isDefaultPrevented()||Cm([{keyCode:cB.PAGE_UP,action:Cu(yN,t,!1,r)},{keyCode:cB.PAGE_DOWN,action:Cu(yN,t,!0,r)}],o),wO(o)&&n.get()&&(wT(n,t,!1),t.nodeChanged())})})(t,o),o}};class wz{constructor(t){let r;this.lastPath=[],this.editor=t;let n=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",n=>{let o=t.selection.getRng(),a={startContainer:o.startContainer,startOffset:o.startOffset,endContainer:o.endContainer,endOffset:o.endOffset};"nodechange"!==n.type&&c0(a,r)||t.dispatch("SelectionChange"),r=a}),t.on("contextmenu",()=>{t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{let r=t.selection.getStart(!0);r&&dK(t)&&!n.isSameElementPath(r)&&t.dom.isChildOf(r,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",r=>{!r.isDefaultPrevented()&&dK(t)&&("IMG"===t.selection.getNode().nodeName?uD.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){let r;let n=this.editor.selection;if(this.editor.initialized&&n&&!iZ(this.editor)&&!this.editor.mode.isReadOnly()){let o=this.editor.getBody();(r=n.getStart(!0)||o).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(r,o)||(r=o);let a=[];this.editor.dom.getParent(r,t=>t===o||(a.push(t),!1)),this.editor.dispatch("NodeChange",{...t,element:r,parents:a})}}isSameElementPath(t){let r;let n=this.editor,o=ev(n.dom.getParents(t,Q,n.getBody()));if(o.length===this.lastPath.length){for(r=o.length;r>=0&&o[r]===this.lastPath[r];r--);if(-1===r)return this.lastPath=o,!0}return this.lastPath=o,!1}}let wj=a3("image"),wH=a3("event"),w$=t=>r=>{r[wH]=t},wV=w$(0),wq=w$(2),wW=w$(1),wK=t=>J.from(t[wH]).exists(t=>0===t),wG=a3("mode"),wY=t=>r=>{r[wG]=t},wX=(t,r)=>wY(r)(t),wQ=wY(0),wJ=wY(2),wZ=wY(1),w0=t=>r=>J.from(r[wG]).exists(r=>r===t),w1=w0(0),w2=w0(1),w3=["none","copy","link","move"],w8=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],w5=()=>{let t=new window.DataTransfer,r="move",n="all",o={get dropEffect(){return r},set dropEffect(e){en(w3,e)&&(r=e)},get effectAllowed(){return n},set effectAllowed(e){wK(o)&&en(w8,e)&&(n=e)},get items(){var a;return{...a=t.items,get length(){return a.length},add:(t,r)=>{if(w1(o)){if(!N(t))return a.add(t);if(!D(r))return a.add(t,r)}return null},remove:t=>{w1(o)&&a.remove(t)},clear:()=>{w1(o)&&a.clear()}}},get files(){return w2(o)?Object.freeze({length:0,item:t=>null}):t.files},get types(){return t.types},setDragImage:(r,n,a)=>{w1(o)&&(o[wj]={image:r,x:n,y:a},t.setDragImage(r,n,a))},getData:r=>w2(o)?"":t.getData(r),setData:(r,n)=>{w1(o)&&t.setData(r,n)},clearData:r=>{w1(o)&&t.clearData(r)}};return wQ(o),o},w6=(t,r)=>t.setData("text/html",r),w9="x-tinymce/html",w4=H(w9),w7="<!-- "+w9+" -->",Ee=t=>w7+t,Et=t=>-1!==t.indexOf(w7),Er="%MCEPASTEBIN%",En=t=>t.dom.get("mcepastebin"),Eo=t=>L(t)&&"mcepastebin"===t.id,Ea=t=>t===Er,El=(t,r)=>(tM.each(r,r=>{t=_(r,RegExp)?t.replace(r,""):t.replace(r[0],r[1])}),t),Ei=t=>El(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(t,r,n)=>r||n?"\xa0":" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),Es=(t,r)=>({content:t,cancelled:r}),Ed=(t,r)=>(t.insertContent(r,{merge:sf(t),paste:!0}),!0),Ec=t=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(t),Eu=(t,r,n)=>!(t.selection.isCollapsed()||!Ec(r))&&(t.undoManager.extra(()=>{n(t,r)},()=>{t.execCommand("mceInsertLink",!1,r)}),!0),Em=(t,r,n)=>!!(Ec(r)&&eo(sN(t),t=>e8(r.toLowerCase(),`.${t.toLowerCase()}`)))&&(t.undoManager.extra(()=>{n(t,r)},()=>{t.insertContent('<img src="'+r+'">')}),!0),Ef=(o=0,()=>"mceclip"+o++),Eg=t=>{let r=w5();return w6(r,t),wJ(r),r},Ep=(t,r,n,o,a)=>{let l=((t,r,n)=>{let o=t.dispatch("PastePreProcess",{content:r,internal:n}),a=((t,r)=>{let n=hx({sanitize:sS(t)},t.schema);n.addNodeFilter("meta",t=>{tM.each(t,t=>{t.remove()})});let o=n.parse(r,{forced_root_block:!1,isRootContent:!0});return mn({validate:!0},t.schema).serialize(o)})(t,o.content);return t.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?((t,r,n)=>{let o=t.dom.create("div",{style:"display:none"},r),a=t.dispatch("PastePostProcess",{node:o,internal:n});return Es(a.node.innerHTML,a.isDefaultPrevented())})(t,a,n):Es(a,o.isDefaultPrevented())})(t,r,n);if(!l.cancelled){let r=l.content,n=()=>{o||!sg(t)?Ed(t,r):tM.each([Eu,Em,Ed],n=>!n(t,r,Ed))};a?xQ(t,"insertFromPaste",{dataTransfer:Eg(r)}).isDefaultPrevented()||(n(),xX(t,"insertFromPaste")):n()}},Eh=(t,r,n,o)=>{let a=n||Et(r);Ep(t,r.replace(w7,""),a,!1,o)},Eb=(t,r,n)=>{let o=t.dom.encode(r).replace(/\r\n/g,"\n"),a=((t,r,n)=>{let o=t.split(/\n\n/),a=((t,r)=>{let n="<"+t,o=eL(r,(t,r)=>r+'="'+o7.encodeAllRaw(t)+'"');return o.length&&(n+=" "+o.join(" ")),n+">"})(r,n),l="</"+r+">",i=ea(o,t=>t.split(/\n/).join("<br />"));return 1===i.length?i[0]:ea(i,t=>a+t+l).join("")})(ow(o,sh(t)),io(t),ia(t));Ep(t,a,!1,!0,n)},Ev=t=>{let r={};if(t&&t.types)for(let n=0;n<t.types.length;n++){let o=t.types[n];try{r[o]=t.getData(o)}catch(t){r[o]=""}}return r},Ey=(t,r)=>r in t&&t[r].length>0,EC=t=>Ey(t,"text/html")||Ey(t,"text/plain"),Ex=(t,r,n)=>{let o="paste"===r.type?r.clipboardData:r.dataTransfer;if(si(t)&&o){let a=((t,r)=>{let n=r.items?eh(eS(r.items),t=>"file"===t.kind?[t.getAsFile()]:[]):[],o=r.files?eS(r.files):[];return ed(n.length>0?n:o,(t=>{let r=sN(t);return t=>e3(t.type,"image/")&&eo(r,r=>(t=>{let r=t.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return tM.hasOwn(n,r)?"image/"+n[r]:"image/"+r})(r)===t.type)})(t))})(t,o);if(a.length>0)return r.preventDefault(),Promise.all(ea(a,t=>pi(t).then(r=>({file:t,uri:r})))).then(r=>{n&&t.selection.setRng(n),el(r,r=>{((t,r)=>{pa(r.uri).each(({data:n,type:o,base64Encoded:a})=>{let l=a?n:btoa(n),i=r.file,s=t.editorUpload.blobCache,d=s.getByData(l,o),c=null!=d?d:((t,r,n,o)=>{let a=Ef(),l=im(t)&&L(n.name),i=l?((t,r)=>{let n=r.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return L(n)?t.dom.encode(n[1]):void 0})(t,n.name):a,s=l?n.name:void 0,d=r.create(a,n,o,i,s);return r.add(d),d})(t,s,i,l);Eh(t,`<img src="${c.blobUri()}">`,!1,!0)})})(t,r)})}),!0}return!1},Ew=(t,r,n,o,a)=>{var l;let i=Ei(n),s=Ey(r,w4())||Et(n),d=!s&&(l=i,!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(l)),c=Ec(i);(Ea(i)||!i.length||d&&!c)&&(o=!0),(o||c)&&(i=Ey(r,"text/plain")&&d?r["text/plain"]:(t=>{let r=am(),n=hx({},r),o="",a=r.getVoidElements(),l=tM.makeMap("script noscript style textarea video audio iframe object"," "),i=r.getBlockElements(),s=t=>{let n=t.name;if("br"!==n){if("wbr"!==n){if(a[n]&&(o+=" "),l[n])o+=" ";else{if(3===t.type&&(o+=t.value),!(t.name in r.getVoidElements())){let r=t.firstChild;if(r)do s(r);while(r=r.next)}i[n]&&t.next&&(o+="\n","p"===n&&(o+="\n"))}}}else o+="\n"};return t=El(t,[/<!\[[^\]]+\]>/g]),s(n.parse(t)),o})(i)),Ea(i)||(o?Eb(t,i,a):Eh(t,i,s,a))},EE=(t,r,n)=>{let o;t.on("keydown",t=>{(cB.metaKeyPressed(t)&&86===t.keyCode||t.shiftKey&&45===t.keyCode)&&!t.isDefaultPrevented()&&(o=t.shiftKey&&86===t.keyCode)}),t.on("paste",a=>{var l,i;if(a.isDefaultPrevented()||tB.os.isAndroid()&&0===(null===(i=null===(l=a.clipboardData)||void 0===l?void 0:l.items)||void 0===i?void 0:i.length))return;let s="text"===n.get()||o;o=!1;let d=Ev(a.clipboardData);!EC(d)&&Ex(t,a,r.getLastRng()||t.selection.getRng())||(Ey(d,"text/html")?(a.preventDefault(),Ew(t,d,d["text/html"],s,!0)):Ey(d,"text/plain")&&Ey(d,"text/uri-list")?(a.preventDefault(),Ew(t,d,d["text/plain"],s,!0)):(r.create(),uD.setEditorTimeout(t,()=>{let n=r.getHtml();r.remove(),Ew(t,d,n,s,!1)},0)))}),(t=>{let r=t=>e3(t,"webkit-fake-url"),n=t=>e3(t,"data:");t.parser.addNodeFilter("img",(o,a,l)=>{var i;if(!si(t)&&!0===(null===(i=l.data)||void 0===i?void 0:i.paste))for(let a of o){let o=a.attr("src");N(o)&&!a.attr("data-mce-object")&&o!==tB.transparentSrc&&(r(o)||!sb(t)&&n(o))&&a.remove()}})})(t)},Ek=(t,r,n,o)=>{((t,r,n)=>{if(!t)return!1;try{return t.clearData(),t.setData("text/html",r),t.setData("text/plain",n),t.setData(w4(),r),!0}catch(t){return!1}})(t.clipboardData,r.html,r.text)?(t.preventDefault(),o()):n(r.html,o)},ES=t=>(r,n)=>{let{dom:o,selection:a}=t,l=o.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=o.create("div",{contenteditable:"true"},r);o.setStyles(l,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),l.appendChild(i),o.add(t.getBody(),l);let s=a.getRng();i.focus();let d=o.createRng();d.selectNodeContents(i),a.setRng(d),uD.setEditorTimeout(t,()=>{a.setRng(s),o.remove(l),n()},0)},E_=t=>({html:Ee(t.selection.getContent({contextual:!0})),text:t.selection.getContent({format:"text"})}),EN=t=>!t.selection.isCollapsed()||!!t.dom.getParent(t.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",t.getBody()),ER=(t,r)=>{var n,o;return ue.getCaretRangeFromPoint(null!==(n=r.clientX)&&void 0!==n?n:0,null!==(o=r.clientY)&&void 0!==o?o:0,t.getDoc())},EA=(t,r)=>{t.focus(),r&&t.selection.setRng(r)},EO=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,ET=t=>tM.trim(t).replace(EO,dI).toLowerCase(),EB=(t,r,n)=>{let o=su(t);if(n||"all"===o||!sm(t))return r;let a=o?o.split(/[, ]/):[];if(a&&"none"!==o){let n=t.dom,o=t.selection.getNode();r=r.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(t,r,l,i)=>{let s=n.parseStyle(n.decode(l)),d={};for(let t=0;t<a.length;t++){let r=s[a[t]],l=r,i=n.getStyle(o,a[t],!0);/color/.test(a[t])&&(l=ET(l),i=ET(i)),i!==l&&(d[a[t]]=r)}let c=n.serializeStyle(d,"span");return c?r+' style="'+c+'"'+i:r+i})}else r=r.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return r=r.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(t,r,n,o)=>r+' style="'+n+'"'+o)},ED=t=>{let r=aL(!1),n=aL(sp(t)?"text":"html"),o=(t=>{let r=aL(null);return{create:()=>((t,r)=>{let{dom:n,selection:o}=t,a=t.getBody();r.set(o.getRng());let l=n.add(t.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},Er);tB.browser.isFirefox()&&n.setStyle(l,"left","rtl"===n.getStyle(a,"direction",!0)?65535:-65535),n.bind(l,"beforedeactivate focusin focusout",t=>{t.stopPropagation()}),l.focus(),o.select(l,!0)})(t,r),remove:()=>((t,r)=>{let n=t.dom;if(En(t)){let o;let a=r.get();for(;o=En(t);)n.remove(o),n.unbind(o);a&&t.selection.setRng(a)}r.set(null)})(t,r),getEl:()=>En(t),getHtml:()=>(t=>{let r=t.dom,n=(t,n)=>{t.appendChild(n),r.remove(n,!0)},[o,...a]=ed(t.getBody().childNodes,Eo);el(a,t=>{n(o,t)});let l=r.select("div[id=mcepastebin]",o);for(let t=l.length-1;t>=0;t--){let a=r.create("div");o.insertBefore(a,l[t]),n(a,l[t])}return o?o.innerHTML:""})(t),getLastRng:r.get}})(t);(tB.browser.isChromium()||tB.browser.isSafari())&&((t,r)=>{t.on("PastePreProcess",n=>{n.content=r(t,n.content,n.internal)})})(t,EB),t.addCommand("mceTogglePlainTextPaste",()=>{"text"===n.get()?(n.set("html"),cT(t,!1)):(n.set("text"),cT(t,!0)),t.focus()}),t.addCommand("mceInsertClipboardContent",(r,n)=>{n.html&&Eh(t,n.html,n.internal,!1),n.text&&Eb(t,n.text,!1)}),(t=>{let r=r=>n=>{r(t,n)},n=ss(t);M(n)&&t.on("PastePreProcess",r(n));let o=sd(t);M(o)&&t.on("PastePostProcess",r(o))})(t),t.on("PreInit",()=>{t.on("cut",r=>{!r.isDefaultPrevented()&&EN(t)&&Ek(r,E_(t),ES(t),()=>{if(tB.browser.isChromium()||tB.browser.isFirefox()){let r=t.selection.getRng();uD.setEditorTimeout(t,()=>{t.selection.setRng(r),t.execCommand("Delete")},0)}else t.execCommand("Delete")})}),t.on("copy",r=>{!r.isDefaultPrevented()&&EN(t)&&Ek(r,E_(t),ES(t),U)}),sl(t)&&t.on("dragend dragover draggesture dragdrop drop drag",t=>{t.preventDefault(),t.stopPropagation()}),si(t)||t.on("drop",t=>{let r=t.dataTransfer;r&&eo(r.files,t=>/^image\//.test(t.type))&&t.preventDefault()}),t.on("drop",n=>{if(n.isDefaultPrevented())return;let o=ER(t,n);if(P(o))return;let a=Ev(n.dataTransfer),l=Ey(a,w4());if((!EC(a)||(t=>{let r=t["text/plain"];return!!r&&0===r.indexOf("file://")})(a))&&Ex(t,n,o))return;let i=a[w4()],s=i||a["text/html"]||a["text/plain"],d=((t,r,n,o)=>{let a=t.getParent(n,t=>oU(r,t));if(a&&eI(o,"text/html")){let t=(new DOMParser).parseFromString(o["text/html"],"text/html").body;return!T(t.querySelector(a.nodeName.toLowerCase()))}return!1})(t.dom,t.schema,o.startContainer,a);r.get()&&!d||s&&(n.preventDefault(),uD.setEditorTimeout(t,()=>{t.undoManager.transact(()=>{i&&t.execCommand("Delete"),EA(t,o);let r=Ei(s);a["text/html"]?Eh(t,r,l,!0):Eb(t,r,!0)})}))}),t.on("dragstart",t=>{r.set(!0)}),t.on("dragover dragend",n=>{si(t)&&!r.get()&&(n.preventDefault(),EA(t,ER(t,n))),"dragend"===n.type&&r.set(!1)}),EE(t,o,n)})},EP=t=>n7(rl(t)),EL=(t,r)=>{let n=r.getNode();D(n)||t.selection.setCursorLocation(n,r.offset())},EM=(t,r)=>{var n;return 0===t.startOffset&&t.endOffset===(null===(n=r.textContent)||void 0===n?void 0:n.length)},EF=tS(),EI=EF.browser,EU=EF.os,Ez=EI.isSafari(),Ej=EU.isMacOS()||EU.isiOS(),EH=(t,r)=>L(t.getParent(r.container(),"details")),E$=(t,r)=>{let n=t.dom.getParent(r.container(),"details");if(n&&!n.open){let r=t.dom.select("summary",n)[0];r&&df(r).each(r=>EL(t,r))}else EL(t,r)},EV=(t,r,n)=>{let o=t.selection,a=o.getNode(),l=o.getRng(),i=n.keyCode===cB.BACKSPACE,s=n.keyCode===cB.DELETE,d=t.selection.isCollapsed(),c=lk.fromRangeStart(l),u=t.getBody();return!((d||!((t,r)=>{let n=r.startSummary.exists(r=>r.contains(t.startContainer)),o=r.startSummary.exists(r=>r.contains(t.endContainer)),a=r.startDetails.forall(t=>r.endDetails.forall(r=>t!==r));return(n||o)&&!(n&&o)||a})(l,r))&&!(d&&i&&r.startSummary.exists(t=>dm(t).exists(t=>t.isEqual(c))))&&!(d&&s&&r.startSummary.exists(t=>df(t).exists(r=>nL(r.getNode())&&du(t,r).exists(t=>t.isEqual(c))||r.isEqual(c))))&&!(d&&i&&r.startDetails.exists(t=>du(t,c).forall(t=>r.startSummary.exists(r=>!r.contains(c.container())&&r.contains(t.container())))))&&!(d&&s&&r.startDetails.exists(t=>dc(u,c).forall(r=>!t.contains(r.container()))))&&(!Ez||!nV(a)||(!d&&EM(l,a)||fg(s,c,a)?EP(a):t.undoManager.transact(()=>{let r=o.getSel(),{anchorNode:l,anchorOffset:s,focusNode:c,focusOffset:u}=null!=r?r:{},m=()=>{L(l)&&L(s)&&L(c)&&L(u)&&(null==r||r.setBaseAndExtent(l,s,c,u))},f=(t,r)=>{el(t.childNodes,t=>{dX(t)&&r.appendChild(t)})},g=t.dom.create("span",{"data-mce-bogus":"all"});f(a,g),a.appendChild(g),m(),d&&(Ej&&(n.altKey||i&&n.metaKey)||!Ej&&n.ctrlKey)&&(null==r||r.modify("extend",i?"left":"right",n.metaKey?"line":"word")),!o.isCollapsed()&&EM(o.getRng(),g)?EP(a):(t.execCommand(i?"Delete":"ForwardDelete"),l=null==r?void 0:r.anchorNode,s=null==r?void 0:r.anchorOffset,c=null==r?void 0:r.focusNode,u=null==r?void 0:r.focusOffset,f(g,a),m()),t.dom.remove(g)}),0)))},Eq=t=>{(t=>{t.on("click",r=>{t.dom.getParent(r.target,"details")&&r.preventDefault()})})(t),t.parser.addNodeFilter("details",r=>{let n=sA(t);el(r,t=>{"expanded"===n?t.attr("open","open"):"collapsed"===n&&t.attr("open",null)})}),t.serializer.addNodeFilter("details",r=>{let n=sO(t);el(r,t=>{"expanded"===n?t.attr("open","open"):"collapsed"===n&&t.attr("open",null)})}),(t=>{t.on("keydown",r=>{r.keyCode!==cB.BACKSPACE&&r.keyCode!==cB.DELETE||((t,r)=>{let n=J.from(t.getParent(r.startContainer,"details")),o=J.from(t.getParent(r.endContainer,"details"));if(n.isSome()||o.isSome()){let r=n.bind(r=>J.from(t.select("summary",r)[0]));return J.some({startSummary:r,startDetails:n,endDetails:o})}return J.none()})(t.dom,t.selection.getRng()).fold(()=>{((t,r)=>{let{dom:n,selection:o}=t,a=t.getBody();if(t.selection.isCollapsed()){let l=lk.fromRangeStart(o.getRng()),i=n.getParent(l.container(),n.isBlock);if(i&&n.isEmpty(i)){if(T(i.nextSibling)){let o=du(a,l).filter(t=>EH(n,t));if(o.isSome())return o.each(n=>{r||E$(t,n)}),!0}else if(T(i.previousSibling)&&dc(a,l).filter(t=>EH(n,t)))return!0}return di(r,a,l).fold(X,o=>!!EH(n,o)&&(i&&n.isEmpty(i)&&t.dom.remove(i),r||E$(t,o),!0))}return!1})(t,r.keyCode===cB.DELETE)&&r.preventDefault()},n=>{EV(t,n,r)&&r.preventDefault()})})})(t)},EW=t=>nI(t.dom),EK=t=>r=>rg(rl(t),r),EG=(t,r)=>rH(rl(t),EW,EK(r)),EY=(t,r,n)=>{let o=new nb(t,r),a=n?o.next.bind(o):o.prev.bind(o),l=t;for(let r=n?t:a();r&&!nL(r);r=a())op(r)&&(l=r);return l},EX=t=>{let r=((t,r)=>{let n=lk.fromRangeStart(t).getNode(),o=rH(rl(n),t=>nF(t.dom)||nQ(t),EK(r)).getOr(rl(r)).dom,a=EY(n,o,!1),l=EY(n,o,!0),i=document.createRange();return EG(a,o).fold(()=>{nA(a)?i.setStart(a,0):i.setStartBefore(a)},t=>i.setStartBefore(t.dom)),EG(l,o).fold(()=>{nA(l)?i.setEnd(l,l.data.length):i.setEndAfter(l)},t=>i.setEndAfter(t.dom)),i})(t.selection.getRng(),t.getBody());t.selection.setRng(f2(r))};(c=g||(g={})).Before="before",c.After="after";let EQ=(t,r)=>Math.abs(t.left-r),EJ=(t,r)=>Math.abs(t.right-r),EZ=(t,r)=>eu(ed(t,t=>r>=t.top&&r<=t.bottom),(t,r)=>t.fold(()=>J.some(r),t=>{let n=Math.min(r.left,t.left),o=Math.min(r.top,t.top),a=Math.max(r.right,t.right),l=Math.max(r.bottom,t.bottom);return J.some({top:o,right:a,bottom:l,left:n,width:a-n,height:l-o})}),J.none()).fold(()=>[[],t],r=>{let{pass:n,fail:o}=es(t,t=>((t,r)=>{let n=Math.max(0,Math.min(t.bottom,r.bottom)-Math.max(t.top,r.top))/Math.min(t.height,r.height);return t.top<r.bottom&&t.bottom>r.top&&n>.5})(t,r));return[n,o]}),E0=(t,r,n)=>r>t.left&&r<t.right?0:Math.min(Math.abs(t.left-r),Math.abs(t.right-r)),E1=(t,r,n)=>{let o=t=>op(t.node)?J.some(t):nC(t.node)?E1(eS(t.node.childNodes),r,n):J.none(),a=(t,a)=>{let l=ex(t,(t,o)=>a(t,r,n)-a(o,r,n));return((t,a)=>{if(t.length>=2){let l=o(t[0]).getOr(t[0]),i=o(t[1]).getOr(t[1]);if(2>Math.abs(a(l,r,n)-a(i,r,n))){if(nA(l.node))return J.some(l);if(nA(i.node))return J.some(i)}}return J.none()})(l,a).orThunk(()=>e_(l,o))},[l,i]=EZ(ya(t),n),{pass:s,fail:d}=es(i,t=>t.top<n);return a(l,E0).orThunk(()=>a(d,ll)).orThunk(()=>a(s,ll))},E2=(t,r,n)=>((t,r,n)=>{let o=rl(t),a=rb(o),l=rc(a,r,n).filter(t=>rp(o,t)).getOr(o);return((t,r,n,o)=>{let a=(r,l)=>{let i=ed(r.dom.childNodes,W(t=>nC(t)&&t.classList.contains("mce-drag-container")));return l.fold(()=>E1(i,n,o),t=>{let r=ed(i,r=>r!==t.dom);return E1(r,n,o)}).orThunk(()=>(rg(r,t)?J.none():rC(r)).bind(t=>a(t,J.some(r))))};return a(r,J.none())})(o,l,r,n)})(t,r,n).filter(t=>sj(t.node)).map(t=>({node:t.node,position:EQ(t,r)<EJ(t,r)?g.Before:g.After})),E3=t=>{var r,n;let o=t.getBoundingClientRect(),a=t.ownerDocument,l=a.documentElement,i=a.defaultView;return{top:o.top+(null!==(r=null==i?void 0:i.scrollY)&&void 0!==r?r:0)-l.clientTop,left:o.left+(null!==(n=null==i?void 0:i.scrollX)&&void 0!==n?n:0)-l.clientLeft}},E8=t=>({target:t,srcElement:t}),E5=(t,r,n,o)=>{let a=((t,r)=>{let n=(t=>{let r=w5(),n=J.from(t[wG]);return wJ(t),wV(r),r.dropEffect=t.dropEffect,r.effectAllowed=t.effectAllowed,J.from(t[wj]).each(t=>r.setDragImage(t.image,t.x,t.y)),el(t.types,n=>{"Files"!==n&&r.setData(n,t.getData(n))}),el(t.files,t=>r.items.add(t)),J.from(t[wH]).each(t=>{((t,r)=>{w$(r)(t)})(r,t)}),n.each(n=>{wX(t,n),wX(r,n)}),r})(t);return"dragstart"===r?(wV(n),wQ(n)):"drop"===r?(wq(n),wJ(n)):(wW(n),wZ(n)),n})(n,t);return D(o)?((t,r,n)=>{let o=K("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:t,composedPath:o,initEvent:o,preventDefault:U,stopImmediatePropagation:U,stopPropagation:U,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:o,initMouseEvent:o,getModifierState:o,dataTransfer:n,...E8(r)}})(t,r,a):{...o,dataTransfer:a,type:t,...E8(r)}},E6=((...t)=>r=>{for(let n=0;n<t.length;n++)if(t[n](r))return!0;return!1})(nI,nF),E9=(t,r,n,o)=>{let a=t.dom,l=r.cloneNode(!0);a.setStyles(l,{width:n,height:o}),a.setAttrib(l,"data-mce-selected",null);let i=a.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return a.setStyles(i,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:o}),a.setStyles(l,{margin:0,boxSizing:"border-box"}),i.appendChild(l),i},E4=(t,r)=>n=>()=>{let o="left"===t?n.scrollX:n.scrollY;n.scroll({[t]:o+r,behavior:"smooth"})},E7=E4("left",-32),ke=E4("left",32),kt=E4("top",-32),kr=E4("top",32),kn=t=>{t&&t.parentNode&&t.parentNode.removeChild(t)},ko=(t,r,n,o,a)=>{"dragstart"===r&&w6(o,t.dom.getOuterHTML(n));let l=E5(r,n,o,a);return t.dispatch(r,l)},ka=(t,r)=>{let n=a$((t,n)=>{r._selectionOverrides.hideFakeCaret(),E2(r.getBody(),t,n).fold(()=>r.selection.placeCaretAt(t,n),o=>{let a=r._selectionOverrides.showCaret(1,o.node,o.position===g.Before,!1);a?r.selection.setRng(a):r.selection.placeCaretAt(t,n)})},0);return r.on("remove",n.cancel),o=>t.on(a=>{var l,i,s,d,c,u;let m=Math.max(Math.abs(o.screenX-a.screenX),Math.abs(o.screenY-a.screenY));if(!a.dragging&&m>10){let t=ko(r,"dragstart",a.element,a.dataTransfer,o);if(L(t.dataTransfer)&&(a.dataTransfer=t.dataTransfer),t.isDefaultPrevented())return;a.dragging=!0,r.focus()}if(a.dragging){let m=o.currentTarget===r.getDoc().documentElement,f=(s=r.inline?E3(r.getBody()):{left:0,top:0},d=(t=>{let r=t.getBody();return t.inline?{left:r.scrollLeft,top:r.scrollTop}:{left:0,top:0}})(r),{pageX:(u={pageX:(c=((t,r)=>{if(r.target.ownerDocument!==t.getDoc()){let n=E3(t.getContentAreaContainer()),o=(t=>{let r=t.getBody(),n=t.getDoc().documentElement,o={left:r.scrollLeft,top:r.scrollTop},a={left:r.scrollLeft||n.scrollLeft,top:r.scrollTop||n.scrollTop};return t.inline?o:a})(t);return{left:r.pageX-n.left+o.left,top:r.pageY-n.top+o.top}}return{left:r.pageX,top:r.pageY}})(r,o)).left-s.left+d.left,pageY:c.top-s.top+d.top}).pageX-a.relX,pageY:u.pageY+5});l=a.ghost,i=r.getBody(),l.parentNode!==i&&i.appendChild(l),((t,r,n,o,a,l,i,s,d,c,u,m)=>{let f=0,g=0;t.style.left=r.pageX+"px",t.style.top=r.pageY+"px",r.pageX+n>a&&(f=r.pageX+n-a),r.pageY+o>l&&(g=r.pageY+o-l),t.style.width=n-f+"px",t.style.height=o-g+"px";let p=d.clientHeight,h=d.clientWidth,b=i+d.getBoundingClientRect().top,v=s+d.getBoundingClientRect().left;u.on(t=>{t.intervalId.clear(),t.dragging&&m&&(i+8>=p?t.intervalId.set(kr(c)):i-8<=0?t.intervalId.set(kt(c)):s+8>=h?t.intervalId.set(ke(c)):s-8<=0?t.intervalId.set(E7(c)):b+16>=window.innerHeight?t.intervalId.set(kr(window)):b-16<=0?t.intervalId.set(kt(window)):v+16>=window.innerWidth?t.intervalId.set(ke(window)):v-16<=0&&t.intervalId.set(E7(window)))})})(a.ghost,f,a.width,a.height,a.maxX,a.maxY,o.clientY,o.clientX,r.getContentAreaContainer(),r.getWin(),t,m),n.throttle(o.clientX,o.clientY)}})},kl=(t,r,n)=>{t.on(t=>{t.intervalId.clear(),t.dragging&&n.fold(()=>ko(r,"dragend",t.element,t.dataTransfer),n=>ko(r,"dragend",t.element,t.dataTransfer,n))}),ki(t)},ki=t=>{t.on(t=>{t.intervalId.clear(),kn(t.ghost)}),t.clear()},ks=t=>{let r=aH(),n=aB.DOM,o=document,a=ka(r,t),l=n=>kl(r,t,J.some(n));t.on("mousedown",n=>{var o,a;if(0===n.button){let l=ef(t.dom.getParents(n.target),E6).getOr(null);if(L(l)&&(o=t.dom,a=t.getBody(),nI(l)&&l!==a&&o.isEditable(l.parentElement))){let o=t.dom.getPos(l),a=t.getBody(),i=t.getDoc().documentElement;r.set({element:l,dataTransfer:w5(),dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?a.scrollWidth:i.offsetWidth)-2,maxY:(t.inline?a.scrollHeight:i.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:l.offsetWidth,height:l.offsetHeight,ghost:E9(t,l,l.offsetWidth,l.offsetHeight),intervalId:aj(100)})}}}),t.on("mousemove",a),t.on("mouseup",n=>{r.on(r=>{var o,a,l;if(r.intervalId.clear(),r.dragging){if(a=(t=>{let r=t.getSel();if(L(r)){let t=r.getRangeAt(0).startContainer;return nA(t)?t.parentNode:t}return null})(t.selection),l=r.element,!P(a)&&a!==l&&!t.dom.isChildOf(a,l)&&t.dom.isEditable(a)){let a=null!==(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))&&void 0!==o?o:t.getBody();ko(t,"drop",a,r.dataTransfer,n).isDefaultPrevented()||t.undoManager.transact(()=>{((t,r)=>{let n=t.getParent(r.parentNode,t.isBlock);kn(r),n&&n!==t.getRoot()&&t.isEmpty(n)&&n7(rl(n))})(t.dom,r.element),(t=>{let r=t.getData("text/html");return""===r?J.none():J.some(r)})(r.dataTransfer).each(r=>t.insertContent(r)),t._selectionOverrides.hideFakeCaret()})}ko(t,"dragend",t.getBody(),r.dataTransfer,n)}}),ki(r)}),n.bind(o,"mousemove",a),n.bind(o,"mouseup",l),t.on("remove",()=>{n.unbind(o,"mousemove",a),n.unbind(o,"mouseup",l)}),t.on("keydown",n=>{n.keyCode===cB.ESC&&kl(r,t,J.none())})},kd=(t,r)=>fH(t.getBody(),r),kc=t=>{let r;let n=t.selection,o=t.dom,a=t.getBody(),l=sI(t,a,o.isBlock,()=>uH(t)),i="sel-"+o.uniqueId(),s="data-mce-selected",d=t=>t!==a&&(nI(t)||nj(t))&&o.isChildOf(t,a)&&o.isEditable(t.parentNode),c=(r,o,a,i=!0)=>t.dispatch("ShowCaret",{target:o,direction:r,before:a}).isDefaultPrevented()?null:(i&&n.scrollIntoView(o,-1===r),l.show(a,o)),u=t=>oo(t)||os(t)||od(t),m=t=>u(t.startContainer)||u(t.endContainer),f=r=>{let n=t.schema.getVoidElements(),a=o.createRng(),l=r.startContainer,i=r.startOffset,s=r.endContainer,d=r.endOffset;return eI(n,l.nodeName.toLowerCase())?0===i?a.setStartBefore(l):a.setStartAfter(l):a.setStart(l,i),eI(n,s.nodeName.toLowerCase())?0===d?a.setEndBefore(s):a.setEndAfter(s):a.setEnd(s,d),a},p=(l,u)=>{if(!l)return null;if(l.collapsed){if(!m(l)){let t=u?1:-1,r=s3(t,a,l),n=r.getNode(!u);if(L(n)){if(sj(n))return c(t,n,!!u&&!r.isAtEnd(),!1);if(on(n)&&nI(n.nextSibling)){let t=o.createRng();return t.setStart(n,0),t.setEnd(n,0),t}}let i=r.getNode(u);if(L(i)){if(sj(i))return c(t,i,!u&&!r.isAtEnd(),!1);if(on(i)&&nI(i.previousSibling)){let t=o.createRng();return t.setStart(i,1),t.setEnd(i,1),t}}}return null}let f=l.startContainer,g=l.startOffset,p=l.endOffset;if(nA(f)&&0===g&&nI(f.parentNode)&&(f=f.parentNode,g=o.nodeIndex(f),f=f.parentNode),!nC(f))return null;if(p===g+1&&f===l.endContainer){let a=f.childNodes[g];if(d(a))return(a=>{let l=a.cloneNode(!0),d=t.dispatch("ObjectSelected",{target:a,targetClone:l});if(d.isDefaultPrevented())return null;let c=((r,a)=>{let l=rl(t.getBody()),s=t.getDoc(),d=rV(l,"#"+i).getOrThunk(()=>{let t=ri('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',s);return t0(t,"id",i),r6(l,t),t}),c=o.createRng();r7(d),r4(d,[rd("\xa0",s),rl(a),rd("\xa0",s)]),c.setStart(d.dom.firstChild,1),c.setEnd(d.dom.lastChild,0),rQ(d,{top:o.getPos(r,t.getBody()).y+"px"}),ux(d);let u=n.getSel();return u&&(u.removeAllRanges(),u.addRange(c)),c})(a,d.targetClone),u=rl(a);return el(np(rl(t.getBody()),`*[${s}]`),t=>{rg(u,t)||t5(t,s)}),o.getAttrib(a,s)||a.setAttribute(s,"1"),r=a,b(),c})(a)}return null},h=()=>{r&&r.removeAttribute(s),rV(rl(t.getBody()),"#"+i).each(ne),r=null},b=()=>{l.hide()};return h0(t)||(t.on("click",r=>{o.isEditable(r.target)||(r.preventDefault(),t.focus())}),t.on("blur NewBlock",h),t.on("ResizeWindow FullscreenStateChanged",l.reposition),t.on("tap",r=>{let n=r.target,o=kd(t,n);nI(o)?(r.preventDefault(),vd(t,o).each(p)):d(n)&&vd(t,n).each(p)},!0),t.on("mousedown",r=>{let l=r.target;if(l!==a&&"HTML"!==l.nodeName&&!o.isChildOf(l,a)||!((t,r,n)=>{let o=rl(t.getBody()),a=t.inline?o:rl(rb(o).dom.documentElement),l=((t,r,n,o)=>{let a=r.dom.getBoundingClientRect();return{x:n-(t?a.left+r.dom.clientLeft+bE(r):0),y:o-(t?a.top+r.dom.clientTop+bw(r):0)}})(t.inline,a,r,n);return((t,r,n)=>{let o=bC(t),a=bx(t);return r>=0&&n>=0&&r<=o&&n<=a})(a,l.x,l.y)})(t,r.clientX,r.clientY))return;h(),b();let i=kd(t,l);nI(i)?(r.preventDefault(),vd(t,i).each(p)):E2(a,r.clientX,r.clientY).each(o=>{var a;r.preventDefault(),(a=c(1,o.node,o.position===g.Before,!1))&&n.setRng(a),nC(i)?i.focus():t.getBody().focus()})}),t.on("keypress",t=>{cB.modifierPressed(t)||nI(n.getNode())&&t.preventDefault()}),t.on("GetSelectionRange",t=>{let n=t.range;if(r){if(!r.parentNode)return void(r=null);(n=n.cloneRange()).selectNode(r),t.range=n}}),t.on("SetSelectionRange",t=>{t.range=f(t.range);let r=p(t.range,t.forward);r&&(t.range=r)}),t.on("AfterSetSelectionRange",t=>{let r=t.range,n=r.startContainer.parentElement;m(r)||nC(n)&&"mcepastebin"===n.id||b(),L(n)&&o.hasClass(n,"mce-offscreen-selection")||h()}),ks(t),i5(t)&&(t=>{let r=r=>{if(!r.isDefaultPrevented()){let n=r.dataTransfer;n&&(en(n.types,"Files")||n.files.length>0)&&(r.preventDefault(),"drop"===r.type&&bA(t,"Dropped file type is not supported"))}},n=n=>{uM(t,n.target)&&r(n)},o=()=>{let o=aB.DOM,a=t.dom,l=document,i=t.inline?t.getBody():t.getDoc(),s=["drop","dragover"];el(s,t=>{o.bind(l,t,n),a.bind(i,t,r)}),t.on("remove",()=>{el(s,t=>{o.unbind(l,t,n),a.unbind(i,t,r)})})};t.on("init",()=>{uD.setEditorTimeout(t,o,0)})})(t),(t=>{let r=a$(()=>{if(!t.removed&&t.getBody().contains(document.activeElement)){let r=t.selection.getRng();if(r.collapsed){let n=vc(t,r,!1);t.selection.setRng(n)}}},0);t.on("focus",()=>{r.throttle()}),t.on("blur",()=>{r.cancel()})})(t),(t=>{t.on("init",()=>{t.on("focusin",r=>{let n=r.target;if(nj(n)){let r=fH(t.getBody(),n),o=nI(r)?r:n;t.selection.getNode()!==o&&vd(t,o).each(r=>t.selection.setRng(r))}})})})(t)),{showCaret:c,showBlockCaretContainer:t=>{t.hasAttribute("data-mce-caret")&&(oc(t),n.scrollIntoView(t))},hideFakeCaret:b,destroy:()=>{l.destroy(),r=null}}},ku=(t,r)=>{let n=r;for(let r=t.previousSibling;nA(r);r=r.previousSibling)n+=r.data.length;return n},km=(t,r,n,o,a)=>{if(nA(n)&&(o<0||o>n.data.length))return[];let l=a&&nA(n)?[ku(n,o)]:[o],i=n;for(;i!==r&&i.parentNode;)l.push(t.nodeIndex(i,a)),i=i.parentNode;return i===r?l.reverse():[]},kf=(t,r,n,o,a,l,i=!1)=>({start:km(t,r,n,o,i),end:km(t,r,a,l,i)}),kg=(t,r)=>{let n=r.slice(),o=n.pop();return F(o)?eu(n,(t,r)=>t.bind(t=>J.from(t.childNodes[r])),J.some(t)).bind(t=>nA(t)&&(o<0||o>t.data.length)?J.none():J.some({node:t,offset:o})):J.none()},kp=(t,r)=>kg(t,r.start).bind(({node:n,offset:o})=>kg(t,r.end).map(({node:t,offset:r})=>{let a=document.createRange();return a.setStart(n,o),a.setEnd(t,r),a})),kh=(t,r,n)=>{if(r&&t.isEmpty(r)&&!n(r)){let o=r.parentNode;t.remove(r),kh(t,o,n)}},kb=(t,r,n,o=!0)=>{let a=r.startContainer.parentNode,l=r.endContainer.parentNode;r.deleteContents(),o&&!n(r.startContainer)&&(nA(r.startContainer)&&0===r.startContainer.data.length&&t.remove(r.startContainer),nA(r.endContainer)&&0===r.endContainer.data.length&&t.remove(r.endContainer),kh(t,a,n),a!==l&&kh(t,l,n))},kv=(t,r)=>J.from(t.dom.getParent(r.startContainer,t.dom.isBlock)),ky=(t,r,n)=>{let o=t.dynamicPatternsLookup({text:n,block:r});return{...t,blockPatterns:lX(o).concat(t.blockPatterns),inlinePatterns:lQ(o).concat(t.inlinePatterns)}},kC=(t,r,n,o)=>{let a=t.createRng();return a.setStart(r,0),a.setEnd(n,o),a.toString()},kx=(t,r,n)=>{((t,r,n)=>{if(nA(t)&&0>=t.length)return J.some(CU(t,0));{let r=a7(Cz);return J.from(r.forwards(t,0,Cj(t),n)).map(t=>CU(t.container,0))}})(r,0,r).each(o=>{var a;let l=o.container;CV(l,n.start.length,r).each(n=>{let o=t.createRng();o.setStart(l,0),o.setEnd(n.container,n.offset),kb(t,o,t=>t===r)});let i=rl(l),s=nK(i);/^\s[^\s]/.test(s)&&(a=s.slice(1),nW.set(i,a))})},kw=(t,r)=>t.create("span",{"data-mce-type":"bookmark",id:r}),kE=(t,r)=>{let n=t.createRng();return n.setStartAfter(r.start),n.setEndBefore(r.end),n},kk=(t,r,n)=>{let o=kp(t.getRoot(),n).getOrDie("Unable to resolve path range"),a=o.startContainer,l=o.endContainer,i=0===o.endOffset?l:l.splitText(o.endOffset),s=0===o.startOffset?a:a.splitText(o.startOffset),d=s.parentNode;return{prefix:r,end:i.parentNode.insertBefore(kw(t,r+"-end"),i),start:d.insertBefore(kw(t,r+"-start"),s)}},kS=(t,r,n)=>{kh(t,t.get(r.prefix+"-end"),n),kh(t,t.get(r.prefix+"-start"),n)},k_=t=>0===t.start.length,kN=(t,r,n,o)=>{let a=r.start;return Cq(t,o.container,o.offset,(t,r)=>{let n=t.data.substring(0,r),o=n.lastIndexOf(a.charAt(a.length-1)),l=n.lastIndexOf(a);return -1!==l?l+a.length:-1!==o?o+1:-1},n).bind(o=>{var l,i;let s=null!==(i=null===(l=n.textContent)||void 0===l?void 0:l.indexOf(a))&&void 0!==i?i:-1;if(-1!==s&&o.offset>=s+a.length){let r=t.createRng();return r.setStart(o.container,o.offset-a.length),r.setEnd(o.container,o.offset),J.some(r)}{let l=o.offset-a.length;return C$(o.container,l,n).map(r=>{let n=t.createRng();return n.setStart(r.container,r.offset),n.setEnd(o.container,o.offset),n}).filter(t=>t.toString()===a).orThunk(()=>kN(t,r,n,CU(o.container,0)))}})},kR=(t,r,n,o)=>{let a=t.dom,l=a.getRoot(),i=n.pattern,s=n.position.container,d=n.position.offset;return C$(s,d-n.pattern.end.length,r).bind(c=>{let u=kf(a,l,c.container,c.offset,s,d,o);if(k_(i))return J.some({matches:[{pattern:i,startRng:u,endRng:u}],position:c});{let s=kA(t,n.remainingPatterns,c.container,c.offset,r,o),d=s.getOr({matches:[],position:c}),m=d.position,f=((t,r,n,o,a,l=!1)=>{if(0===r.start.length&&!l){let r=t.createRng();return r.setStart(n,o),r.setEnd(n,o),J.some(r)}return CH(n,o,a).bind(n=>kN(t,r,a,n).bind(t=>{var r;return l&&(t.endContainer===n.container&&t.endOffset===n.offset||0===n.offset&&(null===(r=t.endContainer.textContent)||void 0===r?void 0:r.length)===t.endOffset)?J.none():J.some(t)}))})(a,i,m.container,m.offset,r,s.isNone());return f.map(t=>{let r=((t,r,n,o=!1)=>kf(t,r,n.startContainer,n.startOffset,n.endContainer,n.endOffset,o))(a,l,t,o);return{matches:d.matches.concat([{pattern:i,startRng:r,endRng:u}]),position:CU(t.startContainer,t.startOffset)}})}})},kA=(t,r,n,o,a,l)=>{let i=t.dom;return CH(n,o,i.getRoot()).bind(s=>{let d=kC(i,a,n,o);for(let i=0;i<r.length;i++){let c=r[i];if(!e8(d,c.end))continue;let u=r.slice();u.splice(i,1);let m=kR(t,a,{pattern:c,remainingPatterns:u,position:s},l);if(m.isNone()&&o>0)return kA(t,r,n,o-1,a,l);if(m.isSome())return m}return J.none()})},kO=(t,r,n)=>{t.selection.setRng(n),"inline-format"===r.type?el(r.format,r=>{t.formatter.apply(r)}):t.execCommand(r.cmd,!1,r.value)},kT=(t,r,n,o,a,l)=>((t,r)=>{let n=eb(t,t=>eo(r,r=>t.pattern.start===r.pattern.start&&t.pattern.end===r.pattern.end));return t.length===r.length?n?t:r:t.length>r.length?t:r})(kA(t,a.inlinePatterns,n,o,r,l).fold(()=>[],t=>t.matches),kA(t,ex(a.inlinePatterns,(t,r)=>r.end.length-t.end.length),n,o,r,l).fold(()=>[],t=>t.matches)),kB=(t,r)=>{if(0===r.length)return;let n=t.dom,o=t.selection.getBookmark(),a=((t,r)=>{let n=a3("mce_textpattern"),o=ec(r,(r,o)=>{let a=kk(t,n+`_end${r.length}`,o.endRng);return r.concat([{...o,endMarker:a}])},[]);return ec(o,(r,a)=>{let l=o.length-r.length-1,i=k_(a.pattern)?a.endMarker:kk(t,n+`_start${l}`,a.startRng);return r.concat([{...a,startMarker:i}])},[])})(n,r);el(a,r=>{let o=n.getParent(r.startMarker.start,n.isBlock),a=t=>t===o;k_(r.pattern)?((t,r,n,o)=>{let a=kE(t.dom,n);kb(t.dom,a,o),kO(t,r,a)})(t,r.pattern,r.endMarker,a):((t,r,n,o,a)=>{let l=t.dom,i=kE(l,o),s=kE(l,n);kb(l,s,a),kb(l,i,a);let d={prefix:n.prefix,start:n.end,end:o.start},c=kE(l,d);kO(t,r,c)})(t,r.pattern,r.startMarker,r.endMarker,a),kS(n,r.endMarker,a),kS(n,r.startMarker,a)}),t.selection.moveToBookmark(o)},kD=(t,r)=>{let n=t.selection.getRng();return kv(t,n).map(o=>{var a;let l=Math.max(0,n.startOffset),i=ky(r,o,null!==(a=o.textContent)&&void 0!==a?a:""),s=kT(t,o,n.startContainer,l,i,!0),d=((t,r,n,o)=>{var a;let l=t.dom,i=io(t);if(!l.is(r,i))return[];let s=null!==(a=r.textContent)&&void 0!==a?a:"";return((t,r)=>{let n=ex(t,(t,r)=>r.start.length-t.start.length),o=r.replace("\xa0"," ");return ef(n,t=>0===r.indexOf(t.start)||0===o.indexOf(t.start))})(n.blockPatterns,s).map(t=>tM.trim(s).length===t.start.length?[]:[{pattern:t,range:kf(l,l.getRoot(),r,0,r,0,!0)}]).getOr([])})(t,o,i);return(d.length>0||s.length>0)&&(t.undoManager.add(),t.undoManager.extra(()=>{t.execCommand("mceInsertNewLine")},()=>{t.insertContent("\uFEFF"),kB(t,s),((t,r)=>{if(0===r.length)return;let n=t.selection.getBookmark();el(r,r=>((t,r)=>{let n=t.dom,o=r.pattern,a=kp(n.getRoot(),r.range).getOrDie("Unable to resolve path range");return kv(t,a).each(r=>{"block-format"===o.type?((t,r)=>{let n=r.get(t);return O(n)&&eE(n).exists(t=>eI(t,"block"))})(o.format,t.formatter)&&t.undoManager.transact(()=>{kx(t.dom,r,o),t.formatter.apply(o.format)}):"block-command"===o.type&&t.undoManager.transact(()=>{kx(t.dom,r,o),t.execCommand(o.cmd,!1,o.value)})}),!0})(t,r)),t.selection.moveToBookmark(n)})(t,d);let r=t.selection.getRng(),n=CH(r.startContainer,r.startOffset,t.dom.getRoot());t.execCommand("mceInsertNewLine"),n.each(r=>{let n=r.container;"\uFEFF"===n.data.charAt(r.offset-1)&&(n.deleteData(r.offset-1,1),kh(t.dom,n.parentNode,r=>r===t.dom.getRoot()))})}),!0)}).getOr(!1)},kP=(t,r,n)=>{for(let o=0;o<t.length;o++)if(n(t[o],r))return!0;return!1},kL=t=>{let r=tM.each,n=cB.BACKSPACE,o=cB.DELETE,a=t.dom,l=t.selection,i=t.parser,s=tB.browser,d=s.isFirefox(),c=s.isChromium()||s.isSafari(),u=tB.deviceType.isiPhone()||tB.deviceType.isiPad(),m=tB.os.isMacOS()||tB.os.isiOS(),f=(r,n)=>{try{t.getDoc().execCommand(r,!1,String(n))}catch(t){}},g=t=>t.isDefaultPrevented(),p=()=>{t.shortcuts.add("meta+a",null,"SelectAll")},h=()=>{t.inline||a.bind(t.getDoc(),"mousedown mouseup",r=>{let n;if(r.target===t.getDoc().documentElement){if(n=l.getRng(),t.getBody().focus(),"mousedown"===r.type){if(oo(n.startContainer))return;l.placeCaretAt(r.clientX,r.clientY)}else l.setRng(n)}})},b=()=>{Range.prototype.getClientRects||t.on("mousedown",r=>{if(!g(r)&&"HTML"===r.target.nodeName){let r=t.getBody();r.blur(),uD.setEditorTimeout(t,()=>{r.focus()})}})},v=()=>{let r=i4(t);t.on("click",n=>{let o=n.target;/^(IMG|HR)$/.test(o.nodeName)&&a.isEditable(o.parentNode)&&(n.preventDefault(),t.selection.select(o),t.nodeChanged()),"A"===o.nodeName&&a.hasClass(o,r)&&0===o.childNodes.length&&a.isEditable(o.parentNode)&&(n.preventDefault(),l.select(o))})},y=()=>{t.on("keydown",t=>{if(!g(t)&&t.keyCode===n&&l.isCollapsed()&&0===l.getRng().startOffset){let r=l.getNode().previousSibling;if(r&&r.nodeName&&"table"===r.nodeName.toLowerCase())return t.preventDefault(),!1}return!0})},C=()=>{i0(t)||t.on("BeforeExecCommand mousedown",()=>{f("StyleWithCSS",!1),f("enableInlineTableEditing",!1),iB(t)||f("enableObjectResizing",!1)})},x=()=>{t.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},w=()=>{t.inline||t.on("keydown",()=>{document.activeElement===document.body&&t.getWin().focus()})},E=()=>{t.inline||(t.contentStyles.push("body {min-height: 150px}"),t.on("click",r=>{let n;"HTML"===r.target.nodeName&&(n=t.selection.getRng(),t.getBody().focus(),t.selection.setRng(n),t.selection.normalize(),t.nodeChanged())}))},k=()=>{m&&t.on("keydown",r=>{!cB.metaKeyPressed(r)||r.shiftKey||37!==r.keyCode&&39!==r.keyCode||(r.preventDefault(),t.selection.getSel().modify("move",37===r.keyCode?"backward":"forward","lineboundary"))})},S=()=>{t.on("click",t=>{let r=t.target;do if("A"===r.tagName)return void t.preventDefault();while(r=r.parentNode)}),t.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},_=()=>{t.on("init",()=>{t.dom.bind(t.getBody(),"submit",t=>{t.preventDefault()})})};return h0(t)?(c&&(h(),v(),_(),p(),u&&(w(),E(),S())),d&&(b(),C(),x(),k())):(t.on("keydown",r=>{if(g(r)||r.keyCode!==cB.BACKSPACE)return;let n=l.getRng(),o=n.startContainer,i=n.startOffset,s=a.getRoot(),d=o;if(n.collapsed&&0===i){for(;d.parentNode&&d.parentNode.firstChild===d&&d.parentNode!==s;)d=d.parentNode;"BLOCKQUOTE"===d.nodeName&&(t.formatter.toggle("blockquote",void 0,d),(n=a.createRng()).setStart(o,0),n.setEnd(o,0),l.setRng(n))}}),(()=>{let r=t=>{let r=a.create("body"),n=t.cloneContents();return r.appendChild(n),l.serializer.serialize(r,{format:"html"})};t.on("keydown",l=>{let i=l.keyCode;if(!g(l)&&(i===o||i===n)&&t.selection.isEditable()){let n=t.selection.isCollapsed(),o=t.getBody();if(n&&!a.isEmpty(o)||!n&&!(n=>{let o=r(n),l=a.createRng();return l.selectNode(t.getBody()),o===r(l)})(t.selection.getRng()))return;l.preventDefault(),t.setContent(""),o.firstChild&&a.isBlock(o.firstChild)?t.selection.setCursorLocation(o.firstChild,0):t.selection.setCursorLocation(o,0),t.nodeChanged()}})})(),tB.windowsPhone||t.on("keyup focusin mouseup",r=>{cB.modifierPressed(r)||(t=>{let r=t.getBody(),n=t.selection.getRng();return n.startContainer===n.endContainer&&n.startContainer===r&&0===n.startOffset&&n.endOffset===r.childNodes.length})(t)||l.normalize()},!0),c&&(h(),v(),t.on("init",()=>{f("DefaultParagraphSeparator",io(t))}),_(),y(),i.addNodeFilter("br",t=>{let r=t.length;for(;r--;)"Apple-interchange-newline"===t[r].attr("class")&&t[r].remove()}),u?(w(),E(),S()):p()),d&&(t.on("keydown",r=>{if(!g(r)&&r.keyCode===n&&t.getBody().getElementsByTagName("hr").length&&l.isCollapsed()&&0===l.getRng().startOffset){let t=l.getNode(),n=t.previousSibling;if("HR"===t.nodeName)return a.remove(t),void r.preventDefault();n&&n.nodeName&&"hr"===n.nodeName.toLowerCase()&&(a.remove(n),r.preventDefault())}}),b(),(()=>{let n=()=>{let n=a.getAttribs(l.getStart().cloneNode(!1));return()=>{let o=l.getStart();o!==t.getBody()&&(a.setAttrib(o,"style",null),r(n,t=>{o.setAttributeNode(t.cloneNode(!0))}))}},o=()=>!l.isCollapsed()&&a.getParent(l.getStart(),a.isBlock)!==a.getParent(l.getEnd(),a.isBlock);t.on("keypress",r=>{let a;return!(!(g(r)||8!==r.keyCode&&46!==r.keyCode)&&o()&&(a=n(),t.getDoc().execCommand("delete",!1),a(),r.preventDefault(),1))}),a.bind(t.getDoc(),"cut",r=>{if(!g(r)&&o()){let r=n();uD.setEditorTimeout(t,()=>{r()})}})})(),C(),t.on("SetContent ExecCommand",t=>{"setcontent"!==t.type&&"mceInsertLink"!==t.command||r(a.select("a:not([data-mce-block])"),t=>{var r;let n=t.parentNode,o=a.getRoot();if((null==n?void 0:n.lastChild)===t){for(;n&&!a.isBlock(n);){if((null===(r=n.parentNode)||void 0===r?void 0:r.lastChild)!==n||n===o)return;n=n.parentNode}a.add(n,"br",{"data-mce-bogus":1})}})}),x(),k(),y(),t.on("drop",r=>{var n;let o=null===(n=r.dataTransfer)||void 0===n?void 0:n.getData("text/html");N(o)&&/^<img[^>]*>$/.test(o)&&t.dispatch("dragend",new window.DragEvent("dragend",r))}))),{refreshContentEditable:U,isHidden:()=>{if(!d||t.removed)return!1;let r=t.selection.getSel();return!r||!r.rangeCount||0===r.rangeCount}}},kM=aB.DOM,kF=t=>t.inline?t.getElement().nodeName.toLowerCase():void 0,kI=t=>eP(t,t=>!1===D(t)),kU=t=>{let r=t.options.get,n=t.editorUpload.blobCache;return kI({allow_conditional_comments:r("allow_conditional_comments"),allow_html_data_urls:r("allow_html_data_urls"),allow_svg_data_urls:r("allow_svg_data_urls"),allow_html_in_named_anchor:r("allow_html_in_named_anchor"),allow_script_urls:r("allow_script_urls"),allow_unsafe_link_target:r("allow_unsafe_link_target"),convert_fonts_to_spans:r("convert_fonts_to_spans"),fix_list_elements:r("fix_list_elements"),font_size_legacy_values:r("font_size_legacy_values"),forced_root_block:r("forced_root_block"),forced_root_block_attrs:r("forced_root_block_attrs"),preserve_cdata:r("preserve_cdata"),inline_styles:r("inline_styles"),root_name:kF(t),sanitize:r("xss_sanitization"),validate:!0,blob_cache:n,document:t.getDoc()})},kz=t=>{let r=t.options.get;return kI({custom_elements:r("custom_elements"),extended_valid_elements:r("extended_valid_elements"),invalid_elements:r("invalid_elements"),invalid_styles:r("invalid_styles"),schema:r("schema"),valid_children:r("valid_children"),valid_classes:r("valid_classes"),valid_elements:r("valid_elements"),valid_styles:r("valid_styles"),verify_html:r("verify_html"),padd_empty_block_inline_children:r("format_empty_lines")})},kj=t=>t.inline?t.ui.styleSheetLoader:t.dom.styleSheetLoader,kH=t=>{let r=kj(t),n=iA(t),o=t.contentCSS,a=()=>{r.unloadAll(o),t.inline||t.ui.styleSheetLoader.unloadAll(n)},l=()=>{t.removed?a():t.on("remove",a)};if(t.contentStyles.length>0){let r="";tM.each(t.contentStyles,t=>{r+=t+"\r\n"}),t.dom.addStyle(r)}let i=Promise.all(((t,r,n)=>{let o=[kj(t).loadAll(r)];return t.inline?o:o.concat([t.ui.styleSheetLoader.loadAll(n)])})(t,o,n)).then(l).catch(l),s=iR(t);return s&&((t,r)=>{let n=rl(t.getBody()),o=rL(rP(n)),a=rs("style");t0(a,"type","text/css"),r6(a,rd(r)),r6(o,a),t.on("remove",()=>{ne(a)})})(t,s),i},k$=t=>{!0!==t.removed&&(h0(t)||t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"}),(t=>{t.bindPendingEventDelegates(),t.initialized=!0,(t=>{t.dispatch("Init")})(t),t.focus(!0),(t=>{let r=t.dom.getRoot();t.inline||dK(t)&&t.selection.getStart(!0)!==r||dm(r).each(r=>{let n=r.getNode(),o=n_(n)?dm(n).getOr(r):r;t.selection.setRng(o.toRange())})})(t),t.nodeChanged({initial:!0});let r=st(t);M(r)&&r.call(t,t),(t=>{let r=sn(t);r&&uD.setEditorTimeout(t,()=>{let n;(n=!0===r?t:t.editorManager.get(r))&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)})(t)})(t))},kV=t=>{let r=t.getElement(),n=t.getDoc();t.inline&&(kM.addClass(r,"mce-content-body"),t.contentDocument=n=document,t.contentWindow=window,t.bodyElement=r,t.contentAreaContainer=r);let o=t.getBody();o.disabled=!0,t.readonly=i0(t),t._editableRoot=i1(t),!t.readonly&&t.hasEditableRoot()&&(t.inline&&"static"===kM.getStyle(o,"position",!0)&&(o.style.position="relative"),o.contentEditable="true"),o.disabled=!1,t.editorUpload=bz(t),t.schema=am(kz(t)),t.dom=aB(n,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,update_styles:!0,root_element:t.inline?t.getBody():null,collect:t.inline,schema:t.schema,contentCssCors:ix(t),referrerPolicy:iw(t),onSetAttrib:r=>{t.dispatch("SetAttrib",r)}}),t.parser=(t=>{let r=hx(kU(t),t.schema);return r.addAttributeFilter("src,href,style,tabindex",(r,n)=>{let o=t.dom,a="data-mce-"+n,l=r.length;for(;l--;){let i=r[l],s=i.attr(n);if(s&&!i.attr(a)){if(0===s.indexOf("data:")||0===s.indexOf("blob:"))continue;"style"===n?((s=o.serializeStyle(o.parseStyle(s),i.name)).length||(s=null),i.attr(a,s),i.attr(n,s)):"tabindex"===n?(i.attr(a,s),i.attr(n,null)):i.attr(a,t.convertURL(s,n,i.name))}}}),r.addNodeFilter("script",t=>{let r=t.length;for(;r--;){let n=t[r],o=n.attr("type")||"no/type";0!==o.indexOf("mce-")&&n.attr("type","mce-"+o)}}),sE(t)&&r.addNodeFilter("#cdata",r=>{var n;let o=r.length;for(;o--;){let a=r[o];a.type=8,a.name="#comment",a.value="[CDATA["+t.dom.encode(null!==(n=a.value)&&void 0!==n?n:"")+"]]"}}),r.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",r=>{let n=r.length,o=t.schema.getNonEmptyElements();for(;n--;){let t=r[n];t.isEmpty(o)&&0===t.getAll("br").length&&t.append(new u8("br",1))}}),r})(t),t.serializer=bt((t=>{let r=t.options.get;return{...kU(t),...kz(t),...kI({remove_trailing_brs:r("remove_trailing_brs"),url_converter:r("url_converter"),url_converter_scope:r("url_converter_scope"),element_format:r("element_format"),entities:r("entities"),entity_encoding:r("entity_encoding"),indent:r("indent"),indent_after:r("indent_after"),indent_before:r("indent_before")})}})(t),t),t.selection=h4(t.dom,t.getWin(),t.serializer,t),t.annotator=cE(t),t.formatter=bQ(t),t.undoManager=bZ(t),t._nodeChangeDispatcher=new wz(t),t._selectionOverrides=kc(t),(t=>{let r=aH(),n=aL(!1),o=aV(r=>{t.dispatch("longpress",{...r,type:"longpress"}),n.set(!0)},400);t.on("touchstart",t=>{y0(t).each(a=>{o.cancel();let l={x:a.clientX,y:a.clientY,target:t.target};o.throttle(t),n.set(!1),r.set(l)})},!0),t.on("touchmove",a=>{o.cancel(),y0(a).each(o=>{r.on(a=>{((t,r)=>{let n=Math.abs(t.clientX-r.x),o=Math.abs(t.clientY-r.y);return n>5||o>5})(o,a)&&(r.clear(),n.set(!1),t.dispatch("longpresscancel"))})})},!0),t.on("touchend touchcancel",a=>{o.cancel(),"touchcancel"!==a.type&&r.get().filter(t=>t.target.isEqualNode(a.target)).each(()=>{n.get()?a.preventDefault():t.dispatch("tap",{...a,type:"tap"})})},!0)})(t),Eq(t),(t=>{let r="contenteditable",n=" "+tM.trim(sx(t))+" ",o=" "+tM.trim(sC(t))+" ",a=y9(n),l=y9(o),i=sw(t);i.length>0&&t.on("BeforeSetContent",r=>{((t,r,n)=>{let o=r.length,a=n.content;if("raw"!==n.format){for(;o--;)a=a.replace(r[o],y4(t,a,sC(t)));n.content=a}})(t,i,r)}),t.parser.addAttributeFilter("class",t=>{let n=t.length;for(;n--;){let o=t[n];a(o)?o.attr(r,"true"):l(o)&&o.attr(r,"false")}}),t.serializer.addAttributeFilter(r,t=>{let n=t.length;for(;n--;){let o=t[n];(a(o)||l(o))&&(i.length>0&&o.attr("data-mce-content")?(o.name="#text",o.type=3,o.raw=!0,o.value=o.attr("data-mce-content")):o.attr(r,null))}})})(t),h0(t)||((t=>{t.on("mousedown",r=>{r.detail>=3&&(r.preventDefault(),EX(t))})})(t),(t=>{let r=[",",".",";",":","!","?"],n=[32],o=()=>{var r,n;return r=sv(t),n=sy(t),{inlinePatterns:lQ(r),blockPatterns:lX(r),dynamicPatternsLookup:n}},a=()=>t.options.isSet("text_patterns_lookup");t.on("keydown",r=>{if(13===r.keyCode&&!cB.modifierPressed(r)&&t.selection.isCollapsed()){let n=o();(n.inlinePatterns.length>0||n.blockPatterns.length>0||a())&&kD(t,n)&&r.preventDefault()}},!0);let l=()=>{if(t.selection.isCollapsed()){let r=o();(r.inlinePatterns.length>0||a())&&((t,r)=>{let n=t.selection.getRng();kv(t,n).map(o=>{let a=Math.max(0,n.startOffset-1),l=kC(t.dom,o,n.startContainer,a),i=ky(r,o,l),s=kT(t,o,n.startContainer,a,i,!1);s.length>0&&t.undoManager.transact(()=>{kB(t,s)})})})(t,r)}};t.on("keyup",t=>{kP(n,t,(t,r)=>t===r.keyCode&&!cB.modifierPressed(r))&&l()}),t.on("keypress",n=>{kP(r,n,(t,r)=>t.charCodeAt(0)===r.charCode)&&uD.setEditorTimeout(t,l)})})(t));let a=wU(t);yZ(t,a),(t=>{t.on("NodeChange",q(y5,t))})(t),(t=>{var r;let n=t.dom,o=io(t),a=null!==(r=iP(t))&&void 0!==r?r:"",l=(r,i)=>{if((t=>{if(b2(t)){let r=t.keyCode;return!b3(t)&&(cB.metaKeyPressed(t)||t.altKey||r>=112&&r<=123||en(b0,r))}return!1})(r))return;let s=t.getBody(),d=(!b2(r)||!!(b3(r)||"keyup"===r.type&&229===r.keyCode))&&((t,r,n)=>{if(oN(rl(r),!1)){let o=r.firstElementChild;return!o||!t.getStyle(r.firstElementChild,"padding-left")&&!t.getStyle(r.firstElementChild,"padding-right")&&n===o.nodeName.toLowerCase()}return!1})(n,s,o);(""!==n.getAttrib(s,b1)!==d||i)&&(n.setAttrib(s,b1,d?a:null),n.setAttrib(s,"aria-placeholder",d?a:null),((t,r)=>{t.dispatch("PlaceholderToggle",{state:r})})(t,d),t.on(d?"keydown":"keyup",l),t.off(d?"keyup":"keydown",l))};e7(a)&&t.on("init",r=>{l(r,!0),t.on("change SetContent ExecCommand",l),t.on("paste",r=>uD.setEditorTimeout(t,()=>l(r)))})})(t),ED(t);let l=eF(t.plugins,"rtc").bind(t=>J.from(t.setup)).fold(()=>(t.rtcInstance=hZ(t),J.none()),r=>(t.rtcInstance=(()=>{let t=H(null),r=H("");return{init:{bindEvents:U},undoManager:{beforeChange:U,add:t,undo:t,redo:t,clear:U,reset:U,hasUndo:X,hasRedo:X,transact:t,ignore:U,extra:U},formatter:{match:X,matchAll:H([]),matchNode:H(void 0),canApply:X,closest:r,apply:U,remove:U,toggle:U,formatChanged:H({unbind:U})},editor:{getContent:r,setContent:H({content:"",html:""}),insertContent:H(""),addVisual:U},selection:{getContent:r},autocompleter:{addDecoration:U,removeDecoration:U},raw:{getModel:H(J.none())}}})(),J.some(()=>r().then(r=>(t.rtcInstance=(t=>{let r=t=>R(t)?t:{},{init:n,undoManager:o,formatter:a,editor:l,selection:i,autocompleter:s,raw:d}=t;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:o.beforeChange,add:o.add,undo:o.undo,redo:o.redo,clear:o.clear,reset:o.reset,hasUndo:o.hasUndo,hasRedo:o.hasRedo,transact:(t,r,n)=>o.transact(n),ignore:(t,r)=>o.ignore(r),extra:(t,r,n,a)=>o.extra(n,a)},formatter:{match:(t,n,o,l)=>a.match(t,r(n),l),matchAll:a.matchAll,matchNode:a.matchNode,canApply:t=>a.canApply(t),closest:t=>a.closest(t),apply:(t,n,o)=>a.apply(t,r(n)),remove:(t,n,o,l)=>a.remove(t,r(n)),toggle:(t,n,o)=>a.toggle(t,r(n)),formatChanged:(t,r,n,o,l)=>a.formatChanged(r,n,o,l)},editor:{getContent:t=>l.getContent(t),setContent:(t,r)=>({content:l.setContent(t,r),html:""}),insertContent:(t,r)=>(l.insertContent(t),""),addVisual:l.addVisual},selection:{getContent:(t,r)=>i.getContent(r)},autocompleter:{addDecoration:s.addDecoration,removeDecoration:s.removeDecoration},raw:{getModel:()=>J.some(d.getRawModel())}}})(r),r.rtc.isRemote)))));(t=>{let r=t.getDoc(),n=t.getBody();(t=>{t.dispatch("PreInit")})(t),so(t)||(r.body.spellcheck=!1,kM.setAttrib(n,"spellcheck","false")),t.quirks=kL(t),(t=>{t.dispatch("PostRender")})(t);let o=iO(t);void 0!==o&&(n.dir=o);let a=sa(t);a&&t.on("BeforeSetContent",t=>{tM.each(a,r=>{t.content=t.content.replace(r,t=>"<!--mce:protected "+escape(t)+"-->")})}),t.on("SetContent",()=>{t.addVisual(t.getBody())}),t.on("compositionstart compositionend",r=>{t.composing="compositionstart"===r.type})})(t),l.fold(()=>{kH(t).then(()=>k$(t))},r=>{t.setProgressState(!0),kH(t).then(()=>{r().then(r=>{t.setProgressState(!1),k$(t),h3(t)},r=>{t.notificationManager.open({type:"error",text:String(r)}),k$(t),h3(t)})})})},kq=aB.DOM,kW=aB.DOM,kK=(t,r)=>({editorContainer:t,iframeContainer:r,api:{}}),kG=t=>{let r=t.getElement();return t.inline?kK(null):(t=>{let r=kW.create("div");return kW.insertAfter(r,t),kK(r,r)})(r)},kY=async t=>{var r;t.dispatch("ScriptsLoaded"),(t=>{let r=tM.trim(ip(t)),n=t.ui.registry.getAll().icons,o={...bh.get("default").icons,...bh.get(r).icons};eA(o,(r,o)=>{eI(n,o)||t.ui.registry.addIcon(o,r)})})(t),(t=>{let r=iF(t);if(N(r)){let n=b_.get(r);t.theme=n(t,b_.urls[r])||{},M(t.theme.init)&&t.theme.init(t,b_.urls[r]||t.documentBaseUrl.replace(/\/$/,""))}else t.theme={}})(t),(t=>{let r=iU(t),n=bb.get(r);t.model=n(t,bb.urls[r])})(t),(t=>{let r=[];el(i3(t),n=>{((t,r,n)=>{let o=bS.get(n),a=bS.urls[n]||t.documentBaseUrl.replace(/\/$/,"");if(n=tM.trim(n),o&&-1===tM.inArray(r,n)){if(t.plugins[n])return;try{let l=o(t,a)||{};t.plugins[n]=l,M(l.init)&&(l.init(t,a),r.push(n))}catch(r){((t,r,n)=>{let o=aU.translate(["Failed to initialize plugin: {0}",r]);c_(t,"PluginLoadError",{message:o}),bB(o,n),bA(t,o)})(t,n,r)}}})(t,r,n.replace(/^\-/,""))})})(t);let n=await (t=>{let r=t.getElement();return t.orgDisplay=r.style.display,N(iF(t))?(t=>{let r=t.theme.renderUI;return r?r():kG(t)})(t):M(iF(t))?(t=>{let r=t.getElement(),n=iF(t)(t,r);return n.editorContainer.nodeType&&(n.editorContainer.id=n.editorContainer.id||t.id+"_parent"),n.iframeContainer&&n.iframeContainer.nodeType&&(n.iframeContainer.id=n.iframeContainer.id||t.id+"_iframecontainer"),n.height=n.iframeHeight?n.iframeHeight:r.offsetHeight,n})(t):kG(t)})(t);((t,r)=>{let n={show:J.from(r.show).getOr(U),hide:J.from(r.hide).getOr(U),isEnabled:J.from(r.isEnabled).getOr(Q),setEnabled:n=>{t.mode.isReadOnly()||J.from(r.setEnabled).each(t=>t(n))}};t.ui={...t.ui,...n}})(t,J.from(n.api).getOr({})),t.editorContainer=n.editorContainer,t.contentCSS=t.contentCSS.concat(bD(t,iN(t)),bD(t,iA(t))),t.inline?kV(t):(((t,r)=>{let n=t.translate("Rich Text Area"),o=t3(rl(t.getElement()),"tabindex").bind(tt),a=((t,r,n,o)=>{let a=rs("iframe");return o.each(t=>t0(a,"tabindex",t)),t1(a,n),t1(a,{id:t+"_ifr",frameBorder:"0",allowTransparency:"true",title:r}),rr(a,"tox-edit-area__iframe"),a})(t.id,n,l6(t),o).dom;a.onload=()=>{a.onload=null,t.dispatch("load")},t.contentAreaContainer=r.iframeContainer,t.iframeElement=a,t.iframeHTML=(t=>{let r=l9(t)+"<html><head>";l4(t)!==t.documentBaseUrl&&(r+='<base href="'+t.documentBaseURI.getURI()+'" />'),r+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';let n=l7(t),o=ie(t),a=t.translate(i7(t));return it(t)&&(r+='<meta http-equiv="Content-Security-Policy" content="'+it(t)+'" />'),r+=`</head><body id="${n}" class="mce-content-body ${o}" data-id="${t.id}" aria-label="${a}"><br></body></html>`})(t),kq.add(r.iframeContainer,a)})(t,r={editorContainer:n.editorContainer,iframeContainer:n.iframeContainer}),r.editorContainer&&(r.editorContainer.style.display=t.orgDisplay,t.hidden=kq.isHidden(r.editorContainer)),t.getElement().style.display="none",kq.setAttrib(t.id,"aria-hidden","true"),t.getElement().style.visibility=t.orgVisibility,(t=>{let r=t.iframeElement,n=()=>{t.contentDocument=r.contentDocument,kV(t)};if(s_(t)||tB.browser.isFirefox()){let r=t.getDoc();r.open(),r.write(t.iframeHTML),r.close(),n()}else{let o=na(rl(r),"load",Q,()=>{o.unbind(),n()});r.srcdoc=t.iframeHTML}})(t))},kX=aB.DOM,kQ=t=>"-"===t.charAt(0),kJ=(t,r,n)=>J.from(r).filter(t=>e7(t)&&!bh.has(t)).map(r=>({url:`${t.editorManager.baseURL}/icons/${r}/icons${n}.js`,name:J.some(r)})),kZ=(t,r)=>{let n=aP.ScriptLoader,o=()=>{!t.removed&&(t=>{let r=iF(t);return!N(r)||L(b_.get(r))})(t)&&(t=>{let r=iU(t);return L(bb.get(r))})(t)&&kY(t)};((t,r)=>{let n=iF(t);if(N(n)&&!kQ(n)&&!eI(b_.urls,n)){let o=iI(t),a=o?t.documentBaseURI.toAbsolute(o):`themes/${n}/theme${r}.js`;b_.load(n,a).catch(()=>{bO(t,"ThemeLoadError",bT("theme",a,n))})}})(t,r),((t,r)=>{let n=iU(t);if("plugin"!==n&&!eI(bb.urls,n)){let o=iz(t),a=N(o)?t.documentBaseURI.toAbsolute(o):`models/${n}/model${r}.js`;bb.load(n,a).catch(()=>{bO(t,"ModelLoadError",bT("model",a,n))})}})(t,r),((t,r)=>{let n=iE(r),o=ik(r);if(!aU.hasCode(n)&&"en"!==n){let a=e7(o)?o:`${r.editorManager.baseURL}/langs/${n}.js`;t.add(a).catch(()=>{bO(r,"LanguageLoadError",bT("language",a,n))})}})(n,t),((t,r,n)=>{let o=kJ(r,"default",n),a=J.from(ih(r)).filter(e7).map(t=>({url:t,name:J.none()})).orThunk(()=>kJ(r,ip(r),""));el((t=>{let r=[],n=t=>{r.push(t)};for(let r=0;r<t.length;r++)t[r].each(n);return r})([o,a]),n=>{t.add(n.url).catch(()=>{bO(r,"IconsLoadError",bT("icons",n.url,n.name.getOrUndefined()))})})})(n,t,r),((t,r)=>{let n=(r,n)=>{bS.load(r,n).catch(()=>{bO(t,"PluginLoadError",bT("plugin",n,r))})};eA(i8(t),(r,o)=>{n(o,r),t.options.set("plugins",i3(t).concat(o))}),el(i3(t),t=>{!(t=tM.trim(t))||bS.urls[t]||kQ(t)||n(t,`plugins/${t}/plugin${r}.js`)})})(t,r),n.loadQueue().then(o,o)},k0=tS().deviceType,k1=k0.isPhone(),k2=k0.isTablet(),k3=t=>{if(P(t))return[];{let r=O(t)?t:t.split(/[ ,]/),n=ea(r,e6);return ed(n,e7)}},k8=(t,r)=>{var n,o;let a=((r,n)=>{let o={},a={};return eD(r,(r,n)=>en(t,n),eB(o),eB(a)),{t:o,f:a}})(r);return n=a.t,o=a.f,{sections:H(n),options:H(o)}},k5=(t,r)=>eI(t.sections(),r),k6=(t,r)=>({table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:eF(t,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1,...r?{menubar:!1}:{}}),k9=(t,r)=>{var n;let o=null!==(n=r.external_plugins)&&void 0!==n?n:{};return t&&t.external_plugins?tM.extend({},t.external_plugins,o):o},k4=(t,r,n,o,a)=>{var l;let i=t?{mobile:k6(null!==(l=a.mobile)&&void 0!==l?l:{},r)}:{},s=k8(["mobile"],C6(i,a)),d=tM.extend(n,o,s.options(),t&&k5(s,"mobile")?((t,r,n={})=>{let o=t.sections(),a=eF(o,r).getOr({});return tM.extend({},n,a)})(s,"mobile"):{},{external_plugins:k9(o,s.options())});return((t,r,n,o)=>{var a,l;let i=k3(n.forced_plugins),s=k3(o.plugins),d=k5(r,a="mobile")?r.sections()[a]:{},c=(l=d.plugins?k3(d.plugins):s,t&&k5(r,"mobile")?l:s),u=[...k3(i),...k3(c)];return tM.extend(o,{forced_plugins:i,plugins:u})})(t,s,o,d)},k7=t=>{(t=>{let r=r=>()=>{el("left,center,right,justify".split(","),n=>{r!==n&&t.formatter.remove("align"+n)}),"none"!==r&&(t.formatter.toggle("align"+r,void 0),t.nodeChanged())};t.editorCommands.addCommands({JustifyLeft:r("left"),JustifyCenter:r("center"),JustifyRight:r("right"),JustifyFull:r("justify"),JustifyNone:r("none")})})(t),(t=>{let r=r=>()=>{let n=t.selection,o=n.isCollapsed()?[t.dom.getParent(n.getNode(),t.dom.isBlock)]:n.getSelectedBlocks();return eo(o,n=>L(t.formatter.matchNode(n,r)))};t.editorCommands.addCommands({JustifyLeft:r("alignleft"),JustifyCenter:r("aligncenter"),JustifyRight:r("alignright"),JustifyFull:r("alignjustify")},"state")})(t)},Se=(t,r)=>{let n=t.selection,o=t.dom;return/^ | $/.test(r)?((t,r,n)=>{let o=rl(t.getRoot());return n=mW(o,lk.fromRangeStart(r))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),mK(o,lk.fromRangeEnd(r))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ")})(o,n.getRng(),r):r},St=(t,r)=>{if(t.selection.isEditable()){let{content:n,details:o}=(t=>{if("string"!=typeof t){let r=tM.extend({paste:t.paste,data:{paste:t.paste}},t);return{content:t.content,details:r}}return{content:t,details:{}}})(r);hS(t,{...o,content:Se(t,n),format:"html",set:!1,selection:!0}).each(r=>{var n;let a=(n=r.content,h1(t).editor.insertContent(n,o));h_(t,a,r),t.addVisual()})}},Sr={"font-size":"size","font-family":"face"},Sn=tJ("font"),So=t=>(r,n)=>J.from(n).map(rl).filter(tG).bind(n=>{var o;return go(rl(n.dom),r=>r0(r,t).orThunk(()=>Sn(r)?eF(Sr,t).bind(t=>t3(r,t)):J.none()),t=>rg(rl(r),t)).or((o=n.dom,J.from(aB.DOM.getStyle(o,t,!0))))}).getOr(""),Sa=So("font-size"),Sl=z(t=>t.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),So("font-family")),Si=t=>dm(t.getBody()).bind(t=>{let r=t.container();return J.from(nA(r)?r.parentNode:r)}),Ss=(t,r)=>{var n;return n=j(J.some,r),J.from(t.selection.getRng()).bind(r=>{let n=t.getBody();return r.startContainer===n&&0===r.startOffset?J.none():J.from(t.selection.getStart(!0))}).orThunk(q(Si,t)).map(rl).filter(tG).bind(n)},Sd=(t,r)=>{if(/^[0-9.]+$/.test(r)){let n=parseInt(r,10);if(n>=1&&n<=7){let o=tM.explode(t.options.get("font_size_style_values")),a=tM.explode(t.options.get("font_size_classes"));return a.length>0?a[n-1]||r:o[n-1]||r}}return r},Sc=t=>{let r=t.split(/\s*,\s*/);return ea(r,t=>-1===t.indexOf(" ")||e3(t,'"')||e3(t,"'")?t:`'${t}'`).join(",")},Su=t=>{k7(t),(t=>{t.editorCommands.addCommands({"Cut,Copy,Paste":r=>{let n;let o=t.getDoc();try{o.execCommand(r)}catch(t){n=!0}if("paste"!==r||o.queryCommandEnabled(r)||(n=!0),n||!o.queryCommandSupported(r)){let r=t.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(tB.os.isMacOS()||tB.os.isiOS())&&(r=r.replace(/Ctrl\+/g,"⌘+")),t.notificationManager.open({text:r,type:"error"})}}})})(t),(t=>{t.editorCommands.addCommands({mceAddUndoLevel:()=>{t.undoManager.add()},mceEndUndoLevel:()=>{t.undoManager.add()},Undo:()=>{t.undoManager.undo()},Redo:()=>{t.undoManager.redo()}})})(t),(t=>{t.editorCommands.addCommands({mceSelectNodeDepth:(r,n,o)=>{let a=0;t.dom.getParent(t.selection.getNode(),r=>!nC(r)||a++!==o||(t.selection.select(r),!1),t.getBody())},mceSelectNode:(r,n,o)=>{t.selection.select(o)},selectAll:()=>{let r=t.dom.getParent(t.selection.getStart(),nF);if(r){let n=t.dom.createRng();n.selectNodeContents(r),t.selection.setRng(n)}}})})(t),(t=>{t.editorCommands.addCommands({mceCleanup:()=>{let r=t.selection.getBookmark();t.setContent(t.getContent()),t.selection.moveToBookmark(r)},insertImage:(r,n,o)=>{St(t,t.dom.createHTML("img",{src:o}))},insertHorizontalRule:()=>{t.execCommand("mceInsertContent",!1,"<hr>")},insertText:(r,n,o)=>{St(t,t.dom.encode(o))},insertHTML:(r,n,o)=>{St(t,o)},mceInsertContent:(r,n,o)=>{St(t,o)},mceSetContent:(r,n,o)=>{t.setContent(o)},mceReplaceContent:(r,n,o)=>{t.execCommand("mceInsertContent",!1,o.replace(/\{\$selection\}/g,t.selection.getContent({format:"text"})))},mceNewDocument:()=>{t.setContent(sc(t))}})})(t),(t=>{let r=(r,n,o)=>{let a=N(o)?{href:o}:o,l=t.dom.getParent(t.selection.getNode(),"a");R(a)&&N(a.href)&&(a.href=a.href.replace(/ /g,"%20"),l&&a.href||t.formatter.remove("link"),a.href&&t.formatter.apply("link",a,l))};t.editorCommands.addCommands({unlink:()=>{if(t.selection.isEditable()){if(t.selection.isCollapsed()){let r=t.dom.getParent(t.selection.getStart(),"a");return void(r&&t.dom.remove(r,!0))}t.formatter.remove("link")}},mceInsertLink:r,createLink:r})})(t),t.editorCommands.addCommands({Indent:()=>{yY(t,"indent")},Outdent:()=>{yX(t)}}),t.editorCommands.addCommands({Outdent:()=>yW(t)},"state"),(t=>{t.editorCommands.addCommands({insertParagraph:()=>{wE(wt,t)},mceInsertNewLine:(r,n,o)=>{wk(t,o)},InsertLineBreak:(r,n,o)=>{wE(wd,t)}})})(t),(t=>{t.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":r=>{t.getDoc().execCommand(r);let n=t.dom.getParent(t.selection.getNode(),"ol,ul");if(n){let r=n.parentNode;if(r&&/^(H[1-6]|P|ADDRESS|PRE)$/.test(r.nodeName)){let o=t.selection.getBookmark();t.dom.split(r,n),t.selection.moveToBookmark(o)}}}})})(t),(t=>{t.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":r=>{let n=t.dom.getParent(t.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===r&&"UL"===n.tagName||"insertorderedlist"===r&&"OL"===n.tagName)}},"state")})(t),(t=>{let r=(r,n)=>{t.formatter.toggle(r,n),t.nodeChanged()};t.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":t=>{r(t)},"ForeColor,HiliteColor":(t,n,o)=>{r(t,{value:o})},BackColor:(t,n,o)=>{r("hilitecolor",{value:o})},FontName:(r,n,o)=>{((t,r)=>{let n=Sd(t,r);t.formatter.toggle("fontname",{value:Sc(n)}),t.nodeChanged()})(t,o)},FontSize:(r,n,o)=>{t.formatter.toggle("fontsize",{value:Sd(t,o)}),t.nodeChanged()},LineHeight:(r,n,o)=>{t.formatter.toggle("lineheight",{value:String(o)}),t.nodeChanged()},Lang:(t,n,o)=>{var a;r(t,{value:o.code,customValue:null!==(a=o.customCode)&&void 0!==a?a:null})},RemoveFormat:r=>{t.formatter.remove(r)},mceBlockQuote:()=>{r("blockquote")},FormatBlock:(t,n,o)=>{r(N(o)?o:"p")},mceToggleFormat:(t,n,o)=>{r(o)}})})(t),(t=>{let r=r=>t.formatter.match(r);t.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":t=>r(t),mceBlockQuote:()=>r("blockquote")},"state"),t.editorCommands.addQueryValueHandler("FontName",()=>Ss(t,r=>Sl(t.getBody(),r.dom)).getOr("")),t.editorCommands.addQueryValueHandler("FontSize",()=>Ss(t,r=>Sa(t.getBody(),r.dom)).getOr("")),t.editorCommands.addQueryValueHandler("LineHeight",()=>Ss(t,r=>{let n=rl(t.getBody()),o=go(r,t=>r0(t,"line-height"),q(rg,n));return o.getOrThunk(()=>{let t=parseFloat(rJ(r,"line-height")),n=parseFloat(rJ(r,"font-size"));return String(t/n)})}).getOr(""))})(t),(t=>{t.editorCommands.addCommands({mceRemoveNode:(r,n,o)=>{let a=null!=o?o:t.selection.getNode();if(a!==t.getBody()){let r=t.selection.getBookmark();t.dom.remove(a,!0),t.selection.moveToBookmark(r)}},mcePrint:()=>{t.getWin().print()},mceFocus:(r,n,o)=>{t.removed||(!0===o?u$(t):(t=>{var r;let n=t.selection,o=t.getBody(),a=n.getRng();t.quirks.refreshContentEditable(),L(t.bookmark)&&!uH(t)&&uT(t).each(r=>{t.selection.setRng(r),a=r});let l=(r=n.getNode(),t.dom.getParent(r,r=>"true"===t.dom.getContentEditable(r)));if(l&&t.dom.isChildOf(l,o))return uj(l),uz(t,a),void u$(t);t.inline||(tB.browser.isOpera()||uj(o),t.getWin().focus()),(tB.browser.isFirefox()||t.inline)&&(uj(o),uz(t,a)),u$(t)})(t))},mceToggleVisualAid:()=>{t.hasVisual=!t.hasVisual,t.addVisual()}})})(t)},Sm=["toggleview"],Sf=t=>en(Sm,t.toLowerCase());class Sg{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,r=!1,n,o){let a=this.editor,l=t.toLowerCase(),i=null==o?void 0:o.skip_focus;if(a.removed||("mcefocus"!==l&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(l)||i?(t=>{uT(t).each(r=>t.selection.setRng(r))})(a):a.focus()),a.dispatch("BeforeExecCommand",{command:t,ui:r,value:n}).isDefaultPrevented()))return!1;let s=this.commands.exec[l];return!!M(s)&&(s(l,r,n),a.dispatch("ExecCommand",{command:t,ui:r,value:n}),!0)}queryCommandState(t){if(!Sf(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;let r=t.toLowerCase(),n=this.commands.state[r];return!!M(n)&&n(r)}queryCommandValue(t){if(!Sf(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";let r=t.toLowerCase(),n=this.commands.value[r];return M(n)?n(r):""}addCommands(t,r="exec"){let n=this.commands;eA(t,(t,o)=>{el(o.toLowerCase().split(","),o=>{n[r][o]=t})})}addCommand(t,r,n){let o=t.toLowerCase();this.commands.exec[o]=(t,o,a)=>r.call(null!=n?n:this.editor,o,a)}queryCommandSupported(t){let r=t.toLowerCase();return!!this.commands.exec[r]}addQueryStateHandler(t,r,n){this.commands.state[t.toLowerCase()]=()=>r.call(null!=n?n:this.editor)}addQueryValueHandler(t,r,n){this.commands.value[t.toLowerCase()]=()=>r.call(null!=n?n:this.editor)}}let Sp="data-mce-contenteditable",Sh=(t,r,n)=>{try{t.getDoc().execCommand(r,!1,String(n))}catch(t){}},Sb=(t,r)=>{t.dom.contentEditable=r?"true":"false"},Sv=(t,r)=>{var n;let o=rl(t.getBody());ra(o,n="mce-content-readonly")&&!r?ro(o,n):r&&rr(o,n),r?(t.selection.controlSelection.hideResizeRect(),t._selectionOverrides.hideFakeCaret(),(t=>{J.from(t.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})})(t),t.readonly=!0,Sb(o,!1),el(np(o,'*[contenteditable="true"]'),t=>{t0(t,Sp,"true"),Sb(t,!1)})):(t.readonly=!1,t.hasEditableRoot()&&Sb(o,!0),el(np(o,`*[${Sp}="true"]`),t=>{t5(t,Sp),Sb(t,!0)}),Sh(t,"StyleWithCSS",!1),Sh(t,"enableInlineTableEditing",!1),Sh(t,"enableObjectResizing",!1),(uH(t)||(t=>{let r=rP(rl(t.getElement()));return uE(r).filter(r=>!uL(r.dom)&&uM(t,r.dom)).isSome()})(t))&&t.focus(),(t=>{t.selection.setRng(t.selection.getRng())})(t),t.nodeChanged())},Sy=t=>t.readonly,SC=t=>{t.parser.addAttributeFilter("contenteditable",r=>{Sy(t)&&el(r,t=>{t.attr(Sp,t.attr("contenteditable")),t.attr("contenteditable","false")})}),t.serializer.addAttributeFilter(Sp,r=>{Sy(t)&&el(r,t=>{t.attr("contenteditable",t.attr(Sp))})}),t.serializer.addTempAttr(Sp)},Sx=["copy"],Sw=tM.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class SE{static isNative(t){return!!Sw[t.toLowerCase()]}constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||X}fire(t,r){return this.dispatch(t,r)}dispatch(t,r){let n=t.toLowerCase(),o=ah(n,null!=r?r:{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);let a=this.bindings[n];if(a)for(let t=0,r=a.length;t<r;t++){let r=a[t];if(!r.removed){if(r.once&&this.off(n,r.func),o.isImmediatePropagationStopped())return o;if(!1===r.func.call(this.scope,o))return o.preventDefault(),o}}return o}on(t,r,n,o){if(!1===r&&(r=X),r){let a={func:r,removed:!1};o&&tM.extend(a,o);let l=t.toLowerCase().split(" "),i=l.length;for(;i--;){let t=l[i],r=this.bindings[t];r||(r=[],this.toggleEvent(t,!0)),r=n?[a,...r]:[...r,a],this.bindings[t]=r}}return this}off(t,r){if(t){let n=t.toLowerCase().split(" "),o=n.length;for(;o--;){let a=n[o],l=this.bindings[a];if(!a)return eA(this.bindings,(t,r)=>{this.toggleEvent(r,!1),delete this.bindings[r]}),this;if(l){if(r){let t=es(l,t=>t.func===r);l=t.fail,this.bindings[a]=l,el(t.pass,t=>{t.removed=!0})}else l.length=0;l.length||(this.toggleEvent(t,!1),delete this.bindings[a])}}}else eA(this.bindings,(t,r)=>{this.toggleEvent(r,!1)}),this.bindings={};return this}once(t,r,n){return this.on(t,r,n,{once:!0})}has(t){t=t.toLowerCase();let r=this.bindings[t];return!(!r||0===r.length)}}let Sk=t=>(t._eventDispatcher||(t._eventDispatcher=new SE({scope:t,toggleEvent:(r,n)=>{SE.isNative(r)&&t.toggleNativeEvent&&t.toggleNativeEvent(r,n)}})),t._eventDispatcher),SS={fire(t,r,n){return this.dispatch(t,r,n)},dispatch(t,r,n){if(this.removed&&"remove"!==t&&"detach"!==t)return ah(t.toLowerCase(),null!=r?r:{},this);let o=Sk(this).dispatch(t,r);if(!1!==n&&this.parent){let r=this.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(t,o,!1),r=r.parent?r.parent():void 0}return o},on(t,r,n){return Sk(this).on(t,r,n)},off(t,r){return Sk(this).off(t,r)},once(t,r){return Sk(this).once(t,r)},hasEventListeners(t){return Sk(this).has(t)}},S_=aB.DOM,SN=(t,r)=>{if("selectionchange"===r)return t.getDoc();if(!t.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(r))return t.getDoc().documentElement;let n=iL(t);return n?(t.eventRoot||(t.eventRoot=S_.select(n)[0]),t.eventRoot):t.getBody()},SR=(t,r,n)=>{t.hidden||Sy(t)?Sy(t)&&((t,r)=>{if("click"!==r.type||cB.metaKeyPressed(r))en(Sx,r.type)&&t.dispatch(r.type,r);else{let n=rl(r.target);rq(n,"a",r=>rg(r,rl(t.getBody()))).bind(t=>t3(t,"href")).each(n=>{if(r.preventDefault(),/^#/.test(n)){let r=t.dom.select(`${n},[name="${e1(n,"#")}"]`);r.length&&t.selection.scrollIntoView(r[0],!0)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}})(t,n):t.dispatch(r,n)},SA=(t,n)=>{if(t.delegates||(t.delegates={}),t.delegates[n]||t.removed)return;let o=SN(t,n);if(iL(t)){if(r||(r={},t.editorManager.on("removeEditor",()=>{t.editorManager.activeEditor||r&&(eA(r,(r,n)=>{t.dom.unbind(SN(t,n))}),r=null)})),r[n])return;let a=r=>{let o=r.target,a=t.editorManager.get(),l=a.length;for(;l--;){let t=a[l].getBody();(t===o||S_.isChildOf(o,t))&&SR(a[l],n,r)}};r[n]=a,S_.bind(o,n,a)}else{let r=r=>{SR(t,n,r)};S_.bind(o,n,r),t.delegates[n]=r}},SO={...SS,bindPendingEventDelegates(){let t=this;tM.each(t._pendingNativeEvents,r=>{SA(t,r)})},toggleNativeEvent(t,r){"focus"!==t&&"blur"!==t&&(this.removed||(r?this.initialized?SA(this,t):this._pendingNativeEvents?this._pendingNativeEvents.push(t):this._pendingNativeEvents=[t]:this.initialized&&this.delegates&&(this.dom.unbind(SN(this,t),t,this.delegates[t]),delete this.delegates[t])))},unbindAllNativeEvents(){let t=this,r=t.getBody(),n=t.dom;t.delegates&&(eA(t.delegates,(r,n)=>{t.dom.unbind(SN(t,n),n,r)}),delete t.delegates),!t.inline&&r&&n&&(r.onload=null,n.unbind(t.getWin()),n.unbind(t.getDoc())),n&&(n.unbind(r),n.unbind(t.getContainer()))}},ST=t=>N(t)?{value:t.split(/[ ,]/),valid:!0}:I(t,N)?{value:t,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},SB=(t,r)=>t+(te(r.message)?"":`. ${r.message}`),SD=t=>t.valid,SP=(t,r,n="")=>{let o=r(t);return B(o)?o?{value:t,valid:!0}:{valid:!1,message:n}:o},SL=["design","readonly"],SM=(t,r,n,o)=>{let a=n[r.get()],l=n[o];try{l.activate()}catch(t){return void console.error(`problem while activating editor mode ${o}:`,t)}a.deactivate(),a.editorReadOnly!==l.editorReadOnly&&Sv(t,l.editorReadOnly),r.set(o),((t,r)=>{t.dispatch("SwitchMode",{mode:r})})(t,o)},SF=tM.each,SI=tM.explode,SU={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Sz=tM.makeMap("alt,ctrl,shift,meta,access"),Sj=t=>{let r;let n={},o=tB.os.isMacOS()||tB.os.isiOS();SF(SI(t.toLowerCase(),"+"),t=>{t in Sz?n[t]=!0:/^[0-9]{2,}$/.test(t)?n.keyCode=parseInt(t,10):(n.charCode=t.charCodeAt(0),n.keyCode=SU[t]||t.toUpperCase().charCodeAt(0))});let a=[n.keyCode];for(r in Sz)n[r]?a.push(r):n[r]=!1;return n.id=a.join(","),n.access&&(n.alt=!0,o?n.ctrl=!0:n.shift=!0),n.meta&&(o?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n};class SH{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;let r=this;t.on("keyup keypress keydown",t=>{!r.hasModifier(t)&&!r.isFunctionKey(t)||t.isDefaultPrevented()||(SF(r.shortcuts,n=>{r.matchShortcut(t,n)&&(r.pendingPatterns=n.subpatterns.slice(0),"keydown"===t.type&&r.executeShortcutAction(n))}),r.matchShortcut(t,r.pendingPatterns[0])&&(1===r.pendingPatterns.length&&"keydown"===t.type&&r.executeShortcutAction(r.pendingPatterns[0]),r.pendingPatterns.shift()))})}add(t,r,n,o){let a=this,l=a.normalizeCommandFunc(n);return SF(SI(tM.trim(t)),t=>{let n=a.createShortcut(t,r,l,o);a.shortcuts[n.id]=n}),!0}remove(t){let r=this.createShortcut(t);return!!this.shortcuts[r.id]&&(delete this.shortcuts[r.id],!0)}normalizeCommandFunc(t){let r=this;return"string"==typeof t?()=>{r.editor.execCommand(t,!1,null)}:tM.isArray(t)?()=>{r.editor.execCommand(t[0],t[1],t[2])}:t}createShortcut(t,r,n,o){let a=tM.map(SI(t,">"),Sj);return a[a.length-1]=tM.extend(a[a.length-1],{func:n,scope:o||this.editor}),tM.extend(a[0],{desc:this.editor.translate(r),subpatterns:a.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return"keydown"===t.type&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,r){return!!r&&r.ctrl===t.ctrlKey&&r.meta===t.metaKey&&r.alt===t.altKey&&r.shift===t.shiftKey&&!!(t.keyCode===r.keyCode||t.charCode&&t.charCode===r.charCode)&&(t.preventDefault(),!0)}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}let S$=()=>{let t=(()=>{let t={},r={},n={},o={},a={},l={},i={},s={},d=(t,r)=>(n,o)=>{t[n.toLowerCase()]={...o,type:r}};return{addButton:d(t,"button"),addGroupToolbarButton:d(t,"grouptoolbarbutton"),addToggleButton:d(t,"togglebutton"),addMenuButton:d(t,"menubutton"),addSplitButton:d(t,"splitbutton"),addMenuItem:d(r,"menuitem"),addNestedMenuItem:d(r,"nestedmenuitem"),addToggleMenuItem:d(r,"togglemenuitem"),addAutocompleter:d(n,"autocompleter"),addContextMenu:d(a,"contextmenu"),addContextToolbar:d(l,"contexttoolbar"),addContextForm:d(l,"contextform"),addSidebar:d(i,"sidebar"),addView:d(s,"views"),addIcon:(t,r)=>o[t.toLowerCase()]=r,getAll:()=>({buttons:t,menuItems:r,icons:o,popups:n,contextMenus:a,contextToolbars:l,sidebars:i,views:s})}})();return{addAutocompleter:t.addAutocompleter,addButton:t.addButton,addContextForm:t.addContextForm,addContextMenu:t.addContextMenu,addContextToolbar:t.addContextToolbar,addIcon:t.addIcon,addMenuButton:t.addMenuButton,addMenuItem:t.addMenuItem,addNestedMenuItem:t.addNestedMenuItem,addSidebar:t.addSidebar,addSplitButton:t.addSplitButton,addToggleButton:t.addToggleButton,addGroupToolbarButton:t.addGroupToolbarButton,addToggleMenuItem:t.addToggleMenuItem,addView:t.addView,getAll:t.getAll}},SV=aB.DOM,Sq=tM.extend,SW=tM.each;class SK{constructor(t,r,n){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,Sq(this,SO),this.id=t,this.hidden=!1;let o=k4(k1||k2,k1,r,n.defaultOptions,r);this.options=((t,r)=>{let n={},o={},a=(t,r,n)=>{let a=SP(r,n);return SD(a)?(o[t]=a.value,!0):(console.warn(SB(`Invalid value passed for the ${t} option`,a)),!1)},l=t=>eI(n,t);return{register:(t,l)=>{let i=N(l.processor)?(t=>{let r=(()=>{switch(t){case"array":return O;case"boolean":return B;case"function":return M;case"number":return F;case"object":return R;case"string":return N;case"string[]":return ST;case"object[]":return t=>I(t,R);case"regexp":return t=>_(t,RegExp);default:return Q}})();return n=>SP(n,r,`The value must be a ${t}.`)})(l.processor):l.processor,s=((t,r,n)=>{if(!D(r)){let o=SP(r,n);if(SD(o))return o.value;console.error(SB(`Invalid default value passed for the "${t}" option`,o))}})(t,l.default,i);n[t]={...l,default:s,processor:i},eF(o,t).orThunk(()=>eF(r,t)).each(r=>a(t,r,i))},isRegistered:l,get:t=>eF(o,t).orThunk(()=>eF(n,t).map(t=>t.default)).getOrUndefined(),set:(t,r)=>{if(l(t)){let o=n[t];return o.immutable?(console.error(`"${t}" is an immutable option and cannot be updated`),!1):a(t,r,o.processor)}return console.warn(`"${t}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:t=>{let r=l(t);return r&&delete o[t],r},isSet:t=>eI(o,t)}})(0,o),(t=>{let r=t.options.register;r("id",{processor:"string",default:t.id}),r("selector",{processor:"string"}),r("target",{processor:"object"}),r("suffix",{processor:"string"}),r("cache_suffix",{processor:"string"}),r("base_url",{processor:"string"}),r("referrer_policy",{processor:"string",default:""}),r("language_load",{processor:"boolean",default:!0}),r("inline",{processor:"boolean",default:!1}),r("iframe_attrs",{processor:"object",default:{}}),r("doctype",{processor:"string",default:"<!DOCTYPE html>"}),r("document_base_url",{processor:"string",default:t.documentBaseUrl}),r("body_id",{processor:l5(t,"tinymce"),default:"tinymce"}),r("body_class",{processor:l5(t),default:""}),r("content_security_policy",{processor:"string",default:""}),r("br_in_pre",{processor:"boolean",default:!0}),r("forced_root_block",{processor:t=>{let r=N(t)&&e7(t);return r?{value:t,valid:r}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),r("forced_root_block_attrs",{processor:"object",default:{}}),r("newline_behavior",{processor:t=>{let r=en(["block","linebreak","invert","default"],t);return r?{value:t,valid:r}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),r("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),r("no_newline_selector",{processor:"string",default:""}),r("keep_styles",{processor:"boolean",default:!0}),r("end_container_on_empty_block",{processor:t=>B(t)||N(t)?{valid:!0,value:t}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),r("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),r("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),r("font_size_classes",{processor:"string",default:""}),r("automatic_uploads",{processor:"boolean",default:!0}),r("images_reuse_filename",{processor:"boolean",default:!1}),r("images_replace_blob_uris",{processor:"boolean",default:!0}),r("icons",{processor:"string",default:""}),r("icons_url",{processor:"string",default:""}),r("images_upload_url",{processor:"string",default:""}),r("images_upload_base_path",{processor:"string",default:""}),r("images_upload_credentials",{processor:"boolean",default:!1}),r("images_upload_handler",{processor:"function"}),r("language",{processor:"string",default:"en"}),r("language_url",{processor:"string",default:""}),r("entity_encoding",{processor:"string",default:"named"}),r("indent",{processor:"boolean",default:!0}),r("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),r("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),r("indent_use_margin",{processor:"boolean",default:!1}),r("indentation",{processor:"string",default:"40px"}),r("content_css",{processor:t=>{let r=!1===t||N(t)||I(t,N);return r?N(t)?{value:ea(t.split(","),e6),valid:r}:O(t)?{value:t,valid:r}:!1===t?{value:[],valid:r}:{value:t,valid:r}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:iK(t)?[]:["default"]}),r("content_style",{processor:"string"}),r("content_css_cors",{processor:"boolean",default:!1}),r("font_css",{processor:t=>{let r=N(t)||I(t,N);return r?{value:O(t)?t:ea(t.split(","),e6),valid:r}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),r("inline_boundaries",{processor:"boolean",default:!0}),r("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),r("object_resizing",{processor:t=>{let r=B(t)||N(t);return r?!1===t||lZ.isiPhone()||lZ.isiPad()?{value:"",valid:r}:{value:!0===t?"table,img,figure.image,div,video,iframe":t,valid:r}:{valid:!1,message:"Must be boolean or a string"}},default:!l0}),r("resize_img_proportional",{processor:"boolean",default:!0}),r("event_root",{processor:"object"}),r("service_message",{processor:"string"}),r("theme",{processor:t=>!1===t||N(t)||M(t),default:"silver"}),r("theme_url",{processor:"string"}),r("formats",{processor:"object"}),r("format_empty_lines",{processor:"boolean",default:!1}),r("format_noneditable_selector",{processor:"string",default:""}),r("preview_styles",{processor:t=>{let r=!1===t||N(t);return r?{value:!1===t?"":t,valid:r}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),r("custom_ui_selector",{processor:"string",default:""}),r("hidden_input",{processor:"boolean",default:!0}),r("submit_patch",{processor:"boolean",default:!0}),r("encoding",{processor:"string"}),r("add_form_submit_trigger",{processor:"boolean",default:!0}),r("add_unload_trigger",{processor:"boolean",default:!0}),r("custom_undo_redo_levels",{processor:"number",default:0}),r("disable_nodechange",{processor:"boolean",default:!1}),r("readonly",{processor:"boolean",default:!1}),r("editable_root",{processor:"boolean",default:!0}),r("plugins",{processor:"string[]",default:[]}),r("external_plugins",{processor:"object"}),r("forced_plugins",{processor:"string[]"}),r("model",{processor:"string",default:t.hasPlugin("rtc")?"plugin":"dom"}),r("model_url",{processor:"string"}),r("block_unsupported_drop",{processor:"boolean",default:!0}),r("visual",{processor:"boolean",default:!0}),r("visual_table_class",{processor:"string",default:"mce-item-table"}),r("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),r("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),r("setup",{processor:"function"}),r("init_instance_callback",{processor:"function"}),r("url_converter",{processor:"function",default:t.convertURL}),r("url_converter_scope",{processor:"object",default:t}),r("urlconverter_callback",{processor:"function"}),r("allow_conditional_comments",{processor:"boolean",default:!1}),r("allow_html_data_urls",{processor:"boolean",default:!1}),r("allow_svg_data_urls",{processor:"boolean"}),r("allow_html_in_named_anchor",{processor:"boolean",default:!1}),r("allow_script_urls",{processor:"boolean",default:!1}),r("allow_unsafe_link_target",{processor:"boolean",default:!1}),r("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),r("fix_list_elements",{processor:"boolean",default:!1}),r("preserve_cdata",{processor:"boolean",default:!1}),r("remove_trailing_brs",{processor:"boolean",default:!0}),r("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),r("element_format",{processor:"string",default:"html"}),r("entities",{processor:"string"}),r("schema",{processor:"string",default:"html5"}),r("convert_urls",{processor:"boolean",default:!0}),r("relative_urls",{processor:"boolean",default:!0}),r("remove_script_host",{processor:"boolean",default:!0}),r("custom_elements",{processor:"string"}),r("extended_valid_elements",{processor:"string"}),r("invalid_elements",{processor:"string"}),r("invalid_styles",{processor:l8}),r("valid_children",{processor:"string"}),r("valid_classes",{processor:l8}),r("valid_elements",{processor:"string"}),r("valid_styles",{processor:l8}),r("verify_html",{processor:"boolean",default:!0}),r("auto_focus",{processor:t=>N(t)||!0===t}),r("browser_spellcheck",{processor:"boolean",default:!1}),r("protect",{processor:"array"}),r("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),r("deprecation_warnings",{processor:"boolean",default:!0}),r("a11y_advanced_options",{processor:"boolean",default:!1}),r("api_key",{processor:"string"}),r("paste_block_drop",{processor:"boolean",default:!1}),r("paste_data_images",{processor:"boolean",default:!0}),r("paste_preprocess",{processor:"function"}),r("paste_postprocess",{processor:"function"}),r("paste_webkit_styles",{processor:"string",default:"none"}),r("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),r("paste_merge_formats",{processor:"boolean",default:!0}),r("smart_paste",{processor:"boolean",default:!0}),r("paste_as_text",{processor:"boolean",default:!1}),r("paste_tab_spaces",{processor:"number",default:4}),r("text_patterns",{processor:t=>I(t,R)||!1===t?{value:lJ(!1===t?[]:t),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),r("text_patterns_lookup",{processor:t=>M(t)?{value:r=>{let n=t(r);return lJ(n)},valid:!0}:{valid:!1,message:"Must be a single function"},default:t=>[]}),r("noneditable_class",{processor:"string",default:"mceNonEditable"}),r("editable_class",{processor:"string",default:"mceEditable"}),r("noneditable_regexp",{processor:t=>I(t,l2)?{value:t,valid:!0}:l2(t)?{value:[t],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),r("table_tab_navigation",{processor:"boolean",default:!0}),r("highlight_on_focus",{processor:"boolean",default:!1}),r("xss_sanitization",{processor:"boolean",default:!0}),r("details_initial_state",{processor:t=>{let r=en(["inherited","collapsed","expanded"],t);return r?{value:t,valid:r}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),r("details_serialized_state",{processor:t=>{let r=en(["inherited","collapsed","expanded"],t);return r?{value:t,valid:r}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),r("init_content_sync",{processor:"boolean",default:!1}),r("newdocument_content",{processor:"string",default:""}),t.on("ScriptsLoaded",()=>{r("directionality",{processor:"string",default:aU.isRtl()?"rtl":void 0}),r("placeholder",{processor:"string",default:l1.getAttrib(t.getElement(),"placeholder")})})})(this);let a=this.options.get;a("deprecation_warnings")&&(((t,r)=>{let n=bs(t),o=bu(r),a=o.length>0,l=n.length>0,i="mobile"===r.theme;if(a||l||i){let t=i?`

Themes:
- mobile`:"",r=a?`

Plugins:
- ${o.join("\n- ")}`:"",s=l?`

Options:
- ${n.join("\n- ")}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+t+r+s)}})(r,o),((t,r)=>{let n=bd(t),o=bm(r),a=o.length>0,l=n.length>0;if(a||l){let t=a?`

Plugins:
- ${o.map(bf).join("\n- ")}`:"",r=l?`

Options:
- ${n.join("\n- ")}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+t+r)}})(r,o));let l=a("suffix");l&&(n.suffix=l),this.suffix=n.suffix;let i=a("base_url");i&&n._setBaseUrl(i),this.baseUri=n.baseURI;let s=iw(this);s&&(aP.ScriptLoader._setReferrerPolicy(s),aB.DOM.styleSheetLoader._setReferrerPolicy(s));let d=i2(this);L(d)&&aB.DOM.styleSheetLoader._setContentCssCors(d),az.languageLoad=a("language_load"),az.baseURL=n.baseURL,this.setDirty(!1),this.documentBaseURI=new hs(l4(this),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=iK(this),this.hasVisual=i6(this),this.shortcuts=new SH(this),this.editorCommands=new Sg(this),Su(this);let c=a("cache_suffix");c&&(tB.cacheSuffix=c.replace(/^[\?\&]+/,"")),this.ui={registry:S$(),styleSheetLoader:void 0,show:U,hide:U,setEnabled:U,isEnabled:Q},this.mode=(t=>{let r=aL("design"),n=aL({design:{activate:U,deactivate:U,editorReadOnly:!1},readonly:{activate:U,deactivate:U,editorReadOnly:!0}});return t.serializer?SC(t):t.on("PreInit",()=>{SC(t)}),t.on("ShowCaret",r=>{Sy(t)&&r.preventDefault()}),t.on("ObjectSelected",r=>{Sy(t)&&r.preventDefault()}),{isReadOnly:()=>Sy(t),set:o=>((t,r,n,o)=>{if(o!==n.get()){if(!eI(r,o))throw Error(`Editor mode '${o}' is invalid`);t.initialized?SM(t,n,r,o):t.on("init",()=>SM(t,n,r,o))}})(t,n.get(),r,o),get:()=>r.get(),register:(t,r)=>{n.set(((t,r,n)=>{if(en(SL,r))throw Error(`Cannot override default mode ${r}`);return{...t,[r]:{...n,deactivate:()=>{try{n.deactivate()}catch(t){console.error(`problem while deactivating editor mode ${r}:`,t)}}}}})(n.get(),t,r))}}})(this),n.dispatch("SetupEditor",{editor:this});let u=se(this);M(u)&&u.call(this,this)}render(){(t=>{let r=t.id;aU.setCode(iE(t));let n=()=>{kX.unbind(window,"ready",n),t.render()};if(!aw.Event.domLoaded)return void kX.bind(window,"ready",n);if(!t.getElement())return;let o=rl(t.getElement()),a=t6(o);t.on("remove",()=>{ei(o.dom.attributes,t=>t5(o,t.name)),t1(o,a)}),t.ui.styleSheetLoader=oW.forElement(o,{contentCssCors:i2(t),referrerPolicy:iw(t)}),iK(t)?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden");let l=t.getElement().form||kX.getParent(r,"form");l&&(t.formElement=l,iG(t)&&!nR(t.getElement())&&(kX.insertAfter(kX.create("input",{type:"hidden",name:r}),r),t.hasHiddenInput=!0),t.formEventDelegate=r=>{t.dispatch(r.type,r)},kX.bind(l,"submit reset",t.formEventDelegate),t.on("reset",()=>{t.resetContent()}),!iY(t)||l.submit.nodeType||l.submit.length||l._mceOldSubmit||(l._mceOldSubmit=l.submit,l.submit=()=>(t.editorManager.triggerSave(),t.setDirty(!1),l._mceOldSubmit(l)))),t.windowManager=bN(t),t.notificationManager=bk(t),"xml"===t.options.get("encoding")&&t.on("GetContent",t=>{t.save&&(t.content=kX.encode(t.content))}),iX(t)&&t.on("submit",()=>{t.initialized&&t.save()}),iQ(t)&&(t._beforeUnload=()=>{!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0,set_dirty:!1})},t.editorManager.on("BeforeUnload",t._beforeUnload)),t.editorManager.add(t),kZ(t,t.suffix)})(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return uH(this)}translate(t){return aU.translate(t)}getParam(t,r,n){let o=this.options;return o.isRegistered(t)||(L(n)?o.register(t,{processor:n,default:r}):o.register(t,{processor:Q,default:r})),o.isSet(t)||D(r)?o.get(t):r}hasPlugin(t,r){return!(!en(i3(this),t)||r&&void 0===bS.get(t))}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,r,n){this.editorCommands.addCommand(t,r,n)}addQueryStateHandler(t,r,n){this.editorCommands.addQueryStateHandler(t,r,n)}addQueryValueHandler(t,r,n){this.editorCommands.addQueryValueHandler(t,r,n)}addShortcut(t,r,n,o){this.shortcuts.add(t,r,n,o)}execCommand(t,r,n,o){return this.editorCommands.execCommand(t,r,n,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(SV.show(this.getContainer()),SV.hide(this.id)),this.load(),this.dispatch("show"))}hide(){this.hidden||(this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(SV.hide(this.getContainer()),SV.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,r){this.dispatch("ProgressState",{state:t,time:r})}load(t={}){let r=this.getElement();if(this.removed)return"";if(r){let n={...t,load:!0},o=nR(r)?r.value:r.innerHTML,a=this.setContent(o,n);return n.no_events||this.dispatch("LoadContent",{...n,element:r}),a}return""}save(t={}){let r=this,n=r.getElement();if(!n||!r.initialized||r.removed)return"";let o={...t,save:!0,element:n},a=r.getContent(o),l={...o,content:a};if(l.no_events||r.dispatch("SaveContent",l),"raw"===l.format&&r.dispatch("RawSaveContent",l),a=l.content,nR(n))n.value=a;else{!t.is_removing&&r.inline||(n.innerHTML=a);let o=SV.getParent(r.id,"form");o&&SW(o.elements,t=>t.name!==r.id||(t.value=a,!1))}return l.element=o.element=n=null,!1!==l.set_dirty&&r.setDirty(!1),a}setContent(t,r){return br(this,t,r)}getContent(t){return((t,r={})=>{var n;let o=(n=r.format?r.format:"html",{...r,format:n,get:!0,getInner:!0});return hE(t,o).fold($,r=>{let n=h1(t).editor.getContent(r);return hk(t,n,r)})})(this,t)}insertContent(t,r){r&&(t=Sq({content:t},r)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){void 0===t?br(this,this.startContent,{format:"raw"}):br(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){let r=!this.isNotDirty;this.isNotDirty=!t,t&&t!==r&&this.dispatch("dirty")}getContainer(){return this.container||(this.container=this.editorContainer||SV.get(this.id+"_parent")),this.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=SV.get(this.id)),this.targetElm}getWin(){if(!this.contentWindow){let t=this.iframeElement;t&&(this.contentWindow=t.contentWindow)}return this.contentWindow}getDoc(){if(!this.contentDocument){let t=this.getWin();t&&(this.contentDocument=t.document)}return this.contentDocument}getBody(){var t,r;let n=this.getDoc();return null!==(r=null!==(t=this.bodyElement)&&void 0!==t?t:null==n?void 0:n.body)&&void 0!==r?r:null}convertURL(t,r,n){let o=this.options.get,a=sr(this);return M(a)?a.call(this,t,n,!0,r):!o("convert_urls")||"link"===n||R(n)&&"LINK"===n.nodeName||0===t.indexOf("file:")||0===t.length?t:o("relative_urls")?this.documentBaseURI.toRelative(t):t=this.documentBaseURI.toAbsolute(t,o("remove_script_host"))}addVisual(t){((t,r)=>{h2(t).editor.addVisual(r)})(this,t)}setEditableRoot(t){this._editableRoot!==t&&(this._editableRoot=t,this.readonly||(this.getBody().contentEditable=String(this.hasEditableRoot()),this.nodeChanged()),((t,r)=>{t.dispatch("EditableRootStateChange",{state:r})})(this,t))}hasEditableRoot(){return this._editableRoot}remove(){(t=>{if(!t.removed){let{_selectionOverrides:r,editorUpload:n}=t,o=t.getBody(),a=t.getElement();o&&t.save({is_removing:!0}),t.removed=!0,t.unbindAllNativeEvents(),t.hasHiddenInput&&L(null==a?void 0:a.nextSibling)&&bg.remove(a.nextSibling),(t=>{t.dispatch("remove")})(t),t.editorManager.remove(t),!t.inline&&o&&bg.setStyle(t.id,"display",t.orgDisplay),(t=>{t.dispatch("detach")})(t),bg.remove(t.getContainer()),bp(r),bp(n),t.destroy()}})(this)}destroy(t){((t,r)=>{let{selection:n,dom:o}=t;t.destroyed||(r||t.removed?(r||(t.editorManager.off("beforeunload",t._beforeUnload),t.theme&&t.theme.destroy&&t.theme.destroy(),bp(n),bp(o)),(t=>{let r=t.formElement;r&&(r._mceOldSubmit&&(r.submit=r._mceOldSubmit,delete r._mceOldSubmit),bg.unbind(r,"submit reset",t.formEventDelegate))})(t),(t=>{t.contentAreaContainer=t.formElement=t.container=t.editorContainer=null,t.bodyElement=t.contentDocument=t.contentWindow=null,t.iframeElement=t.targetElm=null;let r=t.selection;if(r){let n=r.dom;t.selection=r.win=r.dom=n.doc=null}})(t),t.destroyed=!0):t.remove())})(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}let SG=aB.DOM,SY=tM.each,SX,SQ=!1,SJ=[],SZ=t=>{let r=t.type;SY(S3.get(),n=>{switch(r){case"scroll":n.dispatch("ScrollWindow",t);break;case"resize":n.dispatch("ResizeWindow",t)}})},S0=t=>{if(t!==SQ){let r=aB.DOM;t?(r.bind(window,"resize",SZ),r.bind(window,"scroll",SZ)):(r.unbind(window,"resize",SZ),r.unbind(window,"scroll",SZ)),SQ=t}},S1=t=>{let r=SJ;return SJ=ed(SJ,r=>t!==r),S3.activeEditor===t&&(S3.activeEditor=SJ.length>0?SJ[0]:null),S3.focusedEditor===t&&(S3.focusedEditor=null),r.length!==SJ.length},S2="CSS1Compat"!==document.compatMode,S3={...SS,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"6.0",releaseDate:"2023-07-12",i18n:aU,activeEditor:null,focusedEditor:null,setup(){let t="",r="",n=hs.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));let o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,r=o.suffix;else{let n=document.getElementsByTagName("script");for(let o=0;o<n.length;o++){let a=n[o].src||"";if(""===a)continue;let l=a.substring(a.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(a)){-1!==l.indexOf(".min")&&(r=".min"),t=a.substring(0,a.lastIndexOf("/"));break}}if(!t&&document.currentScript){let n=document.currentScript.src;-1!==n.indexOf(".min")&&(r=".min"),t=n.substring(0,n.lastIndexOf("/"))}}this.baseURL=new hs(n).toAbsolute(t),this.documentBaseURL=n,this.baseURI=new hs(this.baseURL),this.suffix=r,this.on("AddEditor",q(uI,this)),this.on("RemoveEditor",q(uU,this))},overrideDefaults(t){let r=t.base_url;r&&this._setBaseUrl(r);let n=t.suffix;n&&(this.suffix=n),this.defaultOptions=t;let o=t.plugin_base_urls;void 0!==o&&eA(o,(t,r)=>{az.PluginManager.urls[r]=t})},init(t){let r;let n=this,o=tM.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),a=t=>{r=t},l=()=>{let r,i=0,s=[];SG.unbind(window,"ready",l),(r=>{let o=t.onpageload;o&&o.apply(n,[])})(),r=((t,r)=>{let n=[],o=M(r)?t=>eo(n,n=>r(n,t)):t=>en(n,t);for(let r=0,a=t.length;r<a;r++){let a=t[r];o(a)||n.push(a)}return n})(tB.browser.isIE()||tB.browser.isEdge()?(bB("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):S2?(bB("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):N(t.selector)?SG.select(t.selector):L(t.target)?[t.target]:[]),tM.each(r,t=>{var r;(r=n.get(t.id))&&r.initialized&&!(r.getContainer()||r.getBody()).parentNode&&(S1(r),r.unbindAllNativeEvents(),r.destroy(!0),r.removed=!0)}),0===(r=tM.grep(r,t=>!n.get(t.id))).length?a([]):SY(r,l=>{let d;t.inline&&l.tagName.toLowerCase() in o?bB("Could not initialize inline editor on invalid inline target element",l):((t,o,l)=>{let d=new SK(t,o,n);s.push(d),d.on("init",()=>{++i===r.length&&a(s)}),d.targetElm=d.targetElm||l,d.render()})(((d=l.id)||(d=eF(l,"name").filter(t=>!SG.get(t)).getOrThunk(SG.uniqueId),l.setAttribute("id",d)),d),t,l)})};return SG.bind(window,"ready",l),new Promise(t=>{r?t(r):a=r=>{t(r)}})},get(t){return 0==arguments.length?SJ.slice(0):N(t)?ef(SJ,r=>r.id===t).getOr(null):F(t)&&SJ[t]?SJ[t]:null},add(t){let r=this,n=r.get(t.id);return n===t||(null===n&&SJ.push(t),S0(!0),r.activeEditor=t,r.dispatch("AddEditor",{editor:t}),SX||(SX=t=>{let n=r.dispatch("BeforeUnload");if(n.returnValue)return t.preventDefault(),t.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",SX))),t},createEditor(t,r){return this.add(new SK(t,r,this))},remove(t){let r;let n=this;if(t){if(!N(t))return r=t,T(n.get(r.id))?null:(S1(r)&&n.dispatch("RemoveEditor",{editor:r}),0===SJ.length&&window.removeEventListener("beforeunload",SX),r.remove(),S0(SJ.length>0),r);SY(SG.select(t),t=>{(r=n.get(t.id))&&n.remove(r)})}else for(let t=SJ.length-1;t>=0;t--)n.remove(SJ[t])},execCommand(t,r,n){var o;let a=R(n)?null!==(o=n.id)&&void 0!==o?o:n.index:n;switch(t){case"mceAddEditor":if(!this.get(a)){let t=n.options;new SK(a,t,this).render()}return!0;case"mceRemoveEditor":{let t=this.get(a);return t&&t.remove(),!0}case"mceToggleEditor":{let t=this.get(a);return t?(t.isHidden()?t.show():t.hide(),!0):(this.execCommand("mceAddEditor",!1,n),!0)}}return!!this.activeEditor&&this.activeEditor.execCommand(t,r,n)},triggerSave:()=>{SY(SJ,t=>{t.save()})},addI18n:(t,r)=>{aU.add(t,r)},translate:t=>aU.translate(t),setActive(t){let r=this.activeEditor;this.activeEditor!==t&&(r&&r.dispatch("deactivate",{relatedTarget:t}),t.dispatch("activate",{relatedTarget:r})),this.activeEditor=t},_setBaseUrl(t){this.baseURL=new hs(this.documentBaseURL).toAbsolute(t.replace(/\/+$/,"")),this.baseURI=new hs(this.baseURL)}};S3.setup();let S8=(()=>{let t=aH();return{FakeClipboardItem:t=>({items:t,types:eN(t),getType:r=>eF(t,r).getOrUndefined()}),write:r=>{t.set(r)},read:()=>t.get().getOrUndefined(),clear:t.clear}})(),S5=Math.min,S6=Math.max,S9=Math.round,S4=(t,r,n)=>{let o=r.x,a=r.y,l=t.w,i=t.h,s=r.w,d=r.h,c=(n||"").split("");return"b"===c[0]&&(a+=d),"r"===c[1]&&(o+=s),"c"===c[0]&&(a+=S9(d/2)),"c"===c[1]&&(o+=S9(s/2)),"b"===c[3]&&(a-=i),"r"===c[4]&&(o-=l),"c"===c[3]&&(a-=S9(i/2)),"c"===c[4]&&(o-=S9(l/2)),S7(o,a,l,i)},S7=(t,r,n,o)=>({x:t,y:r,w:n,h:o}),_e=(()=>{let t={},r={};return{load:(n,o)=>{let a=`Script at URL "${o}" failed to load`,l=`Script at URL "${o}" did not call \`tinymce.Resource.add('${n}', data)\` within 1 second`;if(void 0!==t[n])return t[n];{let i=new Promise((t,i)=>{let s=((t,r,n=1e3)=>{let o=!1,a=null,l=t=>(...r)=>{o||(o=!0,null!==a&&(clearTimeout(a),a=null),t.apply(null,r))},i=l(t),s=l(r);return{start:(...t)=>{o||null!==a||(a=setTimeout(()=>s.apply(null,t),n))},resolve:i,reject:s}})(t,i);r[n]=s.resolve,aP.ScriptLoader.loadScript(o).then(()=>s.start(l),()=>s.reject(a))});return t[n]=i,i}},add:(n,o)=>{void 0!==r[n]&&(r[n](o),delete r[n]),t[n]=Promise.resolve(o)},unload:r=>{delete t[r]}}})();try{let t="__storage_test__";(n=window.localStorage).setItem(t,t),n.removeItem(t)}catch(t){n=(()=>{let t={},r=[],n={getItem:r=>t[r]||null,setItem:(n,o)=>{r.push(n),t[n]=String(o)},key:t=>r[t],removeItem:n=>{r=r.filter(t=>t===n),delete t[n]},clear:()=>{r=[],t={}},length:0};return Object.defineProperty(n,"length",{get:()=>r.length,configurable:!1,enumerable:!1}),n})()}let _t={geom:{Rect:{inflate:(t,r,n)=>S7(t.x-r,t.y-n,t.w+2*r,t.h+2*n),relativePosition:S4,findBestRelativePosition:(t,r,n,o)=>{for(let a=0;a<o.length;a++){let l=S4(t,r,o[a]);if(l.x>=n.x&&l.x+l.w<=n.w+n.x&&l.y>=n.y&&l.y+l.h<=n.h+n.y)return o[a]}return null},intersect:(t,r)=>{let n=S6(t.x,r.x),o=S6(t.y,r.y),a=S5(t.x+t.w,r.x+r.w),l=S5(t.y+t.h,r.y+r.h);return a-n<0||l-o<0?null:S7(n,o,a-n,l-o)},clamp:(t,r,n)=>{let o=t.x,a=t.y,l=t.x+t.w,i=t.y+t.h,s=r.x+r.w,d=r.y+r.h,c=S6(0,r.x-o),u=S6(0,r.y-a),m=S6(0,l-s),f=S6(0,i-d);return o+=c,a+=u,n&&(l+=c,i+=u,o-=m,a-=f),S7(o,a,(l-=m)-o,(i-=f)-a)},create:S7,fromClientRect:t=>S7(t.left,t.top,t.width,t.height)}},util:{Delay:uD,Tools:tM,VK:cB,URI:hs,EventDispatcher:SE,Observable:SS,I18n:aU,LocalStorage:n,ImageUploader:t=>{let r=bL(),n=bU(t,r);return{upload:(r,o=!0)=>n.upload(r,o?bI(t):void 0)}}},dom:{EventUtils:aw,TreeWalker:nb,TextSeeker:a7,DOMUtils:aB,ScriptLoader:aP,RangeUtils:ue,Serializer:bt,StyleSheetLoader:oq,ControlSelection:cF,BookmarkManager:ck,Selection:h4,Event:aw.Event},html:{Styles:af,Entities:o7,Node:u8,Schema:am,DomParser:hx,Writer:mr,Serializer:mn},Env:tB,AddOnManager:az,Annotator:cE,Formatter:bQ,UndoManager:bZ,EditorCommands:Sg,WindowManager:bN,NotificationManager:bk,EditorObservable:SO,Shortcuts:SH,Editor:SK,FocusManager:uB,EditorManager:S3,DOM:aB.DOM,ScriptLoader:aP.ScriptLoader,PluginManager:bS,ThemeManager:b_,ModelManager:bb,IconManager:bh,Resource:_e,FakeClipboard:S8,trim:tM.trim,isArray:tM.isArray,is:tM.is,toArray:tM.toArray,makeMap:tM.makeMap,each:tM.each,map:tM.map,grep:tM.grep,inArray:tM.inArray,extend:tM.extend,walk:tM.walk,resolve:tM.resolve,explode:tM.explode,_addCacheSuffix:tM._addCacheSuffix},_r=tM.extend(S3,_t);window.tinymce=_r,window.tinyMCE=_r,(t=>{if("object"==typeof module)try{module.exports=t}catch(t){}})(_r)}();